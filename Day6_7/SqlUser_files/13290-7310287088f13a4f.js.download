(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[13290],{78727:(e,n,i)=>{e.exports=i.p+"133bf0a0b104ec3dfc5b9ab207e54873.svg"},960935:(e,n,i)=>{e.exports=i.p+"c52bdfa460d7b878541ff0d9833e3c7b.svg"},870586:(e,n,i)=>{e.exports=i.p+"93bf1cc8b8b8092aab2c385d85d22c8d.svg"},834818:(e,n,i)=>{e.exports=i.p+"79f07ba26ed583574678b31546848509.svg"},603313:(e,n,i)=>{e.exports=i.p+"33c8b3e3c8d71273ed9abc4d1bec9bcc.svg"},567322:(e,n,i)=>{e.exports=i.p+"5d07fdf28991f39897b8734021141a6f.svg"},604322:(e,n,i)=>{e.exports=i.p+"0d10d16cedc7b8262d0863ae455bb683.svg"},791542:(e,n,i)=>{e.exports=i.p+"774888c01ebff051c2cad178c17079b3.svg"},118356:(e,n,i)=>{e.exports=i.p+"36fd037c0c6525c9044c5c8ef757c740.svg"},952388:(e,n,i)=>{e.exports=i.p+"5066e146579e847ea9f2d818aab586bb.svg"},152248:(e,n,i)=>{e.exports=i.p+"7aa4c2455abe8a0c8cfa1e8e4b93494c.svg"},444257:(e,n,i)=>{e.exports=i.p+"e0420569cdac40ed7e659a1dae697de8.svg"},698037:(e,n,i)=>{"use strict";i.d(n,{hT:()=>a});i(364819);const a={chat:0,channel:0}},763973:(e,n,i)=>{"use strict";i.d(n,{v:()=>a});const a={Chat:"Chat",EduEmptyState:"EduEmptyState",Meeting:"Meeting",Channel:"Channel",ChannelMeeting:"ChannelMeeting",PrivateMeetingSchedulingForm:"PrivateMeetingSchedulingForm",ChannelMeetingSchedulingForm:"ChannelMeetingSchedulingForm",SingleTeamGridView:"SingleTeamGridView",MeetingChat:"MeetingChat",SelectAppEntity:"SelectAppEntity",ChatMakeAsATab:"ChatMakeAsATab",ChannelMakeAsATab:"ChannelMakeAsATab"}},612781:(e,n,i)=>{"use strict";var a,t,r;i.d(n,{NS:()=>a,AR:()=>t,ld:()=>r}),function(e){e[e.Legacy=1]="Legacy",e[e.Store=2]="Store",e[e.InContextGalleryDialogFromChannel=3]="InContextGalleryDialogFromChannel",e[e.InContextGalleryDialogFromGroupChat=4]="InContextGalleryDialogFromGroupChat",e[e.InContextGalleryDialogMoreAppsFromChannel=5]="InContextGalleryDialogMoreAppsFromChannel",e[e.InContextGalleryDialogMoreAppsFromGroupChat=6]="InContextGalleryDialogMoreAppsFromGroupChat",e[e.Flyout=7]="Flyout",e[e.AppsManagementTabView=8]="AppsManagementTabView",e[e.GroupChatAppsManagementView=9]="GroupChatAppsManagementView",e[e.MoreAppFromSamePublisher=10]="MoreAppFromSamePublisher",e[e.MessagingExtensionFlyoutFromChannel=11]="MessagingExtensionFlyoutFromChannel",e[e.MessagingExtensionFlyoutFromChat=12]="MessagingExtensionFlyoutFromChat",e[e.StoreSideload=13]="StoreSideload",e[e.DeepLink=14]="DeepLink",e[e.ConnectorManagementDialog=15]="ConnectorManagementDialog",e[e.AppsManagementTabUpgrade=16]="AppsManagementTabUpgrade",e[e.GroupChatAppsManagementUpgrade=17]="GroupChatAppsManagementUpgrade",e[e.AppsList=18]="AppsList",e[e.TabSdkSideload=19]="TabSdkSideload",e[e.AppsManagementTabFromTeam=20]="AppsManagementTabFromTeam",e[e.AppsManagementTabFromGroupChat=21]="AppsManagementTabFromGroupChat",e[e.AppSuggestionInEmptyChannel=22]="AppSuggestionInEmptyChannel",e[e.MeetingFromGroupchat=23]="MeetingFromGroupchat",e[e.MeetingFromTeam=24]="MeetingFromTeam",e[e.MessagingExtensionFeaturedItem=25]="MessagingExtensionFeaturedItem",e[e.NewMessageUpgrade=26]="NewMessageUpgrade",e[e.AtMentionDirectInstallationFromTeam=27]="AtMentionDirectInstallationFromTeam",e[e.AtMentionDirectInstallationFromGroupChat=28]="AtMentionDirectInstallationFromGroupChat",e[e.PersonalAppBannerUpgrade=29]="PersonalAppBannerUpgrade",e[e.AppBarNew=30]="AppBarNew",e[e.AppsListNew=31]="AppsListNew",e[e.MessagingExtensionFlyoutV2=34]="MessagingExtensionFlyoutV2",e[e.AppsManagementTabFromTeamSideload=35]="AppsManagementTabFromTeamSideload",e[e.AppsManagementTabFromGroupChatSideload=36]="AppsManagementTabFromGroupChatSideload",e[e.PersonalFlyoutAppSearch=37]="PersonalFlyoutAppSearch",e[e.PersonalAppAbout=38]="PersonalAppAbout",e[e.PersonalFlyoutAppSuggestions=39]="PersonalFlyoutAppSuggestions",e[e.ChannelInfoPaneAppWidgetView=40]="ChannelInfoPaneAppWidgetView",e[e.ChannelInfoPaneAppWidgetUpgrade=41]="ChannelInfoPaneAppWidgetUpgrade",e[e.MoreAppsUsedTogether=42]="MoreAppsUsedTogether",e[e.PowerBar=43]="PowerBar",e[e.StageDeepLink=44]="StageDeepLink",e[e.ManageAppsInstalledApp=45]="ManageAppsInstalledApp",e[e.ManageAppsInstalledAppUpgrade=46]="ManageAppsInstalledAppUpgrade",e[e.LobNotifications=47]="LobNotifications",e[e.OnboardingNotifications=48]="OnboardingNotifications",e[e.StoreEditorialArticles=49]="StoreEditorialArticles",e[e.DiscoverAppsNotifications=50]="DiscoverAppsNotifications",e[e.StoreWorkflows=51]="StoreWorkflows",e[e.JITInstallFromPersonalFlyout=52]="JITInstallFromPersonalFlyout",e[e.AutoInstallAppsNotification=53]="AutoInstallAppsNotification",e[e.DeepLinkSideLoad=54]="DeepLinkSideLoad",e[e.DeepLinkTrustedSideLoad=55]="DeepLinkTrustedSideLoad",e[e.ChatListAbout=56]="ChatListAbout",e[e.MessageExtensionFlyout=100]="MessageExtensionFlyout",e[e.Meeting=101]="Meeting",e[e.JITInstallCardAction=102]="JITInstallCardAction",e[e.CardHeaderInstallAction=103]="CardHeaderInstallAction",e[e.ScenePicker=104]="ScenePicker",e[e.MeetingFromChannel=105]="MeetingFromChannel",e[e.Url=106]="Url",e[e.JITInstallConsentOnCard=107]="JITInstallConsentOnCard",e[e.StoreFREDialog=108]="StoreFREDialog",e[e.AdaptiveCard=109]="AdaptiveCard",e[e.MessageExtensionFlyoutSuggestedCollection=110]="MessageExtensionFlyoutSuggestedCollection",e[e.ProactiveMessageForBots=111]="ProactiveMessageForBots",e[e.JITInstallTaskModule=112]="JITInstallTaskModule",e[e.ExposeBotActions=113]="ExposeBotActions",e[e.MessageExtensionCard=114]="MessageExtensionCard",e[e.MeetingFromDeepLink=115]="MeetingFromDeepLink",e[e.UrlPersonalUpgrade=116]="UrlPersonalUpgrade",e[e.MeetingAppsFlyout=117]="MeetingAppsFlyout",e[e.MeetingAppsFlyoutFromChannel=118]="MeetingAppsFlyoutFromChannel",e[e.ReactMessageExtensionFlyoutFromChannel=119]="ReactMessageExtensionFlyoutFromChannel",e[e.ShareFormDialog=120]="ShareFormDialog",e[e.PlatformAppConsentDialog=121]="PlatformAppConsentDialog",e[e.PlatformTabButtonGroupChat=122]="PlatformTabButtonGroupChat",e[e.PlatformTabButtonTeam=123]="PlatformTabButtonTeam",e[e.CopilotInContextGroupChat=124]="CopilotInContextGroupChat",e[e.CopilotInContextMeeting=125]="CopilotInContextMeeting",e[e.CopilotPluginManagerStoreFront=126]="CopilotPluginManagerStoreFront",e[e.ExtensibilityAppPickerFlyoutGroupChat=127]="ExtensibilityAppPickerFlyoutGroupChat",e[e.ExtensibilityAppPickerFlyoutTeam=128]="ExtensibilityAppPickerFlyoutTeam",e[e.ExtensibilityAppPickerSidePanelGroupChat=129]="ExtensibilityAppPickerSidePanelGroupChat",e[e.ExtensibilityAppPickerSidePanelTeam=130]="ExtensibilityAppPickerSidePanelTeam",e[e.ExtensibilityAppPickerSidePanelPersonal=131]="ExtensibilityAppPickerSidePanelPersonal",e[e.ExtensibilityAppPickerFlyoutPersonal=132]="ExtensibilityAppPickerFlyoutPersonal",e[e.ChannelAppManagementTabView=133]="ChannelAppManagementTabView",e[e.InContextStorePersonal=150]="InContextStorePersonal",e[e.MEInContextStoreGroupChat=151]="MEInContextStoreGroupChat",e[e.MEInContextStoreTeam=152]="MEInContextStoreTeam",e[e.TabsInContextStoreGroupChat=153]="TabsInContextStoreGroupChat",e[e.TabsInContextStoreTeam=154]="TabsInContextStoreTeam",e[e.BotsInContextStoreGroupChat=155]="BotsInContextStoreGroupChat",e[e.BotsInContextStoreTeam=156]="BotsInContextStoreTeam",e[e.PlatformAppScopeInstall=157]="PlatformAppScopeInstall",e[e.AppRatingCoachmark=158]="AppRatingCoachmark",e[e.PowerbarMessageExtension=159]="PowerbarMessageExtension",e[e.TeamAppBannerUpgrade=160]="TeamAppBannerUpgrade",e[e.GroupChatAppBannerUpgrade=161]="GroupChatAppBannerUpgrade"}(a||(a={})),function(e){e.AppDetails="AppDetails",e.TCPicker="TCPicker",e.ViewReviews="ViewReviews",e.PostReview="PostReview",e.ReportReview="ReportReview",e.ContextlessConfigPicker="ContextlessConfigPicker"}(t||(t={})),function(e){e.InContext="InContext",e.Update="Update",e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meeting="Meeting",e.RequestAccess="RequestAccess"}(r||(r={}))},30728:(e,n,i)=>{"use strict";var a,t,r;i.d(n,{t7:()=>a,ne:()=>t,j4:()=>r,ZM:()=>l}),function(e){e[e.Card=0]="Card",e[e.MessageExtension=1]="MessageExtension",e[e.PlatformExtensionTab=2]="PlatformExtensionTab",e[e.DeepLink=3]="DeepLink",e[e.ShareToOutlook=4]="ShareToOutlook",e[e.ContentBubble=5]="ContentBubble",e[e.AdaptiveCardTab=6]="AdaptiveCardTab",e[e.BotConfig=7]="BotConfig",e[e.StoreApp=8]="StoreApp",e[e.Workflows=9]="Workflows",e[e.VirtualEvent=10]="VirtualEvent",e[e.BotFeedback=11]="BotFeedback"}(a||(a={})),function(e){e.contentBubble="contentBubble",e.targetedMeetingNotification="targetedMeetingNotification"}(t||(t={})),function(e){e.Small="small",e.Medium="medium",e.Large="large"}(r||(r={}));const l={message:"message",compose:"compose",commandBox:"commandBox",copilot:"copilot",thirdParty:"thirdParty",filesOnedrive:"filesOnedrive",filesSharepoint:"filesSharepoint"}},55265:(e,n,i)=>{"use strict";var a;i.d(n,{Y:()=>a}),function(e){e[e.chat=0]="chat",e[e.channel=1]="channel",e[e.tab=2]="tab",e[e.powerbar=3]="powerbar"}(a||(a={}))},89517:(e,n,i)=>{"use strict";var a,t,r;i.d(n,{$E:()=>a,lO:()=>t,KN:()=>r}),function(e){e.Bot="Bot",e.Connector="Connector",e.MessagingExtension="MessagingExtension",e.Tab="Tab"}(a||(a={})),function(e){e.None="None",e.Files="Files",e.Links="Links",e.Location="Location",e.People="People",e.PinnedMessages="PinnedMessages",e.Photos="Photos",e.Pinned="Pinned",e.Search="Search",e.Tasks="Tasks",e.TimeZone="TimeZone",e.Highlights="Highlights"}(t||(t={})),function(e){e.ORG="org",e.PROJECT="project"}(r||(r={}))},772783:(e,n,i)=>{"use strict";i.d(n,{Jj:()=>a,SN:()=>t,Oe:()=>r,As:()=>o});var a,t,r,l=i(928380);!function(e){e[e.CRITICAL=0]="CRITICAL",e[e.POST_CRITICAL=1]="POST_CRITICAL",e[e.COMPLETE=2]="COMPLETE"}(a||(a={})),function(e){e.LINE_LOADER="line-loader"}(t||(t={})),function(e){e.ALL_PHASE_SIGNALS_RECEIVED="all-phase-signals-received",e.PHASE_PREVIOUSLY_COMPLETED="phase-previously-completed",e.PHASE_STATE_MACHINE_DISPOSED="phase-state-machine-disposed",e.PHASE_TIMEOUT_FIRED="phase-timeout-fired",e.TARGET_AND_PREVIOUS_PHASES_DO_NOT_EXIST="target-and-previous-phases-do-not-exist"}(r||(r={}));const o={[l.sk.HEADER]:{height:{collapsed:"6.1rem",expanded:"30rem"}}}},478522:(e,n,i)=>{"use strict";var a;i.d(n,{B:()=>a}),function(e){e.ag08="ag08",e.ag09="ag09",e.dod="dod",e.gallatin="gallatin",e.gcc="gcc",e.gcchigh="gcchigh",e.life="life",e.prod="prod"}(a||(a={}))},49960:(e,n,i)=>{"use strict";var a,t,r,l,o,d;i.d(n,{bY:()=>a,gG:()=>t,n3:()=>r,f4:()=>l,r$:()=>o,BN:()=>d}),function(e){e[e.general=0]="general",e[e.team=1]="team",e[e.personal=2]="personal",e[e.group=4]="group",e[e.meeting=8]="meeting"}(a||(a={})),function(e){e.installed="installed",e.notInstalled="notInstalled",e.preconsented="preconsented"}(t||(t={})),function(e){e[e.na=0]="na",e[e.bots=1]="bots",e[e.tabs=2]="tabs",e[e.messaging=3]="messaging",e[e.connectors=4]="connectors"}(r||(r={})),function(e){e[e.na=0]="na",e[e.card=1]="card",e[e.deepLink=2]="deepLink",e[e.messageExtension=3]="messageExtension",e[e.platformExtensionTab=4]="platformExtensionTab",e[e.contentBubble=5]="contentBubble",e[e.shareToOutlook=6]="shareToOutlook",e[e.adaptiveCardTab=7]="adaptiveCardTab",e[e.botConfig=8]="botConfig",e[e.storeapp=9]="storeapp",e[e.workflows=10]="workflows",e[e.virtualEvent=11]="virtualEvent",e[e.personalApp=12]="personalApp",e[e.stageViewOpenSDKApi=13]="stageViewOpenSDKApi",e[e.personalAppsFlyout=14]="personalAppsFlyout",e[e.personalAppsFlyoutSearch=15]="personalAppsFlyoutSearch",e[e.botFeedback=16]="botFeedback"}(l||(l={})),function(e){e.bot="bot",e.inputextension="inputextension",e.connectors="connectors"}(o||(o={})),function(e){e.carousel="carousel",e.list="list"}(d||(d={}))},659385:(e,n,i)=>{"use strict";i.d(n,{S:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DataClientPlatformUpdateInContextStoreLaunchInstalledAppResultMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"InContextStoreLaunchInstalledAppInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateInContextStoreLaunchInstalledAppResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},328789:(e,n,i)=>{"use strict";i.d(n,{J:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"setPlatformAppsFetchPolicy"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PlatformAppsFetchPolicyInput"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setPlatformAppsFetchPolicy"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},292992:(e,n,i)=>{"use strict";i.d(n,{h:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"appDefinition"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"developerName"}},{kind:"Field",name:{kind:"Name",value:"developerUrl"}},{kind:"Field",name:{kind:"Name",value:"privacyUrl"}},{kind:"Field",name:{kind:"Name",value:"termsOfUseUrl"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"shortDescription"}},{kind:"Field",name:{kind:"Name",value:"longDescription"}},{kind:"Field",name:{kind:"Name",value:"smallImageUrl"}},{kind:"Field",name:{kind:"Name",value:"largeImageUrl"}},{kind:"Field",name:{kind:"Name",value:"accentColor"}},{kind:"Field",name:{kind:"Name",value:"categories"}},{kind:"Field",name:{kind:"Name",value:"validDomains"}},{kind:"Field",name:{kind:"Name",value:"externalId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"isBlocked"}},{kind:"Field",name:{kind:"Name",value:"isFullScreenApp"}},{kind:"Field",name:{kind:"Name",value:"isFullTrustApp"}},{kind:"Field",name:{kind:"Name",value:"isMicrosoftOwned"}},{kind:"Field",name:{kind:"Name",value:"showTabLoadingIndicator"}},{kind:"Field",name:{kind:"Name",value:"bots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"botDefinition"}}]}},{kind:"Field",name:{kind:"Name",value:"customBots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"endpointUrl"}},{kind:"Field",name:{kind:"Name",value:"secret"}}]}},{kind:"Field",name:{kind:"Name",value:"connectors"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorId"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"configurationUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"galleryTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"configurationUrl"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"canHaveTabConversation"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"meetingSurfaces"}},{kind:"Field",name:{kind:"Name",value:"context"}}]}},{kind:"Field",name:{kind:"Name",value:"staticTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"order"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}},{kind:"Field",name:{kind:"Name",value:"contentBotId"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"containerAppIds"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingExtensionDefinition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isAnonymousAccessAllowed"}},{kind:"Field",name:{kind:"Name",value:"supportsStreaming"}},{kind:"Field",name:{kind:"Name",value:"scenes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"file"}},{kind:"Field",name:{kind:"Name",value:"preview"}},{kind:"Field",name:{kind:"Name",value:"maxAudience"}},{kind:"Field",name:{kind:"Name",value:"seatsReservedForOrganizersOrPresenters"}}]}},{kind:"Field",name:{kind:"Name",value:"filters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}}]}},{kind:"Field",name:{kind:"Name",value:"videoAppContentUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"authorization"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"orgWide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"resourceSpecific"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"fetchCommands"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"initialRun"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"parameters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"inputType"}},{kind:"Field",name:{kind:"Name",value:"value"}},{kind:"Field",name:{kind:"Name",value:"isRequired"}},{kind:"Field",name:{kind:"Name",value:"choices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"appKey"}},{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"messageHandlers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"value"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"domains"}},{kind:"Field",name:{kind:"Name",value:"supportsAnonymousAccess"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"authorization"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authType"}},{kind:"Field",name:{kind:"Name",value:"microsoftEntraConfiguration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"supportsSingleSignOn"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"webApplicationInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appKey"}},{kind:"Field",name:{kind:"Name",value:"resource"}},{kind:"Field",name:{kind:"Name",value:"applicationPermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"screenshotUrls"}},{kind:"Field",name:{kind:"Name",value:"officeAssetId"}},{kind:"Field",name:{kind:"Name",value:"videoUrl"}},{kind:"Field",name:{kind:"Name",value:"devicePermissions"}},{kind:"Field",name:{kind:"Name",value:"securityComplianceInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mcasId"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"csaId"}},{kind:"Field",name:{kind:"Name",value:"csaName"}}]}},{kind:"Field",name:{kind:"Name",value:"defaultInstallScope"}},{kind:"Field",name:{kind:"Name",value:"defaultGroupCapability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"team"}},{kind:"Field",name:{kind:"Name",value:"groupchat"}},{kind:"Field",name:{kind:"Name",value:"meetings"}}]}},{kind:"Field",name:{kind:"Name",value:"subscriptionOffer"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"offerId"}}]}},{kind:"Field",name:{kind:"Name",value:"manifestVersion"}},{kind:"Field",name:{kind:"Name",value:"blockedConfigurations"}}]}},...i(780706).x.definitions]}},214919:(e,n,i)=>{"use strict";i.d(n,{j:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"appsUsageFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppsUsage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIds"}},{kind:"Field",name:{kind:"Name",value:"appActions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"actionId"}}]}},{kind:"Field",name:{kind:"Name",value:"appScenes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"sceneId"}}]}},{kind:"Field",name:{kind:"Name",value:"appsMru"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"lastUsedTimeStamp"}}]}}]}}]}},780706:(e,n,i)=>{"use strict";i.d(n,{x:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"botDefinition"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BotDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"capabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isNotificationOnly"}},{kind:"Field",name:{kind:"Name",value:"supportsFiles"}},{kind:"Field",name:{kind:"Name",value:"supportsCalling"}},{kind:"Field",name:{kind:"Name",value:"supportsVideo"}}]}},{kind:"Field",name:{kind:"Name",value:"commandLists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"configuration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupChat"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"team"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}}]}}]}}]}},74570:(e,n,i)=>{"use strict";i.d(n,{mR:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"broadcastMeetingFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastMeeting"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"composerStreamId"}},{kind:"Field",name:{kind:"Name",value:"broadcastState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"broadcastStateFields"}}]}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"broadcastCommandsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"broadcastMaxAllowedDuration"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"broadcastStateFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastState"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"broadcastCommandsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastProducerAvailableCommands"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setLayout"}},{kind:"Field",name:{kind:"Name",value:"start"}},{kind:"Field",name:{kind:"Name",value:"stop"}},{kind:"Field",name:{kind:"Name",value:"updateMediaState"}},{kind:"Field",name:{kind:"Name",value:"restart"}}]}}]}.definitions]}},647541:(e,n,i)=>{"use strict";i.d(n,{s:()=>r});var a=i(617276),t=i(93852);const r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Call"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonCallUpdateFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonCallMuteFragment"},directives:[{kind:"Directive",name:{kind:"Name",value:"nonreactive"}},{kind:"Directive",name:{kind:"Name",value:"mask"}}]}]}},...a.k.definitions,...t.c.definitions]}},441065:(e,n,i)=>{"use strict";i.d(n,{q:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConsumptionHorizonBookmark"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}}]}}]}},308696:(e,n,i)=>{"use strict";i.d(n,{U:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"consumptionHorizonFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConsumptionHorizon"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}}]}}]}},40341:(e,n,i)=>{"use strict";i.d(n,{n:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonActiveCallFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ActiveCallOfConversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"callType"}}]}}]}},93852:(e,n,i)=>{"use strict";i.d(n,{c:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonCallMuteFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Call"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"isMuted"}},{kind:"Field",name:{kind:"Name",value:"isMutePending"}},{kind:"Field",name:{kind:"Name",value:"state"}}]}}]}},617276:(e,n,i)=>{"use strict";i.d(n,{k:()=>o});var a=i(534813),t=i(74570),r=i(111130),l=i(93192);const o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonCallUpdateFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Call"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"participantId"}},{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"callType"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"callMode"}},{kind:"Field",name:{kind:"Name",value:"extendedCallState"}},{kind:"Field",name:{kind:"Name",value:"groupKeyManagerMri"}},{kind:"Field",name:{kind:"Name",value:"transferorMri"}},{kind:"Field",name:{kind:"Name",value:"isFake"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}},{kind:"Field",name:{kind:"Name",value:"isServerMuted"}},{kind:"Field",name:{kind:"Name",value:"isSpeakerMuted"}},{kind:"Field",name:{kind:"Name",value:"isCallParked"}},{kind:"Field",name:{kind:"Name",value:"isHandRaised"}},{kind:"Field",name:{kind:"Name",value:"selfRaiseHandsRank"}},{kind:"Field",name:{kind:"Name",value:"isSpotlighted"}},{kind:"Field",name:{kind:"Name",value:"isSpotlightFeatureEnabled"}},{kind:"Field",name:{kind:"Name",value:"isCompositorEnabled"}},{kind:"Field",name:{kind:"Name",value:"isWeatherpersonCompositionEnabled"}},{kind:"Field",name:{kind:"Name",value:"isWeatherpersonPresenterEnabled"}},{kind:"Field",name:{kind:"Name",value:"isWatermarkEnabled"}},{kind:"Field",name:{kind:"Name",value:"isTogetherModePinned"}},{kind:"Field",name:{kind:"Name",value:"isMultilingualMeeting"}},{kind:"Field",name:{kind:"Name",value:"supportedSharingLayouts"}},{kind:"Field",name:{kind:"Name",value:"isAplCustomBackgroundEnabled"}},{kind:"Field",name:{kind:"Name",value:"aplCustomBackgroundId"}},{kind:"Field",name:{kind:"Name",value:"isPPTWeatherpersonEnabled"}},{kind:"Field",name:{kind:"Name",value:"isExtensibleAppWeatherpersonEnabled"}},{kind:"Field",name:{kind:"Name",value:"isPPTSbSAndReporterEnabled"}},{kind:"Field",name:{kind:"Name",value:"isPPTCameoEnabled"}},{kind:"Field",name:{kind:"Name",value:"isPPTSharingAvailable"}},{kind:"Field",name:{kind:"Name",value:"isCameoPresenterEnabled"}},{kind:"Field",name:{kind:"Name",value:"isAnnotationSharerWindowOn"}},{kind:"Field",name:{kind:"Name",value:"meetingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"organizerUpn"}}]}},{kind:"Field",name:{kind:"Name",value:"screenSharingBounds"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"top"}},{kind:"Field",name:{kind:"Name",value:"left"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}},{kind:"Field",name:{kind:"Name",value:"multipleScreenshareActive"}},{kind:"Field",name:{kind:"Name",value:"isMovePrivateViewingToPPTEnabled"}},{kind:"Field",name:{kind:"Name",value:"isWhiteboardVideoEffectOn"}},{kind:"Field",name:{kind:"Name",value:"sharingLayoutMode"}},{kind:"Field",name:{kind:"Name",value:"isBreakoutRoomsFeatureEnabled"}},{kind:"Field",name:{kind:"Name",value:"isRaiseHandsEnabledForStreaming"}},{kind:"Field",name:{kind:"Name",value:"isNdiEnabled"}},{kind:"Field",name:{kind:"Name",value:"isRaiseHandsAllowed"}},{kind:"Field",name:{kind:"Name",value:"isVideoOn"}},{kind:"Field",name:{kind:"Name",value:"closedCaptionsLanguage"}},{kind:"Field",name:{kind:"Name",value:"optimalVideoCount"}},{kind:"Field",name:{kind:"Name",value:"isIncomingVideoOn"}},{kind:"Field",name:{kind:"Name",value:"isScreenSharingOn"}},{kind:"Field",name:{kind:"Name",value:"isSharingMuted"}},{kind:"Field",name:{kind:"Name",value:"sharingSourceType"}},{kind:"Field",name:{kind:"Name",value:"isReconciled"}},{kind:"Field",name:{kind:"Name",value:"isMergeable"}},{kind:"Field",name:{kind:"Name",value:"isPSTNEnabled"}},{kind:"Field",name:{kind:"Name",value:"isRejoinable"}},{kind:"Field",name:{kind:"Name",value:"failureType"}},{kind:"Field",name:{kind:"Name",value:"abortReason"}},{kind:"Field",name:{kind:"Name",value:"hadRelayWhitelistingIssue"}},{kind:"Field",name:{kind:"Name",value:"isRoomEndedByOrganizer"}},{kind:"Field",name:{kind:"Name",value:"isRoomEndedByTimer"}},{kind:"Field",name:{kind:"Name",value:"hadReconnectingIssue"}},{kind:"Field",name:{kind:"Name",value:"wasNotAdmittedForLongTime"}},{kind:"Field",name:{kind:"Name",value:"isPushToTalkEnabled"}},{kind:"Field",name:{kind:"Name",value:"capabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isTransferAllowed"}},{kind:"Field",name:{kind:"Name",value:"isCallParkAvailable"}},{kind:"Field",name:{kind:"Name",value:"isVideoPreviewDisabled"}},{kind:"Field",name:{kind:"Name",value:"isVideoBackgroundSettingsDisabled"}},{kind:"Field",name:{kind:"Name",value:"isPSTNCallbackOptionDisabled"}},{kind:"Field",name:{kind:"Name",value:"isSafeTransferAllowed"}},{kind:"Field",name:{kind:"Name",value:"isCloudRecordingAllowed"}},{kind:"Field",name:{kind:"Name",value:"isLocalRecordingAllowed"}},{kind:"Field",name:{kind:"Name",value:"isTranscriptionAllowed"}},{kind:"Field",name:{kind:"Name",value:"isIpVideoAllowed"}},{kind:"Field",name:{kind:"Name",value:"isSingleOutgoingVideoEnabled"}},{kind:"Field",name:{kind:"Name",value:"isBreakoutRoomsAllowed"}},{kind:"Field",name:{kind:"Name",value:"isDocumentCollaborationAllowed"}},{kind:"Field",name:{kind:"Name",value:"isPowerPointSharingAllowed"}},{kind:"Field",name:{kind:"Name",value:"isWhiteboardAllowed"}},{kind:"Field",name:{kind:"Name",value:"allowedRecorder"}},{kind:"Field",name:{kind:"Name",value:"meetingLegalUrl"}},{kind:"Field",name:{kind:"Name",value:"isExternalTenantContentSharingDisabled"}},{kind:"Field",name:{kind:"Name",value:"interpretationEnabled"}}]}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"conversationType"}},{kind:"Field",name:{kind:"Name",value:"dominantSpeakerInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dominantSpeakerInfoFields"}}]}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"isBroadcast"}},{kind:"Field",name:{kind:"Name",value:"broadcastMeeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"broadcastMeetingFields"}}]}},{kind:"Field",name:{kind:"Name",value:"extendedCallType"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isOneToOnePstn"}},{kind:"Field",name:{kind:"Name",value:"isScreenshareFromChat"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"isInterop"}},{kind:"Field",name:{kind:"Name",value:"isVoicemailGreeting"}},{kind:"Field",name:{kind:"Name",value:"isEchoBotCall"}},{kind:"Field",name:{kind:"Name",value:"isContentOnlyMode"}},{kind:"Field",name:{kind:"Name",value:"isEmergencyCall"}},{kind:"Field",name:{kind:"Name",value:"isConsultCall"}},{kind:"Field",name:{kind:"Name",value:"isSkypeForConsumerCall"}},{kind:"Field",name:{kind:"Name",value:"isMeetingTransferred"}},{kind:"Field",name:{kind:"Name",value:"isHolographicCall"}},{kind:"Field",name:{kind:"Name",value:"isVideoTeleConferencingCall"}},{kind:"Field",name:{kind:"Name",value:"isAudioDropInCall"}},{kind:"Field",name:{kind:"Name",value:"isGroupCall"}}]}},{kind:"Field",name:{kind:"Name",value:"consultContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"consultingWith"}},{kind:"Field",name:{kind:"Name",value:"canTransfer"}}]}},{kind:"Field",name:{kind:"Name",value:"canBeRetried"}},{kind:"Field",name:{kind:"Name",value:"isPresenterConnected"}},{kind:"Field",name:{kind:"Name",value:"isVideoLive"}},{kind:"Field",name:{kind:"Name",value:"isScreenShareLive"}},{kind:"Field",name:{kind:"Name",value:"isCoachSupported"}},{kind:"Field",name:{kind:"Name",value:"meetingRole"}},{kind:"Field",name:{kind:"Name",value:"screenSharingControlStateAsViewer"}},{kind:"Field",name:{kind:"Name",value:"callerMri"}},{kind:"Field",name:{kind:"Name",value:"canAddParticipants"}},{kind:"Field",name:{kind:"Name",value:"callHeldAt"}},{kind:"Field",name:{kind:"Name",value:"selfCapabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canUnmuteSelf"}},{kind:"Field",name:{kind:"Name",value:"canMuteOthers"}}]}},{kind:"Field",name:{kind:"Name",value:"emergencyCallInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"myRoleInEmergencyCall"}},{kind:"Field",name:{kind:"Name",value:"callerLocation"}},{kind:"Field",name:{kind:"Name",value:"callerNumber"}},{kind:"Field",name:{kind:"Name",value:"emergencyCalleeMri"}},{kind:"Field",name:{kind:"Name",value:"chatExists"}}]}},{kind:"Field",name:{kind:"Name",value:"reconciledOriginalId"}},{kind:"Field",name:{kind:"Name",value:"pstnCapabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isDialInEnabled"}},{kind:"Field",name:{kind:"Name",value:"isDialOutEnabled"}},{kind:"Field",name:{kind:"Name",value:"isLbrEnabledUser"}}]}},{kind:"Field",name:{kind:"Name",value:"forwardingDestinationType"}},{kind:"Field",name:{kind:"Name",value:"callStateProps"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"hyperLinkInTitle"}},{kind:"Field",name:{kind:"Name",value:"descriptionText"}},{kind:"Field",name:{kind:"Name",value:"icon"}},{kind:"Field",name:{kind:"Name",value:"useOutlineIcon"}},{kind:"Field",name:{kind:"Name",value:"telemetryContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isScdEnabled"}},{kind:"Field",name:{kind:"Name",value:"isScdAvailable"}},{kind:"Field",name:{kind:"Name",value:"terminatedReason"}},{kind:"Field",name:{kind:"Name",value:"mappedToMeetingRoom"}},{kind:"Field",name:{kind:"Name",value:"breakoutRoomsParticipantDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ParticipantMainMeetingDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"showJoinRoomButton"}},{kind:"Field",name:{kind:"Name",value:"assignedRoomName"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"breakoutRoomsCount"}},{kind:"Field",name:{kind:"Name",value:"openBreakoutRoomsCount"}},{kind:"Field",name:{kind:"Name",value:"breakoutRoomDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"remainingRoomDuration"}},{kind:"Field",name:{kind:"Name",value:"initializedAt"}},{kind:"Field",name:{kind:"Name",value:"remainingRoomDurationMs"}},{kind:"Field",name:{kind:"Name",value:"isBreakoutRoom"}},{kind:"Field",name:{kind:"Name",value:"isBreakoutRoomMain"}},{kind:"Field",name:{kind:"Name",value:"additionalData"}},{kind:"Field",name:{kind:"Name",value:"participantInControl"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"participantId"}}]}},{kind:"Field",name:{kind:"Name",value:"managerUserIds"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}},{kind:"Field",name:{kind:"Name",value:"isBreakoutRoomInvite"}},{kind:"Field",name:{kind:"Name",value:"isMainMeetingInvite"}},{kind:"Field",name:{kind:"Name",value:"initiatedTime"}},{kind:"Field",name:{kind:"Name",value:"maskedIdentityDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isIdentityMasked"}},{kind:"Field",name:{kind:"Name",value:"maskedIdSeqNumber"}},{kind:"Field",name:{kind:"Name",value:"maskedId"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meetingCode"}},{kind:"Field",name:{kind:"Name",value:"passcode"}},{kind:"Field",name:{kind:"Name",value:"meetingUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meetingCapability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lockMeeting"}},{kind:"Field",name:{kind:"Name",value:"allowMeetingReactions"}},{kind:"Field",name:{kind:"Name",value:"copilotMode"}},{kind:"Field",name:{kind:"Name",value:"isHostViewModeActive"}},{kind:"Field",name:{kind:"Name",value:"yammerQNAEnabled"}},{kind:"Field",name:{kind:"Name",value:"breakoutRoomsEnabled"}},{kind:"Field",name:{kind:"Name",value:"watermarkScreenShareEnabled"}},{kind:"Field",name:{kind:"Name",value:"watermarkVideoEnabled"}},{kind:"Field",name:{kind:"Name",value:"watermarkScreenShareSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"opacity"}},{kind:"Field",name:{kind:"Name",value:"pattern"}}]}},{kind:"Field",name:{kind:"Name",value:"watermarkVideoSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"opacity"}},{kind:"Field",name:{kind:"Name",value:"pattern"}}]}},{kind:"Field",name:{kind:"Name",value:"sensitivityLabelId"}},{kind:"Field",name:{kind:"Name",value:"maskIdentitiesForRole"}},{kind:"Field",name:{kind:"Name",value:"forceAttendeeStreaming"}},{kind:"Field",name:{kind:"Name",value:"meetingEndToEndEncryptionEnabled"}},{kind:"Field",name:{kind:"Name",value:"streamingModeActive"}},{kind:"Field",name:{kind:"Name",value:"allowTranslatedCaptions"}},{kind:"Field",name:{kind:"Name",value:"enableParticipantRenaming"}},{kind:"Field",name:{kind:"Name",value:"isPresenterCapabilitiesReduced"}},{kind:"Field",name:{kind:"Name",value:"hasCommentStream"}},{kind:"Field",name:{kind:"Name",value:"usersCanAdmitFromLobby"}},{kind:"Field",name:{kind:"Name",value:"whoCanAccessTranscriptAndRecording"}},{kind:"Field",name:{kind:"Name",value:"transcriptAndRecordingUsers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"upn"}}]}},{kind:"Field",name:{kind:"Name",value:"groupCopilotDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"enabled"}}]}},{kind:"Field",name:{kind:"Name",value:"isCopyRestrictionEnforced"}}]}},{kind:"Field",name:{kind:"Name",value:"exchangeId"}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"isChannelMeeting"}},{kind:"Field",name:{kind:"Name",value:"isPrivateMeeting"}},{kind:"Field",name:{kind:"Name",value:"isRecurring"}},{kind:"Field",name:{kind:"Name",value:"meetingType"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"anyWaterMarkLegacyUserEverInMeeting"}},{kind:"Field",name:{kind:"Name",value:"masterEventDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"subject"}}]}},{kind:"Field",name:{kind:"Name",value:"eventDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"subject"}}]}},{kind:"Field",name:{kind:"Name",value:"templateDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"channelObjectId"}},{kind:"Field",name:{kind:"Name",value:"channelTenantId"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingArtifacts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingArtifactsCollection"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingInterpretationDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLiveInterpretationEnabled"}},{kind:"Field",name:{kind:"Name",value:"isAiInterpretationEnabled"}},{kind:"Field",name:{kind:"Name",value:"groups"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"label"}},{kind:"Field",name:{kind:"Name",value:"interpreters"}}]}},{kind:"Field",name:{kind:"Name",value:"floor"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"label"}}]}},{kind:"Field",name:{kind:"Name",value:"liveInterpreterCount"}},{kind:"Field",name:{kind:"Name",value:"liveInterpretationLanguagePairs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"target"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"selfInterpretationDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isInterpreter"}},{kind:"Field",name:{kind:"Name",value:"isAiInterpretationEnabledForSelf"}},{kind:"Field",name:{kind:"Name",value:"group"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"label"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"interpretationVolumeRate"}},{kind:"Field",name:{kind:"Name",value:"selfBidirectionalInterpretationDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"label"}}]}},{kind:"Field",name:{kind:"Name",value:"appliedInteractivityLevel"}},{kind:"Field",name:{kind:"Name",value:"sharingPresenterIds"}},{kind:"Field",name:{kind:"Name",value:"isHighFidelityAudioEnabled"}},{kind:"Field",name:{kind:"Name",value:"hasOverflowRoom"}},{kind:"Field",name:{kind:"Name",value:"shouldAutoRejoin"}},{kind:"Field",name:{kind:"Name",value:"vdiCapabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"video"}},{kind:"Field",name:{kind:"Name",value:"screenshare"}},{kind:"Field",name:{kind:"Name",value:"appshare"}},{kind:"Field",name:{kind:"Name",value:"hid"}},{kind:"Field",name:{kind:"Name",value:"multimonitorscreenshare"}},{kind:"Field",name:{kind:"Name",value:"remoteaudionotifications"}},{kind:"Field",name:{kind:"Name",value:"compositedevices"}},{kind:"Field",name:{kind:"Name",value:"multiwindow"}},{kind:"Field",name:{kind:"Name",value:"datachannel"}},{kind:"Field",name:{kind:"Name",value:"givecontrol"}},{kind:"Field",name:{kind:"Name",value:"sharesystemaudio"}},{kind:"Field",name:{kind:"Name",value:"backgroundeffects"}}]}},{kind:"Field",name:{kind:"Name",value:"rtmpInProperties"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"rtmpEnabled"}}]}},{kind:"Field",name:{kind:"Name",value:"stagingRoomProperties"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"eventActive"}},{kind:"Field",name:{kind:"Name",value:"eventEnded"}},{kind:"Field",name:{kind:"Name",value:"stagingRoomEnabled"}},{kind:"Field",name:{kind:"Name",value:"eventIsLoading"}}]}},{kind:"Field",name:{kind:"Name",value:"callLimits"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sponsor"}}]}},{kind:"Field",name:{kind:"Name",value:"callEndDiagnosticsInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callControllerCode"}},{kind:"Field",name:{kind:"Name",value:"callControllerSubCode"}}]}},{kind:"Field",name:{kind:"Name",value:"acceptedElsewhereBy"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}}]}},{kind:"Field",name:{kind:"Name",value:"isImmersiveViewActive"}},{kind:"Field",name:{kind:"Name",value:"isImmersiveViewActiveLoading"}},{kind:"Field",name:{kind:"Name",value:"userEndpointCount"}},{kind:"Field",name:{kind:"Name",value:"isAppHandlingAudio"}},{kind:"Field",name:{kind:"Name",value:"displayNameOverride"}},{kind:"Field",name:{kind:"Name",value:"brandingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"defaultTheme"}},{kind:"Field",name:{kind:"Name",value:"meetingBrandingThemes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"identity"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"enabled"}},{kind:"Field",name:{kind:"Name",value:"brandAccentColor"}},{kind:"Field",name:{kind:"Name",value:"logoImageLightUri"}},{kind:"Field",name:{kind:"Name",value:"logoImageDarkUri"}},{kind:"Field",name:{kind:"Name",value:"backgroundImageLightUri"}},{kind:"Field",name:{kind:"Name",value:"backgroundImageDarkUri"}}]}},{kind:"Field",name:{kind:"Name",value:"lobbyLogoBrandingImages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"imageUri"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"transcriptOrganizerId"}},{kind:"Field",name:{kind:"Name",value:"transferTargetDisplayName"}},{kind:"Field",name:{kind:"Name",value:"isApplianceMode"}},{kind:"Field",name:{kind:"Name",value:"intent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"participants"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"isServerHold"}},{kind:"Field",name:{kind:"Name",value:"callOrigin"}},{kind:"Field",name:{kind:"Name",value:"participantType"}},{kind:"Field",name:{kind:"Name",value:"backroomChatThreadId"}},{kind:"Field",name:{kind:"Name",value:"commentStreamThreadId"}},{kind:"Field",name:{kind:"Name",value:"isSomeoneInImmersiveView"}},{kind:"Field",name:{kind:"Name",value:"isSomeoneInImmersiveSpace"}},{kind:"Field",name:{kind:"Name",value:"isOfficePreloadAllowed"}},{kind:"Field",name:{kind:"Name",value:"nativeMeetingStageCapability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"enabled"}},{kind:"Field",name:{kind:"Name",value:"level"}}]}},{kind:"Field",name:{kind:"Name",value:"monitoredAgentState"}},{kind:"Field",name:{kind:"Name",value:"invitationData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"proximitySource"}},{kind:"Field",name:{kind:"Name",value:"deviceType"}}]}},{kind:"Field",name:{kind:"Name",value:"isAcsInteropCall"}},{kind:"Field",name:{kind:"Name",value:"isScreenshareFromChatCallEscalated"}},{kind:"Field",name:{kind:"Name",value:"isPstnCallEscalated"}},{kind:"Field",name:{kind:"Name",value:"callQueueInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"onBehalfOf"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"enableCaptcha"}},{kind:"Field",name:{kind:"Name",value:"roomPeopleCount"}},{kind:"Field",name:{kind:"Name",value:"isCallMonitored"}},{kind:"Field",name:{kind:"Name",value:"monitoredAgentState"}},{kind:"Field",name:{kind:"Name",value:"sipMeetingMetaData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"meetingType"}},{kind:"Field",name:{kind:"Name",value:"passcode"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"deviceMetadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"numDisplays"}},{kind:"Field",name:{kind:"Name",value:"platform"}},{kind:"Field",name:{kind:"Name",value:"appVersion"}},{kind:"Field",name:{kind:"Name",value:"modelName"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"endpoints"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"endpointDetailsFields"}}]}}]}},...a.T.definitions,...t.mR.definitions,...r.PP.definitions,...l.He.definitions]}},566424:(e,n,i)=>{"use strict";i.d(n,{h:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonChatAddMembersFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"cfet"}},{kind:"Field",name:{kind:"Name",value:"chatSubType"}},{kind:"Field",name:{kind:"Name",value:"guardianChatInfo"}},{kind:"Field",name:{kind:"Name",value:"hasFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsUnverifiedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsVerifiedUser"}},{kind:"Field",name:{kind:"Name",value:"isMeeting"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOneBotChat"}},{kind:"Field",name:{kind:"Name",value:"isUserMember"}},{kind:"Field",name:{kind:"Name",value:"memberIds"}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUserLength"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"interopConversationStatus"}},{kind:"Field",name:{kind:"Name",value:"mtoShadowUserInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldChatInHomeTenant"}},{kind:"Field",name:{kind:"Name",value:"areAllChatMembersReachableInHomeTenant"}}]}},{kind:"Field",name:{kind:"Name",value:"membersLimited"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}}]}},{kind:"Field",name:{kind:"Name",value:"botMembers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingChatType"}}]}}]}},361891:(e,n,i)=>{"use strict";i.d(n,{Y:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonChatMtoTelemetryFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"hasFederatedMTOUser"}}]}}]}},627750:(e,n,i)=>{"use strict";i.d(n,{F:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonChatPaneLayoutFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mtoShadowUserInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldChatInHomeTenant"}},{kind:"Field",name:{kind:"Name",value:"areAllChatMembersReachableInHomeTenant"}}]}}]}}]}},24706:(e,n,i)=>{"use strict";i.d(n,{W:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonChatRecapFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"hasRecap"}}]}}]}},858863:(e,n,i)=>{"use strict";i.d(n,{I:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonChatWithMtoUserBannerFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"firstMtoMember"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"homeMri"}},{kind:"Field",name:{kind:"Name",value:"displayName"}}]}},{kind:"Field",name:{kind:"Name",value:"mtoHomeUserInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldChatWithFederatedIdentities"}},{kind:"Field",name:{kind:"Name",value:"areAllChatMembersReachableInTheirHomeTenant"}},{kind:"Field",name:{kind:"Name",value:"memberHomeTenantMris"}}]}}]}}]}},255368:(e,n,i)=>{"use strict";i.d(n,{x:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonRecordingMessageMiFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingInformation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"meetingType"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"templateDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}},703566:(e,n,i)=>{"use strict";i.d(n,{n:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonUseExternalTagFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"cfet"}},{kind:"Field",name:{kind:"Name",value:"creator"}},{kind:"Field",name:{kind:"Name",value:"hasFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}},{kind:"Field",name:{kind:"Name",value:"isMeeting"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUserLength"}},{kind:"Field",name:{kind:"Name",value:"memberIds"}},{kind:"Field",name:{kind:"Name",value:"membersLimited"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"givenName"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}}]}}]}}]}},502393:(e,n,i)=>{"use strict";i.d(n,{P:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonUseMtoUserBannerFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"shortTitle"}},{kind:"Field",name:{kind:"Name",value:"mtoShadowUserInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldChatInHomeTenant"}},{kind:"Field",name:{kind:"Name",value:"areAllChatMembersReachableInHomeTenant"}},{kind:"Field",name:{kind:"Name",value:"memberHomeTenantMris"}}]}}]}}]}},534813:(e,n,i)=>{"use strict";i.d(n,{T:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"dominantSpeakerInfoFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DominantSpeakerInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"speakerList"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}}]}}]}},70887:(e,n,i)=>{"use strict";i.d(n,{B:()=>o});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonInstallerIdentityFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InstallerIdentity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installerType"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"azureAdAppId"}}]}}]};var t=i(590438),r=i(292992);const l={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"appPermissions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppPermissions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"orgWide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"resourceSpecific"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]},o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"installedAppFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InstalledApp"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"installationState"}},{kind:"Field",name:{kind:"Name",value:"installedAppProps"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUninstallable"}},{kind:"Field",name:{kind:"Name",value:"isAdminPreInstalled"}},{kind:"Field",name:{kind:"Name",value:"isNewGlobalPreInstalled"}},{kind:"Field",name:{kind:"Name",value:"isNewAdminPreInstalled"}},{kind:"Field",name:{kind:"Name",value:"isUnlicensed"}}]}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"installedVersion"}},{kind:"Field",name:{kind:"Name",value:"installerIdentity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonInstallerIdentityFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensionStates"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageExtensionState"}}]}},{kind:"Field",name:{kind:"Name",value:"definition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}},{kind:"Field",name:{kind:"Name",value:"permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appPermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"statusInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}}]}},{kind:"Field",name:{kind:"Name",value:"botMetadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"registrationInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sourceAppId"}}]}}]}}]}},...a.definitions,...t.O.definitions,...r.h.definitions,...l.definitions]}},369847:(e,n,i)=>{"use strict";i.d(n,{L:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"lastMessageFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LastMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"cardClientId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}},{kind:"Field",name:{kind:"Name",value:"sourceType"}}]}}]}}]}},111130:(e,n,i)=>{"use strict";i.d(n,{iv:()=>a,nn:()=>t,PP:()=>r});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingArtifactCollection"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactCollection"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeKey"}},{kind:"Field",name:{kind:"Name",value:"resources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingArtifactV2"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingArtifactV2"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"addedBy"}},{kind:"Field",name:{kind:"Name",value:"metadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingArtifactMetadataEntries"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingArtifactMetadataEntries"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactMetadataEntry"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"isShared"}},{kind:"Field",name:{kind:"Name",value:"linkScope"}},{kind:"Field",name:{kind:"Name",value:"hostClient"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appTitle"}},{kind:"Field",name:{kind:"Name",value:"fileTitle"}},{kind:"Field",name:{kind:"Name",value:"imageUrl"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"meetingContentMetadataObject"}},{kind:"Field",name:{kind:"Name",value:"thumbnailUrl"}}]}}]}.definitions]}.definitions]},t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"reserveMeetingArtifactResponse"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReserveMeetingArtifactResponse"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLeader"}},{kind:"Field",name:{kind:"Name",value:"secret"}},{kind:"Field",name:{kind:"Name",value:"resourceState"}},{kind:"Field",name:{kind:"Name",value:"expiry"}},{kind:"Field",name:{kind:"Name",value:"collab"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingArtifactCollection"}}]}}]}},...a.definitions]},r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingArtifactsCollection"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactsCollection"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"changeKey"}},{kind:"Field",name:{kind:"Name",value:"resources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingArtifactV2Interface"}}]}},{kind:"Field",name:{kind:"Name",value:"errorState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"MsTeamsDataFragmentsCommonMeetingArtifacts_meetingArtifactsErrorState"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingArtifactV2Interface"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2Interface"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"subType"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2Transcript"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"groupId"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2TranscriptV2"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"webUrl"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"driveId"}},{kind:"Field",name:{kind:"Name",value:"driveItemId"}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"transcriptId"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2Recording"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"thumbnailUrl"}},{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"ownerOid"}},{kind:"Field",name:{kind:"Name",value:"ownerTid"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"threadMessageId"}},{kind:"Field",name:{kind:"Name",value:"driveItemId"}},{kind:"Field",name:{kind:"Name",value:"driveId"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2Notes"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"isShared"}},{kind:"Field",name:{kind:"Name",value:"linkScope"}},{kind:"Field",name:{kind:"Name",value:"hostClient"}},{kind:"Field",name:{kind:"Name",value:"addedBy"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2MeetingContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appTitle"}},{kind:"Field",name:{kind:"Name",value:"fileTitle"}},{kind:"Field",name:{kind:"Name",value:"imageUrl"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"meetingContentMetadataObject"}},{kind:"Field",name:{kind:"Name",value:"correlationProperties"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CorrelationPropertiesFragment"}}]}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2Default"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appTitle"}},{kind:"Field",name:{kind:"Name",value:"fileTitle"}},{kind:"Field",name:{kind:"Name",value:"imageUrl"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"meetingContentMetadataObject"}},{kind:"Field",name:{kind:"Name",value:"listItemUniqueId"}},{kind:"Field",name:{kind:"Name",value:"siteId"}},{kind:"Field",name:{kind:"Name",value:"additionDateTime"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"CorrelationPropertiesFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CorrelationProperties"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"referenceId"}},{kind:"Field",name:{kind:"Name",value:"traceId"}},{kind:"Field",name:{kind:"Name",value:"logicalId"}}]}}]}.definitions]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"MsTeamsDataFragmentsCommonMeetingArtifacts_meetingArtifactsErrorState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactsErrorState"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}},{kind:"Field",name:{kind:"Name",value:"subCode"}},{kind:"Field",name:{kind:"Name",value:"subError"}}]}}]}.definitions]}},590438:(e,n,i)=>{"use strict";i.d(n,{O:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageExtensionState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MessageExtensionState"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"pinOrder"}}]}}]}},93192:(e,n,i)=>{"use strict";i.d(n,{He:()=>t,bs:()=>l});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"participantStreamFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ParticipantStream"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAvailable"}},{kind:"Field",name:{kind:"Name",value:"isStreaming"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"rank"}},{kind:"Field",name:{kind:"Name",value:"negotiationTag"}},{kind:"Field",name:{kind:"Name",value:"participantLegId"}},{kind:"Field",name:{kind:"Name",value:"label"}},{kind:"Field",name:{kind:"Name",value:"endpointId"}},{kind:"Field",name:{kind:"Name",value:"dynamicVirtualParticipantId"}},{kind:"Field",name:{kind:"Name",value:"mediaDeviceCapabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonMediaDeviceCapabilitiesFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"sourceId"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonMediaDeviceCapabilitiesFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MediaDeviceCapabilities"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"videoAspectRatio"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonVideoAspectRatioFragment"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonVideoAspectRatioFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"VideoAspectRatio"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}}]}.definitions]}.definitions]},t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"endpointDetailsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EndpointDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"originalId"}},{kind:"Field",name:{kind:"Name",value:"participantId"}},{kind:"Field",name:{kind:"Name",value:"clientEndpointCapabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"clientEndpointCapabilitiesFields"}}]}},{kind:"Field",name:{kind:"Name",value:"endpointId"}},{kind:"Field",name:{kind:"Name",value:"endpointMetadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"audienceview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"page"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"botData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"hiddenParticipant"}},{kind:"Field",name:{kind:"Name",value:"hiddenStream"}},{kind:"Field",name:{kind:"Name",value:"canBeMutedAndUnMuted"}},{kind:"Field",name:{kind:"Name",value:"page"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingRoom"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"roomName"}},{kind:"Field",name:{kind:"Name",value:"roomNumber"}},{kind:"Field",name:{kind:"Name",value:"isDfRoom"}},{kind:"Field",name:{kind:"Name",value:"joinStatus"}}]}},{kind:"Field",name:{kind:"Name",value:"roomPeopleCount"}}]}},{kind:"Field",name:{kind:"Name",value:"mappedTo"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"clientEndpointCapabilitiesFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ClientEndpointCapabilities"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CanSupportBreakOutRoom"}},{kind:"Field",name:{kind:"Name",value:"supportBreakoutRoomsSelfSelect"}},{kind:"Field",name:{kind:"Name",value:"supportsNudgeFromStreamingIntoRealTime"}}]}}]}.definitions]},r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"weathermanModeDetailFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WeathermanModeDetail"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isWeatherpersonPresenter"}},{kind:"Field",name:{kind:"Name",value:"overlayCoords"}}]}}]},l={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"participantFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Participant"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isServerMuted"}},{kind:"Field",name:{kind:"Name",value:"isHandRaised"}},{kind:"Field",name:{kind:"Name",value:"raiseHandsRank"}},{kind:"Field",name:{kind:"Name",value:"raiseHandsOrderedRank"}},{kind:"Field",name:{kind:"Name",value:"raiseHandSkinTone"}},{kind:"Field",name:{kind:"Name",value:"isSpotlighted"}},{kind:"Field",name:{kind:"Name",value:"spotlightRank"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"isReconciled"}},{kind:"Field",name:{kind:"Name",value:"isStreamingAttendee"}},{kind:"Field",name:{kind:"Name",value:"streams"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"participantStreamFields"}}]}},{kind:"Field",name:{kind:"Name",value:"audio"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"participantStreamFields"}}]}},{kind:"Field",name:{kind:"Name",value:"isFake"}},{kind:"Field",name:{kind:"Name",value:"isVideoLive"}},{kind:"Field",name:{kind:"Name",value:"isScreenShareLive"}},{kind:"Field",name:{kind:"Name",value:"meetingRole"}},{kind:"Field",name:{kind:"Name",value:"stateReason"}},{kind:"Field",name:{kind:"Name",value:"contentSharingRole"}},{kind:"Field",name:{kind:"Name",value:"participantId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"visible"}},{kind:"Field",name:{kind:"Name",value:"holographicDevice"}},{kind:"Field",name:{kind:"Name",value:"endpoints"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"endpointDetailsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"weathermanModeDetail"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"weathermanModeDetailFields"}}]}},{kind:"Field",name:{kind:"Name",value:"mappedTo"}},{kind:"Field",name:{kind:"Name",value:"mappedToMeetingRoom"}},{kind:"Field",name:{kind:"Name",value:"deviceType"}},{kind:"Field",name:{kind:"Name",value:"interpretationDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isInterpreter"}},{kind:"Field",name:{kind:"Name",value:"group"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"joinCorrelationId"}},{kind:"Field",name:{kind:"Name",value:"isInSameRoom"}},{kind:"Field",name:{kind:"Name",value:"isIdentityMasked"}},{kind:"Field",name:{kind:"Name",value:"nonMaskedId"}},{kind:"Field",name:{kind:"Name",value:"nonMaskedDisplayName"}},{kind:"Field",name:{kind:"Name",value:"maskedIdSeqNumber"}},{kind:"Field",name:{kind:"Name",value:"displayNameOverride"}},{kind:"Field",name:{kind:"Name",value:"hasCloudIntelliFrame"}},{kind:"Field",name:{kind:"Name",value:"participantType"}},{kind:"Field",name:{kind:"Name",value:"multistreamFlavor"}}]}},...a.definitions,...t.definitions,...r.definitions]}},189737:(e,n,i)=>{"use strict";i.d(n,{M:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"pinnedMessageItemFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},217098:(e,n,i)=>{"use strict";i.d(n,{x:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userPresenceData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Presence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"availability"}},{kind:"Field",name:{kind:"Name",value:"activity"}},{kind:"Field",name:{kind:"Name",value:"isOutOfOffice"}},{kind:"Field",name:{kind:"Name",value:"statusNote"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"}},{kind:"Field",name:{kind:"Name",value:"publishTime"}},{kind:"Field",name:{kind:"Name",value:"expiry"}}]}},{kind:"Field",name:{kind:"Name",value:"flwPresence"}},{kind:"Field",name:{kind:"Name",value:"flwShifts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"previousShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}},{kind:"Field",name:{kind:"Name",value:"currentShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}},{kind:"Field",name:{kind:"Name",value:"nextShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isFocus"}},{kind:"Field",name:{kind:"Name",value:"workLocation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"locationSource"}},{kind:"Field",name:{kind:"Name",value:"approximateDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"idType"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isBlocked"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}}]}}]}},466548:(e,n,i)=>{"use strict";i.d(n,{z:()=>a,x:()=>t});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"featureSettingsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UserFeatureSettingsInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"coExistenceMode"}},{kind:"Field",name:{kind:"Name",value:"isPrivateChatEnabled"}}]}}]},t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"User"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"decoratedDisplayName"}},{kind:"Field",name:{kind:"Name",value:"givenName"}},{kind:"Field",name:{kind:"Name",value:"surname"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"emailsInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"address"}},{kind:"Field",name:{kind:"Name",value:"isPrimary"}}]}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"tenantName"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"jobTitle"}},{kind:"Field",name:{kind:"Name",value:"department"}},{kind:"Field",name:{kind:"Name",value:"featureSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"featureSettingsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"profileType"}},{kind:"Field",name:{kind:"Name",value:"userType"}}]}},...a.definitions]}},690686:(e,n,i)=>{"use strict";i.d(n,{p:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userProperties"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConversationUserProperties"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isMutedInChannel"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"maskId"}}]}}]}},688194:(e,n,i)=>{"use strict";i.d(n,{lu:()=>a,fO:()=>t});const a=e=>{if(e)switch(e){default:case"Success":return"Success";case"SendFailure":return"SendFailure";case"SendFailureCanRetry":return"SendFailureCanRetry";case"EditFailure":return"EditFailure";case"EditFailureCanRetry":return"EditFailureCanRetry";case"DeleteSingleFailure":return"DeleteSingleFailure";case"DeleteSingleFailureCanRetry":return"DeleteSingleFailureCanRetry";case"DeleteAllFailure":return"DeleteAllFailure";case"DeleteAllFailureCanRetry":return"DeleteAllFailureCanRetry"}},t=e=>!(!e||!/^\[[^\]]+\]$/gi.test(e))},43037:(e,n,i)=>{"use strict";i.d(n,{NX:()=>Ae,Lm:()=>Se,PN:()=>Ce,qd:()=>he,Kj:()=>be,Uv:()=>ye,rG:()=>Me,oq:()=>Fe,Dc:()=>li,vc:()=>Mn,Lv:()=>Nn,f4:()=>tn,jI:()=>Ke,qU:()=>Xe,KH:()=>Xn,fN:()=>Gn,BO:()=>Ge,QM:()=>_e,UL:()=>In,Wk:()=>vn,r9:()=>_n,Sd:()=>ii,PH:()=>ei,__:()=>qn,Fz:()=>Kn,gj:()=>ri,l7:()=>ni,wD:()=>Wn,fc:()=>$n,WC:()=>ai,zX:()=>ti,Rx:()=>pi,S3:()=>Ze,XO:()=>dn,OS:()=>wn,Xq:()=>en,Jd:()=>Jn,OB:()=>Un,FC:()=>Dn,hE:()=>En,RS:()=>ln,FQ:()=>rn,fO:()=>pn,jp:()=>qe,qQ:()=>bn,dM:()=>Qe,fi:()=>Ee,bo:()=>Pe,nT:()=>Ln,RE:()=>xn,_u:()=>He,TH:()=>nn,Ox:()=>Hn,cg:()=>Yn});var a=i(440320),t=i(508411),r=i(239),l=i(848703),o=i(194649),d=i(46377),s=i(676915),m=i(660618),c=i(821296),u=i(75914),p=i(260465),k=i(509648),g=i(339470),N=i(539299),v=i(804510),I=i(348103),S=i(649364),A=i(364819),T=i(467273);const f="private";var M=i(509836);const h="default",y="CallableChannelOboCall",F="callParkService",b="call-log",C="sla-call-history",D=e=>{switch(e){case"default":return M.b6.Default;case"screenSharing":case"ScreenSharing":return M.b6.ScreenSharing;case"emergencyGroupCall":return M.b6.EmergencyGroupCall;default:return M.b6.Unknown}},U=e=>e?{...e,type:e.type||h}:void 0,E={displayName:"Unknown",id:"28:unknown",type:h},w=(e,n,i="value")=>{if(!e)return"";const a=`${i}="`,t=e.find((e=>e.indexOf(n)>=0))?.match(new RegExp(`${i}="(.*?)"`,"g"));return t?t[0].substr(a.length,t[0].length-a.length-1):""},L=(e,n,i,a,t)=>{let r,l,o,s,m=(new Date).toISOString();if(t===d.Go.CallTranscript){const n=((e,n)=>{if(n)try{const e=JSON.parse(unescape(n.replace(/\u200b|\\/g,"")));return{callId:e.callId,userParticipantId:e.originatorParticipantId,transcriptMsg:{scopeId:e.scopeId,isExportedToOdsp:e.isExportedToOdsp}}}catch(n){return void e.error("failed to parse transcription content.",n)}})(e,i);if(!n)return;r=n.callId,l=n.userParticipantId,o=n.transcriptMsg}else if(t===d.Go.CallLogTranscript){const n=((e,n)=>{if(n)try{const e=JSON.parse(unescape(n.replace(/\u200b|\\/g,""))),{CallId:i,UserParticipantId:a,ThreadId:t,MessageId:r}=e;return{callId:i,userParticipantId:a,transcriptMsg:{linkedMessage:{conversationId:t,messageId:r}}}}catch(n){return void e.error("failed to parse transcription content.",n)}})(e,i);if(!n)return;r=n.callId,l=n.userParticipantId,o=n.transcriptMsg}else if(t===d.Go.CallLogRecording){const n=((e,n)=>{if(n)try{const e=JSON.parse(unescape(n.replace(/\u200b|\\/g,""))),{CallId:i,UserParticipantId:a,ThreadId:t,MessageId:r,ContentTypes:l}=e;return{callId:i,userParticipantId:a,recordingMsg:{contentTypes:l,linkedMessage:{conversationId:t,messageId:r}}}}catch(n){return void e.error("failed to parse recording message content.",n)}})(e,i);if(!n)return;r=n.callId,l=n.userParticipantId,s=n.recordingMsg}else if(t===d.Go.CallRecording){const e=((e,n)=>{if(!e)return;const i=e.match(/<.*?>/g),a=w(i,'<Id type="callId"'),t=w(i,"<RecordingContent contentTypes=","contentTypes"),r=w(i,'<Id type="OriginatorParticipantId"'),l=w(i,"<RecordingInitiatorId ");return{callId:a,userParticipantId:r,recordingMsg:{conversationId:d.SG,messageId:n||"",initiatorId:l,content:e,contentTypes:t}}})(i,a);if(!e)return;r=e.callId,l=e.userParticipantId,s=e.recordingMsg}else r=n.callId,l=n?.userParticipantId,m=n.startTime;return{callId:r??"",userParticipantId:l,transcript:o,recordings:s&&[s]||[],startTime:m??""}},x=({skypeMessage:e,loggerFactory:n})=>{const i=e.conversationid,a=e.messagetype,t=e.content,{callHistoryInput:r,isSlaCallHistory:l}=O(e),o=(d=e.id,m=e.clientmessageid,"-1"===d?m:d);var d,m;if(Y(r,i))return;const c=n.newLogger("CallHistoryHelper","data-resolvers-calling");try{const i=G(r),{callDirection:d,callState:m,callType:u,callPhoneLineType:p,connectTime:k,endTime:g,eventTranscript:N,isDeleted:v,originatorParticipant:I,participantList:S,sessionType:A,sharedCorrelationId:y,targetParticipant:F,threadId:b,spamProperties:C,callAttributes:w,forwardingInfo:x,transferInfo:O,sharedLineAppearanceParticipantList:Y,targetDelegator:_}=i,J=Z(i),q=L(c,i,t,o,a);if(!q)return;let X=U(I);X||(X=E,c.warn(`Could not parse valid participant from ${r}`));const K=(e=>"private"===e?f:null)(p),$=(e=>{switch(e){case"missed":return M.A2.Missed;case"accepted":return M.A2.Accepted;case"declined":return M.A2.Declined;case"acceptedElsewhere":return M.A2.AcceptedElsewhere;default:return M.A2.Unknown}})(m),ee=(e=>"incoming"===e?M.QO.Incoming:"outgoing"===e?M.QO.Outgoing:M.QO.Unknown)(d),ne=B(S,F?.type,I?.type,w?.transferor?.type,O?.parkType),ie=W(c,i),{validTargetParticipant:ae,forwarderParticipant:te,forwardedTargetParticipant:re}=P($,F,x,w,l,!!ie.isSharedLineAppearanceActivated,_),{transferorParticipant:le,transferTargetParticipant:oe}=V(w,O,ne),de=(e=>"twoParty"===e?M.nz.TwoParty:"multiParty"===e?M.nz.MultiParty:M.nz.Unknown)(u),se=J&&(e=>({type:e.type,configId:e.configId,onBehalfOf:e.onBehalfOf&&{...e.onBehalfOf,type:h},details:e.details&&{...e.details,type:h}}))(J),{isCallQueue:me}=(0,T._2)({callType:de,applicationContent:se}),ce=ee===M.QO.Outgoing,ue=ee===M.QO.Incoming,pe=ee===M.QO.Incoming&&$===M.A2.Missed,ke=$===M.A2.Declined,ge=$===M.A2.AcceptedElsewhere,Ne=A===M.b6.EmergencyGroupCall&&S?.length>1,ve=(0,T.rV)({endTime:g,connectTime:k,targetParticipant:F}),Ie=e.originalarrivaltime;return{id:`${o};${q.callId}`,callStartTime:new Date(q.startTime).getTime(),applicationContent:se,callDirection:ee,originalArrivalTime:Ie,isMissed:pe,isIncoming:ue,isOutgoing:ce,isDeclined:ke,isAcceptedElsewhere:ge,isEmergencyGroupCall:Ne,isCallQueue:me,callState:$,callType:de,callPhoneLineType:K,durationInMs:ve,connectTime:k,endTime:g,isDeleted:v,messageId:o,messageType:(0,s.h)(n,a,e.properties),originatorParticipant:X,participantList:S?S.map(U):[],targetParticipant:ae,threadId:b,sessionType:D(A),sharedCorrelationId:y??"",spamRiskLevel:C?C.riskLevel:null,...q,transferorParticipant:le,transferTargetParticipant:oe,transferTime:O?.transferTime,transferStatus:O?.transferStatus&&j(O.transferStatus),forwarderParticipant:te,forwardedTargetParticipant:re,forwardedTargetType:R(x?.forwardingDestinationType),forwardingType:z(x?.forwardingType),isSharedLineAppearanceCallHistory:l,...l?Q(c,i):ie,sharedLineAppearanceParticipantList:Y?Y.map(U):[],sharedLineAppearanceCallActionList:N?H(N):[]}}catch(e){c.warn(`UnhandledException in message transformation: ${e}`)}},O=e=>{const{properties:n,callLogsOwnerId:i}=e,a={callHistoryInput:void 0,isSlaCallHistory:!!i};return n&&(n[C]?(a.callHistoryInput=n[C],a.isSlaCallHistory=!0):n[b]&&(a.callHistoryInput=n[b])),a},P=(e,n,i,a,t,r,l)=>{let o,d,s=n&&U(n);return e===M.A2.Accepted&&i?.acceptedBy&&(o=t?l&&U(l):s,s=U(i.acceptedBy)),a?.forwardedFrom&&(o=U(a.forwardedFrom)),(e===M.A2.AcceptedElsewhere||t||r)&&i?.acceptedBy&&(d=U(i.acceptedBy)),a?.delegator&&(o=U(a.delegator)),{validTargetParticipant:s,forwarderParticipant:o,forwardedTargetParticipant:d}},V=(e,n,i)=>{let a,t;return i||(e?.transferor&&(a=U(e.transferor)),n?.transferor&&(a=U(n.transferor)),n?.transferTarget&&(t=U(n.transferTarget))),{transferorParticipant:a,transferTargetParticipant:t}},j=e=>{switch(e){case"transferred":return M.An.Transferred;case"transferAccepted":return M.An.TransferAccepted;case"transferFailed":return M.An.TransferFailed;case"transferSucceeded":return M.An.TransferSucceeded;default:return M.An.Unknown}},B=(e,n,i,a,t)=>{const r=t&&"none"!==t&&"Unknown"!==t;return r||r&&!!e?.find((e=>e.type&&e.type===F))||n===F||i===F||a===F},z=e=>{switch(e){case"immediate":return M.W1.Immediate;case"simultaneous":return M.W1.Simultaneous;default:return}},R=e=>{switch(e){case"user":return M.nk.SingleTarget;case"group":return M.nk.Group;case"delegates":return M.nk.MyDelegates;case"voicemail":return M.nk.Voicemail;default:return}},Q=(e,n)=>{const{sharedLineAppearanceForwardType:i,originatorDelegator:a,targetDelegator:t}=n;return e.log("[toCallHistoryItem] This is an SLA Call created as part of Shared History"),{forwardingType:z(i),originatorDelegator:a&&U(a),targetDelegator:t&&U(t)}},W=(e,n)=>{const{callAttributes:i,forwardingInfo:a,sharedLineAppearanceActivated:t}=n,r=i?.onBehalfOf?.id&&(0,o.AF)(i.onBehalfOf.id);return e.log("[toCallHistoryItem] This is an SLA Call created as part of Personal History"),{isSharedLineAppearanceActivated:!!(t||i?.delegator||r||"delegates"===a?.forwardingDestinationType),originatorDelegator:r&&i?.onBehalfOf?U(i.onBehalfOf):void 0,targetDelegator:i?.delegator?U(i.delegator):void 0}},Y=(e,n)=>void 0===n?!e:n!==d.SG&&n!==d.Vn,G=e=>e?JSON.parse(e):{},Z=e=>{const{applicationContent:n,callAttributes:i,onBehalfOfContext:a}=e;let t;return t=a&&!n?{type:y,configId:a.id||"",onBehalfOf:{type:i?.onBehalfOf?.type||y,id:i?.onBehalfOf?.id||"",displayName:i?.onBehalfOf?.displayName||""}}:n,t},_=e=>{const n=(e=>{switch(e){case"hold":return M.ry.Hold;case"resume":return M.ry.Resume;case"barge":return M.ry.Barge;default:return}})(e.callAction),i=U(e.actionOriginator);if(!n||!i)return;return{callAction:n,callActionTime:e.actionTime,callActionOriginator:i}},H=e=>{const n=[];return e.forEach((e=>{const i=_(e);i&&n.push(i)})),n};var J=i(271126),q=i(785053),X=i(325759),K=i(586892),$=i(355515),ee=i(34655);const ne=e=>{if(!e)return[];const n="meeting.scheduledMeetingInfo";let i=te(e,["startTime","endTime","eventType"],n);const{eventRecurrenceRange:a,eventRecurrencePattern:t}=e;return i=[...i,...ie(a,n),...ae(t,n)],i},ie=(e,n)=>te(e,["startDate"],`${n}.eventRecurrenceRange`),ae=(e,n)=>{let i=[];if(e){const{daily:a,weekly:t,monthly:r,yearly:l,relativeMonthly:o,relativeYearly:d}=e;i=[...te(e,["patternType"],`${n}.eventRecurrencePattern`),...te(a,["interval"],`${n}.eventRecurrencePattern.daily`),...te(t,["interval","daysOfTheWeek"],`${n}.eventRecurrencePattern.weekly`),...te(r,["interval","dayOfMonth"],`${n}.eventRecurrencePattern.monthly`),...te(l,["month","dayOfTheMonth"],`${n}.eventRecurrencePattern.yearly`),...te(o,["interval","dayOfTheWeekIndex","dayOfTheWeek"],`${n}.eventRecurrencePattern.relativeMonthly`),...te(d,["month","dayOfTheWeekIndex","dayOfTheWeek"],`${n}.eventRecurrencePattern.relativeYearly`)],t&&t.daysOfTheWeek&&t.daysOfTheWeek.some((e=>(0,A.isNil)(e)))&&i.push(`${n}.eventRecurrencePattern.weekly.daysOfTheWeek`)}return i},te=(e,n,i)=>{const a=[];return(0,A.isNil)(e)||n.forEach((n=>{(0,A.isNil)(e[n])&&a.push(`${i}.${String(n)}`)})),a};var re=i(244698),le=i(438543),oe=i(688194),de=i(641319);const se=e=>e&&e.vivaTopicsAnnotations?(e=>{try{return(e=>{const{ApiVersion:n,EntityAnnotation:i,TraceId:a,ClientRequestId:t}=e,{SectionMatches:r}=i;return{apiVersion:n,entityAnnotation:{sectionMatches:r.map((e=>{const{EntityMatches:n,SectionId:i}=e;return{entityMatches:n.map((e=>{const{Entities:n,HighlightedName:i,Length:a,StartPos:t,OccurrenceIndex:r,TotalOccurrences:l,Relevance:o}=e;return{entities:n.map((e=>{const{DisplayName:n,Id:i,RelevanceScore:a,Source:t,Type:r}=e;return{displayName:n,id:i,relevanceScore:a,source:t,type:r}})),highlightedName:i,length:a,startPos:t,occurrenceIndex:r,totalOccurrences:l,relevance:{annotationScore:o.AnnotationScore}}})),sectionId:i}}))},traceId:a,clientRequestId:t}})((0,de.n)(e))}catch(e){return}})(e.vivaTopicsAnnotations)??null:null;var me=i(378044);const ce="Action.Compose".toLowerCase(),ue="Action.ODSL".toLowerCase(),pe="ImBack".toLowerCase(),ke="Teams.chatMessage".toLowerCase();class ge{constructor(e){this.parse=e=>this.toSuggestedActionsSchema(e),this.toTargetedUsers=e=>{if(!e)return[];if(!Array.isArray(e))throw new Error(`Suggested action target users should be an array. Target users: ${JSON.stringify(e)}`);const n=[];for(const i of e){if("string"!=typeof i)throw new Error(`Suggested action target users should be an array of strings. Target users: ${JSON.stringify(e)}`);n.push(i)}return n},this.toActionsSchema=e=>{if(!e||(0,A.isEmpty)(e))return[];if(!Array.isArray(e))throw new Error(`Suggested actions should be an array. Actions: ${JSON.stringify(e)}`);const n=[];for(const i of e){const e=this.toSuggestedAction(i);e&&n.push(e)}return n},this.toSuggestedAction=e=>{if(!e||"object"!=typeof e)throw new Error(`suggested action is null or not on object. ${JSON.stringify(e)}`);if("string"!=typeof e.title||"string"!=typeof e.type)throw new Error(`suggested action fiels should be string. ${JSON.stringify(e)}`);const n=e=>"string"!=typeof e?JSON.stringify(e):e;switch(e.type.toLowerCase()){case pe:return{__typename:"SuggestedActionImBack",title:e.title,text:n(e.value||"")};case ce:return this.toActionComposeSchema(e);case ue:return{__typename:"SuggestedActionODSL",title:e.title,value:n(e.value||"")};default:return this.logger.log(`Unsupported action. Type: ${e.type}`),null}},this.logger=e.newLogger("toSuggestedActions","data-resolvers-common")}toSuggestedActionsSchema(e){try{const n=this.toTargetedUsers(e.to),i=this.toActionsSchema(e.actions);return(0,A.isEmpty)(i)?null:{__typename:"SuggestedActions",to:n,actions:i}}catch(e){return this.logger.log(`Error parsing suggested actions. Error: ${e}`),null}}toActionComposeSchema({title:e,value:n}){try{const i=n;if(i&&i instanceof Object&&"string"==typeof i.type&&i.type.toLowerCase()===ke&&i.data&&"object"==typeof i.data){const n=i.data;let a=null;if(n.body&&"object"==typeof n.body){const e=n.body;"string"==typeof e.content&&(a=e.content)}if(!a)return null;const t=this.toAttachmentsSchema(n.attachments),r=this.toMentionsSchema(n.mentions);return{__typename:"SuggestedActionCompose",title:e,content:a,attachments:t,mentions:r}}this.logger.log(`Unsupported action. Value: ${n}`)}catch(e){this.logger.log(`Invalid suggested action value. Error: ${e} Value: ${n}`)}return null}toAttachmentsSchema(e){return e&&Array.isArray(e)?e.map((e=>{if(!e||"object"!=typeof e||"string"!=typeof e.contentUrl||"string"!=typeof e.id||"string"!=typeof e.name)throw new Error(`Attachment fields should be string. ${JSON.stringify(e)}`);return{contentUrl:e.contentUrl,id:e.id,name:e.name}})):(this.logger.log("no attachments found in the suggested action value"),null)}toMentionsSchema(e){if(e&&Array.isArray(e)){const n=[];return e.forEach((e=>{if(!e||"object"!=typeof e||!e.mentioned||"object"!=typeof e.mentioned||!e.mentioned.user||"object"!=typeof e.mentioned.user||"string"!=typeof e.id&&"number"!=typeof e.id||"string"!=typeof e.mentioned.user.id)throw new Error(`Invalid mention object. ${JSON.stringify(e)}`);n.push({id:e.id.toString(),mri:e.mentioned.user.id})})),n}return this.logger.log("no mentions found in the suggested action value"),null}}const Ne="http://schema.skype.com",ve=`${Ne}/StarredMessage`,Ie=`${Ne}/Mention`,Se=`${Ne}/File`,Ae=2,Te=g.$,fe=new Set(["RichText/Media_LocalRecording","RichText/Media_CallRecording","RichText/Media_CallTranscript","Event/Call"]);var Me;!function(e){e.FAMILY="family",e.FRIENDS="friends",e.PROJECT="projectCoord",e.WORKPLACE="company",e.TRIP_PLANNING="tripPlanning",e.GET_TOGETHER="getTogether",e.LOCAL_COMMUNITY="localCommunity",e.HOLIDAY_PLANNING="holidayPlanning"}(Me||(Me={}));const he="preview-",ye="newchat",Fe="welcomePage",be="bizChatMetaOSChatListEntryPoint",Ce="holisticRecapChatListEntryPoint",De=(e,n,i,a=!1)=>{if(!e?.emotions)return null;const t=e.emotions.map((({key:e,users:i})=>({key:e,users:i.map((({mri:e,time:i,value:a})=>({id:(0,S.z)(Te(e),n),time:i,value:a,userId:Te(e)}))).sort(((e,n)=>e.time-n.time))})));return a&&t.sort(((e,n)=>(i?.emotions?.[n.key]??n.users.length??0)-(i?.emotions?.[e.key]??e.users.length??0))),t},Ue=e=>{if(!e||!e.emotions)return null;const n=e.emotions;return Object.keys(n).map((e=>({key:e,count:n[e]})))},Ee=(e,n,i)=>e&&e.mentions?xe(e.mentions,n,i):null,we=(e,n,i)=>e&&e.onbehalfof?xe(e.onbehalfof,n,i):null,Le=(e,n)=>{if(!n||!n.atp)return null;const i=n.atp;try{return"string"==typeof i?JSON.parse(i):i}catch(n){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toAtpSharepointData: ${n}`),null}},xe=(e,n,i)=>{try{if("string"==typeof e&&(0,o.AF)(e))return null;const i="string"==typeof e?JSON.parse(e):e;return i?.length?i.map((({itemid:e,mri:i,displayName:a,mentionType:t})=>({id:`${n}_${e}_${i}`,userId:i,itemId:e,displayName:a,mentionType:t}))):null}catch(e){const a=i?.newLogger("Chat Helper","data-resolvers-common");return a?.errorToTelemetry?.(`UnhandledException in messageId: ${n}, processMentions - errorcode: ${e.errorcode}, error: ${e.error}`,"process_mentions_parse_error"),null}},Oe=(e,n,i,a)=>{if(!n||!n.files)return null;const t=e.newLogger("Chat Helper","data-resolvers-common");try{let e=JSON.parse(n?.files),r=0;return e=e.filter((e=>"deeplink"===e.type)),r=e.length,e=e.filter((e=>e)),r!==e.length&&(t?.errorToTelemetry?.(`toDeepLinks::Files contains falsy value. Filtered out.::id=${i}::conversationId=${a}`,"process_deeplink_parse_error"),r=e.length),e=e.filter((e=>e.id)),r!==e.length&&t?.errorToTelemetry?.(`toDeepLinks::Files contains object without id field which should be a required field. Filtered out.::id=${i}::conversationId=${a}`,"process_deeplink_parse_error"),e.map((({id:e,title:n,fileInfo:i,channelId:t,state:r})=>({id:e,title:n,state:r,serverRelativeUrl:i.serverRelativeUrl,channelId:t||a,siteUrl:i.siteUrl,objectUrl:i.fileUrl})))}catch(e){return t?.errorToTelemetry?.(`toDeepLinks::errorcode=${e.errorcode}::error=${e.error}::id=${i}::conversationId=${a}`,"process_deeplink_parse_error"),null}},Pe=e=>e&&JSON.stringify((0,A.map)(e,(({content:e,...n})=>({...n,content:JSON.parse(e)})))),Ve=(e,n,i)=>{if(!e||!e.links)return{urlPreview:null,embeddedLinks:null};try{const n=["http","https"],a=JSON.parse(e.links),t=[],r=[];return a.forEach((e=>{je(e,t,n),Be(e,r,[...n,"blob"],i)})),{urlPreview:r.length>0?r[0]:null,embeddedLinks:t}}catch(e){return n.newLogger("Chat Helper","data-resolvers-common").log(`Failed to parse message link properties: ${e}`),{urlPreview:null,embeddedLinks:null}}},je=(e,n,i)=>{const{url:a,fileShareUrlMeta:t,title:r,description:l}=e,o=(0,N.Jf)(a,i);t&&n.push({objectUrl:o,title:r,description:l,fileShareUrlMeta:t})},Be=(e,n,i,a)=>{const{url:t,preview:r,previewenabled:l}=e,{previewurl:o,previewmeta:d,title:s,description:m}=r||{},c=(0,N.Jf)(t,i,a||[]);n.push({url:c,thumbnail:(0,N.Jf)(o,i,a||[]),title:s,description:m,previewEnabled:l,thumbnailMeta:d?{width:d.width,height:d.height}:null})},ze=(e,n,i,a)=>{let t=a&&a.policyViolation;const r=a&&a.genericStreamMetadata;if(!t&&!r)return null;const l={};if("string"==typeof t)try{t=JSON.parse(t)}catch(i){e.newLogger("Chat Helper","data-resolvers-common").log(`Exception in parsing PolicyViolation in message: ${n}. Error: ${i}`)}t&&(l.policyViolation=t);let o=r&&r.policyTip;if("string"==typeof r)try{o=JSON.parse(r).policyTip}catch(i){e.newLogger("Chat Helper","data-resolvers-common").log(`Exception in parsing policy tip in message: ${n}. Error: ${i}`)}if(o){const e=a&&a.subject;l.dlpData={id:n,content:i,policyTip:o,subject:e}}return l},Re=e=>{if(!e.scheduledmeetinginfo||(0,A.isNil)(e.scheduledmeetinginfo.eventType))return null;const{iCalUid:n,...i}=e.scheduledmeetinginfo;return{iCalUID:n,...i}},Qe=(e,n)=>{if(!n||!n.meeting)return null;try{const e=JSON.parse(n.meeting),{organizerId:i,tenantId:a,meetingJoinUrl:t,location:r,itemid:l,meetingtitle:o,rsvpTo:s,body:m}=e;return(e=>{const{scheduledMeetingInfo:n}=e,i=ne(n);if(i.length)throw(0,$.$5)(ee.Ir.DataLayerClient,ee.O4.MissingParameter,`validate Meeting schema failed. Missing required prop(s): ${i.join(", ")}`);return e})({meetingActionType:e[d.rF.MeetingType],organizerId:i,tenantId:a,meetingJoinUrl:t,location:r,itemId:l,meetingTitle:o,rsvpTo:s,body:m,scheduledMeetingInfo:Re(e)})}catch(n){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toMeeting: ${n}`),null}},We=(e,n,i,a)=>{const t=n||i;if(t)return t;if(a&&fe.has(e)){const e=a.match(/<id type="callId"[^>]*?\svalue="([^"]+?)"/i);return e&&e[1]||null}return null},Ye=(e,n)=>"-1"===e?n:e,Ge=(0,l.A)((e=>new Intl.Collator(e,{numeric:!1,sensitivity:"accent"}))),Ze=(e,n)=>{if(e.length<=1)return e;const i=Ge(n),a=[...e];return a.sort(((e,n)=>i.compare(e.displayName||"",n.displayName||""))),a},_e=(e,n,i)=>{const a=Ze(e,i),t=[],r=[];return(0,A.forEach)(a,(e=>{const{id:i,displayName:a}=e;if(i!==n&&!K.af.isTFLOffNetworkUser(i)&&a){if(r.push(a),20===r.length)return!1;t.length<3&&t.push(e)}return!0})),{membersLimited:t,memberDisplayNamesLimited:r}},He=(e,n,i,a,r,l,d,s,m,c,u)=>{if(!e?.id)return;const p=qe(e,n,a,r,i,!!l,u),{id:k,messagetype:g,properties:N,callId:v,skypeguid:I,composetime:S,content:A,contentHash:T,conversationid:f,crossPostData:M}=e,h=(0,le.UM)(n,N?.languageStamp,d?.targetLanguageCode,A,m),y=(0,le.qt)(d,h,p.translatedContent,p.translationStatus),F=se(N),b=(0,le.rl)(k,h?.code,s);return{...p,__typename:"Message",__model:e,contentHash:T,interopDeliveryState:mi(N?.deliveryState),smsDeliveryReports:N&&N.smsDeliveryReports?N.smsDeliveryReports:null,announcement:dn(N),notification:oi(n,N),notifications:si(n,N),meeting:Qe(n,N),onBehalfOf:we(N,k,n),callId:We(g,v,I||N&&N.skypeguid,A),callLog:N&&x({skypeMessage:e,loggerFactory:n}),skypeguid:I,composeTime:S,isCallStartedMessage:(0,t.dG)(A,g),replyPermission:N?.replyPermission??null,atpSharepointData:Le(n,N),isDeletedByAdmin:N?.adminDelete||!1,suggestedActions:Je(n,N),forwardedMessageContext:on(N,A),conversationId:f,vivaTopicsAnnotations:F,crossPostStatus:M?(0,oe.lu)(M.status):void 0,crossPostFailedChannels:M?.failedChannels,isWrittenInPreferredLanguage:!y,languageSeenBefore:b,sourceLanguageCode:h?.code??null,repliesSummary:c,parentMessageId:(0,o.gB)(e.conversationLink,p.id||"")}},Je=(e,n)=>n&&n.suggestedActions?new ge(e).parse(n.suggestedActions):null,qe=({id:e,content:n,originalarrivaltime:i,from:a,messagetype:t,annotationsSummary:r,userHasStarred:l,properties:d,clientmessageid:m,version:c,prioritizeimdisplayname:u,imdisplayname:p,translation:k,conversationid:g,conversationLink:N,sendPipelineStatus:v,draftDetails:I},S,A,T,f,M=!1,h)=>{let y=n;A&&(y=A);const F=(0,me.LA)(S,d,T),b=(0,le.eQ)(k),C="Done"===b?.translationStatus?(0,re.yT)()[0].toString():c,D=(0,le.UM)(S,d?.languageStamp),U=(0,o.A$)(I);return{id:Ye(e,m),content:y,originalArrivalTime:i,from:Te(a),messageType:(0,s.h)(S,t,d),isImportant:(0,J.IA)(d?.importance),importance:(0,J.mJ)(d?.importance),emotionsSummary:Ue(r),emotions:De(d,e,r,M),mentions:Ee(d,e,S),cards:F,files:(0,me.Fx)(S,d),deeplinks:Oe(S,d,e,g||N),...Ve(d,S,h),deleteTime:d?.deletetime,editTime:d?.edittime,scheduledSendTime:U?new Date(U).toISOString():null,draftId:d?.draftId||(U?e:null),version:C,userHasSaved:l,renamedDisplayName:u?p:null,imDisplayName:p,clientMessageId:m,dlpContext:ze(S,e,n,d),atpSharepointData:Le(S,d),status:f||"Delivered",hardDeleteReason:d?.hardDeleteReason,hardDeleteTime:d?.hardDeleteTime,onBehalfOf:we(d,e,S),sourceLanguageCode:D?.code??null,...b,sendPipelineStatus:v}};function Xe(e,n){return{__typename:"LastMessage",content:"",preview:"",messageType:"Text",id:e,originalArrivalTime:n,imDisplayName:null,from:null,deleteTime:null,files:null,cards:null,embeddedLinks:null,callId:null,replyPermission:null,onBehalfOf:null,atpSharepointData:null,deeplinks:null,version:null,importance:null,interopDeliveryState:null,smsDeliveryReports:null,suggestedActions:null,emotions:null,emotionsSummary:null,mentions:null,status:null,clientMessageId:e,urlPreview:null,dlpContext:null,editTime:null,userHasSaved:null,isSystemMessage:!1,canShowEveryoneMentionBadge:!1}}function Ke(e,n){return{__typename:"ConsumptionHorizon",id:e,originalArrivalTime:n,timeStamp:n,clientMessageId:(0,X.sN)()}}const $e=()=>({members:[],membersLimited:[],activeCallsCount:null,canBeDiscarded:null,canBeFavorited:null,canBeHidden:null,botMembers:null,canBeLeft:null,canBeMuted:null,canBePinned:null,canBotBeBlocked:null,canManageApps:null,canPopOut:null,canTagContact:null,chatSubType:null,isDisabled:!1,isOneOnOne:!1,isOneOnOneBotChat:!1,isRead:!0,datatid:null,displayName:null,hasActions:null,hasActiveCalls:null,hasFailedMessages:null,isBotBlocked:null,isBotUser:null,isContactTagged:null,isFederated:!1,isHidden:null,isHighImportance:null,isLastMessageFromMe:null,isLastMessageText:null,isMeeting:!1,isMuted:null,isNewChat:!0,isSfB:!1,isUrgentImportance:null,isUserMember:!0,creator:null,meetingInformation:null,userConsumptionHorizon:null,consumptionHorizonBookmark:null,lastMessageTime:null,lastContentMessageTime:null,longTitle:null,messagePreview:null,messagePreviewAria:null,otherMemberMris:null,pictureGroup:null,pictureUpn:null,pinnedIndex:null,plGroupKey:null,presenceSource:null,showAtMention:null,showMarkers:null,tooltipTitle:null,substrateGroupId:null,hasGuestUser:!1,isImpersonation:!1});function en(e){const n=new Date,i=n.toISOString(),a=n.getTime().toString();return{...$e(),__typename:"Conversation",id:e,memberIds:[],memberDisplayNamesLimited:[],nonTeamsFederatedUserLimitedNames:[],hasFederatedUser:!1,chatHistoryHiddenTime:null,hasTflConsumerUser:!1,hasEnterpriseUser:!1,hasUnknownConsumerUser:!1,hasUnknownEnterpriseUser:!1,hasTflSmsUnverifiedUser:!1,hasTflSmsVerifiedUser:!1,tflOffNetworkUser:null,cfet:!1,consumerGroupId:null,tenantId:null,title:"",hasBotMember:!1,hasUnresolvedFederatedUser:!1,isChatDisabledForRecipients:!1,isPrivateChatPolicyDefinedScenario:null,meetingChatPolicy:null,me:null,tflOffNetworkUserLength:null,nonTeamsFederatedUsers:[],nonTeamsFederatedUsersLength:0,chatType:"Chat",type:"Chat",lastMessage:Xe(a,i),consumptionHorizon:Ke(e,i),addedBy:null,addedByTenantId:null,sensitivityLabel:null}}const nn=(e,n,i,a=!1,t)=>{const{annotationsSummary:r,id:l,from:o,messageType:d,properties:m,version:c,...u}=e;if(!l)return null;try{const e=se(m);return{__typename:"Message",__model:null,id:l,from:o,messageType:(0,s.h)(i,d,m),version:(0,A.isNumber)(c)?c.toString():void 0,isImportant:(0,J.IA)(m&&m.importance),importance:(0,J.mJ)(m&&m.importance),interopDeliveryState:mi(m?.deliveryState),smsDeliveryReports:m?.smsDeliveryReports||null,emotions:De(m,l,r,a),emotionsSummary:Ue(r),announcement:dn(m),mentions:Ee(m,l,i),onBehalfOf:we(m,l,i),cards:(0,me.LA)(i,m),files:(0,me.Fx)(i,m),deeplinks:Oe(i,m,l,n),...Ve(m,i,t),deleteTime:m&&m.deletetime,editTime:m&&m.edittime,isDeletedByAdmin:m&&m.adminDelete,scheduledSendTime:m?.sendAt||null,draftId:m?.draftId||null,forwardedMessageContext:on(m,u.content||""),hardDeleteTime:m&&m.hardDeleteTime,hardDeleteReason:m&&m.hardDeleteReason,suggestedActions:Je(i,m),status:"Delivered",dlpContext:ze(i,l,u.content,m),meeting:Qe(i,m),callId:m&&m.skypeguid,callLog:m&&x({skypeMessage:{properties:m,id:l,conversationid:n,messagetype:d,content:u.content,originalarrivaltime:u.originalArrivalTime},loggerFactory:i}),sourceLanguageCode:(0,le.UM)(i,m?.languageStamp)?.code??null,vivaTopicsAnnotations:e,...u}}catch(e){return i.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in message transformation: ${e}`),{__model:null,id:l,from:o,messageType:(0,s.h)(i,d,m),isImportant:null,emotions:null,mentions:null,files:null,announcement:null,urlPreview:null,deleteTime:null,status:null,...u}}},an=({originalArrivalTime:e,timeStamp:n,clientMessageId:i})=>({originalArrivalTime:new Date(e).toISOString(),timeStamp:new Date(n).toISOString(),clientMessageId:i}),tn=(e,n,i,a)=>rn({id:e,properties:{[d.H0.ConsumptionHorizon]:(0,m.cc)(a)},threadProperties:i,type:n}),rn=e=>({id:e.id,...an((0,m.Yg)(e))}),ln=e=>({id:e.id,...an((0,m.qb)(e))}),on=(e,n)=>{if(!e||!e.originalMessageContext)return null;const i=n.indexOf(c.Du.ForwardedContentStart),a=n.lastIndexOf(c.Du.ForwardedContentEnd),t=n.slice(i,a+c.Du.ForwardedContentEnd.length),r="string"==typeof e.originalMessageContext?JSON.parse(e.originalMessageContext):e.originalMessageContext,l={fluid:t.includes("http://schema.skype.com/FluidEmbedCard")||t.includes("http://schema.skype.com/FluidEmbedLink")||t.includes("http://schema.skype.com/FluidLink")};return{originalSenderMri:r.originalSender,originalArrivalTime:r.originalSentTime,originalMessageId:r.messageId,originalMessageContent:t,originalThreadId:r.originalThreadId,originalChannelPostSubject:e?.subject,originalMessageContains:l}},dn=e=>{const n={title:"",originalImageUrl:null,croppedImageUrl:null,colorTheme:null};if(!e?.cards)return n;const i="string"==typeof e.cards?JSON.parse(e.cards):e.cards;if(!i||0===i.length)return n;const a=i.find((e=>"application/vnd.microsoft.teams.messaging-announcementBanner"===e.contentType));if(!a)return n;const t=sn(a);return{title:e.title?e.title:"",originalImageUrl:t.originalImageUrl,croppedImageUrl:t.croppedImageUrl,colorTheme:t.colorTheme,croppedImageHeight:t.croppedImageHeight,croppedImageWidth:t.croppedImageWidth,croppedImageAltText:t.croppedImageAltText,isTeamsIllustration:t.isTeamsIllustration}},sn=e=>{let n=(0,A.get)(e,"content.imageData.origImage.src",null),i=(0,A.get)(e,"content.imageData.croppedImage.src",null);const a=(0,A.get)(e,"content.imageData.croppedImage.imageHeight",null),t=(0,A.get)(e,"content.imageData.croppedImage.imageWidth",null),r=(0,A.get)(e,"content.imageData.croppedImage.imageAltText",null),l=(0,A.get)(e,"content.imageData.isTeamsIllustration",null);let o=(0,A.get)(e,"content.imageData.colorTheme",null)||(0,A.get)(e,"content.colorTheme",null);return n=void 0===n?null:n,i=void 0===i?null:i,o=void 0===o?null:o,{originalImageUrl:n,croppedImageUrl:i,croppedImageHeight:a,croppedImageWidth:t,croppedImageAltText:r,colorTheme:o,isTeamsIllustration:l}},mn=(e,n,i)=>{try{const i=cn(n),a=i?.map((n=>({activityReplyToId:n.replyToId,activityTimestamp:n.timestamp,convId:e,suggestedReplies:n.suggestedActions.actions.filter((e=>e?.channelData?.id&&e?.channelData?.utcTime)).map((e=>{const i={targetMessageId:e?.channelData?.targetMessageId||n.replyToId,type:e?.channelData?.type||"reply"};return{suggestionChannelData:{...e?.channelData,...i},value:e.value||e.title,title:e.title,whisperId:n.id}}))})));return a&&0!==a.length?{suggestedRepliesCollections:a}:null}catch(e){return i.newLogger("Chat Helper","data-resolvers-common").error(`formatQuickReplyAugmentationFromObject: Exception in parsing quick reply augmentation. Error: ${e}`),null}},cn=e=>{const n=e&&e.suggestedActivities&&e.suggestedActivities.filter((e=>e?.type===d.jQ&&e?.from?.id===d.OD&&e?.timestamp&&e?.suggestedActions?.actions?.some((e=>e.type===d.m8||e.type===d.Wg))));return n&&0!==n.length?n:null},un=e=>{switch(e){case u.Wf.None:return"Unknown";case u.Wf.Adhoc:return"Adhoc";case u.Wf.Scheduled:return"Scheduled";case u.Wf.Recurring:return"Recurring";case u.Wf.Broadcast:return"Broadcast";case u.Wf.MeetNow:return"MeetNow"}},pn=e=>e&&e.map((e=>({id:e.id,originalArrivalTime:e.consumptionhorizon,messageVisibilityTime:e.messageVisibilityTime})))||null;function kn(e,n){if(!e||!n)return!1;return(0,p.CF)(e,n)>0}function gn(e,n,i,a,t,r=!1,l=!1,d,s,m=!1){const c=(0,me.vu)(e,i),u=e.find((({id:e})=>e===n))||null,p=Zn(e),k=(0,o.Yo)(e,t,[],d).members||[];return{memberIds:k.map((({id:e})=>e)),..._e(k,n,a),...Nn(c),...Mn(n,k),me:u,isUserMember:!!u,tflOffNetworkUser:(0,A.first)(p),tflOffNetworkUserLength:p.length,hasBotMember:k.some((({id:e})=>(0,o.Iz)(e))),hasFederatedUser:!!c.length||r,hasTflConsumerUser:In(k)||l,hasEnterpriseUser:fn(k),hasUnknownEnterpriseUser:Tn(k),hasUnknownConsumerUser:An(k),hasUnresolvedFederatedUser:c.some(K.af.isUnknownUser),hasTflSmsUnverifiedUser:vn(k),hasTflSmsVerifiedUser:Sn(k),isRetentionHorizonSet:kn(s,d),hasExtendedDirectoryUsers:ci(k),pendingBots:ui(s),hasGuestUser:m}}const Nn=e=>{const n=e.filter((e=>!K.af.isUnknownUser(e)&&e.featureSettings?.coExistenceMode!==r.bi.TeamsOnly&&!!e.displayName));return{nonTeamsFederatedUserLimitedNames:n.slice(0,2).map((({displayName:e})=>e||"")),nonTeamsFederatedUsersLength:n.length}},vn=e=>e.some((({id:e})=>(0,o.gZ)(e))),In=e=>e.some((e=>K.af.isTFLConsumerUser(e))),Sn=e=>e.some((e=>K.af.isTFLSmsVerifiedMri(e?.id))),An=e=>e.some((e=>(0,o.W4)(e.id)&&K.af.isUnknownUser(e))),Tn=e=>e.some((e=>K.af.isEnterpriseUserMri(e.id)&&K.af.isUnknownUser(e))),fn=e=>e.some((e=>K.af.isEnterpriseUserMri(e.id))),Mn=(e,n)=>{let i=!0;const a=n&&n.some((n=>{if(!n.isFederated&&!(0,o.oG)(n.id,d.LE)&&n.id!==e&&n.featureSettings){const e=n.featureSettings.isPrivateChatEnabled;return null==e?(i=!1,!0):!e}return!1}));return{isPrivateChatPolicyDefinedScenario:i,isChatDisabledForRecipients:a}},hn={opted_out:"OptedOut",claimed:"Claimed",deprovisioned:"Deprovisioned"},yn=e=>{if(!e)return;const n=(0,v.j)(e);return{newlyCreatedUserId:n.userId,code:hn[n.code]}},Fn=e=>{if(e)return(0,I.K)()("Importing","Completed").find((n=>n===e))},bn=e=>({...e,preview:"",isSystemMessage:!1,canShowEveryoneMentionBadge:!1,__typename:"LastMessage"}),Cn=e=>e?`${e}`:null,Dn=({id:e,members:n,consumptionHorizon:i,userConsumptionHorizon:a,lastMessage:t,creator:r,meetingInformation:l,isDisabled:o,disabledReason:s,importState:m,isMuted:c,isLastMessageFromMe:u,isRead:p,isOneOnOne:k,isOneOnOneBotChat:g,isSticky:N,isExternal:v,consumerGroupId:I,templateType:S,chatType:T,historyHiddenTime:f,createdAt:M,interopConversationStatus:h,quickReplyAugmentation:y,meetingPolicy:F,addedBy:b,addedByTenantId:C,sensitivityLabel:D,meetingChatType:U,lastL2MessageIdNFS:E,...w},L,x,O,P)=>{try{const f=(0,A.map)(n,(e=>(0,q.qK)(e))),M=t&&bn(nn(t,e,L)),V=l&&{id:e,subject:l.subject,startTime:l.startTime,scenario:l.scenario,endTime:l.endTime,iCalUid:l.iCalUid,location:l.location,exchangeId:l.exchangeId,meetingType:l.meetingType?un(l.meetingType):"Unknown",resolvedSensitivityLabelId:l.resolvedSensitivityLabelId,isCopyRestrictionEnforced:l.isCopyRestrictionEnforced,templateDetails:l.templateDetails,meetingJoinUrl:l.meetingJoinUrl,messagingPolicy:l.messagingPolicy},j=!(!k&&!N&&S!==d.iy.ImmutableRoster),B=D&&D.id?{id:D.id,isCopyBlocked:D.protectTeamsLabelAction?.isCopyRestrictionEnforced||!1}:void 0,z=Cn(E);return{__typename:"Conversation",...gn(f,O?.id||"",x,P),...w,id:e,consumptionHorizon:i&&{__typename:"ConsumptionHorizon",...tn(e,d.Cr.Chat,{lastjoinat:w.lastJoinAt},i)},consumptionHorizonBookmark:a&&{__typename:"ConsumptionHorizonBookmark",...tn(e,d.Cr.Chat,{lastjoinat:w.lastJoinAt},a)},userConsumptionHorizon:a&&{__typename:"ConsumptionHorizonBookmark",...tn(e,d.Cr.Chat,{lastjoinat:w.lastJoinAt},a)},lastL2MessageIdNotFromSelf:z,lastMessage:M,members:[],creator:r,meetingInformation:V,isDisabled:!!o,disabledReason:yn(s),importState:Fn(m),isMuted:c,isLastMessageFromMe:!!u,isRead:p,isOneOnOne:j,cfet:v,consumerGroupId:I,isOneOnOneBotChat:!!g,chatType:Pn(T),interopConversationStatus:jn(h),quickReplyAugmentation:y&&mn(e,y,L),addedBy:b,addedByTenantId:C,meetingChatPolicy:zn(F),sensitivityLabel:B,meetingChatType:Qn(U)}}catch(n){L.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in conversation object transformation: ${n}`);return{...w,id:e,isUserMember:!1,consumptionHorizon:null,consumptionHorizonBookmark:null,userConsumptionHorizon:null,lastMessage:null,memberIds:[],members:[],membersLimited:[],chatHistoryHiddenTime:f,memberDisplayNamesLimited:[],creator:null,meetingInformation:null,chatType:null}}},Un=({id:e,members:n,tenantId:i,meetingInformation:a},t)=>{try{const t=(0,A.map)(n,(e=>(0,q.qK)(e)));return{__typename:"ConversationMembers",id:e,tenantId:i=i??"",meetingJoinUrl:a?.meetingJoinUrl??"",members:t}}catch(n){t.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in conversation object transformation: ${n}`);return{id:e,members:[]}}},En=(e,n,i,a,t)=>({node:Dn(e,n,i,a,t),cursor:e.createdAt||e.id}),wn=e=>({activities:e.activities,callLogs:e.callLogs,chats:e.chats,total:e.total});function Ln(e){return JSON.stringify((0,A.map)(e,(e=>{const n=e.mentionType,i=e.displayName;return{"@type":Ie,itemid:e.itemId,mri:e.userId,mentionType:n,displayName:i}})))}function xn(e){return!e||e.length<1?null:JSON.stringify(e.map((e=>{const n=e.mentionType,i=e.displayName;return{itemid:e.itemId,mri:e.userId,mentionType:n,displayName:i}})))}const On=new Map([["chat","Chat"],["phonechat","PhoneChat"],["phonelink1on1chat","Phonelink1on1Chat"],["phonelinkgroupchat","PhonelinkGroupChat"],["meeting","Meeting"],["sfbinteropchat","SfBInteropChat"]]),Pn=e=>{let n=null;return null==e||(n=On.get(e),void 0===n&&(n=null)),n},Vn=new Map([["AcceptPending","AcceptPending"],["ExtendedDirectoryAcceptPending","ExtendedDirectoryAcceptPending"],["Accepted","Accepted"],["Blocked","Blocked"],["Quarantined","Quarantined"]]),jn=e=>e&&Vn.get(e)||null,Bn=new Map([["ChatEnabled","ChatEnabled"],["ChatDisabled","ChatDisabled"],["InMeeting","InMeeting"],["ChatEnabledAnonymousDisabled","ChatEnabledAnonymousDisabled"],["InMeetingAnonymousDisabled","InMeetingAnonymousDisabled"]]),zn=e=>e&&Bn.get(e)||null,Rn=new Map([["backroom","Backroom"]]),Qn=e=>e&&Rn.get(e)||null,Wn=e=>!!e&&"PhoneChat"===e,Yn=({id:e,conversationid:n,imdisplayname:i,from:a,composetime:t},r)=>e&&{"@type":ve,mri:Te(a),imdisplayname:i,messageId:e,parentMessageId:r??e,threadId:n,isUnresolvedEmailUser:!1,originalComposeTime:t},Gn=(e,n,i)=>{const a=i.find((i=>{try{const a=JSON.parse((i.properties||{}).starred),t=a&&a["@type"]===ve&&a.threadId===n?a.messageId:void 0;return e===t}catch(e){return!1}}));return a&&a.id},Zn=e=>e.filter((({id:e})=>K.af.isTFLOffNetworkUser(e))),_n=(e,n,i)=>{const a=De(i.properties,i.id);return!!a&&a.some((i=>i.key===e&&!!i.users&&i.users.some((e=>e.userId===n))))},Hn=e=>{let n;switch(e){case c.rI.Error:n="Error";break;case c.rI.Sending:n="Sending";break;case c.rI.Retrying:n="Retrying";break;default:n="Delivered"}return n},Jn=async({resourceType:e,resource:n},i,a)=>{if("ThreadUpdate"===e)try{const{id:e="",members:a}=n,t=a?await i(a,e):[];return{__typename:"ConversationMembers",id:e,members:t}}catch(e){a.newLogger("toChatMembersEvent","data-resolvers-common").error(`Failed getting thread members: ${e}`)}},qn=e=>(0,k.t0)(e)||(0,o.oZ)(e)||(0,p.xl)(e),Xn=(e,n)=>(0,A.filter)(e,(0,A.omit)(n,"__typename")),Kn=e=>!!e&&-1!==e.indexOf(he),$n=e=>!!e?.startsWith("tfl:preview-"),ei=e=>!!e&&(-1!==e.indexOf(d.iB)||-1!==e.indexOf(d.hd)),ni=e=>e===ye,ii=e=>ni(e)||Kn(e),ai=e=>{switch(e){case Me.FAMILY:case Me.FRIENDS:case Me.PROJECT:case Me.WORKPLACE:case Me.TRIP_PLANNING:case Me.GET_TOGETHER:case Me.LOCAL_COMMUNITY:case Me.HOLIDAY_PLANNING:return!0}return!1},ti=e=>!!e&&-1!==e.indexOf(":tflfed:preview-"),ri=e=>!!e&&e.includes("meeting"),li=(e,n,i,t,r,l,o,d)=>{if(!e)return;const s="Phonelink1on1Chat"===n,m="PhonelinkGroupChat"===n,c=i?a.bF.Meeting:t?r?a.bF.Botchat:Wn(n)?a.bF.SMSOneOnOneChat:(0,p.xl)(e)?a.bF.SfcInteropChat:(0,k.t0)(e)?a.bF.SfbInteropChat:l?a.bF.NativeFederatedChat:o?a.bF.FederatedChat:(0,p.qL)(e)&&s?a.bF.Phonelink1on1Chat:a.bF.OneOnOneChat:(0,p.L5)(e)?a.bF.StreamOfNotes:(0,p.qL)(e)&&m?a.bF.PhonelinkGroupChat:(e=>!!e&&e===u.vW.Channel)(d)?a.bF.Channel:a.bF.GroupChat;return c},oi=(e,n)=>{if(!n||!n.notification)return null;try{const e=n.notification;return{alertInMeeting:e.alertInMeeting,externalResourceUrl:e.externalResourceUrl}}catch(n){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in chat message notification transformation: ${n}`),null}},di=e=>{if((0,A.isString)(e)){return{__typename:"DimensionInString",value:e}}if((0,A.isNumber)(e)){return{__typename:"DimensionInFloat",value:e}}return null},si=(e,n)=>{if(!n||!n.notifications)return null;try{const e="string"==typeof n.notifications?JSON.parse(n.notifications):n.notifications;return e&&e.map((({surface:e,contentType:n,content:i})=>({surface:e,contentType:n,content:{value:{height:di(i.value?.height)??void 0,width:di(i.value?.width)??void 0,title:i.value?.title??"",url:i.value?.url??""},actions:i.actions??[]}})))}catch(n){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in message notifications parsing: ${n}`),null}};function mi(e){if(e)return"string"==typeof e?e:e.state}const ci=e=>e.some((e=>K.af.isExtendedDirectoryUser(e))),ui=e=>{if(e&&Kn(e.id)){const n=e.properties.pendingBotMembers;if(n){return(0,v.j)(n)}}},pi=e=>{const n=e.split(";");return{conversationId:n[0],replyChainId:n.find((e=>e.startsWith("replyChainId=")))?.split("=")[1]||null,messageId:n.find((e=>e.startsWith("messageId=")))?.split("=")[1]||null}}},378044:(e,n,i)=>{"use strict";i.d(n,{LA:()=>d,Fx:()=>u,vu:()=>p});var a=i(364819),t=i(348103),r=i(539299),l=i(355515),o=i(34655);const d=(e,n,i)=>{if(!n||!n.cards||"string"!=typeof n.cards&&!i)return null;try{let e=String(n.cards);i&&(e=i);return JSON.parse(e).map((({appIcon:e,appId:n,appName:i,cardClientId:a,content:t,contentType:r,locale:l,userSpecificContent:o})=>({appIcon:e,appId:n||"",appName:i,cardClientId:a,content:JSON.stringify(t),contentType:r,locale:l,...!!o&&{userSpecificContent:o}})))}catch(n){return e.newLogger("Conversation Last Message Processing","services-io-chat").log("UnhandledException in toCards."),null}};var s;!function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WOPI=1]="WOPI",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(s||(s={}));const m=(e,n)=>{try{const n=JSON.parse(e);if(!n||!n.code)return;const i=(e=>{switch(e){case"BOX":return"BOX";case"DROPBOX":return"DROPBOX";case"EGNYTE":return"EGNYTE";case"GOOGLEDRIVE":return"GOOGLEDRIVE";case"SHAREFILE":return"SHAREFILE";default:throw new Error("Invalid provider code")}})(n.code);return{code:i,type:(e=>{switch(e){case s.Sharepoint:return"Sharepoint";case s.WOPI:return"WOPI";case s.Google:return"Google";case s.OneDrive:return"OneDrive";case s.Recent:return"Recent";case s.Aggregate:return"Aggregate";case s.FileSystem:return"FileSystem";case s.Search:return"Search";case s.AllFiles:return"AllFiles";case s.SharedWithMe:return"SharedWithMe";default:throw new Error("Not a valid provider type")}})(parseInt(n.type,10))}}catch(e){return void n.newLogger("Conversation Last Message Processing","services-io-chat").log(`Failed to parse provider data: ${e}`)}},c=(e,n)=>{{const i=2,a=["http","https"],{filePreview:d,chicletBreadcrumbs:s,fileInfo:c,anchorFileId:u,progressComplete:p,isUploadError:k,fileChicletState:g,providerData:N}=e,{shareUrl:v,shareId:I,itemId:S}=c,A=d||{},T=g?.serviceName,{id:f,baseUrl:M,objectUrl:h,type:y,title:F,state:b}=((e,n)=>{const{version:i}=e;let{id:a,baseUrl:t,objectUrl:r,type:d,title:s,state:m}=e;if(i!==n&&(({itemid:a,fileName:s,fileType:d,fileInfo:{fileUrl:r,siteUrl:t}}=e),m=e.fileChicletState?.state),"string"!=typeof a)throw(0,l.$5)("ChatHelpers",o.O4.Undefined,"toFiles",{id:a,version:i,type:d},"File id is missing");return{id:a,baseUrl:t,objectUrl:r,type:d,title:s,state:m}})(e,i),C="active"!==b&&"hidden"!==b,D=m(N,n),U=(0,t.K)()("aggregatefiles","customspo","downloads","p2p","personal","recent","teams","teamsSdk"),E=(0,t.K)()("active","deleted","reference","hidden");return{id:f,itemId:S,chicletBreadcrumbs:s,baseUrl:(0,r.Jf)(M,a),objectUrl:(0,r.Jf)(h,a),shareId:I,shareUrl:v,type:y,title:F,fileId:f,isReferencedFile:C,anchorFileId:u,progressComplete:p&&parseInt(p,10)||null,serviceName:T&&U.find((e=>e===T)),state:b&&E.find((e=>e===b)),hasUploadFailed:k,providerDataV2:D,...A}}},u=(e,n)=>{if(!n||!n.files||"string"!=typeof n.files)return null;try{let i=JSON.parse(n.files);i=i.filter((e=>"deeplink"!==e.type));return(0,a.map)(i,(n=>c(n,e)))}catch(e){return null}},p=(e,n)=>e.filter((({tenantId:e,isFederated:i})=>i||n&&e&&e!==n))},325759:(e,n,i)=>{"use strict";i.d(n,{Pf:()=>s,sN:()=>m,MM:()=>c});var a=i(364819),t=i(244698),r=i(332752),l=i(355515),o=i(34655),d=i(194649);const s=(e,n,i)=>{let t=[];if((0,a.isEmpty)(e)||(0,a.isEmpty)(n)){const a=`Invalid user ids when generating chat id from members: userId1=${e}, userId2=${n}`;throw i.error(a),(0,l.$5)(a,o.O4.InvalidInput,"chatIdFromMembers")}t=(0,d.Iz)(e)&&!(0,d.Iz)(n)?[(0,d.m9)(n),(0,d.m9)(e)]:!(0,d.Iz)(e)&&(0,d.Iz)(n)?[(0,d.m9)(e),(0,d.m9)(n)]:[(0,d.m9)(e),(0,d.m9)(n)].sort();const r=(0,d.Xb)(e),s=(0,d.Xb)(n);if(r||s){if(r===s)return`19:${r}:${t[0]}_${t[1]}@unq.gbl.spaces`;i.warn(`Both users are in different clouds: ${r} and ${s}. This should be a federated chat, falling back to default chat ID generation.`)}return`19:${t[0]}_${t[1]}@unq.gbl.spaces`};function m(){const[e,n]=(0,t.yT)(2);return`${e}${n}`.substr(0,19)}function c(e){const{ageGroup:n}=e.get(r.w.AgeConsent);return"MinorWithMsaParentalConsent"===n||"MinorWithoutMsaParentalConsent"===n||"MinorNoMsaParentalConsentRequired"===n||"MinorWithoutParentalConsent"===n||"MinorWithParentalConsent"===n||"MinorNoParentalConsentRequired"===n}},271126:(e,n,i)=>{"use strict";var a,t;i.d(n,{aY:()=>t,IA:()=>r,zS:()=>l,mJ:()=>o}),function(e){e[e.Standard=0]="Standard",e[e.Important=2]="Important",e[e.Urgent=3]="Urgent"}(a||(a={})),function(e){e.Standard="",e.Important="high",e.Urgent="urgent"}(t||(t={}));const r=e=>"Important"===o(e),l=e=>t[e]||t.Standard,o=e=>{switch(e){case t.Important:case a.Important:return"Important";case t.Urgent:case a.Urgent:return"Urgent";case t.Standard:case a.Standard:default:return"Standard"}}},243507:(e,n,i)=>{"use strict";i.d(n,{i2:()=>a,j8:()=>t,Fo:()=>l});const a="suggested-org-group-chat",t="suggested-project-group-chat",r=[a,t];function l(e){return r.includes(e)}},529442:(e,n,i)=>{"use strict";i.d(n,{vV:()=>r,SU:()=>l,Qr:()=>o,UB:()=>d});var a=i(75914),t=i(364819);const r=e=>{switch(e){case a.nP.Moderate:return"Moderate";case a.nP.NoRestriction:return"NoRestriction";case a.nP.Strict:default:return"Strict"}},l=(e,n,i,a)=>d(n,e.threadProperties.spaceThreadTopic,e.threadProperties.pictureETag,e.threadProperties.groupId,i,a),o=(e,n,i,a,t)=>d(i,e.threadProperties.topicThreadTopic,n?.threadProperties.pictureETag,n?.threadProperties.groupId,a,t),d=(e,n,i,a,r,l)=>{const o=encodeURIComponent(n);return r&&l&&!(0,t.isEmpty)(l)?e+"beta/users/{objectId}/profilepicturev2/teams/{teamGroupId}?etag={etag}&displayName={displayName}&voidCache=true".replace("{objectId}",l).replace("{teamGroupId}",a||"").replace("{etag}",i||"").replace("{displayName}",o):e+"beta/teams/{teamGroupId}/profilepicturev2?etag={etag}&displayName={displayName}&voidCache=true".replace("{teamGroupId}",a||"").replace("{etag}",i||"").replace("{displayName}",o)}},438543:(e,n,i)=>{"use strict";i.d(n,{wJ:()=>d,KN:()=>m,bX:()=>c,W3:()=>k,fj:()=>g,UM:()=>N,qt:()=>I,eQ:()=>A,rl:()=>T});var a,t=i(136723),r=i(554186),l=i(75914),o=i(514188);!function(e){e.HIGH="HIGH",e.MEDIUM="MEDIUM",e.LOW="LOW"}(a||(a={}));const d=new RegExp("https?://[^\\s]+","i"),s="-",m=e=>{if(0===(e=e.toLowerCase()).lastIndexOf("zh-",0))switch(e){case"zh-cht":case"zh-hant":case"zh-hk":case"zh-tw":return"zh-cht";default:return"zh-chs"}let n=e.indexOf(s,1);if(-1===n)return e;let i=e.indexOf(s,n+1);return-1===i&&(i=e.length),i-n==5&&(n=i),e.substring(0,n)},c=e=>{const n=e?m(e):"",i=(0,t.get)("tcurlang")||n;return{targetLanguage:i,knownLanguages:[i]}},u=(e,n)=>(e=>{switch(e){case l.Uf.Success:return"Done";case l.Uf.MessageNotFound:return"MessageNotFound";case l.Uf.VersionNotFound:return"VersionNotFound";case l.Uf.LanguageDetectionFailed:return"LanguageDetectionFailed";case l.Uf.SkipTranslation:case l.Uf.ContentIsEmpty:return"TranslationNotNeeded";default:return"UnknownError"}})(((e,n)=>{const i=l.Uf[e];return void 0!==i?i:(n?.error(`Unable to parse translation result code: ${e}`),l.Uf.UnknownError)})(e,n)),p=async(e,n,i,a,t,r,o,d,s)=>{try{return await e.translateMessages(n,i,a,t,r,o,s)}catch(e){return d.error(`Failed to translate ${o}: ${e}`),r.map((({id:e,version:n})=>({id:e,version:n||"",detectedLanguage:{languageId:"",score:0},resultCode:l.Uf[l.Uf.UnknownError],translatedContent:"",translatedSubject:"",translatedTitle:""})))}},k=async(e,n,i,a,t,l,o)=>{const{targetLanguage:d,knownLanguages:s}=i,m=(0,r.v4)(),c=t.map((({messageId:e,version:n})=>n?{id:e,version:n}:{id:e}));return{convId:a,targetLangCode:d,correlationId:m,translations:(await p(e,a,n,d,s,c,m,l,o)).map((e=>({messageId:e.id,content:e.translatedContent||"",sourceLangCode:e.detectedLanguage?.languageId||"",resultCode:u(e.resultCode,l),version:e.version})))}},g=async(e,n,i)=>{try{return(await e.getSupportedTranslationLanguages(n)).map((({languageTag:e,languageName:n})=>({languageCode:e,languageName:n})))}catch(e){return i.error(`Unable to retrieve languages: ${e}`),[]}},N=(e,n,i,t,r)=>{if("string"!=typeof n)return null;try{const e=(0,o.J)(n),l=e.languages?.split(";")?.map((e=>{const[n,i]=e.split(":");return{code:n,score:parseInt(i,10)}})),d=l[0].code;if("null"===d)return null;let s=l.length;s>0&&""===l[s-1].code&&(l.pop(),s--);const m=void 0!==e.length,c=s>0&&"length"===l[s-1].code;if(!(m||c))return{code:d,confidenceLevel:a.LOW};const u=JSON.parse(r??"{}").settingsData,p=u?.find((n=>n.detector===e.detector));if(!(p&&i&&t&&p.minConfidence))return{code:d,confidenceLevel:a.LOW};const k=((e,n)=>{const i=e.minCharMap,a=e.minCharMapOverrides,t=new Map([["ar","arabic"],["fa","arabic"],["ku","arabic"],["ru","cyrillic"],["uk","cyrillic"],["bg","cyrillic"],["sr","cyrillic"],["sr-cyrl","cyrillic"],["sr-latn","latin"],["mk","cyrillic"],["uz","cyrillic"],["zh","han"],["zh-chs","han"],["zh-cht","han"],["ja","han"],["ko","han"],["vi","latin"],["en","latin"],["de","latin"],["fr","latin"],["es","latin"],["it","latin"],["pt","latin"],["ca","latin"],["nl","latin"],["pl","latin"],["tr","latin"],["sv","latin"],["cs","latin"],["da","latin"],["hu","latin"],["no","latin"],["nb","latin"],["ro","latin"],["fi","latin"],["ms","latin"],["sk","latin"],["et","latin"],["hr","latin"],["lt","latin"],["sl","latin"],["id","latin"],["lv","latin"],["gl","latin"],["is","latin"],["sq","latin"],["nn","latin"],["cy","latin"],["af","latin"],["mt","latin"],["ga","latin"],["eo","latin"],["so","latin"],["sw","latin"],["bs","latin"],["eu","latin"],["az","latin"],["ht","latin"],["la","latin"],["za","latin"]]);return a?.[n]??i?.[t.get(n)??""]??i?.others??5})(p,d),g=p.minConfidence??70,N=l.find((e=>e.code===i))?.score;if(i!==d){let n=0;if(m&&(n=parseInt(e.length,10)||0),c&&(n=v(l)),n<k)return{code:d,confidenceLevel:a.LOW};if(N&&N>=g)return{code:i,confidenceLevel:a.LOW}}return{code:d,confidenceLevel:a.HIGH}}catch(i){return e.newLogger("toSourceLanguageCode","data-resolvers-common").error(`Failed to calculate source language code from language stamp: ${n}.`),null}},v=e=>{const n=e.pop();return n?.score||0},I=(e,n,i,t)=>{const r=n?.code;if(!e||!r||n?.confidenceLevel===a.LOW)return!1;const l=e.knownLanguages;if(r===e.targetLanguageCode||l.includes(r))return!1;switch(e.translationMode){case"SUGGEST_TRANSLATION":return!0;case"ALWAYS_TRANSLATE":if(i&&"ShowOriginalMessage"===t)return!0}return!1},S=(e,n)=>{if(!e)return"ShowOriginalMessage";if(!n)return"Done";switch(n){case l.Uf.Success:return"Done";case l.Uf.SkipTranslation:return"TranslationNotNeeded";case l.Uf.MessageNotFound:return"MessageNotFound";case l.Uf.VersionNotFound:return"VersionNotFound";case l.Uf.LanguageDetectionFailed:return"LanguageDetectionFailed";case l.Uf.UnsupportedSourceLanguage:return"UnsupportedSourceLanguage";default:return"UnknownError"}},A=e=>{const{body:n,subject:i,title:a,toggled:t,detectedLanguageName:r,sourceLanguageCode:l,targetLanguageCode:o,isOnDemandTranslation:d,isInProgress:s,error:m}=e||{};if(s)return{translationStatus:"InProcess"};return(void 0!==n||void 0!==m)&&r&&l&&o?{translationStatus:S(!!t,m),translatedSubject:i,translatedContent:n,translatedTitle:a,isOnDemandTranslation:d,sourceLanguageName:r,sourceLanguageCode:l}:void 0},T=(e,n,i)=>{if(!i)return!1;let a=null;return i&&(a=i.find((e=>e.languageCode===n))),!(!a||a.messageId===e)}},785053:(e,n,i)=>{"use strict";i.d(n,{qK:()=>d,N4:()=>s,p_:()=>N});var a=i(210071),t=i(586892),r=i(97882),l=i(194649),o=i(364819);const d=(e,n,i,a)=>{const r=t.af.getRequestCount(e),{accountEnabled:l,mri:o,objectId:d,displayName:s,givenName:k,surname:N,type:I,jobTitle:S,userPrincipalName:A,email:T,tenantId:f,sipProxyAddress:M,mobile:h,telephoneNumber:y,tenantName:F,decoratedDisplayName:b,cid:C,description:D,externalCalendarEmailAddress:U,homeMri:E,homeTenantId:w,mtoLabel:L,profileType:x,avatarETag:O}=e,P={__typename:"User",accountEnabled:l,id:v(e),objectId:d,mri:o,displayName:s,givenName:k,surname:N,type:I,jobTitle:S,userPrincipalName:A,email:T,tenantId:i||f||null,sipProxyAddress:M,mobile:h,telephoneNumber:y,requestCount:r,preferredUserName:n,tenantName:F||null,decoratedDisplayName:b||null,cid:C,description:D,externalCalendarEmailAddress:U,emailForQuery:a,homeMri:E,homeTenantId:w,mtoLabel:L,profileType:x,avatarETag:O};return function(e,n){const i=e.department;i&&(n.department=i)}(e,P),p(e,P),u(e,P),m(e,P),c(e,P),g(P),P},s=e=>{const{id:n,displayName:i,description:a,email:t,phone:r,mri:l,requestCount:o,syncSource:d}=e;return{__typename:"User",id:n,mri:l,objectId:l,displayName:i,userPrincipalName:l,givenName:i,surname:i,description:a,email:t,mobile:r,telephoneNumber:r,requestCount:o,syncSource:d}},m=(e,n)=>{if(function(e){const n=e;return void 0!==n.isFederated||void 0!==n.isAnonymousB2bUser||"federated"===n.type?.toLowerCase()}(e)){const{isFederated:i,fetchErrorCode:a,isAnonymousB2bUser:t}=e;n.isFederated=i||"federated"===e.type?.toLowerCase(),n.fetchErrorCode=a,n.isAnonymousB2bUser=t}else n.isFederated=null,n.fetchErrorCode=null,n.isAnonymousB2bUser=null},c=(e,n)=>{e.featureSettings&&(n.featureSettings=e.featureSettings),e.isBlocked&&(n.isBlocked=e.isBlocked),e.cid&&(n.cid=e.cid),e.isIbBarred&&(n.isInfoBarrierSet=e.isIbBarred),e.isAnonymousUser&&(n.isAnonymousUser=e.isAnonymousUser),e.phonesInfo&&(n.phonesInfo=(0,o.cloneDeep)(e.phonesInfo)),e.emailsInfo&&(n.emailsInfo=(0,o.cloneDeep)(e.emailsInfo)),e.xtapUser&&(n.xtapUser=e.xtapUser),e.companyName&&(n.companyName=e.companyName),e.tenantName&&(n.tenantName=e.tenantName),e.imageUri&&(n.imageUri=e.imageUri),e.selfAvatarLastupdatedTime&&(n.selfAvatarLastupdatedTime=e.selfAvatarLastupdatedTime),e.avatarUrl&&(n.avatarUrl=e.avatarUrl),n.isShortProfile=e.isShortProfile},u=(e,n)=>{(function(e){return void 0!==e.userType}(e)||function(e){const n=e;return n.type?n.type===a.Pk.botType:(0,l.Iz)(e.mri)}(e)||function(e){return"aduser"===e.type?.toLowerCase()||"aduser"===e.$$subType?.toLowerCase()}(e))&&(n.userType=e.userType,n.description=e.description,n.isUnified=e.isUnified,n.securityEnabled=e.securityEnabled,n.featureSettings=e.featureSettings,n.imageUri=e.imageUri,n.userLocation=e.userLocation)},p=(e,n)=>{const i=e.phones;i&&(n.phones=i.map((e=>k(e))))},k=e=>({number:e.number,type:e.type}),g=e=>{const{mri:n}=e;if((0,r.Ku)(n)&&!e.displayName){const i=(0,r.IK)(n);e.displayName=i,e.givenName=i}else if(n&&(0,l.gZ)(n)&&!e.displayName){const i=(0,l.eu)(n);e.displayName=i,e.givenName=i}else e.displayName||(e.displayName="Unknown User");return e},N=e=>!!e&&!("string"!=typeof e||!t.af.isTFLSmsVerifiedMri(e)),v=e=>e.mri||e.objectId||e.concatenatedId},3120:(e,n,i)=>{"use strict";i.d(n,{mu:()=>t,AZ:()=>r});const a="EntityMoreInfo",t={requestPersonMoreInfo:"requestPersonMoreInfo",requestPersonMoreOrgInfo:"requestPersonMoreOrgInfo",requestTopicMoreInfo:"requestTopicMoreInfo"},r={requestPersonMoreInfo:e=>({originator:a,type:t.requestPersonMoreInfo,data:()=>({...e})}),requestPersonMoreOrgInfo:e=>({originator:a,type:t.requestPersonMoreOrgInfo,data:()=>({...e})}),requestTopicMoreInfo:e=>({originator:a,type:t.requestTopicMoreInfo,data:()=>({...e})})}},947521:(e,n,i)=>{"use strict";i.d(n,{hQ:()=>t,E2:()=>r,YV:()=>l,h1:()=>o,Cu:()=>d,hB:()=>s,hV:()=>m});var a,t,r,l,o,d,s,m;!function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(a||(a={})),function(e){e.web="web",e.desktop="desktop",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows"}(t||(t={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.meetingStage="meetingStage"}(r||(r={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(l||(l={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(o||(o={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(d||(d={})),function(e){e.activityFeed="activityFeed",e.card="card",e.connectorConfiguration="connectorConfiguration",e.deepLink="deepLink",e.deepLinkStageView="deepLinkStageView",e.deepLinkQuickAccess="deepLinkQuickAccess",e.contentBubble="contentBubble",e.messageExtension="messageExtension",e.tab="tab",e.shareToOutlook="shareToOutlook",e.adaptiveCardTab="adaptiveCardTab",e.adaptiveCardCollabStage="adaptiveCardCollabStage",e.adaptiveCardStageModal="adaptiveCardStageModal",e.platformAppView="platformAppView",e.chatTab="chatTab",e.channelTab="channelTab",e.sidePanel="sidePanel",e.privateMeetingSchedulingForm="privateMeetingSchedulingForm",e.channelMeetingSchedulingForm="channelMeetingSchedulingForm",e.personalApp="personalApp",e.botConfig="botConfig",e.storeApp="storeApp",e.stageViewOpenSDKApi="stageViewOpenSDKApi",e.workflows="workflows",e.virtualEvent="virtualEvent",e.botChat="botChat",e.precache="precache"}(s||(s={})),function(e){e.teamsElectron="TEAMS-ELECTRON",e.teamsWeb="TEAMS-WEB",e.teamsMaglev="TEAMS-MAGLEV"}(m||(m={}))},390151:(e,n,i)=>{"use strict";i.d(n,{Xh:()=>o,fP:()=>l});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ServicesIoDataBotConfigProfileAppDefinitionsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"botId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinitions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"botId"},value:{kind:"Variable",name:{kind:"Name",value:"botId"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataBotConfigProfileAppDefinitionsFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"installedApps"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScopes"},value:{kind:"ListValue",values:[{kind:"EnumValue",value:"Personal"}]}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"botId"},value:{kind:"Variable",name:{kind:"Name",value:"botId"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"definition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataBotConfigProfileAppDefinitionsFragment"}}]}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataBotConfigProfileAppDefinitionsFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"bots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"capabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isNotificationOnly"}},{kind:"Field",name:{kind:"Name",value:"supportsFiles"}},{kind:"Field",name:{kind:"Name",value:"supportsCalling"}},{kind:"Field",name:{kind:"Name",value:"supportsVideo"}}]}},{kind:"Field",name:{kind:"Name",value:"configuration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"team"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataBotConfigProfileAppDefinitionsFragment_botConfigurationScope"}}]}},{kind:"Field",name:{kind:"Name",value:"groupChat"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ServicesIoDataBotConfigProfileAppDefinitionsFragment_botConfigurationScope"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"developerName"}},{kind:"Field",name:{kind:"Name",value:"developerUrl"}},{kind:"Field",name:{kind:"Name",value:"longDescription"}},{kind:"Field",name:{kind:"Name",value:"shortDescription"}},{kind:"Field",name:{kind:"Name",value:"connectors"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorId"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"configurationUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"privacyUrl"}},{kind:"Field",name:{kind:"Name",value:"largeImageUrl"}},{kind:"Field",name:{kind:"Name",value:"termsOfUseUrl"}},{kind:"Field",name:{kind:"Name",value:"meetingExtensionDefinition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"supportsStreaming"}},{kind:"Field",name:{kind:"Name",value:"scenes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"file"}},{kind:"Field",name:{kind:"Name",value:"preview"}},{kind:"Field",name:{kind:"Name",value:"maxAudience"}},{kind:"Field",name:{kind:"Name",value:"seatsReservedForOrganizersOrPresenters"}}]}},{kind:"Field",name:{kind:"Name",value:"filters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"galleryTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"configurationUrl"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"canHaveTabConversation"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"meetingSurfaces"}},{kind:"Field",name:{kind:"Name",value:"context"}}]}},{kind:"Field",name:{kind:"Name",value:"staticTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isFullScreenApp"}},{kind:"Field",name:{kind:"Name",value:"isFullTrustApp"}},{kind:"Field",name:{kind:"Name",value:"validDomains"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"isMicrosoftOwned"}},{kind:"Field",name:{kind:"Name",value:"externalId"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"webApplicationInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"applicationPermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"authorization"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resourceSpecific"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"devicePermissions"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ServicesIoDataBotConfigProfileAppDefinitionsFragment_botConfigurationScope"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BotConfigurationScope"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}}]}.definitions]}.definitions]};var t=i(286412),r=i(508411);async function l(e,n,i,t){const{data:l}=await e.query({query:a,variables:{botId:(0,r.Uf)(n),conversationId:i,scope:t}});let d;return l?.installedApps&&l.installedApps.length>0&&(d=o(l.installedApps.map((e=>e?.definition)))),d&&d.length>0||!l?.appDefinitions||(d=o([...l.appDefinitions])),d?.[0]}const o=e=>e?.sort(((e,n)=>(0,t.Z)(n?.version??"0",e?.version??"0")))},355552:(e,n,i)=>{"use strict";i.d(n,{jr:()=>a,gM:()=>t,UB:()=>r,jq:()=>l,m7:()=>o,RS:()=>d,H$:()=>s,_N:()=>m,b5:()=>c,DU:()=>u,iV:()=>p,DP:()=>k,_e:()=>g,zK:()=>N,c3:()=>v,Pq:()=>I,RX:()=>S,H:()=>A,ew:()=>T,Wg:()=>U,ez:()=>E,d9:()=>w,qf:()=>L,Gh:()=>x,RJ:()=>O,FG:()=>P,A1:()=>V,L2:()=>j,IT:()=>B});const a={Team:"Team",Personal:"Personal",GroupChat:"GroupChat"};var t,r,l;!function(e){e.Pin="Pin",e.Unpin="Unpin",e.Reorder="Reorder"}(t||(t={})),function(e){e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat",e.Channel="Channel"}(r||(r={})),function(e){e.UserAppPin="UserAppPin",e.TenantAppPolicyChange="TenantAppPolicyChange"}(l||(l={}));const o={Tab:"Tab",Bot:"Bot",Messaging:"Messaging",Connector:"Connector",StaticTab:"StaticTab",CUSTOMBOT:"CUSTOMBOT"};var d;!function(e){e.Added="Added",e.Removed="Removed",e.Updated="Updated",e.Synced="Synced",e.Mutated="Mutated",e.HashUpdate="HashUpdate"}(d||(d={}));const s={Unknown:"Unknown",SidePanel:"SidePanel",Stage:"Stage"};var m;!function(e){e.Unknown="Unknown",e.PersonalTab="PersonalTab",e.ChannelTab="ChannelTab",e.PrivateChatTab="PrivateChatTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.CallingSidePanel="CallingSidePanel"}(m||(m={}));const c={Unknown:"Unknown",PersonalTab:"PersonalTab",ChannelTab:"ChannelTab",PrivateChatTab:"PrivateChatTab",MeetingChatTab:"MeetingChatTab",MeetingDetailsTab:"MeetingDetailsTab",MeetingSidePanel:"MeetingSidePanel",MeetingStage:"MeetingStage",TeamLevelApp:"TeamLevelApp"};var u,p,k;!function(e){e.Application="Application",e.Delegated="Delegated"}(u||(u={})),function(e){e.Unknown="Unknown",e.Enabled="Enabled",e.Disabled="Disabled"}(p||(p={})),function(e){e.BotBased="botBased",e.ApiBased="apiBased"}(k||(k={}));const g={MRU:"MRU",AlphabeticalAsc:"AlphabeticalAsc",AlphabeticalDesc:"AlphabeticalDesc"};var N,v,I,S,A;!function(e){e.NewUpload="NewUpload",e.Update="Update",e.Upgrade="Upgrade"}(N||(N={})),function(e){e.NewUpload="NewUpload",e.Update="Update"}(v||(v={})),function(e){e.User="User",e.AzureAdApp="AzureAdApp"}(I||(I={})),function(e){e.Unknown="Unknown",e.PrivateChannel="PrivateChannel"}(S||(S={})),function(e){e.Federation="Federation"}(A||(A={}));const T={Unknown:"Unknown",TeamsApp:"TeamsApp",TaosSharedApp:"TaosSharedApp"};var f,M,h,y,F,b,C,D;!function(e){e.Mail="mail"}(f||(f={})),function(e){e.Desktop="desktop",e.Mobile="mobile"}(M||(M={})),function(e){e.General="general"}(h||(h={})),function(e){e.Short="short",e.Long="long"}(y||(y={})),function(e){e.MailRead="mailRead",e.MailCompose="mailCompose",e.MeetingDetailsOrganizer="meetingDetailsOrganizer",e.MeetingDetailsAttendee="meetingDetailsAttendee",e.OnlineMeetingDetailsOrganizer="onlineMeetingDetailsOrganizer",e.LogEventMeetingDetailsAttendee="logEventMeetingDetailsAttendee",e.Default="default"}(F||(F={})),function(e){e.After="after",e.Before="before"}(b||(b={})),function(e){e.Button="button",e.Menu="menu"}(C||(C={})),function(e){e.PromptUser="promptUser",e.SoftBlock="softBlock",e.Block="block"}(D||(D={}));var U,E,w,L,x,O,P,V,j,B;!function(e){e.Bot="bot"}(U||(U={})),function(e){e.None="none",e.ApiSecretServiceAuth="apiSecretServiceAuth",e.MicrosoftEntra="microsoftEntra",e.OAuth2_0="oAuth2.0"}(E||(E={})),function(e){e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meetings="Meetings"}(w||(w={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Connector="Connector"}(L||(L={})),function(e){e.Installed="Installed",e.InstalledAndFavorited="InstalledAndFavorited",e.InstalledAndHidden="InstalledAndHidden",e.InstalledAndPermanent="InstalledAndPermanent",e.InstalledAndDeprecated="InstalledAndDeprecated",e.Featured="Featured",e.NotInstalled="NotInstalled",e.PreConsented="PreConsented",e.AdminPreInstalled="AdminPreInstalled"}(x||(x={})),function(e){e.Unknown="Unknown",e.OfficeAddIn="OfficeAddIn",e.OfficeAddIns="OfficeAddIns",e.ExchangeAddIn="ExchangeAddIn",e.ExchangeAddIns="ExchangeAddIns",e.LineOfBusiness="LineOfBusiness",e.Bot="Bot",e.Bots="Bots",e.MessageExtension="MessageExtension",e.ComposeExtensions="ComposeExtensions",e.Extension="Extension",e.Extensions="Extensions",e.FirstPartyPages="FirstPartyPages",e.Dynamics="Dynamics",e.AAD="AAD",e.LaunchPage="LaunchPage",e.StaticTabs="StaticTabs",e.GraphConnector="GraphConnector",e.ConfigurableTabs="ConfigurableTabs",e.Connector="Connector",e.Connectors="Connectors",e.Activity="Activity",e.Activities="Activities",e.MeetingExtension="MeetingExtension",e.MeetingExtensionDefinition="MeetingExtensionDefinition",e.OpenAiPlugins="OpenAiPlugins"}(O||(O={})),function(e){e.MessageReadCommandSurface="MessageReadCommandSurface",e.MessageComposeCommandSurface="MessageComposeCommandSurface",e.AppointmentOrganizerCommandSurface="AppointmentOrganizerCommandSurface",e.AppointmentAttendeeCommandSurface="AppointmentAttendeeCommandSurface"}(P||(P={})),function(e){e.chats="chats",e.channels="channels",e.channelMeetings="meetings"}(V||(V={})),function(e){e.GlobalPrepinned="GlobalPrepinned",e.UserPinned="UserPinned",e.AdminPrepinned="AdminPrepinned"}(j||(j={})),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(B||(B={}))},117228:(e,n,i)=>{"use strict";i.d(n,{OV:()=>d,I4:()=>s,$G:()=>m,T8:()=>c,rE:()=>u,Ak:()=>k,Bd:()=>g,qI:()=>N,il:()=>v,M7:()=>I,qJ:()=>A,B7:()=>f});var a=i(46377),t=i(260465),r=i(364819),l=i(194649),o=i(933370);function d(e){const[n,i,t]=function(e){const n=3,i=e.split(";");return i&&i.length===n&&i[0]&&!isNaN(Number(i[0]))&&i[1]&&!isNaN(Number(i[1]))&&i[2]&&!(0,r.isNil)(Number(i[2]))?i:a.S0.split(";")}(e),l=Number(i)||0;return{originalArrivalTime:Number(n)||0,timeStamp:l,clientMessageId:t}}const s=(e,n)=>(0,t.r0)(n.type)?e.chat:(0,t.Mn)(n.type)?e.channel:void 0;function m(e,n){const i=d(e.properties&&e.properties[a.H0.ConsumptionHorizon]||a.S0);if(n){const a=s(n,e)||-1;if(M(e,i.originalArrivalTime,a))return i;i.originalArrivalTime=Math.max(i.originalArrivalTime,a)}return i}function c(e,n,i){const a=n.consumptionHorizon,t=a?.split(";")?.[0]||0,r=Number(t)||0;let l=r;if(i){const a=s(i,e)||-1,t=Number(n.replyChainId);if(M(e,r,a)||!isNaN(t)&&t>a)return{originalArrivalTime:r,timeStamp:0,clientMessageId:""};l=Math.max(r,a)}return{originalArrivalTime:l,timeStamp:0,clientMessageId:""}}function u(e,n){let i=d(p(e.properties)||a.S0);if(n){(s(n,e)||-1)>=i.timeStamp&&(i={originalArrivalTime:0,timeStamp:0,clientMessageId:"0"})}return i}const p=e=>e?.userConsumptionHorizon||e?.consumptionHorizonBookmark||null;function k(e,n){const i=d(e.properties&&e.properties[a.H0.ReplyChainListConsumptionHorizon]||a.S0);if(n){const a=s(n,e)||-1;if(M(e,i.originalArrivalTime,a))return i;i.originalArrivalTime=Math.max(i.originalArrivalTime,a),i.timeStamp=Math.max(i.timeStamp,a)}return i}function g(e){let n=e.lastMessageTimeUtc;if((0,r.isNil)(n)){const i=e.lastMessage?.originalarrivaltime;n=i&&new Date(i).getTime()||0}return n}const N=(e,n)=>{const i=m(e,n),a=u(e,n);return g(e)<=i.originalArrivalTime&&0===a.originalArrivalTime},v=(e,n,i,t=!1)=>{if("newchat"===e.id||(e=>!!e&&-1!==e.indexOf("preview-"))(e.id))return!0;let r=I(e,n,i,t);if(!r&&(e=>!!e&&e.includes(a.nu))(e.id)&&e.lastContentMessageTime&&e.lastMessage&&((0,l.o3)(e.lastMessage)||(0,l.bf)(e.lastMessage.messagetype))){const n=new Date(e.lastContentMessageTime).getTime(),a=m(e,i),t=u(e,i);r=n<=a.originalArrivalTime&&0===t.originalArrivalTime}return r},I=(e,n,i,t=!1)=>{let o="";e.lastMessage&&((0,l.o3)(e.lastMessage)?o=S(e.lastMessage)||"":e.lastMessage.from&&(o=(0,r.last)(e.lastMessage.from.split("/"))||""));const d=N(e,i),s=0===u(e,i).originalArrivalTime,m=-1!==o.indexOf(n);return!!t&&m&&!!e.lastMessage?.properties?.[a.rF.OriginalMessageContext]?d:d||m&&s},S=e=>{let n="";if((0,l.o3)(e)&&e.content){const i=e.content.match(/<initiator>(.*?)<\/initiator>/i);i&&i[1]&&(n=i[1].trim())}return n},A=(e,n)=>{const{clientMessageId:i,originalArrivalTime:a}=u(e,n),t=0!==a?new Date(a).toISOString():o.EJ;return!!i&&"0"!==i&&T(t)},T=e=>{e=e?.toString();return 0!==new Date(e&&"0"!==e?e:o.EJ).valueOf()},f=(e,n,i)=>{const t=A(e,i);let r=!1;if(e.lastMessage?.messagetype===a.Go.CallRecording){const n=new Date(e.lastContentMessageTime||o.EJ),{originalArrivalTime:a}=m(e,i);r=n>new Date(a||o.EJ)}else r=!N(e,i);const l=e.lastMessage?.from,d=!!(l&&n&&l?.indexOf(n)>-1);return t||r&&!d},M=(e,n,i)=>(0,t.r0)(e.type)&&e.threadProperties?.lastjoinat>i&&!T(n)},660618:(e,n,i)=>{"use strict";i.d(n,{cc:()=>h,Yg:()=>v,qb:()=>I,PS:()=>y,iL:()=>A,zk:()=>S,Su:()=>T,XC:()=>M,IH:()=>p,H9:()=>c,Pr:()=>f,Dj:()=>u,Fq:()=>k});var a=i(364819),t=i(698037),r=i(900301);const l=()=>o.instance;class o{constructor(){this._enabled=!1,this._currentAppConsumptionHorizon={current:t.hT,timestamp:void 0}}static get instance(){return o._instance||(o._instance=new o),o._instance}get isEnabled(){return this._enabled}setEnabled(e,{logger:n}){this._enabled=e,n.infoToTelemetry?.("Enabling appConsumptionHorizon singleton","cdl_appch_singleton",void 0,!0)}get currentAppConsumptionHorizon(){return this.isEnabled?this._currentAppConsumptionHorizon.current:t.hT}get latestAppConsumptionHorizonUpdate(){return this._currentAppConsumptionHorizon}updateAppConsumptionHorizon(e,{logger:n}){this.isEnabled?(this._currentAppConsumptionHorizon=(0,a.clone)(e),n.infoToTelemetry?.(`AppConsumptionHorizon updated to '${(0,r.hR)(e)}'.`,"cdl_appch_singleton",void 0,!0)):n.warnToTelemetry?.(`Tried updating appConsumptionHorizon while singleton was disabled '${(0,r.hR)(e)}'.`,"cdl_appch_singleton",void 0,!0)}}var d=i(117228),s=i(46377),m=i(260465);const c=e=>(0,d.qI)(e,N()?l().currentAppConsumptionHorizon:void 0),u=(e,n)=>(0,d.M7)(e,n,N()?l().currentAppConsumptionHorizon:void 0),p=e=>function(e){if(!e.properties)return!1;const n=e.properties[s.H0.LastImportantImTime];return function(e){if(!e)return 0;const n=new Date(e);return n?n.getTime():0}(n)>Number(g(e).originalArrivalTime)}(e),k=e=>{const n=e.threadProperties[s.iy.SharedInSpaces];return!!n&&n.includes(e.parentId)},g=e=>(0,a.isEmpty)(e.properties&&e.properties[s.H0.ConsumptionHorizonBookmark])?v(e):I(e);function N(){return o.instance.isEnabled}const v=e=>(0,d.$G)(e,N()?l().currentAppConsumptionHorizon:void 0),I=e=>(0,d.rE)(e,N()?l().currentAppConsumptionHorizon:void 0),S=e=>(0,d.Ak)(e,N()?l().currentAppConsumptionHorizon:void 0),A=(e,n)=>(0,d.T8)(e,n,N()?l().currentAppConsumptionHorizon:void 0),T=(e,n)=>(0,d.B7)(e,n,N()?l().currentAppConsumptionHorizon:void 0),f=(e,n,i=!1)=>(0,d.il)(e,n,N()?l().currentAppConsumptionHorizon:void 0,i),M=e=>(0,d.qJ)(e,N()?l().currentAppConsumptionHorizon:void 0),h=e=>{let n="";return e&&(n=[e.originalArrivalTime,e.timeStamp,e.clientMessageId].join(";")),n};function y(e,n){if((0,m.Z9)(e)&&(0,d.il)(e,n,void 0))return{updatedConsumptionHorizon:void 0,updatedConsumptionHorizonBookmark:void 0};if((0,m.IV)(e)&&!(0,d.B7)(e,n,void 0))return{updatedConsumptionHorizon:void 0,updatedConsumptionHorizonBookmark:void 0};const i=(0,d.I4)(l().currentAppConsumptionHorizon,e),a=(0,d.rE)(e,void 0),t=(0,d.Bd)(e),r=h({originalArrivalTime:t,timeStamp:Date.now().valueOf(),clientMessageId:e.lastMessage?.clientmessageid||"0"});let o;return i&&(0,d.qJ)(e,void 0)&&i>=a.timeStamp&&(o=s.S0),{updatedConsumptionHorizon:r,updatedConsumptionHorizonBookmark:o}}},509648:(e,n,i)=>{"use strict";i.d(n,{Jy:()=>Q,Ph:()=>c,rf:()=>u,CA:()=>D,IB:()=>z,FV:()=>R,oB:()=>O,BV:()=>C,IG:()=>P,_5:()=>U,oQ:()=>j,Ns:()=>x,qX:()=>h,y$:()=>g,aY:()=>k,Wq:()=>A,vQ:()=>M,GW:()=>F,n2:()=>b,CR:()=>E,j7:()=>w,Cy:()=>y,oI:()=>p,FF:()=>T,t0:()=>f,SL:()=>B,nK:()=>S,kO:()=>L,cR:()=>V,tH:()=>N});var a=i(332752),t=i(46377),r=i(886185),l=i(364819),o=i(821296),d=i(194649),s=i(933370);var m=i(75914);const c=({isActionToAccept:e,isUserBlocked:n,isInQuarantine:i,quarantineCounter:r,creator:l,currentUserMri:o},d)=>{let s=t.$y.Accepted;if(e){if(n){const e=l===o,{maxInviteFreeQuarantineCounter:n}=d.get(a.w.People),m=r>=(n||0);i&&!e?s=t.$y.AcceptPending:e&&m&&(s=t.$y.Quarantined)}}else s=t.$y.Blocked;return s},u=(e,n)=>e===t.j5.Accept?t.$y.Accepted:e===t.j5.Block?t.$y.Blocked:e===t.j5.Unblock&&n?t.$y.Accepted:t.$y.AcceptPending,p=e=>!!e?.startsWith(t.gN.PhonelinkSmsPrefix),k=(e,n)=>g(e.id,n)&&A(e,n),g=(e,n)=>{if(!I(e))return!1;const{overrideThreadTypeForPrivateFeeds:i}=n.get(a.w.Sync);return(!(0,d.JO)(e)||!i)&&!p(e)},N=(e,n,i)=>{if(!e)return"";if((0,d.zh)(e,!0)){i.errorToTelemetry?.(`Reply chain ID found in conversation ID: ${e}. CallerInfo: ${n}`,"cdl_conversations_fetch",{reason:n,conversationId:e},!0);const{isValid:a,conversationId:t}=(0,d.my)(e);if(a)return t}return e},v=/^\d+[:]{1}.+/,I=e=>!(0,l.isUndefined)(e)&&e!==t.bY&&!p(e)&&!e.includes(t.pK)&&!e.includes(t.LH)&&v.test(e),S=e=>e.startsWith(t.zD)?"MRI conv id":e,A=(e,n)=>!(T(e)&&!function(e){const{msgEnableSfbCloudFromBVD:n}=e.get(a.w.Messaging),{isSfbCloud:i,isSipEnabled:t,isSfbCloudInBVD:r,isSipEnabledInBVD:l}=e.get(a.w.UserResources);return!!(n?l&&r:t&&i)}(n));function T(e){return((0,l.isString)(e)?e:e.id).endsWith(t.lo)}const f=e=>!!e&&T(e),M=e=>{const n=e.memberProperties?.[t.UO.RelationshipState];return!!n?.edRedemptionRequired},h=e=>{const n=e.memberProperties?.[t.UO.RelationshipState];return!!n?.blockTime};const y=e=>!!e.memberProperties?.[t.UO.IsModerator],F=e=>e.threadProperties&&!!e.threadProperties[t.iy.ParentSpaces],b=e=>e.threadProperties&&e.threadProperties[t.iy.ThreadType]===r.b.Team&&F(e),C=e=>{if(e.threadProperties&&e.threadProperties?.[t.iy.ParentSpaces])try{const n=JSON.parse(e.threadProperties?.[t.iy.ParentSpaces]);return n&&n.linkedSpaceInfoItems&&n.linkedSpaceInfoItems[0]&&n.linkedSpaceInfoItems[0].spaceThreadId&&n.linkedSpaceInfoItems[0].spaceThreadId.length>0}catch(e){return!1}return!1},D=e=>{if(e.threadProperties)try{const n=e.threadProperties.meeting,i=n?JSON.parse(n):void 0;return i?i.meetingType:void 0}catch{return}},U=(e,n,i)=>{if(n){const{enableStreamChatFeature:e,forceCommentStreamForConversations:t}=n.get(a.w.Calling);if(!e)return!1;if(i&&(t??[]).includes(i))return!0}if(e&&void 0!==e.isLiveChatEnabled)return function(e){switch(typeof e){case"boolean":return e;case"number":return 1===e;case"string":const n=e.toLowerCase();return"true"===n||"on"===n||"1"===n}return!1}(e.isLiveChatEnabled)},E=e=>w(e.type),w=e=>!!e&&e.toLowerCase&&e.toLowerCase()===t.Cr.Meeting.toLowerCase(),L=e=>{let n;if(E(e)&&e.threadProperties.meeting)try{const i=JSON.parse(e.threadProperties.meeting);i.subject&&(n=i.subject)}catch{return n}return n},x=e=>e===t.Go.Text||e===t.Go.RichText||e===t.Go.HTML,O=e=>!!e.members?.some((e=>(0,d.W4)(e.id))),P=e=>e.id===o.lD.CallLogConversationId||e.id===o.lD.SharedCallLogConversationId||(0,d._5)(e?.threadProperties?.threadType),V=e=>{if(e===t.uN)return!1;const n=1209600*s.om*.5;if(!e||isNaN(e))return!0;return e-Date.now()<n},j=e=>e?.threadProperties&&(e?.threadProperties[t.iy.ThreadType]===r.b.Community||e?.threadProperties[t.iy.SpaceType]===t.iy.SpaceType_Community),B=e=>e?.threadProperties&&e?.threadProperties[t.iy.ThreadType]===r.b.SubCommunity,z=e=>e.threadProperties&&e.threadProperties[t.iy.SubstrateGroupId]||"",R=e=>{const n=e.threadProperties?.[t.iy.ThreadSubType]?.toLowerCase();return n||m.jZ.Unknown},Q=e=>{const n=e.threadProperties&&e.threadProperties[t.iy.ThreadType];return W(n)},W=e=>{if(e)return"space"===e||"topic"===e?"Channel":"meeting"===e?"Meeting":"None"}},260465:(e,n,i)=>{"use strict";i.d(n,{UZ:()=>p,kp:()=>k,xL:()=>g,CT:()=>N,oy:()=>v,bI:()=>I,I_:()=>S,bJ:()=>A,kW:()=>T,lz:()=>f,GK:()=>M,Yt:()=>h,FA:()=>y,PP:()=>b,j8:()=>C,E0:()=>D,IJ:()=>U,bl:()=>E,yT:()=>w,Rt:()=>L,BA:()=>O,s8:()=>P,nX:()=>V,Z9:()=>j,r0:()=>B,pB:()=>z,lE:()=>R,as:()=>Q,_Y:()=>W,IV:()=>Y,Mn:()=>G,Zl:()=>Z,xt:()=>_,SG:()=>H,Zp:()=>J,mT:()=>q,Vj:()=>X,HV:()=>K,yW:()=>$,CF:()=>ee,ZV:()=>ne,vz:()=>ie,B6:()=>ae,oh:()=>te,LK:()=>re,Y5:()=>le,Gw:()=>oe,mz:()=>de,aJ:()=>se,iF:()=>me,h1:()=>ce,NX:()=>ue,K$:()=>pe,CN:()=>ke,LN:()=>ge,qL:()=>ve,je:()=>Ie,mv:()=>Se,sx:()=>Ae,Cy:()=>Te,$i:()=>ye,kE:()=>Fe,d2:()=>be,__:()=>Ce,CE:()=>De,Yp:()=>Ue,XS:()=>Ee,Ce:()=>we,rD:()=>Le,xl:()=>xe,L5:()=>Oe,Xv:()=>Pe,UC:()=>Ve,Dt:()=>je,kA:()=>Be,V8:()=>ze,$T:()=>Re,W:()=>Qe,Ps:()=>We,Vb:()=>Ye,Gy:()=>Ge,ZT:()=>Ze,WH:()=>_e,rq:()=>He,OW:()=>Je,EO:()=>Ke,F$:()=>$e,T4:()=>en,MO:()=>nn,Nb:()=>an,OK:()=>tn,n_:()=>rn,$x:()=>ln,ze:()=>on,bX:()=>dn,nG:()=>sn,OA:()=>mn,AJ:()=>cn,ME:()=>un,mb:()=>pn,f9:()=>kn,S9:()=>gn,QP:()=>Nn,Bt:()=>vn,mp:()=>In});var a=i(821296),t=i(364819),r=i(332752),l=i(194649),o=i(46377),d=i(886185),s=i(75914),m=i(509648),c=i(875880),u=i(226883);var p;!function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO"}(p||(p={}));const k=e=>{const n=y(e);return(0,m.FF)(e)?n:n||(0,m.t0)(e)},g=e=>e.threadProperties?.[o.iy.Creator]||null,N=e=>e.threadProperties&&e.threadProperties[o.iy.CreatedAt]?e.threadProperties[o.iy.CreatedAt]:null,v=e=>{if(!e)throw new Error("Invalid conversation passed to isDeleted()");if(!e.threadProperties)return!1;const n=e.threadProperties.isDeleted||e.threadProperties[o.iy.IsDeleted];return!!n&&("boolean"==typeof n?n:"function"==typeof n.toLowerCase&&"true"===n.toLowerCase())},I=e=>{if(!e)throw new Error("Invalid conversation passed to isConversationDeleted()");if(!e.properties)return!1;const n=e.properties.isDeleted||e.properties[o.H0.isDeleted];return!!n&&("boolean"==typeof n?n:"function"==typeof n.toLowerCase&&"true"===n.toLowerCase())},S=(e,n)=>{if(!e)throw new Error("Invalid conversation passed to shouldConversationDeletedByDeleteChat()");const i=ie(e,n);return 0!==i&&(!(0,t.isNil)(e.lastMessageTimeUtc)&&i>=e.lastMessageTimeUtc)},A=e=>!(!e.properties||!e.properties[o.H0.Followed])&&"true"===e.properties[o.H0.Followed]?.toLowerCase(),T=e=>!(!e.properties||!e.properties[o.H0.Collapsed])&&"true"===e.properties[o.H0.Collapsed]?.toLowerCase(),f=e=>-1===e.detailsVersion?-1===e.threadVersion:0===e.threadVersion,M=e=>f(e)||!oe(e);function h(e){return e.includes(o.pK)||e.includes(o.LH)||e===o.bY}const y=e=>(0,l.ye)(e.id,e?.threadProperties?.threadType)&&h(e.id),F="lwgChannelLie-",b=e=>`${F}${e}`,C=e=>e.startsWith(F),D=e=>Y(e)&&e.properties&&!!e.properties.isLie,U=e=>e.threadProperties&&(e.threadProperties[o.iy.ThreadType]===d.b.Team||e.threadProperties[o.iy.ThreadType]===d.b.Community)&&!(0,m.GW)(e),E=e=>!(e.threadProperties[o.iy.ParentSpaces]||!e.threadProperties[o.iy.SubstrateGroupId]||!e.threadProperties[o.iy.GroupId]||e.threadProperties[o.iy.ThreadSubType]),w=e=>U(e)&&!E(e),L=e=>J(e)?We(e)||"":ue(e)||"";function x(e){return!!e.threadProperties&&e.threadProperties[o.iy.ThreadType]===d.b.Team}const O=e=>{if(e.properties){if(e.properties[o.H0.Favorite])return"true"===e.properties[o.H0.Favorite]?.toLowerCase();if(x(e))return!0}return!1},P=e=>!e.properties||void 0===e.properties[o.H0.GeneralChannelFavorite]||null===e.properties[o.H0.GeneralChannelFavorite]||"true"===e.properties[o.H0.GeneralChannelFavorite]?.toLowerCase(),V=e=>{const n=U(e);return n&&P(e)||!n&&O(e)},j=(e,n=!1)=>B(e.type,n),B=(e,n=!1)=>!(0,t.isNil)(e)&&(e.toLowerCase()===o.Cr.Chat.toLowerCase()||e.toLowerCase()===o.Cr.PhoneChat.toLowerCase()||e.toLowerCase()===o.Cr.Phonelink1on1Chat.toLowerCase()||e.toLowerCase()===o.Cr.PhonelinkGroupChat.toLowerCase()||e.toLowerCase()===o.Cr.OneOnOne.toLowerCase()||e.toLowerCase()===o.Cr.StreamOfNotes.toLowerCase()||!n&&(0,m.j7)(e)),z=e=>e.type===o.Cr.RCC,R=e=>e.id===a.lD.NotificationConversationId||(0,l.p3)(e?.threadProperties?.threadType),Q=e=>e===a.lD.AnnotationsConversationId,W=e=>e.id===a.lD.DraftsConversationId,Y=e=>G(e.type),G=e=>e===o.Cr.Team||e===o.Cr.Topic,Z=e=>de(e)===s.Cu.Shared,_=e=>de(e)===s.Cu.Standard,H=e=>[o.SG,o.Vn].includes(e.id),J=e=>(0,m.n2)(e)&&(0,m.BV)(e)&&de(e)===s.Cu.Private,q=e=>U(e)&&!!e.memberProperties&&!!e.memberProperties[o.UO.ChannelOnlyMember],X=e=>{if(!(0,m.CR)(e))return!1;const n=(0,m.CA)(e);return!!n&&n===o.Wf.MeetNow},K=e=>{if(!(0,m.CR)(e))return!1;const n=(0,m.CA)(e);return!!n&&n===o.Wf.Scheduled},$=(e,n)=>e.from.substring(e.from.indexOf("/")+1)===(-1===n.indexOf(o.kv)?o.kv+n:n),ee=(e,n)=>{if(!e.threadProperties)return 0;const{enableRetentionHorizonBasedPruning:i}=n.get(r.w.Sync),a=i||Z(e)?e.threadProperties.retentionHorizonV2:0;return a&&isFinite(Number(a))?Number(a):0},ne=(e,n)=>e?.members?.find((e=>e.id===n))?.shareHistoryTime??0,ie=(e,n)=>{if(!e.properties)return 0;if(I(e))return e.lastMessageTimeUtc?e.lastMessageTimeUtc+1:864e13;const i=(!n||!!n.get(r.w.Messaging).enableDeleteChat)&&j(e)?e.properties.clearHistoryTime:0;return i&&isFinite(Number(i))?Number(i):0},ae=e=>!!e.mruEvictedTime&&e.mruEvictedTime>0,te=(e,n,i)=>{const a=ee(n,i);return!isNaN(Number(e))&&!isNaN(a)&&Number(e)<a},re=(e,n,i)=>{const a=ie(n,i),t=Number(e);return!isNaN(t)&&!isNaN(a)&&t<a},le=(e,n,i=!1)=>{if((0,l.ye)(e.id,e?.threadProperties?.threadType)&&!f(e)){if(e.memberProperties&&!(0,t.isEmpty)(e.memberProperties)&&i)return e.memberProperties[o.UO.ExpirationTime];if(e.members&&n){const i=(0,t.find)(e.members,(e=>e&&e.id===n));return i&&i.memberExpirationTime}return e.memberProperties&&e.memberProperties[o.UO.ExpirationTime]}},oe=(e,n)=>!(0,l.ye)(e.id,e?.threadProperties?.threadType)||!f(e)&&!v(e)&&((0,t.isArray)(e.members)&&n?(0,t.some)(e.members,(e=>e&&e.id===n)):!(e.threadProperties&&Y(e)&&!e.threadProperties[o.iy.LastLeaveAt]&&!e.threadProperties[o.iy.LastJoinAt])&&!(e.threadProperties&&e.threadProperties[o.iy.LastLeaveAt]&&(!e.threadProperties[o.iy.LastJoinAt]||e.threadProperties[o.iy.LastJoinAt]<e.threadProperties[o.iy.LastLeaveAt])));function de(e){if(!e||!Y(e))return;const n=e.threadProperties[o.iy.SpaceTypes],i=n?parseInt(n,10):0,a=!!e.threadProperties[o.iy.SubstrateGroupId],t=(0,m.FV)(e);return E(e)?s.Cu.Standalone:a?t===s.jZ.PrivateChannel?s.Cu.Private:s.Cu.Shared:(i&s.QU.Private)===s.QU.Private?s.Cu.Private:s.Cu.Standard}const se=(e,n)=>{if(!!e.threadProperties.isLastMessageFromMe)return!0;const i=e.lastMessage?.from;if(!i)return!1;return n===(0,t.last)(i.split("/"))},me=(e,n)=>(0,t.reduce)(e.members,((e,i)=>{const a=i.id;return a&&a!==n&&e.push(a),e}),[]),ce=(e,n,i)=>{let a;const r=!e.members||!!e.members&&(0,t.some)(e.members,(e=>!e));if(i&&!r){const t=me(e,n);a=y(e)&&1===t.length?i[t[0]]:i[e.id]}return a},ue=e=>{if(!e)throw new Error("Invalid conversation passed to topicName");if(e.threadProperties){if(j(e)){let n=e.threadProperties.topic;if(n&&-1!==n.indexOf(":")&&(n=void 0),!n&&(0,m.CR)(e)){const i=(0,m.kO)(e);i&&(n=i)}return n}if(x(e)&&ye(e)){const n=We(e);if(n&&n.trim())return n}else{const n=e.threadProperties.topic,i=e.threadProperties[o.iy.TopicThreadTopic];if(i&&i.trim())return i;if(n&&n.trim())return n}}return""},pe=(e,n=!1)=>j(e,!0)&&!Oe(e.id)&&!ke(e,n),ke=(e,n=!1)=>{const i=e.members&&e.members.length<=2;return j(e,!0)&&i&&(Te(e)||y(e)||he(e)||!n&&Me(e)||Ne(e))&&!e.members?.some((e=>(0,l.mD)(e.id)))},ge=e=>ke(e)&&e.members?.some((({id:e})=>(0,l.Iz)(e))),Ne=e=>e.members&&e.members.length<=2&&fe(e)&&(e.type===o.Cr.PhoneChat||e.threadProperties&&e.threadProperties[o.iy.ThreadType]===d.b.PhoneChat),ve=e=>(0,m.oI)(e),Ie=e=>ve(e.id),Se=e=>!!e&&((0,l.Ku)(e)||(0,l.gZ)(e)||(0,l.aL)(e)||(0,l.vd)(e)),Ae=e=>e.type===o.Cr.PhonelinkGroupChat,Te=e=>e.type===o.Cr.Phonelink1on1Chat,fe=e=>(0,t.some)(e.members,(e=>!!e.id&&e.id.startsWith(o.gN.Pstn))),Me=e=>j(e,!0)&&e.members&&2===e.members.length&&!(0,t.isNil)(e.threadProperties)&&parseInt(e.threadProperties[o.iy.CreatedAt],10)<o.If,he=e=>!!e.id&&e.id.indexOf(o.W0)>-1||(0,l.CM)(e.threadProperties),ye=e=>e.threadProperties&&e.threadProperties[o.iy.ThreadType]===d.b.Topic||J(e)||Z(e)||(0,m.SL)(e)||D(e),Fe=e=>(0,m.t0)(e),be=e=>xe(e&&e.id),Ce=e=>Fe(e)||(e=>Ue(e))(e)||be(e),De=e=>Ue(e)||(0,m.t0)(e),Ue=e=>{const n=(0,t.isString)(e)?e:e.id;return(0,t.endsWith)(n,o.L)||(0,t.endsWith)(n,o.s8)||(0,t.startsWith)(n,o.iB)},Ee=e=>Ue(e)||Je(e),we=e=>Ue(e)||qe(e),Le=(e,n)=>Ke(e)!==n,xe=e=>!!e&&((0,t.endsWith)(e,o.wx)||(0,t.startsWith)(e,o.Rq)),Oe=e=>e===o.cB,Pe=e=>!(e.id!==o.cB||e.lastMessage||e.threadProperties.retentionHorizonV2&&0!==e.threadProperties.retentionHorizonV2),Ve=e=>{const n=(0,t.endsWith)(e,o.L)||(0,t.endsWith)(e,o.s8)||(0,t.startsWith)(e,o.iB),i=e.endsWith(o.lo),a=xe(e);return n||i||a},je=e=>{const n=le(e),i=n&&n<Date.now();return oe(e)&&!i},Be=e=>{if(e.threadProperties&&e.threadProperties[o.iy.Topics]){const n=e.threadProperties[o.iy.Topics];if("["!==n.substr(0,1))return n.split("|").map((e=>({id:e,name:"Unknown"})));try{return JSON.parse(n)}catch{return[]}}return[]},ze=(e,n)=>{const i=Be(e);for(const e of i)if(e.id===n)return e.isShared??!1;return!1},Re=(e,n)=>{const i=Be(e);for(const e of i)if(e.id===n)return e.archivalLevel?.trim().toLowerCase()},Qe=e=>!!e?.some((e=>(0,l.Iz)(e))),We=e=>{if(e.threadProperties){if(e.threadProperties[o.iy.XTeamName])return e.threadProperties[o.iy.XTeamName];if(e.type===o.Cr.Team&&e.threadProperties.topic)return e.threadProperties.topic}},Ye=e=>{const n=Be(e),i=We(e);return n.map((n=>{const a={},t=n.name;return a[o.iy.CreatedAt]=parseInt(n.createdat,10),a[o.iy.Picture]=n.picture,a[o.iy.IsDeleted]=n.isdeleted,a[o.iy.XTeamName]=n.isShared?t:i,a.topic=t,a[o.iy.TopicThreadTopic]=t,{threadProperties:a,id:n.id,members:[],messages:"",properties:{},version:0,type:o.Cr.Topic,threadVersion:0,detailsVersion:-1,oldConsumptionHorizonKeys:[],teamId:e.id,lastMessageTimeUtc:0,isPending:void 0,memberProperties:{},mruEvictedTime:0,rosterVersion:0,rosterSummary:void 0,botMembers:[],lastSeenSkipRosterState:void 0,lastMessage:void 0,localClientId:"",isUserMember:!1,source:e.source}}))},Ge=e=>{if(e.parentId)return e.parentId;if((0,m.GW)(e))try{const n=JSON.parse(e.threadProperties[o.iy.ParentSpaces]),i=n.linkedSpaceInfoItems[0].spaceThreadId;if(!(0,t.isEmpty)(i))return i}catch{return}},Ze=e=>{const n=e.threadProperties&&e.threadProperties[o.iy.SpaceId];return(U(e)?e.id:(0,m.GW)(e)?Ge(e):n)||e.teamId},_e=e=>{const n=e?e.trim().toLowerCase():void 0;return"true"!==n&&("false"===n||void 0)},He=e=>e.threadProperties&&((0,t.isBoolean)(e.threadProperties[o.iy.GapDetectionEnabled])?e.threadProperties[o.iy.GapDetectionEnabled]:"true"===(0,t.lowerCase)(e.threadProperties[o.iy.GapDetectionEnabled])),Je=e=>!!ke(e)&&qe(e),qe=e=>{const n=Ke(e);return n&&!Ue(e)&&(0,t.some)(e.members,(e=>e.tenantId&&e.tenantId!==n))||Xe(e.id)||Xe(e.localClientId||"")},Xe=e=>(0,t.startsWith)(e,o.hd),Ke=e=>e.threadProperties&&e.threadProperties[o.iy.TenantId],$e=e=>{const n=e.threadProperties[o.iy.ArchivalLevel],i=U(e)&&!!n&&n.toLowerCase()===o.L6.Space.toLowerCase(),a=Y(e)&&!!n&&(n.toLowerCase()===o.L6.Topic.toLowerCase()||n.toLowerCase()===o.L6.Space.toLowerCase());return i||a},en=e=>{if(!e||!e.properties)return!1;const n=e.properties[o.H0.isPinned];return!!n&&("boolean"==typeof n?n:"string"==typeof n&&"true"===n.toLowerCase())},nn=e=>{const n=e.memberProperties?.[o.UO.RelationshipState];return!!n?.inQuarantine},an=e=>{const n=e.memberProperties?.[o.UO.RelationshipState];return"number"==typeof n?.quarantineCounter?n?.quarantineCounter:0},tn=e=>!!e.memberProperties?.[o.UO.ExplicitlyAdded],rn=e=>e?.properties?.suppressLastMessageUpdate===o.XR.Sender,ln=e=>ke(e)&&!e.usersProps?.hasFederatedUser&&(0,t.every)(e.members,(e=>e.id?.startsWith(o.kv)))||!1,on=e=>!(!U(e)||parseInt(e.threadProperties?.[o.iy.SpaceTypes],10)!==s.QU.TenantWide),dn=(e,n)=>!!(n&&""!==n&&e.threadProperties&&e.threadProperties[o.iy.TenantId]&&e.threadProperties[o.iy.TenantId]!==n),sn=(e,n)=>!(!U(e)||dn(e,n)||on(e)||v(e)||!oe(e)||q(e)),mn=e=>{if(e?.meetingInfo)try{const n=["Accepted","Declined","Follow","Tentative","None"],i=JSON.parse(e.meetingInfo)?.rsvpStatus;return i&&n.includes(i)?i:"None"}catch(e){return"None"}return"None"},cn=(e,n,i,a)=>{if(a&&i?.get(r.w.Chat).enableRSVPBasedMeetingChatNotifications&&a===e.threadProperties[o.iy.Creator])return!1;const{meetingChatNotification:t=c.AP.MeetingsUserParticipatesIn,meetingChatNotificationForAcceptedMeetings:l=c.AP.MeetingsUserIsInvitedTo,meetingChatNotificationForTentativeMeetings:d=c.AP.MeetingsUserParticipatesIn}={...n},s=c.AP.MeetingsUserIsInvitedTo,m=t!==s;if(!i?.get(r.w.Chat).enableRSVPBasedMeetingChatNotifications)return m||!1;const u=l!==s,p=d!==s;try{const n=e?.properties;switch(mn(n)){case"Declined":case"Follow":return!0;case"Accepted":return u||!1;default:return p||!1}}catch(e){return p||!1}},un=(e,n,i,a)=>{const t=_e(e?.properties?.alerts);return void 0!==t?t:!!(0,l.Qi)(e.id)&&cn(e,n,i,a)};function pn(e){if(!Y(e)||w(e)||J(e))return!1;const n=le(e);return n!==o.uN&&(!n||n<Date.now())}const kn=e=>gn(e)&&Z(e),gn=e=>Y(e)&&!v(e)&&!$e(e)&&V(e)&&oe(e),Nn=(e,n)=>{const i=e.threadProperties[o.iy.CreatedAt]||"0";return Sn(i)<n},vn=(e,n)=>e.threadProperties[o.iy.Creator]===n,In=e=>U(e)&&"General"!==e.threadProperties[o.iy.TopicThreadTopic],Sn=e=>(0,u.Ql)(parseInt(e,10),Date.now(),"seconds")},676915:(e,n,i)=>{"use strict";i.d(n,{h:()=>t});var a=i(46377);const t=(e,n,i)=>{if(n===a.Go.HTML){if(r(e,i))return a.Go.Collaborate;if(l(e,i))return a.Go.Embed}return n},r=(e,n)=>{const i=o(e,n);if(!i)return!1;const a=i.find((e=>"application/vnd.microsoft.card.fluid"===e.contentType));return!!a&&!!a.content.componentUrl},l=(e,n)=>{const i=o(e,n);if(!i)return!1;const a=i.find((e=>"application/vnd.microsoft.card.fluidEmbedCard"===e.contentType));return!!a&&!!a.content.componentUrl},o=(e,n)=>{if(n?.cards)try{return JSON.parse(n.cards)}catch(n){e.newLogger("Conversation Last Message Processing","services-io-chat").log("UnhandledException in toCards.")}return null}},875880:(e,n,i)=>{"use strict";i.d(n,{AP:()=>a,nM:()=>t,$Q:()=>r,KO:()=>l,I_:()=>o,vn:()=>d});const a={MeetingsUserIsInvitedTo:"MeetingsUserIsInvitedTo",MeetingsUserParticipatesIn:"MeetingsUserParticipatesIn",MeetingsManuallyUnmuted:"MeetingsManuallyUnmuted"},t={VOICE_CALL:"VOICE_CALL",VIDEO_CALL:"VIDEO_CALL"},r={aggregatedLikeInChatAndChannel:"AggregatedLikeInChatAndChannel",aggregatedMentionsInTeamAndChannel:"AggregatedMentionsInTeamAndChannel",aggregatedPersonalMention:"AggregatedPersonalMention",aggregatedReplyAndReplyToReply:"AggregatedReplyAndReplyToReply",alertSound:"alertSound",alertSoundType:"alertSoundType",alertUrgentSoundType:"alertUrgentSoundType",allowUrgentNotifications:"allowUrgentNotifications",appNotificationEnabled:"appNotificationEnabled",callTransferFailed:"CallTransferFailed",chat:"Chat",dLPNotifySender:"DLP_NotifySender",downloaded:"Download_Downloaded",downloadFailed:"Download_DownloadFailed",downloadStarted:"Download_DownloadStarted",emailDigestDelay:"EmailDigestDelay",emailNotificationDelay:"EmailNotificationDelay",error:"Error",followChannelNewMessage:"Follow_ChannelNewMessage",followChannelReplyMessage:" Follow_ChannelReplyMessage",globalMention:"Global_Mention",globalSoundAndPreview:"GlobalSoundAndPreview",hideNotificationDuringCallsAndMeetings:"HideNotificationDuringCallsAndMeetings",huddleStartedNotification:"HuddleStartedNotification",incomingCallsAndMeetingStartSound:"IncomingCallsAndMeetingStartSound",inferred:"Inferred",like:"Like",likeInChat:"LikeInChat_v2",meetingChatNotification:"MeetingChatNotification",meetingChatNotificationForAcceptedMeetings:"MeetingChatNotification_AcceptedMeeting",meetingChatNotificationForTentativeMeetings:"MeetingChatNotification_TentativeMeeting",meetingWentLiveNotification:"MeetingWentLiveNotification",mentionChannel:"Mention_Channel",mentionInChat_Everyone:"MentionInChat_Everyone",mentionInChat_Nearby:"MentionInChat_Nearby",mentionInChat_Person:"MentionInChat_Person_v2",mentionPerson:"Mention_Person",mentionTag:"Mention_Tag",mentionTeam:"Mention_Team",messageSendFailed:"MessageSendFailed",msGraphChannelMeetingCanceled:"channelMeetingCanceled",msGraphChannelMeetingCreated:"channelMeetingCreated",msGraphChannelMeetingForwarded:"channelMeetingForwarded",msGraphChannelMeetingForwardedWithoutOrganizer:"channelMeetingForwardedWithoutOrganizer",msGraphChannelMeetingUpdated:"channelMeetingUpdated",msGraphDelegateMeetingCanceled:"delegateMeetingCanceled",msGraphDelegateMeetingCreated:"delegateMeetingCreated",msGraphDelegateMeetingUpdated:"delegateMeetingUpdated",msGraphMeetingOrganisedByMe:"privateMeetingForwardedNotification",msGraphMeetingSentToMe:"privateMeetingCreated",msGraphPrivateMeetingCanceled:"privateMeetingCanceled",msGraphPrivateMeetingForwarded:"privateMeetingForwarded",msGraphPrivateMeetingForwardedNotificationWithAttendee:"privateMeetingForwardedNotificationWithAttendee",msGraphPrivateMeetingForwardedNotificationWithAttendeeAndTotal:"privateMeetingForwardedNotificationWithAttendeeAndTotal",msGraphPrivateMeetingForwardedNotificationWithTwoAttendee:"privateMeetingForwardedNotificationWithTwoAttendee",msGraphPrivateMeetingUpdated:"privateMeetingUpdated",muteGenericNotifications:"muteGenericNotifications",notificationStyleList:"NotificationStyleList",playNotificationSoundsForUrgentAndPriority:"PlayNotificationSoundsForUrgentAndPriority",playNotificationSoundsWhenBusyOrInMeetings:"PlayNotificationSoundsWhenBusyOrInMeetings",presenceStatus:"PresenceStatus",priority:"Priority",projectBoardAssignments:"ProjectBoardAssignments",reply:"Reply",replyToPolls:"ReplyToPolls",replyToReply:"ReplyToReply",resetTeamsAndChannelsSettings:"Reset_Teams_And_Channels_Settings",respectOsDnDForCustomToasts:"RespectOsDnDForCustomToasts",selectedPreset:"selectedPreset",showNotificationDuringCallsAndMeetings:"ShowNotificationDuringCallsAndMeetings",showPreviewInToasts:"ShowPreviewInToasts",showUnreadChatsRemindersInToasts:"showUnreadChatsRemindersInToasts",staffHub:"StaffHub",teamMembershipChangeAddedToSharedChannel:"TeamMembershipChange_AddedToSharedChannel",teamMembershipChangeAddedToTeam:"TeamMembershipChange_AddedToTeam",teamMembershipChangePendingOnBehalfOfJoinRequest:"TeamMembershipChange_PendingOnBehalfOfJoinRequest",teamMembershipChangePendingOnBehalfOfJoinRequestMultiple:"TeamMembershipChange_PendingOnBehalfOfJoinRequestMultiple",teamMembershipChangePendingSelfJoinRequest:"TeamMembershipChange_PendingSelfJoinRequest",teamMembershipChangePromotedToSharedChannelOwner:"TeamMembershipChange_PromotedToSharedChannelOwner",teamMembershipChangePromotedToTeamAdmin:"TeamMembershipChange_PromotedToTeamAdmin",teamMembershipChannelOwnerUnshareTeamOwnerNotify:"TeamMembershipChange_ChannelOwnerUnshareTeamOwnerNotify",teamMembershipTeamOwnerUnshareChannelOwnerNotify:"TeamMembershipChange_TeamOwnerUnshareChannelOwnerNotify",teamMembershipTeamShareTeamOwnerNotify:"TeamMembershipChange_TeamShareTeamOwnerNotify",teamsTasks:"TeamsTasks",thirdParty_Bot:"ThirdParty_Bot",trending:"Trending",useTeamsChimeForToasts:"useTeamsChimeForToasts",visibleChannelMention_v2:"Visible_ChannelMention_v2",visibleChannelNewMessage_v2:"Visible_ChannelNewMessage_v2",visibleChannelReplyMessage_v2:"Visible_ChannelReplyMessage_v2"};var l,o;!function(e){e[e.AllActivity=1]="AllActivity",e[e.MyAtMentions=2]="MyAtMentions",e[e.Custom=3]="Custom"}(l||(l={})),function(e){e.MainPage="notification_settings_text",e.GraphPage="notification_settings_graph_apps_subheader_text",e.ChatPage="notification_settings_details_chat_subheader_text",e.MeetingsPage="notification_settings_details_only_meetings_subheader_text",e.TeamsChannelCustomisedPage="notification_settings_details_teams_channel_button_custom_label",e.CallGroupPage="group_call_forwarding_notification_setting"}(o||(o={}));const d="ef56c0de-36fc-4ef8-b417-3d82ba9d073c"},248203:(e,n,i)=>{"use strict";var a,t,r;i.d(n,{d1:()=>a,gI:()=>t,f_:()=>r,Kq:()=>l,wf:()=>o,Hh:()=>d,ui:()=>s}),function(e){e.addToCall="addToCall",e.addToChat="addToChat",e.addToMeeting="addToMeeting",e.addToMeetingForSharedChannel="addToMeetingForSharedChannel",e.addToSpeedDialOrContacts="addToSpeedDialOrContacts",e.addContacts="addContacts",e.addToTeam="addToTeam",e.atMention="atMention",e.callForwardGroupSelection="callForwardGroupSelection",e.calendarPeoplePicker="calendarPeoplePicker",e.callRouting="callToRouting",e.delegationSelection="delegationSelection",e.meetingSchedule="meetingSchedule",e.newChat="newChat",e.orgChart="orgChart",e.presenceSettings="presenceSettings",e.priorityContactsSelection="priorityContactsSelection",e.searchResults="searchResults",e.searchPeopleFilter="searchPeopleFilter",e.searchSuggestions="searchSuggestions",e.shareToTeams="shareToTeams",e.shareContact="shareContact",e.taggedContactsSelection="taggedContactSelection",e.transfer="transfer",e.escalateMessage="escalateMessage",e.addToSharedChannel="addToSharedChannel",e.followPresence="followPresence",e.statusNote="statusNote",e.meetingRoomCall="meetingRoomCall",e.voicemailTransferTarget="voicemailTransferTarget",e.exceptionHandlingPerson="exceptionHandlingPerson",e.exceptionHandlingVoiceapp="exceptionHandlingVoiceapp",e.externalSuggestedContacts="externalSuggestedContacts",e.forwardMessage="forwardMessage",e.virtualEvent="virtualEvent",e.flyout="flyout",e.fluidAtMention="fluidAtMention",e.signersList="signersList",e.addToCommunities="addToCommunities",e.copyTags="copyTags",e.groupTemplate="groupTemplate",e.adaptiveCard="adaptiveCard",e.selectPeopleFilter="selectPeopleFilter",e.addToMeetingRegularChannel="addToMeetingRegularChannel",e.tflDefault="tflDefault",e.tflZeroStateFallback="tflFilterFallback",e.powerbar="powerbar",e.forwardMessageSingleSelection="forwardMessageSingleSelection",e.callForwardNoUserSelection="callForwardNoUserSelection",e.pickerFilterFallback="pickerFilterFallback",e.callingDefault="callingDefault",e.powerbarSearchV2Filter="powerbarSearchV2Filter"}(a||(a={})),function(e){e.AADTenant="AADTenant",e.Bot="Bot",e.Copilots="Copilots",e.CallQandAA="CallQandAA",e.Channels="Channels",e.DisabledUser="DisabledUser",e.DL="DL",e.Federated="Federated",e.FederatedConsumer="FederatedConsumer",e.Guest="Guest",e.ModernGroup="ModernGroup",e.PersonalContact="PersonalContact",e.ExpandedPersonalContact="ExpandedPersonalContact",e.Pstn="Pstn",e.Room="Room",e.UserDefinedGroup="UserDefinedGroup",e.TeamTags="TeamTags",e.PstnNonE164="PstnNonE164",e.LetterMapNumbers="LetterMapNumbers",e.GroupChats="GroupChats",e.Meetings="Meetings",e.Xtap="Xtap",e.TflOffNetworkEmails="TflOffNetworkEmails",e.TflOffNetworkPhones="TflOffNetworkPhones",e.SkypeConsumer="SkypeConsumer",e.TflConsumer="TflConsumer",e.TflSmsName="TflSmsName",e.ImplicitContacts="ImplicitContacts",e.ImplicitContactsForSMBSuggestions="ImplicitContactsForSMBSuggestions",e.ExtendedDirectoryUsers="ExtendedDirectoryUsers",e.MTOUsers="MTOUsers",e.Tfl2WaySmsUsers="Tfl2WaySmsUsers",e.B2BMembers="B2BMembers",e.NonEmailSecurityGroupsWithDLs="NonEmailSecurityGroupsWithDLs",e.UnNamedGroupChats="UnNamedGroupChats",e.Teams="Teams"}(t||(t={})),function(e){e.AAD="AAD",e.IndexedDb="IndexedDB",e.MiddleTier="MT",e.Substrate="3S",e.TopNCache="TopNCache",e.Memory="Memory",e.TFLZeroState="TFLZeroState"}(r||(r={}));const l={IDBFedBot:"IDB-FedBot",IDBPeopleGroup:"IDB-PeopleGroup",TeamTag:"TeamTag",Memory:"Memory",MT:"MT"},o={EntityActionTaken:"EntityActionTaken",EntityClicked:"EntityClicked",MouseHover:"MouseHover"},d={OpenContactCard:"OpenContactCard",Remove:"Remove"},s={Vertical:"vertical"}},736028:(e,n,i)=>{"use strict";i.d(n,{H:()=>d,G:()=>o});var a=i(248203);const t={[a.d1.callForwardGroupSelection]:[a.gI.AADTenant,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Pstn,a.gI.CallQandAA],[a.d1.meetingRoomCall]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Bot,a.gI.DisabledUser,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.PersonalContact,a.gI.CallQandAA,a.gI.Federated,a.gI.FederatedConsumer,a.gI.ImplicitContacts,a.gI.SkypeConsumer,a.gI.TflConsumer],[a.d1.searchSuggestions]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.Room,a.gI.GroupChats,a.gI.Xtap,a.gI.Meetings,a.gI.TflSmsName,a.gI.SkypeConsumer],[a.d1.addToMeetingForSharedChannel]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.Room,a.gI.TeamTags,a.gI.GroupChats,a.gI.Xtap,a.gI.TflOffNetworkEmails,a.gI.TflOffNetworkPhones,a.gI.TflConsumer,a.gI.SkypeConsumer,a.gI.ImplicitContacts],[a.d1.calendarPeoplePicker]:[a.gI.AADTenant,a.gI.Guest,a.gI.Federated,a.gI.DisabledUser,a.gI.PersonalContact,a.gI.ModernGroup,a.gI.DL,a.gI.SkypeConsumer],[a.d1.searchResults]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.ModernGroup,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.SkypeConsumer],[a.d1.addToTeam]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.DisabledUser,a.gI.SkypeConsumer,a.gI.NonEmailSecurityGroupsWithDLs,a.gI.TeamTags],[a.d1.newChat]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.UserDefinedGroup,a.gI.TeamTags,a.gI.TflSmsName,a.gI.ExtendedDirectoryUsers,a.gI.SkypeConsumer],[a.d1.transfer]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.SkypeConsumer],[a.d1.addToCall]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Bot,a.gI.DisabledUser,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.PersonalContact,a.gI.CallQandAA,a.gI.Federated,a.gI.FederatedConsumer,a.gI.ImplicitContacts,a.gI.SkypeConsumer,a.gI.TflConsumer,a.gI.Xtap,a.gI.Room],[a.d1.addToChat]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.DisabledUser,a.gI.TeamTags,a.gI.ExtendedDirectoryUsers,a.gI.SkypeConsumer],[a.d1.searchPeopleFilter]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.Pstn,a.gI.TeamTags,a.gI.SkypeConsumer],[a.d1.callRouting]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.SkypeConsumer],[a.d1.delegationSelection]:[a.gI.AADTenant,a.gI.B2BMembers,a.gI.SkypeConsumer],[a.d1.presenceSettings]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Pstn,a.gI.SkypeConsumer],[a.d1.addToMeeting]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.SkypeConsumer],[a.d1.meetingSchedule]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.DL,a.gI.ModernGroup,a.gI.Pstn,a.gI.SkypeConsumer],[a.d1.addToSpeedDialOrContacts]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.CallQandAA,a.gI.SkypeConsumer],[a.d1.addContacts]:[a.gI.AADTenant,a.gI.Guest,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.CallQandAA,a.gI.Pstn,a.gI.SkypeConsumer],[a.d1.atMention]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Bot,a.gI.Pstn,a.gI.SkypeConsumer],[a.d1.orgChart]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Pstn,a.gI.SkypeConsumer],[a.d1.shareContact]:[a.gI.AADTenant,a.gI.SkypeConsumer],[a.d1.priorityContactsSelection]:[a.gI.AADTenant,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Pstn,a.gI.SkypeConsumer,a.gI.Guest],[a.d1.taggedContactsSelection]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.DL,a.gI.SkypeConsumer],[a.d1.shareToTeams]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.DisabledUser,a.gI.UserDefinedGroup,a.gI.SkypeConsumer],[a.d1.escalateMessage]:[a.gI.AADTenant,a.gI.SkypeConsumer],[a.d1.voicemailTransferTarget]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Bot,a.gI.DisabledUser,a.gI.ModernGroup,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.SkypeConsumer],[a.d1.addToSharedChannel]:[a.gI.AADTenant,a.gI.Xtap,a.gI.SkypeConsumer],[a.d1.externalSuggestedContacts]:[a.gI.ImplicitContactsForSMBSuggestions,a.gI.SkypeConsumer],[a.d1.exceptionHandlingPerson]:[a.gI.AADTenant],[a.d1.exceptionHandlingVoiceapp]:[a.gI.CallQandAA],[a.d1.forwardMessage]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.UserDefinedGroup,a.gI.TeamTags,a.gI.TflSmsName,a.gI.ExtendedDirectoryUsers,a.gI.SkypeConsumer],[a.d1.statusNote]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.UserDefinedGroup,a.gI.ModernGroup,a.gI.TflSmsName,a.gI.ExtendedDirectoryUsers,a.gI.SkypeConsumer],[a.d1.virtualEvent]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Bot,a.gI.Pstn,a.gI.SkypeConsumer],[a.d1.flyout]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.DisabledUser,a.gI.TeamTags,a.gI.ExtendedDirectoryUsers,a.gI.SkypeConsumer],[a.d1.fluidAtMention]:[a.gI.AADTenant,a.gI.Room,a.gI.Guest,a.gI.B2BMembers,a.gI.Bot,a.gI.Pstn,a.gI.SkypeConsumer],[a.d1.signersList]:[a.gI.AADTenant,a.gI.Federated,a.gI.Guest,a.gI.B2BMembers],[a.d1.addToCommunities]:[a.gI.FederatedConsumer,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.PersonalContact,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.Room,a.gI.TeamTags,a.gI.GroupChats,a.gI.Xtap,a.gI.TflOffNetworkEmails,a.gI.TflOffNetworkPhones,a.gI.TflConsumer,a.gI.SkypeConsumer,a.gI.ImplicitContacts],[a.d1.groupTemplate]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.DisabledUser,a.gI.TeamTags,a.gI.ExtendedDirectoryUsers,a.gI.SkypeConsumer,a.gI.TflOffNetworkEmails,a.gI.TflOffNetworkPhones],[a.d1.adaptiveCard]:[a.gI.AADTenant],[a.d1.selectPeopleFilter]:[a.gI.AADTenant,a.gI.Guest],[a.d1.copyTags]:[a.gI.TeamTags],[a.d1.followPresence]:[a.gI.AADTenant],[a.d1.addToMeetingRegularChannel]:[a.gI.AADTenant,a.gI.Federated,a.gI.Guest,a.gI.B2BMembers,a.gI.Room],[a.d1.tflDefault]:[a.gI.AADTenant,a.gI.B2BMembers,a.gI.Guest,a.gI.Federated],[a.d1.powerbar]:[],[a.d1.forwardMessageSingleSelection]:[],[a.d1.callForwardNoUserSelection]:[],[a.d1.pickerFilterFallback]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.PersonalContact,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.Room,a.gI.TeamTags,a.gI.GroupChats,a.gI.Xtap,a.gI.TflOffNetworkEmails,a.gI.TflOffNetworkPhones,a.gI.TflConsumer,a.gI.SkypeConsumer,a.gI.ImplicitContacts],[a.d1.callingDefault]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.PersonalContact,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.Room,a.gI.TeamTags,a.gI.GroupChats,a.gI.Xtap,a.gI.TflOffNetworkEmails,a.gI.TflOffNetworkPhones,a.gI.TflConsumer,a.gI.SkypeConsumer,a.gI.ImplicitContacts],[a.d1.tflZeroStateFallback]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.PersonalContact,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.Room,a.gI.TeamTags,a.gI.GroupChats,a.gI.Xtap,a.gI.TflOffNetworkEmails,a.gI.TflOffNetworkPhones,a.gI.TflConsumer,a.gI.SkypeConsumer,a.gI.ImplicitContacts],[a.d1.powerbarSearchV2Filter]:[a.gI.AADTenant,a.gI.Guest,a.gI.B2BMembers,a.gI.Federated,a.gI.FederatedConsumer,a.gI.Bot,a.gI.DisabledUser,a.gI.DL,a.gI.ModernGroup,a.gI.PersonalContact,a.gI.UserDefinedGroup,a.gI.Pstn,a.gI.CallQandAA,a.gI.Room,a.gI.TeamTags,a.gI.GroupChats,a.gI.Xtap,a.gI.TflOffNetworkEmails,a.gI.TflOffNetworkPhones,a.gI.TflConsumer,a.gI.SkypeConsumer,a.gI.ImplicitContacts]};var r=i(364819);const l=(e,n)=>(0,r.flatten)(e.filter((([e,i])=>e===n)).map((([e,n])=>n))),o={[a.f_.Substrate]:[a.gI.AADTenant,a.gI.Guest,a.gI.GroupChats,a.gI.DL,a.gI.ModernGroup,a.gI.Room,a.gI.ExtendedDirectoryUsers,a.gI.PersonalContact,a.gI.MTOUsers,a.gI.CallQandAA],[a.f_.AAD]:[a.gI.Guest],[a.f_.IndexedDb]:[a.gI.Federated,a.gI.FederatedConsumer,a.gI.SkypeConsumer,a.gI.Bot,a.gI.Pstn],[a.f_.MiddleTier]:[],[a.f_.TopNCache]:[],[a.f_.Memory]:[],[a.f_.TFLZeroState]:[]};class d{constructor(e,n){this.includeFeatures=e,this.name=n,this.includeAADTenant=!1,this.includeGuest=!1,this.includeFederated=!1,this.includeFederatedConsumer=!1,this.includeBot=!1,this.includeDisabledUser=!1,this.includeDL=!1,this.includeModernGroup=!1,this.includePersonalContact=!1,this.includeExpandedPersonalContact=!1,this.includeUserDefinedGroup=!1,this.includePstn=!1,this.includeCallQandAA=!1,this.includeRoom=!1,this.includeTeamTags=!1,this.includeGroupChats=!1,this.includeMeetingChats=!1,this.includeXtap=!1,this.includeOffNetworkEmails=!1,this.includeOffNetworkPhones=!1,this.includeSkypeConsumer=!1,this.includeTflConsumer=!1,this.includeTflSmsName=!1,this.includeImplicitContacts=!1,this.includeImplicitContactsForSMBSuggestions=!1,this.includeExtendedDirectoryUsers=!1,this.includeMTOUsers=!1,this.includeTfl2WaySmsUsers=!1,this.includeB2BMembers=!1,this.includeNonEmailSecurityGroupsWithDLs=!1,this.includeUnNamedGroupChats=!1,this.includeChannels=!1,this.includeTeams=!1,this.includeCopilots=!1,this.includeAADTenant=(0,r.includes)(e,a.gI.AADTenant),this.includeGuest=(0,r.includes)(e,a.gI.Guest),this.includeFederated=(0,r.includes)(e,a.gI.Federated),this.includeFederatedConsumer=(0,r.includes)(e,a.gI.FederatedConsumer),this.includeBot=(0,r.includes)(e,a.gI.Bot),this.includeCopilots=(0,r.includes)(e,a.gI.Copilots),this.includeDisabledUser=(0,r.includes)(e,a.gI.DisabledUser),this.includeDL=(0,r.includes)(e,a.gI.DL),this.includeModernGroup=(0,r.includes)(e,a.gI.ModernGroup),this.includePersonalContact=(0,r.includes)(e,a.gI.PersonalContact),this.includeExpandedPersonalContact=(0,r.includes)(e,a.gI.ExpandedPersonalContact),this.includeUserDefinedGroup=(0,r.includes)(e,a.gI.UserDefinedGroup),this.includePstn=(0,r.includes)(e,a.gI.Pstn),this.includeCallQandAA=(0,r.includes)(e,a.gI.CallQandAA),this.includeRoom=(0,r.includes)(e,a.gI.Room),this.includeTeamTags=(0,r.includes)(e,a.gI.TeamTags),this.includeGroupChats=(0,r.includes)(e,a.gI.GroupChats),this.includeMeetingChats=(0,r.includes)(e,a.gI.Meetings),this.includeXtap=(0,r.includes)(e,a.gI.Xtap),this.includeOffNetworkEmails=(0,r.includes)(e,a.gI.TflOffNetworkEmails),this.includeOffNetworkPhones=(0,r.includes)(e,a.gI.TflOffNetworkPhones),this.includeSkypeConsumer=(0,r.includes)(e,a.gI.SkypeConsumer),this.includeTflConsumer=(0,r.includes)(e,a.gI.TflConsumer),this.includeTflSmsName=(0,r.includes)(e,a.gI.TflSmsName),this.includeImplicitContacts=(0,r.includes)(e,a.gI.ImplicitContacts),this.includeImplicitContactsForSMBSuggestions=(0,r.includes)(e,a.gI.ImplicitContactsForSMBSuggestions),this.includeExtendedDirectoryUsers=(0,r.includes)(e,a.gI.ExtendedDirectoryUsers),this.includeMTOUsers=(0,r.includes)(e,a.gI.MTOUsers),this.includeTfl2WaySmsUsers=(0,r.includes)(e,a.gI.Tfl2WaySmsUsers),this.includeB2BMembers=(0,r.includes)(e,a.gI.B2BMembers),this.includeNonEmailSecurityGroupsWithDLs=(0,r.includes)(e,a.gI.NonEmailSecurityGroupsWithDLs),this.includeUnNamedGroupChats=(0,r.includes)(e,a.gI.UnNamedGroupChats),this.includeChannels=(0,r.includes)(e,a.gI.Channels),this.includeTeams=(0,r.includes)(e,a.gI.Teams)}}d.fromName=(e,n=[])=>{if(!(e in t))throw new TypeError("Invalid `name` attribute passed. Please make sure it exists in PEOPLE_FILTER_NAME_CONFIG.");const i=l(n,!0),a=l(n,!1),o=r.without.apply(null,[(0,r.concat)(t[e],i),...a]);return new d(o,e)},d.createFrom=(e,n,i)=>new d(n||e.includeFeatures,i||e.name),d.includesAll=(e,n)=>(0,r.every)(n,(n=>(0,r.includes)(e.includeFeatures,n))),d.includesAny=(e,n)=>(0,r.some)(n,(n=>(0,r.includes)(e.includeFeatures,n)))},771330:(e,n,i)=>{"use strict";var a,t,r;i.d(n,{SV:()=>a,Yw:()=>t,xi:()=>r,Xz:()=>l,L:()=>o,X3:()=>d,s9:()=>s,GA:()=>m,FL:()=>c,gm:()=>u}),function(e){e.ConsumerUser="ConsumerUser",e.NotFound="NotFound",e.Success="Success"}(a||(a={})),function(e){e[e.CoreScenario=0]="CoreScenario",e[e.DialToneScenario=1]="DialToneScenario",e[e.BackgroundTask=2]="BackgroundTask"}(t||(t={})),function(e){e.XSmall="HR32x32",e.Small="HR64x64",e.Medium="HR96x96",e.XMedium="HR120x120",e.Large="HR196x196"}(r||(r={}));const l=["Large","XMedium","Medium","Small","XSmall"];var o;!function(e){e.Mobile="Mobile",e.Business="Business",e.Home="Home",e.Pager="Pager",e.Organization="Organization",e.HomeFax="HomeFax",e.BusinessFax="BusinessFax",e.Other="Other",e.Unknown="Unknown",e.Assistant="Assistant",e.OtherFax="OtherFax",e.Radio="Radio"}(o||(o={}));const d={Private:"Private",Public:"Public"};var s,m,c;!function(e){e.success="success",e.invalid="invalid",e.inTenantUser="intenantuser",e.consumerUser="consumeruser",e.notFound="notfound",e.notAllowed="notallowed",e.failed="failed",e.missingResponse="missingresponse",e.backendrequestfailed="backendrequestfailed"}(s||(s={})),function(e){e.UpdateMSASearchabilityStamping="updateMSASearchabilityStamping",e.UpdateMsaAliasVisibilitySetting="updateMsaAliasVisibilitySetting",e.GetPeopleProfilesByMris="getPeopleProfilesByMris",e.GetFederatedPeopleProfilesByMris="getFederatedPeopleProfilesByMris",e.GetPeopleProfilesByEmails="getPeopleProfilesByEmails",e.GetFederatedPeopleProfilesByEmails="getFederatedPeopleProfilesByEmails",e.GetMeProfile="getMeProfile",e.GetOfficeGroup="getOfficeGroup",e.GetUser="getUser",e.FetchAllUsersByMrisInSharedChannel="people_get_all_users_sharedChannel",e.FetchAllUsersByMrisInSharedChannelBatch="people_get_users_sharedChannel_batch",e.UpdateMsaUserName="update_msa_profile_displayname",e.UpdateProfileAvatar="update_profile_avatar",e.removeSelfProfilePicture="remove_msa_profile_picture",e.UpdateGroupProfileAvatar="update_group_profile_avatar",e.DeleteGroupProfileAvatar="delete-group-profile-avatar",e.GetTflConsumerProfilesByMris="getTflConsumerProfilesByMris",e.GetSkypeConsumerProfilesByMris="getSkypeConsumerProfilesByMris",e.GetTenantPrivacyPolicyStatementUrl="getTenantPrivacyPolicyStatementUrl",e.GetProfilePicturePolicy="getProfilePicturePolicy",e.GetExternalProfilesByAliases="getExternalProfilesByAliases"}(m||(m={})),function(e){e.GET="GET",e.POST="POST",e.PATCH="PATCH",e.PUT="PUT",e.DELETE="DELETE"}(c||(c={}));const u=["displayName","imageUri","selfAvatarLastupdatedTime","profileType","avatarETag"]},210071:(e,n,i)=>{"use strict";i.d(n,{qQ:()=>t,Pk:()=>r,$o:()=>l,A9:()=>o,OY:()=>d,V5:()=>s,PC:()=>m,rN:()=>c});var a=i(724801);const t={saveUnknownUser:"unknown_user_profile_generated",unknownUserFromDB:"unknown_user_from_index_db"},r={botType:"BOT"},l={member:"Member",guest:"Guest",anonymousUser:"AnonymousUser",voiceApp:"ADVoiceApp",DistributionList:"Group",PublicDistributionList:"PublicDistributionList",Bot:"Bot",person:"Person",federated:"Federated",skypeConsumer:"SkypeConsumer",tflUser:"TFLUser",tflOffNetwork:"TFLOffNetwork",personalContactUser:"PersonalContactUser",tflConsumer:"TflConsumer",pstn:"pstn",extendedDirectoryUser:"EDUser",PendingOrgContact:"PendingOrgContact",OrgContact:"OrgContact",MTOUser:"MTOUser",B2BMember:"B2BMember",ADUser:"ADUser",ACSUser:"ACSUser",room:"Room"},o={inTenant:"INTENANT",federated:"FEDERATED",sharedChannel:"SHAREDCHANNEL",skypeConsumer:"SKYPECONSUMER",tflConsumer:"TFLCONSUMER",tflClient:"TFLCLIENT",notRequestedFromMT:"NOTREQUESTEDFROMMT",anonymous:"ANONYMOUS"},d={appOffline:"appOffline",noProfile:"noprofile",accountDisabled:"accountDisabled"},s={MTOUser:64,B2BMember:32},m={showWarningBannerMinimumThreshold:20,type:{team:"team",channel:"channel",person:"person",webhook:"webhook",bot:"BOT",addABot:"addABot",app:"app"},hintElement:"ts-hint"},c=[a.nW.NOT_FOUND.toString(),d.accountDisabled]},586892:(e,n,i)=>{"use strict";i.d(n,{OJ:()=>p,Oc:()=>k,iB:()=>A,mc:()=>T,et:()=>f,F:()=>M,X7:()=>h,fV:()=>y,lT:()=>b,jP:()=>C,SG:()=>D,af:()=>U});var a,t=i(771330),r=i(248203),l=i(332752),o=i(478522),d=i(210071),s=i(364819),m=i(736028),c=i(641030),u=i(97882);const p="unknown_email_address@invalid.teams.ms",k="4:",g="8:tfloffnetwork:",N=`${g}email:`,v=`${g}phone:`,I="19:",S="50:sms:",A="50:smsunverified:",T="unknown user",f="8:teamsvisitor:",M="8:guest:",h=4,y="28:orgid:",F=["live","sip_profile","myspace","c2c","sms"];var b;!function(e){e.peoplePickerMTSelection="people_picker_mt_selection",e.peoplePickerGroupConversation="people_picker_group_conversation_selection",e.peoplePickerCachedPeople="people_picker_is_cached_people_selection",e.peoplePickerTeamTags="people_picker_team_tags",e.peoplePickerScheduledTags="people_picker_scheduled_tags",e.peoplePickerSubstrateSelection="people_picker_substrate_selection",e.peoplePickerDistributionList="people_picker_distribution_list",e.peoplePickerImplicitContact="people_picker_implicit_contact",e.peoplePickerPSTNSelection="people_picker_pstn_selection",e.peoplePickerChannelConversation="people_picker_channel_conversation_selection",e.peoplePickerTeamConversation="people_picker_team_conversation_selection"}(b||(b={}));const C="TflContacts";var D;!function(e){e.NotResolved="NotResolved",e.External="External",e.User="User",e.DistributionList="DistributionList"}(D||(D={}));class U{static isUnknownUser(e){return e.email===p||"unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com"===e.email}static getUnknownUserEmail(){return p}static getRequestCount(e){return e&&e.requestCount||e.$$requestCount||0}static getUserDisplayNameWithPostfixAndSecurityLabel(e,n,i,a,t,r){const{id:d}=e;let{displayName:s}=e,m=null;const{enableExternalTagForPSTNUsers:c,enableLabelingUsersByTrustLevel:u,enableMTOLabel:p}=n.get(l.w.People),k=n.get(l.w.Metadata).environment===o.B.life;if(!s)return{displayName:null,securityLabel:m};if(e.isRenamed&&(s=this.checkAndAddEditedTag(s,i),m=this.getEditedUserTag(i)),k)this.isAnonymousUser(d)&&(s=this.checkAndAddGuestTag(s,i),m=this.getGuestUserTag(i));else{if(this.isMTOUser(e))return this.getMTOUserDisplayNamePostfixHelperAndSecurityLabel(!!p,!!r,"mtoLabel"in e?e.mtoLabel:null,s,i);if(this.isAnonymousUser(d)){const n=this.getAnonymousTfwUserDisplayNamePostfixHelperAndSecurityLabel(e,s,!!u,a,i);s=n.displayName,m=n.securityLabel}else if(this.isFederatedUser(e)||this.isExtendedDirectoryUser(e)||this.isTFLConsumerUser(e)||this.isSfcUser(e))this.isAnonymousTfwUser(a)?(s=U.checkAndAddUnverifiedTag(s,i),m=this.getUnverifiedTag(i)):(s=U.checkAndAddExternalTag(s,i),m=this.getExternalTag(i));else if(u&&("isAnonymousB2bUser"in e&&e.isAnonymousB2bUser||this.isAcsUserMri(d)))s=this.checkAndAddUnverifiedTag(s,i),m=this.getUnverifiedTag(i);else if(this.isGuestUser(e))s=this.checkAndAddGuestTag(s,i),m=this.getGuestUserTag(i);else if(u&&this.isAnonymousTfwUser(a)&&this.isConsumerUserMri(d))s=this.checkAndAddUnverifiedTag(s,i),m=this.getUnverifiedTag(i);else if(c&&this.isPSTNUser({mri:e.id})){const a=U.getPSTNUserDisplayNamePostfixHelperAndSecurityLabel(e.id,s,n,!!t,i);s=a.displayName,m=a.securityLabel}}return{displayName:s,securityLabel:m}}static getUserDisplayNameWithPostfix(e,n,i,a,t,r){return this.getUserDisplayNameWithPostfixAndSecurityLabel(e,n,i,a,t,r).displayName}static getUserSecurityLabel(e,n,i,a,t,r){const l=this.getUserDisplayNameWithPostfixAndSecurityLabel(e,n,i,a,t,r).securityLabel;if(!l)return null;const o=l.match(/\(([^)]+)\)/g);return o&&o.length?o[o.length-1].slice(1,-1):null}static checkAndAddEditedTag(e,n){const i=this.getDefaultEditedDisplayName(n),a=this.getEditedUserTag(n);let t=e;return e.includes(a)||e===i||(t+=` ${a}`),t}static checkAndAddGuestTag(e,n){const i=this.getDefaultGuestDisplayName(n),a=this.getGuestUserTag(n);let t=e;return e.includes(a)||e===i||(t+=` ${a}`),t}static checkAndAddExternalTag(e,n){const i=this.getDefaultExternalDisplayname(n),a=this.getExternalTag(n);let t=e;return e.includes(a)||e===i||(t+=` ${a}`),t}static checkAndAddUnverifiedTag(e,n){const i=this.getDefaultUnverifiedDisplayname(n),a=this.getUnverifiedTag(n);let t=e;return e.includes(a)||e===i||(t+=` ${a}`),t}static getPSTNUserDisplayNamePostfixHelperAndSecurityLabel(e,n,i,a,t){const{enableLabelingUsersByTrustLevel:r,disableUnverifiedLabelForPSTNUsers:o}=i.get(l.w.People),{emergencySmsNumbers:d,hotlineSMSNumbers:s}=i.get(l.w.Messaging);return r?o||a||this.isEmergencyOrHotlinePhoneNumber(e,d||[],s||[])?{displayName:U.checkAndAddExternalTag(n,t),securityLabel:this.getExternalTag(t)}:{displayName:U.checkAndAddUnverifiedTag(n,t),securityLabel:this.getUnverifiedTag(t)}:{displayName:U.checkAndAddExternalTag(n,t),securityLabel:this.getExternalTag(t)}}static getAnonymousTfwUserDisplayNamePostfixHelperAndSecurityLabel(e,n,i,a,t){let r;return"isCcmUser"in e&&e.isCcmUser?(n=this.checkAndAddExternalTag(n,t),r=this.getExternalTag(t)):i?(n=a!==e.id?this.checkAndAddUnverifiedTag(n,t):n,r=this.getUnverifiedTag(t)):(n=this.checkAndAddGuestTag(n,t),r=this.getGuestUserTag(t)),{displayName:n,securityLabel:r}}static getMTOUserDisplayNamePostfixHelperAndSecurityLabel(e,n,i,a,t){return e&&n&&i?{displayName:`${a} (${i})`,securityLabel:`(${i})`}:e?{displayName:a,securityLabel:null}:{displayName:U.checkAndAddExternalTag(a,t),securityLabel:this.getExternalTag(t)}}static getDefaultEditedDisplayName(e){return e.stringTranslate("calling","default_edited_displayname",{defaultValue:"Edited"})}static getEditedUserTag(e){return e.stringTranslate("calling","edited_user_postfix",{defaultValue:"(Edited)"})}static getDefaultGuestDisplayName(e){return e.stringTranslate("peoplePicker","default_guest_displayname",{defaultValue:"Guest"})}static getGuestUserTag(e){return e.stringTranslate("peoplePicker","guest_user_postfix",{defaultValue:"(Guest)"})}static getDefaultExternalDisplayname(e){return e.stringTranslate("peoplePicker","default_external_displayname",{defaultValue:"External"})}static getDefaultUnverifiedDisplayname(e){return e.stringTranslate("peoplePicker","default_unverified_displayname",{defaultValue:"Unverified"})}static getExternalTag(e){return e.stringTranslate("peoplePicker","external_user_postfix",{defaultValue:"(External)"})}static getUnverifiedTag(e){return e.stringTranslate("peoplePicker","unverified_user_postfix",{defaultValue:"(Unverified)"})}static applyFeatureFlagSettings(e,n){let i=e.includeFeatures;const a=Boolean(n.get(l.w.Messaging).enableConsumerConversations);switch(e.name){case r.d1.addToMeeting:{const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:t}=n.get(l.w.Federated);t||(i=(0,s.difference)(i,[r.gI.Federated])),e&&(i=(0,s.difference)(i,[r.gI.Bot])),i=a?(0,s.difference)(i,[r.gI.Federated]):(0,s.difference)(i,[r.gI.TflConsumer]);break}case r.d1.pickerFilterFallback:{const{enableTflTfwFederation:e,enableTfwTflFederation:t}=n.get(l.w.Host);a?e&&(i=(0,s.difference)(i,[r.gI.Federated])):t&&(i=(0,s.difference)(i,[r.gI.TflConsumer]));break}case r.d1.meetingSchedule:const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:t}=n.get(l.w.Federated);t||(i=(0,s.difference)(i,[r.gI.Federated])),e&&(i=(0,s.difference)(i,[r.gI.Bot]));break;case r.d1.addToChat:const{enableFederatedUsersInAddToChat:o}=n.get(l.w.Federated),{enableTfwFederationOnTfl:d,enableTfwTflFederation:m}=n.get(l.w.Host);a?d||(i=(0,s.difference)(i,[r.gI.Federated])):(o||(i=(0,s.difference)(i,[r.gI.Federated])),m||(i=(0,s.difference)(i,[r.gI.TflConsumer])));const{enableDLsInAddToChat:c}=n.get(l.w.DistributionLists);c||(i=(0,s.difference)(i,[r.gI.DL]));break;case r.d1.addToTeam:const{enableFederatedUsersInAddToTeam:u}=n.get(l.w.Federated);u||(i=(0,s.difference)(i,[r.gI.Federated]));break;case r.d1.addToSpeedDialOrContacts:const{enableFederatedUsersInAddToSpeedDialOrContacts:p}=n.get(l.w.Federated);p||(i=(0,s.difference)(i,[r.gI.Federated]))}return m.H.createFrom(e,i)}static filterSearchResults(e,n,i){let a=n;return(e=U.applyFeatureFlagSettings(e,i)).includeFederated||(a=a.filter((e=>!(U.isFederatedUser(e)||U.isSfcUser(e)||U.isTFLConsumerUser(e))))),e.includeGuest||(a=a.filter((e=>!U.isGuestUser(e)))),e.includeBot||(a=a.filter((e=>!U.isBot(e)))),e.includeDL||(a=a.filter((e=>!U.isDistributionList(e)))),e.includePstn||(a=a.filter((e=>!U.isPSTNUser(e)))),e.includeAADTenant||(a=a.filter((e=>!U.isInTenantUser(e)))),e.includeCallQandAA||(a=a.filter((e=>!U.isCallQorAAUser(e)))),e.includeSkypeConsumer||(a=a.filter((e=>!U.isSfcUser(e)))),e.includeTflConsumer||(a=a.filter((e=>!U.isTFLConsumerUser(e)))),e.includeTflSmsName||(a=a.filter((e=>!U.isTFLSmsFriendlyNameUser(e)))),e.includeMTOUsers||(a=a.filter((e=>!U.isMTOUser(e)))),e.includeTfl2WaySmsUsers||(a=a.filter((e=>!U.isTFLSmsVerifiedMri(e?.mri||"")))),e.includeB2BMembers||(a=a.filter((e=>!U.isB2BMember(e)))),e.includeRoom||(a=a.filter((e=>!U.isConfRoom(e)))),e.includeCopilots||(a=a.filter((e=>!U.isCopilotBot(e.mri,i)))),a}static isMixedChatUser(e,n){const i=!e&&U.isFederatedUser({type:n})||e&&U.isTFLConsumerUser({type:n})||e&&U.isSfcUser({type:n});return Boolean(i)}static isCopilotBot(e,n){const{copilotAppsIds:i}=n.get(l.w.Messaging)??{};return!(!e||!i?.some((n=>`28:${n}`===e)))}static isSfCUserPrefix(e){return-1!==F.indexOf(e)}static matchEmailAliasInMeProfile(e,n){return!(0,s.isEmpty)(n)&&(0,s.some)(n,(n=>e.toLowerCase()===n.address?.toLowerCase()))}static matchPhoneAliasInMeProfile(e,n){return!(0,s.isEmpty)(n)&&(0,s.some)(n,(n=>e===n.number))}static generatePstnProfile(e,n,i,a,t,r,o){let m;const{enableExternalTagForPSTNUsers:p,enableLabelingUsersByTrustLevel:g,disableUnverifiedLabelForPSTNUsers:N}=r?.get(l.w.People)??{},{emergencySmsNumbers:v,hotlineSMSNumbers:I,enablePaidSmsChat:S}=r?.get(l.w.Messaging)??{},A=e.slice(k.length),T=U.getHotlineNumberMapping(A,r);if(a&&i){const t=(0,u.kZ)(A),r=(0,c.n4)(t,i,a,!0);m={mri:e,displayName:(0,s.isEmpty)(n)?S&&T?.shortCode||r.display:n,givenName:r.display,description:S&&T?r.display:void 0,surname:"",userPrincipalName:e,accountEnabled:!1,jobTitle:"",type:d.$o.pstn,telephoneNumber:r.display}}else m={mri:e,displayName:S&&T?.shortCode||n,description:S&&T?.phoneNumber||void 0,givenName:n,surname:"",userPrincipalName:e,accountEnabled:!1,jobTitle:"",type:d.$o.pstn,telephoneNumber:T?.phoneNumber||A};return p&&t?.stringTranslate instanceof Function&&(!g||N||o||this.isEmergencyOrHotlinePhoneNumber(e,v||[],I||[])?m.decoratedDisplayName=U.checkAndAddExternalTag(m.displayName||n,t):m.decoratedDisplayName=U.checkAndAddUnverifiedTag(m.displayName||n,t)),m}static convertStringToBlobFile(e){const n=e.split(",")[1];if((0,s.isEmpty)(n))return;const i=atob(n),a=e.split(",")[0].split(":")[1].split(";")[0],t=new ArrayBuffer(i.length),r=new Uint8Array(t);for(let e=0;e<i.length;e++)r[e]=i.charCodeAt(e);return new Blob([r],{type:a})}static getPhoneNumbers(e){let n=[];return e?.telephoneNumber&&n.push(e.telephoneNumber),e?.phones&&e.phones.length>0&&(n=n.concat(e.phones.map((e=>e.number)))),n}static getExtendedDirectoryPhoneNumber(e){return U.getPhoneNumbers(e)[0]}static isPartialSCContext(e,n){return!!(e&&!n||!e&&n)}static getFederationType(e,n){let i;const a={type:n};return e?U.isTFLUser(a)?i="tflWithTfl":U.isFederatedUser(a)&&(i="tflWithTfw"):U.isSfcUser(a)?i="tfwWithSfc":U.isTFLConsumerUser(a)?i="tfwWithTfl":U.isFederatedUser(a)&&(i="tfwWithTfw"),i}static getTfwExtendedDirectoryMembership(e,n={}){const{mri:i,userType:a}=e,{excludeOffNetwork:t=!0}=n;return!t&&this.isTFLOffNetworkUser(i)?"offNetwork":this.isPEUPUser(a)?"pending":this.isEUPUser(a)?"accepted":void 0}static getTflExtendedDirectoryMembership(e){return!0===e?"pending":!1===e?"accepted":void 0}static determineM365PersonaType(e){if(!e)return D.NotResolved;const{type:n,userType:i}=e;if(!n)return D.NotResolved;switch(n){case"Federated":case"TflConsumer":case"SkypeConsumer":case d.$o.pstn:return D.External;case"person":case"ADUser":return i&&"Guest"===i?D.NotResolved:D.User;case"Group":return D.DistributionList;default:return D.User}}static isValidNameForInitialsAvatarForPstnUser(e,n){return!!(U.isPSTNUser({mri:e})&&U.isValidNameForInitialsAvatar(n))}static isValidNameForInitialsAvatar(e){const n=new RegExp("(^\\p{L})","iu");return!!(!!e&&n.test(e))}static getDescriptionForPstnContact(e,n,i,a,t){let r;const{mri:o,displayName:d}=e,m=o.split(k)[1],{enablePaidSmsChat:c}=t.get(l.w.Messaging)??{};return c&&U.isPSTNUser({mri:o})&&a&&(U.isTextSameAsPhoneNumber(d,m,n)||(0,s.forEach)(a,(e=>{U.isTextSameAsPhoneNumber(m,e.number,n)&&(r=i.stringTranslate("people",U.getPhoneTypePeopleKey(e.type),{phoneNumber:e.number}))}))),r}static isSearchV2EnabledForPicker(e,n,i){return!!i&&(!(!e||!n)&&!n.includes(e))}static areUnNamedGroupChatsEnabledForPicker(e,n,i){return!!i&&(!(!e||!n)&&n.includes(e))}static areChannelsEnabledForPicker(e,n,i){return!!i&&(!(!e||!n)&&n.includes(e))}static areTeamsEnabledForPicker(e,n,i){return!!i&&(!(!e||!n)&&n.includes(e))}static getTeamPickerItemIdForTeam(e){return`${e}_team`}static getTeamIdFromTeamPickerItemId(e){return e.replace("_team","")}static isTextSameAsPhoneNumber(e,n,i){if(!e||!n)return!1;if(e.toLocaleLowerCase()===n.toLocaleLowerCase())return!0;const a=(0,u.kZ)(e),t=(0,c.n4)(a,"peopleUtilities_isTextSameAsPhoneNumber_Name",i),r=(0,c.n4)(n,"peopleUtilities_isTextSameAsPhoneNumber_Phone",i);return t?.diallable===r?.diallable}static getPhoneTypePeopleKey(e){switch(e){case t.L.Mobile:return`phone_type_${t.L.Mobile}`;case t.L.Business:return`phone_type_${t.L.Business}`;case t.L.Home:return`phone_type_${t.L.Home}`;case t.L.Pager:return`phone_type_${t.L.Pager}`;case t.L.Organization:return`phone_type_${t.L.Organization}`;case t.L.HomeFax:return`phone_type_${t.L.HomeFax}`;case t.L.BusinessFax:return`phone_type_${t.L.BusinessFax}`;case t.L.Assistant:return`phone_type_${t.L.Assistant}`;case t.L.OtherFax:return`phone_type_${t.L.OtherFax}`;case t.L.Radio:return`phone_type_${t.L.Radio}`;default:return`phone_type_${t.L.Other}`}}static isEmergencyOrHotlinePhoneNumber(e,n,i){const a=e.slice(k.length);return n.includes(a)||i.includes(a)}static getHotlineNumberMapping(e,n){const i=n?.get(l.w.People)?.hotlineNumbersMapping||[{shortCode:"988",phoneNumber:"+18002738255"}];for(const n of i)if(e===n?.shortCode||e===n?.phoneNumber)return n}}a=U,U.isFederatedUser=e=>!!e.isFederated||e.type?.toLowerCase()===d.$o.federated.toLowerCase(),U.isGuestUser=e=>e.type===d.$o.guest||e.userType===d.$o.guest,U.isPersonalContactUser=e=>e.type===d.$o.personalContactUser||e.userType===r.gI.PersonalContact,U.isTFLUser=e=>e.type===d.$o.tflUser,U.isTFLConsumerUser=e=>e.type===d.$o.tflConsumer,U.isTFLSmsUser=e=>e.id&&U.isTFLSmsMri(e.id),U.isTFLSmsFriendlyNameUser=e=>e.id&&U.isTFLSmsMri(e.id)&&e.friendlyName,U.isInTenantUser=e=>!(e.type?.toLowerCase()!==d.PC.type.person.toLowerCase()&&e.type!==d.$o.ADUser||U.isGuestUser(e)||e.isFederated),U.isBot=e=>e.type?.toUpperCase()===d.Pk.botType,U.isDistributionList=e=>e.type===d.$o.DistributionList&&(!e.objectType||e.objectType===d.$o.DistributionList),U.isPSTNUser=e=>e.mri&&0===e.mri.indexOf(k),U.isSfcUser=e=>e.type===d.$o.skypeConsumer,U.isTflOrSkypeConsumerUser=e=>U.isTFLConsumerUser(e)||U.isSfcUser(e),U.isMTOUser=e=>e.profileType===d.V5.MTOUser||e.userType===d.$o.MTOUser||e.peopleSubType===d.$o.MTOUser,U.isB2BMemberMTOUser=e=>U.isMTOUser(e)&&(e.type===d.$o.ADUser||e.type===d.$o.person),U.isFederatedMTOUser=e=>U.isMTOUser(e)&&U.isFederatedUser(e),U.isB2BMember=e=>e.profileType===d.V5.B2BMember||e.userType===d.$o.B2BMember,U.isB2BGuest=e=>e.userType===d.$o.guest,U.isExtendedDirectoryUser=e=>U.isPEUPUser(e.userType)||U.isEUPUser(e.userType)||e.type===d.$o.extendedDirectoryUser,U.isConfRoom=e=>e.userType===d.$o.room,U.isPEUPUser=e=>e===d.$o.PendingOrgContact,U.isEUPUser=e=>e===d.$o.OrgContact,U.isSfBUser=e=>Boolean(e.mri&&-1!==e.mri.indexOf("sfb:")),U.isCallQorAAUser=e=>e.type===d.$o.voiceApp,U.isAnonymousUser=e=>a.isAnonymousTfwUser(e)||a.isAnonymousTflUser(e),U.isAnonymousTfwUser=e=>e?.startsWith(f),U.isAnonymousTflUser=e=>e?.startsWith(M),U.isAnonymousPstn=e=>e?.startsWith("4:anonymous"),U.isAcsUserMri=e=>e?.startsWith("8:acs:"),U.isTFLOffNetworkUser=e=>0===e?.indexOf(g),U.isTFLOffNetworkPhoneUser=e=>0===e?.indexOf(v),U.isTFLOffNetworkEmailUser=e=>0===e?.indexOf(N),U.isTFLSmsUnVerifiedMri=e=>0===e?.indexOf(A),U.isTFLSmsVerifiedMri=e=>0===e?.indexOf(S),U.isTFLSmsMri=e=>0===e?.indexOf(S)||0===e?.indexOf(A),U.isTFLSmsOrOffNetworkPhoneMri=e=>U.isTFLOffNetworkPhoneUser(e)||U.isTFLSmsMri(e),U.isTflSmsUnverifiedOrOffNetworkPhoneMri=e=>U.isTFLSmsUnVerifiedMri(e)||U.isTFLOffNetworkPhoneUser(e),U.isEnterpriseUserMri=e=>0===e?.indexOf("8:orgid:"),U.isConsumerUserMri=e=>{if(!e||!e.startsWith("8:"))return!1;const n=e.split(":");return!!(2===n.length||3===n.length&&a.isSfCUserPrefix(n[1]))},U.isDisplayNameUnknownUser=e=>e?.toLowerCase()===T||"unknown"===e?.toLowerCase(),U.isConversationItem=e=>0===e.id?.indexOf(I),U.isUnNamedConversationItem=e=>void 0!==e.groupChatName&&(null===e.groupChatName||0===e.groupChatName.length),U.isChannelPickerItem=e=>void 0!==e.pickerItemType&&e.pickerItemType===b.peoplePickerChannelConversation&&0===e.id?.indexOf(I),U.isTeamPickerItem=e=>void 0!==e.pickerItemType&&e.pickerItemType===b.peoplePickerTeamConversation&&0===e.id?.indexOf(I),U.isTag=e=>"Tag"===e.type,U.getPhoneNumberFromMri=e=>e&&U.isTFLSmsUnVerifiedMri(e)?e.slice(A.length):""},514188:(e,n,i)=>{"use strict";function a(e){const n=e.startsWith("?")||e.startsWith("#");e=n?e.substring(1):e;const i={};return e.split("&").forEach((e=>{const[n,a]=e.split("=");i[n]=decodeURIComponent((a||"").replace(/^.+?(=)/,""))})),i}i.d(n,{J:()=>a})},836617:(e,n,i)=>{"use strict";i.d(n,{c:()=>p,nD:()=>N,$j:()=>v,wf:()=>I,d$:()=>S});var a=i(737554),t=i(539299),r=i(193021),l=i(607002);const o=new RegExp("media.*\\.giphy\\.com$","i"),d=new RegExp([".*\\.asm\\.skype\\.com$",".*\\.asyncgw\\.teams\\.microsoft\\.com$",".*\\.ams\\.gcc\\.teams\\.microsoft\\.com$",".*\\.ams\\.gov\\.teams\\.microsoft\\.us$",".*\\.ams\\.dod\\.teams\\.microsoft\\.us$",".*\\.asyncgw\\.teams\\.microsoft\\.scloud$",".*\\.asyncgw\\.teams\\.eaglex\\.ic\\.gov$",".*\\.asyncgw\\.teams\\.microsoftonline\\.cn$","\\urlp\\.sfbassets\\.com$","statics\\.gov\\.teams\\.microsoft\\.us$","statics\\.dod\\.teams\\.microsoft\\.us$","statics\\.teams\\.microsoft\\.com$","statics\\.teams\\.cdn\\.office\\.net$","staticsint\\.teams\\.cdn\\.office\\.net$","statics-dev\\.teams\\.cdn\\.office\\.net$","statics\\.teams\\.cdn\\.live\\.net$","staticsint\\.teams\\.cdn\\.live\\.net$","statics-dev\\.teams\\.cdn\\.live\\.net$","statics-cn\\.teams\\.cdn\\.office\\.net$","statics\\.teams\\.eaglex\\.ic\\.gov$","statics\\.teams\\.microsoft\\.scloud$","media.*\\.giphy\\.com$","local\\.teams\\.(?:office|live)\\.com$"].join("|"),"i"),s=new RegExp([".*\\logout*"].join("|"),"i"),m=/^\/asm\/[a-z]+/i,c="/urlp/v1/url/content",u="/urlp/v1/url/image/Favicon",p=e=>`data:${k(e)};base64,${e}`,k=e=>{const n=(0,a.F)(e);let i;return i=255===n[0]&&216===n[1]?"image/jpg":137===n[0]&&80===n[1]&&78===n[2]&&71===n[3]?"image/png":71===n[0]&&73===n[1]&&70===n[2]?"image/gif":66===n[0]&&77===n[1]?"image/bmp":"image/unknown",i},g=e=>{const n=(0,r.z)().location.origin;if((0,t.nA)(e,n))return!0;const i=(0,t.yz)(e).toLowerCase(),a=(0,t.Yn)(e).toLowerCase();return d.test(i)||"teams.microsoft.com"===i&&m.test(a)},N=e=>g(e)&&(e=>{const n=(0,t.Yn)(e).toLowerCase();return!s.test(n)})(e)||e.startsWith("data:image"),v=e=>{const n=(0,t.yz)(e).toLowerCase();return o.test(n)};function I(e){return e.endsWith("/middletier/getGif/giphy.gif")}function S(e,n){try{const i=new URL(e);return g(e)&&!(0,l.D$)(e)&&!(0,t.nA)(e,n)&&(i.pathname===c||i.pathname===u)}catch(e){return!1}}},915179:(e,n,i)=>{"use strict";i.d(n,{Z2:()=>a,zg:()=>t,Fi:()=>r,Jy:()=>l,Y0:()=>o,D$:()=>d,V6:()=>s,n6:()=>m,kW:()=>c});const a=180,t=2,r=.5,l=10,o=48,d=62,s=20,m=250,c=1e4},847382:(e,n,i)=>{"use strict";i.d(n,{Y5:()=>a,yh:()=>r,AJ:()=>l,cD:()=>o});var a,t=i(915179);!function(e){e.ULTRA_WIDE="ultra-wide",e.SUPER_SMALL="super-small",e.THIN="thin",e.TALL="tall",e.STANDARD="standard",e.ONE_PIXEL_IMAGE="one-pixel-image",e.NONE="none"}(a||(a={}));const r=(e,n,i=t.n6)=>{let a=e,r=n;return n>i&&(a=i*a/r,r=i),{width:a,height:r}},l=(e,n)=>{if(1===n&&1===e)return a.ONE_PIXEL_IMAGE;if(n/e>=t.zg)return a.TALL;const i=n<t.Z2;return e/n>=t.zg?i?a.THIN:a.ULTRA_WIDE:i?a.SUPER_SMALL:a.STANDARD},o=(e,n,i)=>{if(i===a.THIN||i===a.ULTRA_WIDE){const i=e/t.Jy,a=n/t.Jy;let r=i;if(i>t.D$||a>t.Y0){const e=2,n=t.Z2/t.Jy,l=t.D$/i,o=n/a;r=Number((i*Math.min(l,o)).toFixed(e))}return{"--calculatedWideImageWidth":`${r}rem`}}return{}}},607002:(e,n,i)=>{"use strict";i.d(n,{IC:()=>T,FF:()=>f,vB:()=>M,Ap:()=>h,D$:()=>y,N7:()=>F,Xd:()=>b,MC:()=>C,Mw:()=>w,lo:()=>L,fq:()=>x,qD:()=>O,QK:()=>P});var a=i(539299),t=i(915179);const r="asm.skype.com",l="api.ams.gcc.teams.microsoft.com",o="urlp.ams.gcc.teams.microsoft.com",d="api.ams.gov.teams.microsoft.us",s="api.ams.dod.teams.microsoft.us",m="api.asyncgw.teams.microsoft.scloud",c="api.asyncgw.teams.microsoftonline.cn",u="api.asyncgw.teams.eaglex.ic.gov",p="asyncgw.teams.microsoft.com",k="/v1/objects",g="/views/video",N="/ams",v="teams.microsoft.com",I=/^\/asm\/[a-z]+/i,S=/^\/asm\/[a-z]+\/v1\/objects/i,A=/v1\/objects\/([^/]{1,300})/i;var T,f;function M(e){if(e&&y(e)){const n=e.match(A);return n&&n[1]||""}return""}function h(e){const n=(0,a.yz)(e).toLowerCase(),i=(0,a.Yn)(e);return n.endsWith(r)||n===l||n===d||n===s||n===m||n===c||n===u||n===o||n.endsWith(p)||n===v&&I.test(i)}function y(e){if(L(e))return!0;const n=(0,a.Yn)(e);return h(e)&&(n.startsWith(k)||S.test(n))}function F(e){if(!e)return!1;const n=(0,a.Yn)(e);return!(!L(e)||!n.endsWith(g))||h(e)&&n.endsWith(g)}function b(e){return F(e)?f.Video:y(e)?f.Image:f.None}async function C(e){const n=e instanceof Blob?new Uint8Array(await(e.arrayBuffer?.())):e;if(!n||n.length<6)return!1;if(71!==n[0]||73!==n[1]||70!==n[2])return function(e){if(!e)return!1;let n=-1,i=-1;for(let a=0;a<e.length-4;a++)if(97===e[a]&&99===e[a+1]&&84===e[a+2]&&76===e[a+3]&&(i=a),73===e[a]&&68===e[a+1]&&65===e[a+2]&&84===e[a+3]){n=a;break}return i>=0&&n>i}(n);let i=0;for(let e=0;e<n.length-9&&!(D(n,e)&&(U(n,e+8)||E(n,e+8))&&(i++,i>1));e++);return i>1}function D(e,n){return 33===e[n]&&249===e[n+1]&&4===e[n+2]}function U(e,n){return 44===e[n]}function E(e,n){return 33===e[n]&&255===e[n+1]&&11===e[n+2]}function w(e,n){if(!e||!y(e)||!n||e.startsWith(n))return e;return[n,new URL(e).pathname.substring(1)].join("")}function L(e){return(0,a.Yn)(e).toLowerCase().startsWith(N+k)}function x(e){return e>20971520}function O(e){if(!e||"image/*"===e)return"";const n=e.match(/^image\/([^*]+)$/);return n?n[1]:e}!function(e){e[e.IMAGE_SIZE_TOO_LARGE=10001]="IMAGE_SIZE_TOO_LARGE",e[e.UNSUPPORTED_IMAGE_FORMAT=10002]="UNSUPPORTED_IMAGE_FORMAT"}(T||(T={})),function(e){e.None="None",e.Image="Image",e.Video="Video"}(f||(f={}));const P=async(e,n)=>{const i=document.createElement("canvas"),a=i.getContext("2d");return a?new Promise((r=>{const l=new Image;l.onload=()=>{try{const n=t.kW,o=t.kW;let d=l.width,s=l.height;const m=d/s;if(d<=o&&s<=n)return i.remove(),void r(e);d>s?(d=o,s=d/m):(s=n,d=s*m),i.width=d,i.height=s,a.drawImage(l,0,0,d,s),i.toBlob((n=>{let a;n&&(a=URL.createObjectURL(n)),i.remove(),r(a||e)}),"image/png")}catch(a){n.error(`Error resizing image, error: ${a}`),i.remove(),r(e)}},l.src=e})):(i.remove(),e)}},286412:(e,n,i)=>{"use strict";i.d(n,{Z:()=>a});const a=(e,n)=>{if(e===n)return 0;const i=[e,n].map((e=>e.split("."))),[a,t]=i.map((e=>e.length)),r=Math.min(a,t);for(let e=0;e<r;e++){const[n,a]=i.map((n=>parseInt(n[e],10)||0));if(n!==a)return n>a?1:-1}return a>t?1:a<t?-1:0}},960128:(e,n,i)=>{"use strict";i.d(n,{H:()=>t});var a=i(647541);function t(e,n,i){try{return n.readFragment({id:`Call:${e}`,fragment:a.s,fragmentName:"callingFields"})||void 0}catch(e){i?.log("getCall - call not found in cache")}}},998606:(e,n,i)=>{"use strict";var a,t,r,l,o;i.d(n,{A2:()=>a,UI:()=>t,LF:()=>r,Fo:()=>l,D1:()=>o}),function(e){e.Attendee="attendee",e.Presenter="presenter",e.Organizer="organizer"}(a||(a={})),function(e){e.Interactive="interactive",e.NonInteractive="nonInteractive"}(t||(t={})),function(e){e.DeeplinkNonoffice="DeeplinkNonoffice",e.DeeplinkOffice="DeeplinkOffice",e.DeeplinkFileChiclet="DeeplinkFileChiclet",e.MeetingSidepanel="MeetingSidepanel",e.DocCollab="DocCollab",e.Annotation="Annotation"}(r||(r={})),function(e){e[e.Reconnecting=1e3]="Reconnecting",e[e.Transferring=1001]="Transferring",e[e.TransferFailed=1002]="TransferFailed",e[e.TransferSucceeded=1003]="TransferSucceeded",e[e.Escalating=1004]="Escalating",e[e.EscalationFailed=1005]="EscalationFailed",e[e.EscalationSucceeded=1006]="EscalationSucceeded",e[e.Parking=1007]="Parking",e[e.ParkSucceeded=1008]="ParkSucceeded",e[e.ParkFailed=1009]="ParkFailed",e[e.MusicOnHold=1010]="MusicOnHold",e[e.Aborted=1011]="Aborted"}(l||(l={})),function(e){e[e.CallSetupFailed=0]="CallSetupFailed",e[e.CallDropped=1]="CallDropped",e[e.Undefined=2]="Undefined"}(o||(o={}))},467273:(e,n,i)=>{"use strict";i.d(n,{oG:()=>o,_2:()=>d,rV:()=>s,kI:()=>c});var a=i(509836),t=i(194649),r=i(46377);i(364819);var l;!function(e){e.Default="default",e.Voicemail="voicemail",e.CallParkService="callParkService",e.OriginalEmergencyCallParticipant="originalEmergencyCallParticipant"}(l||(l={}));const o=e=>!!e&&(0,t.oG)(e,r.LE),d=({callType:e,applicationContent:n},i)=>{const t={isCallQueue:!1,isForCurrentCallQueue:!1,callQueueType:null};if(n?.type===a.OT.HuntGroup){switch(e){case a.nz.TwoParty:t.callQueueType=a.Eb.transfer;break;case a.nz.MultiParty:t.callQueueType=a.Eb.conference}t.isCallQueue=void 0!==t.callQueueType,t.isForCurrentCallQueue=m(i,n.configId)}else n?.type===a.OT.CallableChannelOboCall&&(t.isCallQueue=!0,t.isForCurrentCallQueue=m(i,n.configId));return t},s=({endTime:e,connectTime:n,targetParticipant:i})=>{let a=0;if(n&&e&&i?.type!==l.Voicemail.toString()){const i=new Date(e),t=new Date(n);a+=Math.round(i.getTime()-t.getTime())}return a},m=(e,n)=>!!e&&!!n&&e===n,c=(e,n,i,t)=>{const r=a.vF.CallsApp===n&&!t,l=e?.userDelegates.delegates,o=l&&l.length>0,d=Boolean(i&&o&&r),s=e?.userDelegators.delegators,m=s&&s.length>0;return{userIsADelegatorOnPersonalTab:d,userIsADelegateOnPersonalTab:Boolean(i&&m&&r&&!d),userIsOnDelegatorTab:Boolean(i&&t)}}},509836:(e,n,i)=>{"use strict";i.d(n,{b6:()=>a,nz:()=>t,A2:()=>r,QO:()=>l,An:()=>o,W1:()=>d,nk:()=>s,Eb:()=>m,ry:()=>c,vF:()=>u,OT:()=>p});const a={Default:"Default",ScreenSharing:"ScreenSharing",EmergencyGroupCall:"EmergencyGroupCall",Unknown:"Unknown"},t={MultiParty:"MultiParty",TwoParty:"TwoParty",Unknown:"Unknown"},r={Accepted:"Accepted",AcceptedElsewhere:"AcceptedElsewhere",Declined:"Declined",Missed:"Missed",Unknown:"Unknown"},l={Outgoing:"Outgoing",Incoming:"Incoming",Unknown:"Unknown"},o={Transferred:"Transferred",TransferAccepted:"TransferAccepted",TransferFailed:"TransferFailed",TransferSucceeded:"TransferSucceeded",Unknown:"Unknown"},d={Immediate:"Immediate",Simultaneous:"Simultaneous",Unanswered:"Unanswered"},s={Voicemail:"Voicemail",SingleTarget:"SingleTarget",MyDelegates:"MyDelegates",DoNothing:"DoNothing",Group:"Group"};var m;!function(e){e.transfer="transfer",e.conference="conference"}(m||(m={}));const c={Hold:"Hold",Resume:"Resume",Barge:"Barge"},u={CallsApp:"CallsApp",CallableChannel:"CallableChannel",QueuesApp:"QueuesApp"};var p;!function(e){e.HuntGroup="HuntGroup",e.CallableChannelOboCall="CallableChannelOboCall"}(p||(p={}))},988536:(e,n,i)=>{"use strict";i.d(n,{a:()=>t});var a=i(364819);class t{constructor(){this._card={type:"AdaptiveCard",version:"1.5",body:[{type:"Container",items:[]}],actions:[]}}addLabel(e){return this.addElement({type:"TextBlock",text:e,weight:"bolder"}),this}addTextBlock(e){return this.addElement({type:"TextBlock",text:e}),this}addTextInput(e,n,i,a,t,r){return this.addElement({type:"Input.Text",id:e,placeholder:n,value:i,maxLength:a,isMultiline:t,label:r?.label,isRequired:r?.isRequired,errorMessage:r?.errorMessage}),this}addNumberInput(e,n,i,a){return this.addElement({type:"Input.Number",id:e,placeholder:n,value:i,label:a?.label,isRequired:a?.isRequired,errorMessage:a?.errorMessage}),this}addDateInput(e,n,i,a){return this.addElement({type:"Input.Date",id:e,placeholder:n,value:i,label:a?.label,isRequired:a?.isRequired,errorMessage:a?.errorMessage}),this}addTimeInput(e,n,i,a){return this.addElement({type:"Input.Time",id:e,placeholder:n,value:i,label:a?.label,isRequired:a?.isRequired,errorMessage:a?.errorMessage}),this}addToggle(e,n,i,a){return this.addElement({type:"Input.Toggle",id:e,title:n,value:i,isRequired:a?.isRequired,errorMessage:a?.errorMessage}),this}addChoiceSet(e,n,i,a,t,r,l){return this.addElement({type:"Input.ChoiceSet",id:e,title:n,isMultiSelect:i,style:a?"compact":"expanded",choices:t,value:r,label:l?.label,isRequired:l?.isRequired,errorMessage:l?.errorMessage}),this}addImageSet(e,n){return this.addElement({type:"ImageSet",id:e,images:n}),this}addSubmitAction(e,n,i,a){return this._card.actions&&this._card.actions.push({id:e,type:"Action.Submit",title:n,data:i,style:a?.style}),this}addSpeak(e){return this._card.speak=e,this}getCard(){return{content:JSON.stringify(this._card),contentType:"application/vnd.microsoft.card.adaptive"}}getRawJson(){return(0,a.cloneDeep)(this._card)}addElement(e){this._card.body&&this._card.body[0].items.push(e)}}},737554:(e,n,i)=>{"use strict";function a(e){if(!e)return new Uint8Array(0);return t(e.split(",")[1])}function t(e){const n=atob(e),i=new Uint8Array(n.length);for(let e=0;e<n.length;e++)i[e]=n.charCodeAt(e);return i}i.d(n,{a:()=>a,F:()=>t})},900301:(e,n,i)=>{"use strict";i.d(n,{JT:()=>r,oJ:()=>l,M5:()=>o,Gu:()=>s,hR:()=>m});var a=i(364819),t=i(355515);function r(e,n,i){return e=d(e,n,i=i||l),1===n.length&&"object"==typeof n[0]&&(e=d(e,n[0],i)),e}function l(e){if(null===e)return"null";if(void 0===e)return"undefined";const n=typeof e;if("string"===n)return e;if("number"===n||"boolean"===n)return String(e);if("function"===n)return"";if((0,a.isDate)(e))return e.toISOString();try{return JSON.stringify(e)}catch(n){return m(e)}}function o(e,n){let i=`[errorType=${typeof e}]`;return i+=e?"object"==typeof e?`[errorName=${e.name}][errorMessage=${e.message}][errorStack=${e.stack}]`:`[error=${e.toString()}]`:`[error=Undefined ${n} Error]`,(0,t.Mr)(i)}function d(e,n,i){for(const a in n)n.hasOwnProperty(a)&&(e=e.replace(`{${a}}`,i(n[a])));return s(e)}function s(e){return null==e||0===e.length?e:` ${e}`.substr(1)}function m(e,n){const i=new WeakSet;return JSON.stringify(e,((e,n)=>{if(!i.has(n)){if(n&&"object"==typeof n){if(i.add(n),n instanceof Map||n instanceof Set)return Array.from(n);if(n instanceof Error)return`${n.name}: ${n.message}`;if(n.constructor&&n.constructor!==Object&&n.constructor!==Array||n.prototype)return}return n}}),n)}},804510:(e,n,i)=>{"use strict";i.d(n,{j:()=>a});const a=(e,n={},i)=>{let a;try{if(void 0===e)throw new Error('"undefined" is not valid JSON');a=JSON.parse(e)}catch(e){a=n,i?.(e)}return a}},348103:(e,n,i)=>{"use strict";function a(){return(...e)=>e}i.d(n,{K:()=>a})},496066:(e,n,i)=>{"use strict";i.d(n,{L:()=>a});const a={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,capsLock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,zero:48,a:65,c:67,v:68,command:91,contextMenu:93,number0:48,number9:57,numpad0:96,numpad9:105,numpadAdd:107,numpadSubtract:109,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,equal:187,hyphen:189,forwardslash:191}},21450:(e,n,i)=>{"use strict";var a;i.d(n,{C:()=>a}),function(e){e.User="8:orgid:",e.Pstn="4:",e.Bot="28:",e.GcchUser="8:gcch:",e.DodUser="8:dod:",e.AcsUser="8:acs:",e.PstnExtension=";ext="}(a||(a={}))},226883:(e,n,i)=>{"use strict";i.d(n,{zL:()=>H,O5:()=>J,b4:()=>q,kq:()=>X,$I:()=>K,o9:()=>$,XU:()=>ee,Xd:()=>ne,K1:()=>ie,a$:()=>ae,JJ:()=>te,WB:()=>re,Oh:()=>le,Ql:()=>oe,qi:()=>de,oB:()=>se,PA:()=>me,Ft:()=>ce,tj:()=>ue,sn:()=>pe,g5:()=>ke,ci:()=>ge,ol:()=>Ne,D0:()=>ve,dS:()=>Ie,Y8:()=>Se,ro:()=>Ae,tF:()=>Te,s0:()=>fe,cK:()=>Me,xc:()=>he,es:()=>ye,ef:()=>Fe,U_:()=>be,D:()=>Ce,q7:()=>De,r6:()=>Ue,zx:()=>Ee,y:()=>we,En:()=>Le,m8:()=>xe,LW:()=>Oe});var a=i(933370),t=i(831090),r=i(530351),l=i(949426),o=i(663609),d=i(125203),s=i(501219),m=i(711900),c=i(352448),u=i(346414),p=i(106578),k=i(527850),g=i(559751),N=i(798202),v=i(917917),I=i(366159),S=i(495081),A=i(197891),T=i(524083),f=i(393721),M=i(165435),h=i(188943),y=i(976588),F=i(376850),b=i(465459),C=i(289390),D=i(542992),U=i(573563),E=i(375886),w=i(84167),L=i(863963),x=i(865264),O=i(299556),P=i(811697),V=i(244606),j=i(26402),B=i(548993),z=i(158291),R=i(446550),Q=i(444759),W=i(695909),Y=i(535249),G=i(566058),Z=i(629230),_=i(134585);const H=e=>e instanceof Date?e:new Date(e),J=(e,n)=>H(e).getTime()<=H(n).getTime(),q=e=>(0,t.A)(Ne(H(e)),1),X=(e,n=a.ZD.Sunday)=>(0,r.A)(H(e),{weekStartsOn:n}),K=(e,n=a.ZD.Sunday)=>Ne((0,l.A)(H(e),{weekStartsOn:n})),$=e=>0-H(e).getTimezoneOffset(),ee=(e,{hours:n,minutes:i,seconds:a,milliseconds:t})=>{let r=new Date(e);return void 0===n||isNaN(n)||(r=(0,o.A)(r,n)),void 0===i||isNaN(i)||(r=(0,d.A)(r,i)),void 0===a||isNaN(a)||(r=(0,s.A)(r,a)),void 0===t||isNaN(t)||(r=(0,m.A)(r,t)),r},ne=(e,{hours:n,months:i,minutes:a,days:r,seconds:l})=>{let o=new Date(e);return void 0===n||isNaN(n)||(o=(0,c.A)(o,n)),void 0===a||isNaN(a)||(o=(0,u.A)(o,a)),void 0===l||isNaN(l)||(o=(0,p.A)(o,l)),void 0===r||isNaN(r)||(o=(0,t.A)(o,r)),void 0===i||isNaN(i)||(o=(0,k.A)(o,i)),o},ie=(e,n)=>ne(e,{days:n}),ae=(e,n)=>(0,g.A)(H(H(e)),n),te=(e,n)=>(0,N.A)(H(e),n),re=e=>e&&e.getTime(),le=e=>(0,v.A)(H(e))*a.XP+(0,I.A)(H(e)),oe=(e,n,i)=>{const a=H(n),t=H(e);switch(i){case"hours":return(0,S.A)(a,t);case"minutes":return(0,A.A)(a,t);case"seconds":return(0,T.A)(a,t);case"days":return(0,f.A)(a,t);case"weeks":return(0,M.A)(a,t);case"months":return(0,h.A)(a,t);case"milliseconds":return(0,y.A)(a,t);case"years":return(0,F.A)(a,t);case"calendarDays":return(0,b.A)(a,t)}},de=()=>{try{const e=Intl.DateTimeFormat()&&Intl.DateTimeFormat().resolvedOptions();return e&&e.timeZone}catch{return""}},se=(e,n)=>!(!n||n.length<1)&&n.indexOf(H(e).getDay())>-1,me=e=>{const n=ae(new Date(Date.now()),1);return Ae(H(e),n)},ce=(e,n)=>(0,C.A)(H(e),H(n)),ue=e=>(0,D.A)(H(e)),pe=e=>(0,U.A)(H(e)),ke=e=>(0,E.A)(H(e)),ge=e=>(0,w.A)(H(e)),Ne=e=>(0,L.A)(H(e)),ve=e=>(0,x.A)(H(e)),Ie=(e,n)=>(0,O.A)(H(e),H(n)),Se=(e,n)=>(0,P.A)(H(e),H(n)),Ae=(e,n)=>(0,V.A)(H(e),H(n)),Te=(e,n)=>(0,j.A)(H(e),H(n)),fe=(e,n)=>(0,B.A)(H(e),H(n)),Me=e=>(0,z.A)(H(e)),he=e=>(0,R.A)(H(e)),ye=e=>(0,Q.A)(H(e)),Fe=e=>(0,W.A)(H(e)),be=e=>(0,Y.A)(H(e)),Ce=e=>(0,G.A)(H(e)),De=(e,n="extended",i="complete")=>(0,Z.A)(H(e),{format:n,representation:i}),Ue=(e,n)=>(0,_.A)(H(e),n),Ee=(e,n)=>((e=new Date(e)).setMilliseconds(0),n?e.toISOString():De(e)),we=(e,n=0,i=!1)=>{const a=ne(new Date(e),{minutes:new Date(e).getTimezoneOffset()+n});return n>0&&i?Ne(a):a},Le=e=>{const n=e.indexOf("T");if(n<=0)throw new Error(`Invalid date ${e}`);return`${e.substr(0,n)}T00:00:00.000Z`},xe=(e,n)=>{const i=oe(e,n,"minutes"),t=Math.floor(i/a.XV),r=i%a.XV;return{durationDays:t,durationHours:Math.floor(r/a.XP),durationMinutes:r%a.XP}},Oe=e=>{if(!e)return null;switch(typeof e){case"string":try{return new Date(e).toISOString()}catch(n){if(n instanceof RangeError)return new Date(parseInt(e,10)).toISOString()}case"number":return new Date(e).toISOString();default:return null}}},649364:(e,n,i)=>{"use strict";i.d(n,{z:()=>a});const a=(e,n)=>`${e}__${n}`},508411:(e,n,i)=>{"use strict";i.d(n,{F6:()=>l,Q2:()=>d,a9:()=>s,Uf:()=>m,l7:()=>c,dG:()=>u,sZ:()=>p,XU:()=>k,qh:()=>g});var a=i(364819),t=i(942016),r=i(46377);function l(e,n){try{const i=o(e);if("https://local.teams.office.com"===new URL(e).origin)return!0;for(const e of(0,a.uniqBy)(n,(e=>e.toLowerCase()))){let n="";const a=e.split(".");for(let e=0;e<a.length;e++)n+=(e>0?"[.]":"")+a[e].replace("*","[^/^.]+");const t=new RegExp(`^https://${n}((/|\\?).*)?$`,"i");if(i.match(t))return!0}}catch{return!1}return!1}const o=e=>new URL(e).href,d=e=>e?.replace(/;messageid=.*/,""),s=(e,n,i)=>{let a="";if(!e.id||c(e.id))return a;switch(e.type){case t.ck.extensions:try{a=JSON.parse(e.id).threadId||i}catch(n){a=e.id||i||""}break;case t.ck.chats:case t.ck.chatthread:a=e.id.replace("replyChainId","messageid");break;case t.ck.communities:case t.ck.channels:case t.ck.channelthread:let r;try{r=JSON.parse(e.id).channelId}catch{r=e.id}a=n?`${r};messageid=${n}`:r;break;case t.ck.shareformdialog:break;case t.ck.meetingcollaboration:default:a=e.id}return a},m=e=>e&&e.replace(new RegExp(`^${r.gN.BotPrefix}`),""),c=e=>"newchat"===e||e?.includes("preview"),u=(e,n=r.Go.Call)=>n===r.Go.Call&&/<partlist/.test(e)&&!g(e,n),p=(e,n)=>!!k(e,n)&&g(e),k=(e,n)=>n===r.Go.Call&&e.includes('<conversationType>"huddleGroupCall"</conversationType>'),g=(e,n=r.Go.Call)=>n===r.Go.Call&&(-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e))},641030:(e,n,i)=>{"use strict";i.d(n,{n4:()=>s,UZ:()=>N,zj:()=>T});var a=i(364819),t=i(21450),r=i(726907),l=i(332752),o=i(97882),d=i(524109);const s=(e,n,i,a)=>{let t={normalized:e,diallable:e,display:e};const{logger:r,userLocale:l,isDialPlansEnabled:d,allowNonE164Mri:s,phoneNumberUtil:c,phoneNumberFormat:k}=i;if(!c||!k)return r.warn(`[formatPhoneNumber] Invalid config: isPhoneNumberUtilDefined=${!!c}, isPhoneNumberFormatDefined=${!!k}`),t;if(!e)return r.warn(`[formatPhoneNumber] No phone number provided from: ${n}`),t;if(r.log(`[formatPhoneNumber] Received phoneNumber: ${e} from: ${n}`),!a){const n=(0,o.tv)(e),a=m(n,i);if(r.log("[formatPhoneNumber] cleaned_formatting"),d){if(t=S(a,i),r.log(`[formatPhoneNumber] isInternalExtension? ${t.isInternalExtension}`),t.isInternalExtension)return t}else r.log("[formatPhoneNumber] Dialplan not enabled, not applying normalization rules"),t.normalized=a;s||(t.normalized=u(t.normalized,k.E164,i,!0),r.log("[formatPhoneNumber] NonE164 mri are not allowed"))}t={...t,...p(t.normalized,i)};try{const e=c.getInstance().parseAndKeepRawInput(t.normalized,l);t.display=c.getInstance().formatInOriginalFormat(e,k.INTERNATIONAL),t.isValid=c.getInstance().isPossibleNumber(e)&&c.getInstance().isValidNumber(e)}catch(e){r.error(`[formatPhoneNumber] ${e}`),t.display=t.normalized,t.isValid=!1}return r.log(`[formatPhoneNumber] isValid? ${t.isValid}`),t},m=(e,n)=>{if(!n.phoneNumberUtil)return n.logger.warn(`[convertPhoneNumberToAlpha] Invalid config: isPhoneNumberUtilDefined=${!!n.phoneNumberUtil}`),e;const i=c(e,n),a=e.substring(i.length);return n.phoneNumberUtil.convertAlphaCharactersInNumber(i)+a},c=(e,n)=>{if(!n.phoneNumberUtil)return n.logger.warn(`[getPhoneNumberWithoutExtension] Invalid config: isPhoneNumberUtilDefined=${!!n.phoneNumberUtil}`),e;const i=n.phoneNumberUtil.EXTN_PATTERN_,a=e.search(i);return a>=0?e.substring(0,a):e},u=(e,n,i,a,t)=>{const{userLocale:r,logger:l,phoneNumberUtil:o,phoneNumberFormat:d}=i;if(!o||!d)return l.warn(`[parseAndFormatNumber] Invalid config: isPhoneNumberUtilDefined=${!!o}, isPhoneNumberFormatDefined=${!!d}`),e;const s=n||d.INTERNATIONAL,m=I(e,i,"parseAndFormatNumber");if(!v(m,i,t))return m;try{if(a){const e=o.getInstance().parse(m,r);return o.getInstance().format(e,s)}{const e=o.getInstance().parseAndKeepRawInput(m,r);return o.getInstance().formatInOriginalFormat(e,s)}}catch(e){return l.error("[parseAndFormatNumber] Failed to parse and format a phone number",e),m}},p=(e,n)=>{const{enableFormattingFixForExtension:i}=n;return{diallable:c(e,n),extension:i?g(e,n):k(e,n)}},k=(e,n)=>{const i=I(e,n,"getExtension");return g(i,n)},g=(e,n)=>{const{enablePstnWithExtnFix:i,enableFixForDtmfTone:a,logger:t,userLocale:r,phoneNumberUtil:l}=n;if(!l)return t.warn(`[getExtensionFromNormalizedNumber] Invalid config: isPhoneNumberUtilDefined=${!!l}`),"";if(!i&&!a&&!v(e,n))return t.warn(`[getExtension] Received an invalid phone number: ${e}`),"";try{return l.getInstance().parse(e,r).getExtension()||""}catch(e){return t.error("Failed to parse and format a phone number",e),""}},N=(e,n,i,a)=>{const{logger:r}=n;let l=`${t.C.Pstn}${e}`;return i&&(l+=`${t.C.PstnExtension}${i}`),r.log(`[generateMriForPstn] context: ${a} Generated MRI: ${l} for dialOutNumber: ${e} ${i?`and extension: ${i}`:""}`),l},v=(e,n,i)=>{const{userLocale:a,logger:t,phoneNumberUtil:r}=n;if(!r)return t.warn(`[isStandardFormatNormalized] Invalid config: isPhoneNumberUtilDefined=${!!r}`),!1;if(!e)return!1;try{const t=I(e,n,"isStandardFormatNormalized"),l=r.getInstance().parse(t,a),o=r.getInstance().isPossibleNumber(l);return i?o:o&&r.getInstance().isValidNumber(l)}catch(e){return t.error("[isStandardFormatNormalized] error:",e),!1}},I=(e,n,i)=>{const{isDialPlansEnabled:a,logger:t}=n;t.log(`[normalizePstnNumber] Received phoneNumber: ${e} from: ${i}`);const r=(0,o.tv)(e);return a?S(r,n).normalized:r},S=(e,n)=>{const{normalizationRules:i,logger:a,coreSettings:t,ituCountryPrefix:l}=n,o={normalized:e,diallable:e,display:e};if(!i.length)return o;const d=new r.g(i,l,a,t).normalize(e);return o.normalized=d.phoneNumber,o.diallable=d?.phoneNumber,o.display=d?.phoneNumber,o.isInternalExtension=d?.isInternalExtension,o.isValid=d.isNormalized,o},A=(e,n,i,t,r)=>{let l;if(!(0,a.isEmpty)(e)){const n=t?.getInstance().getRegionCodeForCountryCode(Number(e));if(n)return l=n.toLowerCase(),i.log(`Setting locale based on dial plan to ${l}`),l}const o=r?.()||n||"en-US";return o?(l=o.substring(o.indexOf("-")+1).toLowerCase(),i.log(`Setting locale based on teams locale to ${l}`),l):(i.warn("localizationService failed to get locale. Falling back to 'us' locale"),"us")},T=async(e,n,a,t)=>{const r=e.get(l.w.Calling);let o;try{o=await(async(e,n)=>{let a;try{const t=()=>i.e(725236).then(i.t.bind(i,744465,23));a=await(0,d.wg)(t,"libphonenumber-bundle",n),e.log("[getLibPhoneNumber] Loaded @microsoft/google-libphonenumber.")}catch(n){return e.errorToTelemetry?.(`[getLibPhoneNumber] Failed to load @microsoft/google-libphonenumber. Name: ${n?.name}, Message: ${n?.message}`,"utilities_normalization_getlibphonenumber",void 0,!0),Promise.reject(`Failed to load @microsoft/google-libphonenumber : ${n?.message}`)}return a})(a,t)}catch(e){return a.error(`[getConfig] Failed to load @microsoft/google-libphonenumber. ${e}`),Promise.reject({error:"Failed to load @microsoft/google-libphonenumber",message:e})}return{allowNonE164Mri:!!r.allowNonE164Mri,isDialPlansEnabled:!!r.enableDialPlans,enablePstnWithExtnFix:!!r.enablePstnWithExtnFix,normalizationRules:r.dialPlanPolicy?.normalizationRules||[],ituCountryPrefix:r.dialPlanPolicy?.ituCountryPrefix||"",enableFormattingFixForExtension:!!r.enableFormattingFixForExtension,userLocale:A(r.dialPlanPolicy?.ituCountryPrefix||"",n,a,o.PhoneNumberUtil),enableFixForDtmfTone:!!r.enableFixForDtmfTone,logger:a,phoneNumberUtil:o.PhoneNumberUtil,phoneNumberFormat:o.PhoneNumberFormat,coreSettings:e}}},726907:(e,n,i)=>{"use strict";i.d(n,{g:()=>r});var a=i(332752),t=i(97882);class r{constructor(e,n,i,a){this.iTUCountryPrefix=n,this.logger=i,this.coreSettings=a,this.invalidRules=[],this.normalizeRules=[],this.setRules(e)}normalize(e){let n=r.removeFormatCharacters(e);n=r.removeGuid(n);const i=this.coreSettings?.get(a.w.Calling);if(this.logger?.log(`[normalize] Feature flag: stopNormalizationOnPlus=${i?.stopNormalizationOnPlus}`),i?.stopNormalizationOnPlus&&n.startsWith("+"))return this.logger?.log(`[normalize] ${e} starts with plus. Stopping normalization.`),{phoneNumber:n,isNormalized:!0};let l=1;for(const i of this.normalizeRules){const{pattern:a,translation:t,isInternalExtension:r}=i;if(a.test(n)){const i=n.replace(a,t);return this.logger?.log(`[normalize] [${e}] was normalized into [${i}] using rule ${l} of ${this.normalizeRules.length}: ruleExpression=[${a}] translation=[${t}] isInternalExtension=[${r}].`),{phoneNumber:i,isInternalExtension:r,isNormalized:!0}}l++}if(this.logger?.log(`[normalize] No normalization rule matched. [addCountryCodeDuringNormalization=${i?.addCountryCodeDuringNormalization}].`),i?.addCountryCodeDuringNormalization&&!n.startsWith("+")&&(0,t.wk)(n)){const a=this.iTUCountryPrefix||i.dialPlanPolicy?.ituCountryPrefix,t=a?`+${a}`:"",r=`${t}${n}`;return this.logger?.log(`[normalize] [${e}] was normalized into [${r}] by adding country code [${t}].`),{phoneNumber:r,isNormalized:!!t}}return{phoneNumber:n}}getInvalidRules(){return this.invalidRules}getITUCountryPrefix(){return this.iTUCountryPrefix}static removeFormatCharacters(e){return e.replace(/[\s\(\)\-_\/]+/g,"")}static removeGuid(e){return e.replace(/_([a-z]+\d+|\d+[a-z]+)[a-z\d]*$/gi,"")}setRules(e){if(e)for(const n of e)try{this.normalizeRules.push({pattern:new RegExp(n.pattern),translation:n.translation,isInternalExtension:n.isInternalExtension})}catch(e){this.invalidRules.push(n.pattern)}}}},97882:(e,n,i)=>{"use strict";i.d(n,{Ku:()=>t,h4:()=>r,vk:()=>s,Iy:()=>m,IK:()=>c,KM:()=>u,kZ:()=>p,tv:()=>k,wk:()=>g});var a=i(21450);const t=e=>Boolean(e&&e.startsWith(a.C.Pstn)),r=e=>!(!e||!e.startsWith(a.C.AcsUser)),l=/4:[^-_]*-[^-_]*-[^-_]*-[^-_]*-.*/,o=/^\+?\d*[ ]*(\([ ]*\d+[ ]*\))?[0-9 -]+((?:;ext=([0-9]{1,7})|[  \t,]*(?:e?xt(?:ensi(?:ó?|ó))?n?|ｅ?ｘｔｎ?|[,xｘ#＃~～]|int|anexo|ｉｎｔ)[:\.．]?[  \t,-]*([0-9]{1,7})#?|[- ]+([0-9]{1,5})#))?$/i,d=e=>e.indexOf("_"),s=e=>{if(!t(e))return!1;const n=e.slice(a.C.Pstn.length);return-1!==d(n)},m=(e,n)=>l.test(e)&&n,c=e=>{let n=e.slice(a.C.Pstn.length);const i=d(n);return-1!==i&&(n=n.slice(0,i)),n},u=e=>e?`4:${e.replace(/-/g,"").replace(/\s/g,"")}`:"",p=e=>e.replace(/_([a-z]+\d+|\d+[a-z]+)[a-z\d]*$/gi,""),k=e=>{const n=(e=>e.replace(/[ \(\)\-_\/]+/g,""))(p(e));return n},g=e=>o.test(e?.trim())},244698:(e,n,i)=>{"use strict";function a(e=1){const n=new Uint32Array(e),a=i.g;if(a.msCrypto)a.msCrypto.getRandomValues(n);else if(a.crypto)a.crypto.getRandomValues(n);else{let i=e;for(;i--;){const e=4294967296;n[i]=Math.floor(Math.random()*e)}}return Array.from(n)}function t(e){return 0===(n=1/e,Math.floor(Math.random()*n));var n}i.d(n,{yT:()=>a,Dz:()=>t})},239:(e,n,i)=>{"use strict";i.d(n,{bi:()=>a,M5:()=>r,XO:()=>m,kr:()=>g,qU:()=>v,zs:()=>I,fs:()=>S,TY:()=>A,zU:()=>T,wG:()=>f,fV:()=>M,aJ:()=>h,yD:()=>F,T5:()=>b,pc:()=>U});var a,t,r,l=i(46377),o=i(194649),d=i(364819),s=i(210071);!function(e){e.TeamsOnly="TeamsOnly",e.SfBOnly="SfBOnly",e.SfBWithTeamsCollab="SfBWithTeamsCollab",e.SfBWithTeamsCollabAndMeetings="SfBWithTeamsCollabAndMeetings",e.Islands="Islands",e.IslandsWithTempInterop="IslandsWithTempInterop",e.IslandsWithVoipDeepLinking="IslandsWithVoipDeepLinking"}(a||(a={})),function(e){e[e.Islands=1]="Islands",e[e.IslandsWithTempInterop=2]="IslandsWithTempInterop",e[e.IslandsWithVoipDeepLinking=3]="IslandsWithVoipDeepLinking",e[e.SfBOnly=4]="SfBOnly",e[e.SfBWithTeamsCollab=5]="SfBWithTeamsCollab",e[e.SfBWithTeamsCollabAndMeetings=6]="SfBWithTeamsCollabAndMeetings",e[e.TeamsOnly=7]="TeamsOnly",e[e.Legacy=8]="Legacy"}(t||(t={})),function(e){e[e.Teams=0]="Teams",e[e.SfB=1]="SfB",e[e.Federated=2]="Federated",e[e.NativeFederated=3]="NativeFederated"}(r||(r={}));const m=e=>!!(e&&e.coExistenceMode&&a[e.coExistenceMode]),c=e=>!(e!==a.TeamsOnly),u=e=>!(-1===[a.Islands,a.IslandsWithTempInterop,a.IslandsWithVoipDeepLinking].indexOf(e)),p=e=>!(-1===[a.SfBOnly,a.SfBWithTeamsCollab,a.SfBWithTeamsCollabAndMeetings].indexOf(e)),k=(e,n,i=!1)=>{const a=[l.Vb,l.uM,l.QX,l.Sq,l.Ne,l.gI,l.cA,l.Bh,l.m2,l.Nk,l.zl],t=e.split(":");return a.some((e=>{const a=t.findIndex((n=>n===e.slice(0,-1)));return a>=0&&(i?t.splice(a+1,1):t.splice(a+1,0,n.slice(0,-1)),!0)})),t.join(":")},g=e=>!!e&&(0,d.startsWith)(e,l.gN.SkypeSpacesUser+l.K),N=e=>!!e&&e.includes(l.K)&&!(0,d.startsWith)(e,l.gN.SkypeSpacesUser+l.K),v=e=>!e||N(e)?e:e.includes(l.gN.SkypeSpacesUser)?k(e,l.K):void 0,I=e=>!!e&&!(0,d.startsWith)(l.gN.SkypeSpacesUser+l.hh,e)&&e.includes(l.hh),S=e=>!!e&&!(0,d.startsWith)(l.gN.SkypeSpacesUser+l.O,e)&&e.includes(`:${l.O}`),A=e=>!e||S(e)?e:e.includes(l.gN.SkypeSpacesUser)?k(e,l.O):void 0,T=e=>!e||I(e)?e:e.includes(l.gN.SkypeSpacesUser)?k(e,l.hh):void 0,f=e=>!e||(e=>!!e&&!e.startsWith(l.gN.SkypeSpacesUser+l.OE)&&e.includes(l.OE))(e)?e:e.includes(l.gN.SkypeSpacesUser)?k(e,l.OE):void 0,M=e=>{if(e){if(N(e))return k(e,l.K,!0);if(I(e))return k(e,l.hh,!0)}return e},h=e=>e?S(e)?k(e,l.O,!0):void 0:e,y={isAllowed:!1},F=(e,n,i,a,t,r,l,o)=>{const d=l&&l.coExistenceMode,s=r&&r.coExistenceMode;if(!d||!s)return{isAllowed:!0};if(a){const a=((e,n,i,a,t,r,l)=>{const o=l.newLogger("sfb-interop","services-utilities-sfb-interop");return r.isFederated?!a&&i?(o.log("Chat Disabled: current user is not provisioned on Sfb online"),y):r.coExistenceMode&&t.coExistenceMode?e&&i&&c(t.coExistenceMode)&&c(r.coExistenceMode)?{isAllowed:!1,mri:T(r.mri||"")}:i||n||!u(t.coExistenceMode)&&!u(r.coExistenceMode)?!i&&p(r.coExistenceMode)?{isAllowed:!1,toInterop:!0,mri:r.mri||""}:{isAllowed:!0}:{isAllowed:!1,toInterop:!0,mri:r.mri}:(o.log("Chat Enabled: TeamsUpgradePolicy is not defined for both users"),{isAllowed:!0}):(o.log("Federated Chat Disabled: recipient user is not federated"),(e=>({isAllowed:!1,toInterop:!1,mri:e.mri}))(r))})(e,n,i,t,r,l,o);if(!a.isAllowed)return a}else{const e=((e,n)=>n.coExistenceMode?e&&c(n.coExistenceMode)?{isAllowed:!1,mri:M(n.mri||"")}:!e&&p(n.coExistenceMode)?{isAllowed:!1,mri:v(n.mri||""),toInterop:!0}:{isAllowed:!0}:{isAllowed:!0})(i,l);if(!e.isAllowed)return e}return{isAllowed:!0}},b=e=>{const n=I(e);return C(e)||N(e)||n?(i=e)&&((0,d.startsWith)(i,l.gN.SkypeSpacesUser+l.cA)||(0,d.startsWith)(i,l.gN.SkypeSpacesUser+l.Bh)||(0,d.startsWith)(i,l.gN.SkypeSpacesUser+l.m2)||(0,d.startsWith)(i,l.gN.SkypeSpacesUser+l.Nk)||(0,d.startsWith)(i,l.gN.SkypeSpacesUser+l.zl))?e:n?e.replace(l.hh,""):e.replace(l.K,"").replace(l.v,""):e;var i},C=e=>!!e&&!(0,d.startsWith)(l.gN.SkypeSpacesUser+l.v,e)&&e.includes(l.v),D=(e,n,i,a)=>{const r=e.isFederated,l=(o=e.mri||"",(0,d.endsWith)(o,"@sfbonprem.unq.gbl.spaces"));var o;if(n&&r&&!l&&e.coExistenceMode){const n=t[e.coExistenceMode],r=i===t.TeamsOnly&&n===t.TeamsOnly;return r||a.log(`isNativeFederationMode is false - currentUserMessagingPolicyMode:${t[i]} recipientCoexistenceMode:${t[n]}`),r}return a.log(`isNativeFederationMode is false - enableNativeP2PFederatedChats:${n} isFederated:${r} isOnPremFederated:${l} coExistenceMode:${e.coExistenceMode}`),!1},U=(e,n,i,a,l,d)=>{if(!(e&&e.mri&&e.userType!==s.$o.guest&&e.type!==s.$o.skypeConsumer&&e.type!==s.$o.tflUser&&(0,o.Y$)(e.mri)))return i.log("getUserChatMode - Defaulting to teams chat mode as user profile is undefined or Guest or TFL user or is not a real user mri"),r.Teams;if(e.isFederated)return i.log(`getUserChatMode - federated user - mri: ${e.mri}, coExistenceMode: ${e.coExistenceMode}`),D(e,l,d,i)?r.NativeFederated:r.Federated;const m=((e,n,i)=>{const a=e.coExistenceMode,l=t[a];if(i.log(`getCoexistenceChatMode - caller: ${n}, mri: ${e.mri}, isShortProfile: ${e.isShortProfile}, coExistenceMode: ${t[l]}, MT coExistenceMode: ${a}`),t[l]!==a&&i.error(`getUserChatMode - Mapping error - coExistenceMode : ${t[l]}, MT coExistenceMode: ${a}`),l){const e=[t.SfBOnly,t.SfBWithTeamsCollab,t.SfBWithTeamsCollabAndMeetings],n=[t.TeamsOnly,t.Islands,t.IslandsWithVoipDeepLinking];if(e.includes(l))return r.SfB;if(n.includes(l))return r.Teams;i.warn(`getUserChatMode - unknown coExistenceMode ${t[l]}`)}else e.isShortProfile||i.warn(`getUserChatMode - full profile has no coExistenceMode for mri ${e.mri}`)})(e,n,i);if(m)return m;const c=g(e.mri),u=e.isSkypeTeamsUser,p=(e=>!(!e.isFederated&&void 0!==e.isPrivateChatEnabled)||e.isPrivateChatEnabled)(e);return i.log(`getUserChatMode - caller: ${n}, mri: ${e.mri}, isSfbMri: ${c}, isTeamsChatEnabled: ${p}, hasLoggedInToTeams: ${u}, isSipDisabled: ${e.isSipDisabled}, isSfBEligible: ${a}`),!c&&u&&p||e.isSipDisabled||!a?r.Teams:r.SfB}},691457:(e,n,i)=>{"use strict";i.d(n,{z:()=>r,I:()=>l});var a=i(422816);const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"downloadAmsItem"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"urlOrObjectId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BlobType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"applyRetry"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"networkCorrelationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"downloadAmsItem"},arguments:[{kind:"Argument",name:{kind:"Name",value:"urlOrObjectId"},value:{kind:"Variable",name:{kind:"Name",value:"urlOrObjectId"}}},{kind:"Argument",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"type"}}},{kind:"Argument",name:{kind:"Name",value:"applyRetry"},value:{kind:"Variable",name:{kind:"Name",value:"applyRetry"}}},{kind:"Argument",name:{kind:"Name",value:"networkCorrelationId"},value:{kind:"Variable",name:{kind:"Name",value:"networkCorrelationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"blob"}},{kind:"Field",name:{kind:"Name",value:"fullSizeHeight"}},{kind:"Field",name:{kind:"Name",value:"fullSizeWidth"}},{kind:"Field",name:{kind:"Name",value:"size"}}]}}]}}]},r=async(e,n,i,r,o,d)=>{try{const{data:a}=await e.query({query:t,variables:{urlOrObjectId:n,type:i,applyRetry:r,networkCorrelationId:o},context:{callerInfo:d},fetchPolicy:"network-only"});return{result:a?.downloadAmsItem??void 0,loading:!1,error:void 0}}catch(e){if(e instanceof a.K){const n=e.graphQLErrors.find((e=>l(e.extensions)))?.extensions;return{result:void 0,loading:!1,error:{...n,message:e.message,name:e.name}}}return{result:void 0,loading:!1,error:e}}},l=e=>"string"==typeof e?.cv},102761:(e,n,i)=>{"use strict";i.d(n,{H:()=>v});var a=i(132097);const t=["TeamSettings","ChannelSettings","Channel","ChannelMessage","TeamsTab","Member","Owner","TeamMember","TeamsAppInstallation","File","ChatMember","ChatMessage","ChatSettings","Chat","OnlineMeeting","CameraStream","OutgoingVideoStream","OnlineMeetingParticipant","ChannelMeetingParticipant","InAppPurchase","OnlineMeeting","ChannelMeeting","TeamsActivity","Calls","MeetingStage","ChannelMeetingStage","MicrophoneStream","OnlineMeetingIncomingAudio","ChannelMeetingIncomingAudio","OnlineMeetingActiveSpeaker","ChannelMeetingActiveSpeaker","ChannelMeetingAudioVideo","LiveShareSession","MeetingParticipantReaction","OnlineMeetingNotification","ChannelMeetingNotification","ChatMessageReadReceipt"],r=["MailboxRoamingSettings","MailboxItem","Mailbox","SearchQuery","ChannelMeetingTranscript","OnlineMeetingTranscript"],l=["Read","Create","ReadWrite","Delete","Manage","ReadBasic","ToggleIncomingAudio","Write","Allow","Send","AccessMedia","JoinGroupCalls","Detect","Stream","AccessSharedFolders","AppendOnSend"],o=["Group","Chat","User"];var d;!function(e){e.media="Media",e.geolocation="Geolocation",e.notifications="Notifications",e.midi="Midi",e.openExternal="OpenExternal"}(d||(d={}));const s={[d.media]:"extension_addAppDialogDeviceConsent",[d.geolocation]:"extension_addAppDialogLocationConsent",[d.notifications]:"extension_addAppDialogNotificationsConsent",[d.openExternal]:"extension_addAppDialogExternalLinkContent",[d.midi]:"extension_addAppDialogMIDIContent"},m=["bots","connectors","galleryTabs","messageExtensions","staticTabs"],c=["isFullScreenApp"],u=[{permissionKey:"app_details_basic_full_permission",extendedCapability:["galleryTabs","staticTabs","bots","messageExtensions"]},{permissionKey:"app_details_basic_bots_permission",extendedCapability:["bots"]},{permissionKey:"app_details_full_screen_permission",extendedCapability:["isFullScreenApp"]},{permissionKey:"app_details_identity_permission",extendedCapability:["galleryTabs","staticTabs","bots","messageExtensions"]}],p=[{permissionKey:"extension_addAppDialogTeamAndChatAndMeetingPermission1",extendedCapability:["galleryTabs","staticTabs","bots","messageExtensions"]},{permissionKey:"extension_addAppDialogTeamAndChatAndMeetingPermission2",extendedCapability:["bots","connectors"]},{permissionKey:"extension_addAppDialogIdentityTeamAndChatAndMeetingPermission",extendedCapability:["galleryTabs","staticTabs","bots","messageExtensions"]}],k=[{permissionKey:"app_details_chat_galleryTabs_bots_permission",extendedCapability:["galleryTabs","bots"]},{permissionKey:"app_details_chat_bots_permission",extendedCapability:["bots"]},{permissionKey:"app_details_identity_chat_permission",extendedCapability:["galleryTabs","bots"]}],g=[{permissionKey:"app_details_team_and_chat_full_permission",extendedCapability:["galleryTabs","staticTabs","bots","messageExtensions"]},{permissionKey:"app_details_team_and_chat_bots_connectors_permission",extendedCapability:["bots","connectors"]},{permissionKey:"app_details_identity_team_and_chat_permission",extendedCapability:["galleryTabs","staticTabs","bots","messageExtensions"]}];var N=i(17995);const v=(e,n,i)=>{const a=y(e),t=(0,N.qJ)(e)||(0,N.TJ)(e);let r=t?[]:I(a,e),l=[],o=[];const d=[];return e.webApplicationInfo?.applicationPermissions?.forEach((e=>{e&&d.push(e)})),e.authorization?.permissions?.resourceSpecific?.forEach((e=>{e?.name&&d.push(e.name)})),l=T(d,i,t),o=A(e,a),r=[...r,...l,...o],e.meetingExtensionDefinition?.supportsStreaming&&r.push("app_details_permission_meeting_streaming_access"),n&&(r.push("extension_addAppDialog_meetings_info_permissions"),r.push("extension_addAppDialog_meetings_mute_unmute_permissions")),r},I=(e,n)=>{const i=[],t=S(e,i);for(const e of[t])e(u),(0,a.Z1)("Team",n)&&(0,a.Z1)("GroupChat",n)?e(g):(0,a.Z1)("Team",n)?e(p):(0,a.Z1)("GroupChat",n)&&e(k);return i},S=(e,n)=>i=>{i.forEach(((i,a)=>{i.extendedCapability.some((n=>e.includes(n)))&&n.push(i.permissionKey)}))},A=(e,n)=>n.includes("staticTabs")||n.includes("galleryTabs")?[]:(e.devicePermissions??[])?.map((e=>s[e])),T=(e,n,i)=>{if(!e.length)return[];const a=new Set(e),l=[...h(t,a,n,f),...h(r,a,n,M)];return a.forEach((e=>l.push(e))),!i&&e?.length&&l.push("app_details_permission_teams_access"),l},f=(e,n,i)=>`app_details_permission_${e}_${n}_${i}`.toLocaleLowerCase(),M=(e,n,i)=>`app_details_permission_${e}_${n}_${i}`.toLocaleLowerCase(),h=(e,n,i,a)=>e.reduce(((e,t)=>(o.forEach((r=>{const o=[];if(l.forEach((e=>{const i=`${t}.${e}.${r}`;n.has(i)&&(o.push(e),n.delete(i))})),!o.length)return;const d=o.join("_"),s=a(t,d,r);i.translate("extensibility",s)!==s?e.push(s):o.forEach((n=>{const i=a(t,n,r);e.push(i)}))})),e)),[]),y=e=>[...m,...c].filter((n=>!!e[n]?.length))},17995:(e,n,i)=>{"use strict";i.d(n,{yP:()=>m,eO:()=>c,vx:()=>u,$W:()=>p,Tz:()=>k,Cu:()=>g,HY:()=>N,kq:()=>v,HL:()=>I,_E:()=>S,Ez:()=>w,G3:()=>L,FJ:()=>x,U5:()=>O,Ob:()=>P,mN:()=>V,qJ:()=>j,TJ:()=>B,y$:()=>z,NE:()=>R,sh:()=>Q,wQ:()=>W,Dm:()=>Y,vZ:()=>G,hj:()=>Z,W4:()=>_,ml:()=>H,Ho:()=>J,$P:()=>q,q0:()=>X,gE:()=>K,pb:()=>$,lj:()=>ee,dL:()=>ne,Nq:()=>ie,ND:()=>ae,$9:()=>te,K7:()=>oe,wZ:()=>de});var a=i(132097),t=i(403782),r=i(612781),l=i(46377),o=i(364819),d=i(937690),s=i(358726);const m=e=>!!e.externalId&&!e.tenantId,c=["bots","connectors","galleryTabs","messageExtensions","staticTabs"],u=(e,n)=>(0,o.some)(n,(n=>(0,o.includes)(n.scopes,e))),p=(e,n)=>!!n[e]?.length,k=(e,n,i)=>{if(!e)return!1;const a=n.toLowerCase();for(const n of e)if((!i||n.scopes?.includes(i))&&n.context?.some((e=>e?.toLowerCase()===a)))return!0;return!1},g=e=>{if(!e)return!1;for(const n of e)if(!n.context||0===n.context.length)return!0;return!1},N=(e,n)=>e.messageExtensions?.some((e=>e.commands?.some((e=>e.context?e.context.some((e=>e===n)):"Commandbox"===n||"Compose"))))??!1,v=e=>{const n=e?.bots?.[0]?.id;if(n){const e=n?.startsWith(l.gN.BotPrefix);return e?n:`${l.gN.BotPrefix}${n}`}},I=e=>{switch(e?.type){case d.ld.Team:return e.teamId;case d.ld.GroupChat:case d.ld.Meeting:return e.chatId;default:return}};const S=e=>!!e.meetingExtensionDefinition?.scenes&&e.meetingExtensionDefinition.scenes.length>0,A="https://player.vimeo.com/video/{vimeoId}",T="https://www.youtube.com/embed/{youtubeId}?&showinfo=0&rel=0&modestbranding=1",f="youtube.com/",M="youtu.be/",h="vimeo.com/",y=/^https?:\/\/(([0-9a-zA-Z.\-_+%]+\/?)*)(\?([0-9a-zA-Z.\-_+%]+=[0-9a-zA-Z.\-_+%]+)(\&[0-9a-zA-Z.\-_+%]+=[0-9a-zA-Z.\-_+%]+)*)?$/,F=1,b=3,C=/([0-9a-zA-Z.\-_+%]+)\/?$/,D=/\/embed\/([0-9a-zA-Z.\-_+%]+)/,U=/v=([0-9a-zA-Z.\-_+%]+)/,E=1;function w(e){let n="";if(!y.test(e))return n;const i=e.match(y);if(i&&i[F]){const e=i[F];if(D.test(e)){const i=e.match(D);i&&i[E]&&(n=T.replace("{youtubeId}",i[E]))}else if(e.includes(f)&&i[b]&&U.test(i[b])){const e=i[b].match(U);e&&e[E]&&(n=T.replace("{youtubeId}",e[E]))}else if(C.test(e)){const i=e.match(C);i&&i[E]&&(e.includes(M)?n=T.replace("{youtubeId}",i[E]):e.includes(h)&&(n=A.replace("{vimeoId}",i[E])))}}return n}const L=(e,n,i,r,l,s,m)=>async(c,u)=>{if(!c)return[];const k=(t,o,m,c)=>(0,a.Pe)(e,n,i,t,o,r,s,m,l({installType:d.ld.InContext,chatId:m}),void 0,c,!0);return Promise.all((0,o.map)(u,(async i=>{switch(i.installScope){case"Personal":return await(async(e,n,i,r,l)=>{if(!(p("messageExtensions",e)||(0,a.Z1)("Personal",e)||l&&S(e)))return!1;const d=await(0,a.HI)(n,i,r,!0,{shouldFetchPersonalApps:!0,entryPoint:t.gY.AppDetails});return!(0,o.some)(d,(n=>n.id===e.id&&"Personal"===n.installedScope))})(c,e,r,n,m)?k(c.id,"Personal"):null;case"GroupChat":case"Team":return(0,a.Z1)(i.installScope,c)?k(c.id,i.installScope,i.installChatOrTeamId,"app-details-data-context-provider-v1"):null;default:return null}})))},x=e=>s.Ee.includes(e.entryPoint)?e.teamId:e.chatId,O=e=>{const n=e.entryPoint,i=e.isTaosSharedApp,a=e,t=e,{icLaunchOptions:l,threadId:o}=e;let s;if(l&&n!==r.NS.InContextStorePersonal){const{teamId:e}=l;s=n===r.NS.MEInContextStoreGroupChat||n===r.NS.TabsInContextStoreGroupChat||n===r.NS.BotsInContextStoreGroupChat?{chatId:o}:t.templatedAppId?{teamId:e,channelId:o}:{teamId:o}}return e.entryPoint===r.NS.DeepLinkSideLoad?{appType:d.uC.DeepLinkSideload,entryPoint:n,appId:e.appId}:e.entryPoint===r.NS.DeepLinkTrustedSideLoad?{appType:d.uC.TrustedSideload,entryPoint:n,templatedAppId:e.appId,templateInstanceId:e.templateInstanceId,environment:e.environment}:a.manifestFile?{appType:d.uC.Sideload,entryPoint:n,manifestURL:a.manifestFile,chatId:e.chatId,teamId:e.teamId,channelId:e.channelId}:t.templatedAppId?{...s,appType:d.uC.TrustedSideload,entryPoint:n,templatedAppId:t.templatedAppId,templateInstanceId:e.appId,environment:t.environment}:e.entryPoint===r.NS.DeepLink&&e.templateInstanceId&&e.appId?{appType:d.uC.TrustedSideload,entryPoint:n,templatedAppId:e.appId,templateInstanceId:e.templateInstanceId,environment:e.environment}:s?{...s,entryPoint:n,appType:d.uC.Normal,appId:e.appId}:{appType:d.uC.Normal,entryPoint:n,appId:e.appId,teamId:e.teamId,chatId:e.chatId,channelId:e.channelId,isTaosSharedApp:i,isAppEnableRequired:e.isAppEnableRequired}},P=()=>{throw new Error("Not implemented")},V=(e,n,i)=>{const a=i===d.ld.Meeting;let t;return t="Team"===n?a?"ChannelMeeting":"Team":"GroupChat"===n?a?"Meeting":"GroupChat":"Personal",e.appDetailsExclusionList?.[t]},j=e=>!!e.exchangeAddInElement,B=e=>!!e.officeAddInElement,z=e=>!(!e||!e.metaCapabilities||!e.metaCapabilities.copilotPlugins&&!e.metaCapabilities.copilotExtensions),R=e=>!!e?.metaCapabilities?.declarativeCopilots,Q=e=>!!e?.metaCapabilities?.customEngineCopilots,W=e=>(e=>{const n=!!e&&!!e.metaCapabilities,i=n&&!e.metaCapabilities.copilotPlugins,a=n&&!!e.metaCapabilities.copilotExtensions;return i&&a||R(e)})(e)?"launchcopilotextension":"launchcopilotplugin",Y=e=>(0,a.Z1)("Personal",e)||j(e)||B(e)||p("extensions",e),G=(e,n)=>!n&&z(e)&&!R(e)&&u("Personal",e.bots)&&!e?.bots?.[0]?.capabilities?.isNotificationOnly,Z=(e,n)=>z(e)&&(!Y(e)||!n)&&(!(u("Personal",e.bots)&&!e?.bots?.[0]?.capabilities?.isNotificationOnly)||R(e)),_=(e,n)=>!!(n?.bots&&e?.bots&&n.bots.length>e.bots.length),H=(e,n)=>{if(n.bots&&e.bots){const i=(0,o.difference)(n.bots[0]?.scopes,e.bots[0]?.scopes?e.bots[0]?.scopes:[]);return e.bots[0]?.id!==n.bots[0]?.id||!(0,o.isEmpty)(i)}return!1},J=(e,n)=>!(!n.bots||!e.bots||e.bots[0]?.capabilities?.supportsFiles===n.bots[0]?.capabilities?.supportsFiles)&&!!n.bots[0]?.capabilities?.supportsFiles,q=(e,n)=>!(!n.bots||!e.bots||e.bots[0]?.capabilities?.supportsCalling===n.bots[0]?.capabilities?.supportsCalling)&&!!n.bots[0]?.capabilities?.supportsCalling,X=(e,n)=>!(!n.bots||!e.bots||e.bots[0]?.capabilities?.supportsVideo===n.bots[0]?.capabilities?.supportsVideo)&&!!n.bots[0]?.capabilities?.supportsVideo,K=(e,n)=>!(e.webApplicationInfo?.id===n.webApplicationInfo?.id),$=(e,n)=>!!(n.messageExtensions&&e.messageExtensions&&n.messageExtensions.length>e.messageExtensions.length),ee=(e,n,i,a)=>!!a&&"upgradeFlow"===i.type&&(((e,n)=>!(!e||!n)&&(_(n,e)||H(n,e)||q(n,e)||X(n,e)||J(n,e)||$(n,e)||K(n,e)))(e,n)||!!i.newKeys.length),ne=e=>u("Team",e.galleryTabs)&&(k(e.galleryTabs,"ChannelTab")||g(e.galleryTabs)),ie=e=>u("Team",e.staticTabs)&&(k(e.staticTabs,"ChannelTab")||k(e.staticTabs,"TeamLevelApp")||g(e.staticTabs)),ae=e=>u("GroupChat",e.galleryTabs)&&(k(e.galleryTabs,"PrivateChatTab")||g(e.galleryTabs)),te=e=>u("GroupChat",e.staticTabs)&&(k(e.staticTabs,"PrivateChatTab")||g(e.staticTabs)),re=(e,n)=>{switch(n){case"Team":return ne(e);case"GroupChat":return(e=>u("GroupChat",e.galleryTabs)&&(k(e.galleryTabs,"PrivateChatTab")||k(e.galleryTabs,"MeetingStage")||k(e.galleryTabs,"MeetingSidePanel")||g(e.galleryTabs)))(e);default:return u(n,e.galleryTabs)}},le=(e,n)=>{switch(n){case"Team":return ie(e);case"GroupChat":return(e=>u("GroupChat",e.staticTabs))(e);default:return u(n,e.staticTabs)}},oe=(e,n,i,a)=>{let t=u(n,e.bots)&&!i?.bots||u(n,e.connectors)&&!i?.connectors||re(e,n)&&!i?.galleryTabs||le(e,n)&&!i?.staticTabs;if("Team"===n)return t;if(t||(t=u(n,e.messageExtensions)&&!i?.messageExtensions),"Personal"!==n)return t;const r=(e.meetingExtensionDefinition?.scenes?.length??0)>0,l=(e.meetingExtensionDefinition?.filters?.length??0)>0,o=j(e),d=B(e),s=p("extensions",e),m=!a&&z(e);return t||r||l||o||d||s||m},de=e=>{if(!e)return"";if((0,o.startsWith)(e,"com.microsoft"))return e;return/^([a-zA-Z]_)?[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i.test(e)||/^[w|W][a|A][0-9]+$/i.test(e)?e:`${e[0]}${new Array(e.length).join("*")}`}},937690:(e,n,i)=>{"use strict";var a,t,r,l,o,d,s;i.d(n,{uC:()=>a,Rh:()=>t,Q8:()=>r,ld:()=>l,Vb:()=>o,EU:()=>d,Bp:()=>s}),function(e){e[e.Normal=1]="Normal",e[e.Sideload=2]="Sideload",e[e.TrustedSideload=3]="TrustedSideload",e[e.DeepLinkSideload=4]="DeepLinkSideload"}(a||(a={})),function(e){e[e.About=0]="About",e[e.Permission=1]="Permission"}(t||(t={})),function(e){e.Overview="Overview",e.Features="Features",e.Reviews="Reviews",e.Permissions="Permissions",e.DiscoverMoreApps="DiscoverMoreApps",e.WhatsNew="WhatsNew"}(r||(r={})),function(e){e.InContext="InContext",e.Contextless="Contextless",e.Update="Update",e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meeting="Meeting",e.RequestAccess="RequestAccess"}(l||(l={})),function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning"}(o||(o={})),function(e){e.NoTeamScope="NoTeamScope",e.NoChatScope="NoChatScope",e.NoAccess="NoAccess",e.NoCopilotLicense="NoCopilotLicense",e.HasPermissionError="HasPermissionError",e.SideLoadNonPreviewAudience="SideLoadNonPreviewAudience",e.SideLoadPublicOffer="SideLoadPublicOffer",e.SideLoadPurchase="SideLoadPurchase",e.NoAccessWithAdminRequestConfig="NoAccessWithAdminRequestConfig",e.RequestedAccessWithAdminRequestConfig="RequestedAccessWithAdminRequestConfig",e.DisabledInstallScopes="DisabledInstallScopes",e.SideloadDebugging="SideloadDebugging"}(d||(d={})),function(e){e[e.NoBuySubscription=1]="NoBuySubscription",e[e.BuySubscriptionWithNoWarning=2]="BuySubscriptionWithNoWarning",e[e.BuySubscriptionWithLoadingIcon=3]="BuySubscriptionWithLoadingIcon",e[e.BuySubscriptionWithWarningPublicOffer=4]="BuySubscriptionWithWarningPublicOffer",e[e.BuySubscriptionWithWarningPreviewOfferNotFound=5]="BuySubscriptionWithWarningPreviewOfferNotFound",e[e.BuySubscriptionWithWarningPurchase=6]="BuySubscriptionWithWarningPurchase"}(s||(s={}))},358726:(e,n,i)=>{"use strict";i.d(n,{PJ:()=>t,Qt:()=>r,em:()=>l,m7:()=>o,R:()=>d,V2:()=>s,Z1:()=>m,Ee:()=>c,mo:()=>u,Of:()=>p,Wb:()=>k,c8:()=>g,$_:()=>N,Q5:()=>v,wP:()=>I,no:()=>S});var a=i(612781);const t="APP_DETAILS_DIALOG_ROOT_ID",r=["Installed","InstalledAndFavorited","InstalledAndPermanent","AdminPreInstalled","RequireConsent"],l=5,o={widthBreakpoint:"900px",heightBreakpoint:"720px"},d={imageWidth:90,imageHeight:50.60029282576867,imageNarrowWidth:60,imageNarrowHeight:33.733528550512446},s=[[[a.NS.TabsInContextStoreTeam,a.NS.BotsInContextStoreTeam,a.NS.AppSuggestionInEmptyChannel,a.NS.AtMentionDirectInstallationFromTeam,a.NS.ConnectorManagementDialog,a.NS.InContextGalleryDialogFromChannel,a.NS.InContextGalleryDialogMoreAppsFromChannel,a.NS.MeetingFromTeam,a.NS.MeetingFromChannel,a.NS.MeetingAppsFlyoutFromChannel,a.NS.ReactMessageExtensionFlyoutFromChannel,a.NS.PlatformTabButtonTeam,a.NS.ExtensibilityAppPickerFlyoutTeam,a.NS.ExtensibilityAppPickerSidePanelTeam],["Personal","Team"]],[[a.NS.TabsInContextStoreGroupChat,a.NS.BotsInContextStoreGroupChat,a.NS.AtMentionDirectInstallationFromGroupChat,a.NS.InContextGalleryDialogFromGroupChat,a.NS.InContextGalleryDialogMoreAppsFromGroupChat,a.NS.MeetingFromGroupchat,a.NS.Meeting,a.NS.MeetingFromDeepLink,a.NS.MeetingAppsFlyout,a.NS.ExtensibilityAppPickerSidePanelGroupChat,a.NS.ExtensibilityAppPickerFlyoutGroupChat,a.NS.PlatformTabButtonGroupChat],["Personal","GroupChat"]],[[a.NS.InContextStorePersonal,a.NS.MEInContextStoreGroupChat,a.NS.MEInContextStoreTeam,a.NS.MessagingExtensionFlyoutV2,a.NS.MessageExtensionFlyout,a.NS.MessageExtensionFlyoutSuggestedCollection,a.NS.ScenePicker,a.NS.JITInstallCardAction,a.NS.CardHeaderInstallAction,a.NS.JITInstallTaskModule,a.NS.ProactiveMessageForBots,a.NS.PlatformAppConsentDialog,a.NS.CopilotInContextGroupChat,a.NS.CopilotInContextMeeting,a.NS.ExtensibilityAppPickerSidePanelPersonal,a.NS.ExtensibilityAppPickerFlyoutPersonal],["Personal"]]],m=[[[a.NS.AppsManagementTabFromTeamSideload,a.NS.TabsInContextStoreTeam,a.NS.BotsInContextStoreTeam],["Personal","Team"]],[[a.NS.AppsManagementTabFromGroupChatSideload,a.NS.TabsInContextStoreGroupChat,a.NS.BotsInContextStoreGroupChat],["Personal","GroupChat"]],[[a.NS.MessagingExtensionFlyoutV2],["Personal"]]],c=[...s[0][0],...m[0][0]],u=(s[1][0],m[1][0],[[s[0][0],["Team"]],[s[1][0],["GroupChat"]],[s[2][0],["Personal"]]]),p=[[m[0][0],["Team"]],[m[1][0],["GroupChat"]],[m[2][0],["Personal"]]],k=[a.NS.PersonalAppBannerUpgrade,a.NS.NewMessageUpgrade,a.NS.AppsManagementTabUpgrade,a.NS.ChannelInfoPaneAppWidgetUpgrade,a.NS.GroupChatAppsManagementUpgrade,a.NS.ManageAppsInstalledAppUpgrade,a.NS.UrlPersonalUpgrade,a.NS.TeamAppBannerUpgrade,a.NS.GroupChatAppBannerUpgrade],g=[a.NS.AtMentionDirectInstallationFromGroupChat,a.NS.InContextGalleryDialogFromGroupChat],N=[a.NS.AtMentionDirectInstallationFromTeam,a.NS.InContextGalleryDialogFromChannel],v=[a.NS.PersonalAppAbout,a.NS.GroupChatAppsManagementView],I=[a.NS.AppsManagementTabView,a.NS.ChannelInfoPaneAppWidgetView],S=[a.NS.AppsManagementTabView]},675784:(e,n,i)=>{"use strict";i.d(n,{QL:()=>g,dX:()=>v,wM:()=>k});var a=i(513432);const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"chatWithUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chatWithUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}},{kind:"Field",name:{kind:"Name",value:"memberIds"}}]}}]}}]},r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"sendMessage"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"message"}},type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"action"}},type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageAction"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendMessage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"message"},value:{kind:"Variable",name:{kind:"Name",value:"message"}}},{kind:"Argument",name:{kind:"Name",value:"action"},value:{kind:"Variable",name:{kind:"Name",value:"action"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"fireCallingIntent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntentInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fireCallingIntent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntent"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var o=i(325759),d=i(332752),s=i(727780),m=i(277362),c=i(127066),u=i(46377),p=i(194649);const k=(e,n,i)=>{const{enableCentralizedCommandingForEV:t}=(0,c.w2)(d.w.Host,["enableCentralizedCommandingForEV"]),{enablePlatformNavigationForBots:r}=(0,c.w2)(d.w.Extensibility,["enablePlatformNavigationForBots"]);return a.useMemo((()=>({sendMessage:N(n,i),startChat:v(e,n,!!r,i),startCall:I(e,n,i,!!t)})),[e,n,i,t,r])},g=async(e,n)=>{const{data:i}=await e.query({query:t,variables:{userId:n},fetchPolicy:"network-only"});return i?.chatWithUser},N=(e,n)=>async(i,a,t)=>{try{const n=await g(e,i);if(!n)throw new Error(`Could not fetch the user conversation using the mri ${i}`);const l={convId:n.id,message:{content:a,clientMessageId:(0,o.sN)(),messageType:u.Go.Text},action:"Create"};await e.mutate({mutation:r,variables:l}),t.stop()}catch{const e=`Error while sending quick message with mri ${i}`;n.error(e),t?.fail({message:e})}},v=(e,n,i,a)=>async(t,r)=>{try{if(!t)throw new Error("No mri provided");const a=await g(n,t);if(a&&a.id){(0,p.Iz)(t)&&i?e.platform.platformTabById(JSON.stringify({appId:t,threadId:a.id,tabEntityId:"conversations"}),{stateTransition:s.Ar.new,visibilityState:s.Rp.show,correlation:{source:m.p.AppProfileCard}}):e.chat.chatById(a.id,{entityCommand:{stateTransition:s.Ar.new,visibilityState:s.Rp.show,correlation:{source:m.p.AppProfileCard}}})}else e.chat.chatWithUsers({userIds:[t],entityCommand:{stateTransition:s.Ar.new,visibilityState:s.Rp.show,correlation:{source:m.p.AppProfileCard}}});r?.stop()}catch{const e=`Error while we execute start chat with mri ${t}`;a?.error(e),r?.fail({message:e})}},I=(e,n,i,a)=>async(t,r,o)=>{try{if(!t)throw new Error(`Could not get the user mri ${t} from the persona identifier `);const i=(async(e,n,i=!1)=>{const a={callingIntent:{type:"OneToOneCall",joinOptions:{outgoingVideo:i,outgoingAudio:!0,oneToOne:{sharingSourceId:void 0}},coordinates:{oneToOne:{mri:n}}}},{data:t}=await e.mutate({mutation:l,variables:a});return t?.fireCallingIntent?.id})(n,t,r),d=g(n,t),[c,u]=await Promise.all([i,d]);if(!c)throw new Error(`Could not fetch the user calling IntentId using the mri ${t}`);const p=u?.id;a||e.call.callById(c,{stateTransition:s.Ar.new,visibilityState:s.Rp.show,correlation:{source:m.p.AppProfileCard}},p),o.stop()}catch{const e=`Error while StartCall using the mri ${t}`;i.error(e),o.fail({message:e})}}},725087:(e,n,i)=>{"use strict";i.d(n,{y:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appDefinition"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinition"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}}]}},...i(292992).h.definitions]}},953186:(e,n,i)=>{"use strict";i.d(n,{T:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appDefinitions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinitions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}}]}},...i(292992).h.definitions]}},404355:(e,n,i)=>{"use strict";i.d(n,{qn:()=>a,e6:()=>l,bf:()=>o,xK:()=>d,ag:()=>s,Q4:()=>m,c5:()=>c,$R:()=>u,yq:()=>p,dU:()=>k,pJ:()=>g,oD:()=>N,Wl:()=>v,GD:()=>S,v8:()=>A,ZQ:()=>T,kp:()=>f,Cn:()=>M,WX:()=>h,td:()=>y,LY:()=>F,zh:()=>D,TW:()=>E});var a,t=i(403782),r=i(364819);!function(e){e.Bot="Bot",e.Connector="Connector",e.Messaging="Messaging",e.StaticTabs="StaticTabs",e.GalleryTab="GalleryTab"}(a||(a={}));const l=e=>!!e&&b(e,["Installed","InstalledAndFavorited","InstalledAndPermanent","AdminPreInstalled"]),o=e=>C(e,["Installed","InstalledAndFavorited","InstalledAndPermanent","AdminPreInstalled"]),d=e=>"InstalledApp"===e?.__typename&&!(0,r.isUndefined)(e?.definition),s=e=>!!e&&b(e,["InstalledAndPermanent"]),m=e=>!!e&&b(e,["Featured"]),c=e=>!!e&&b(e,["PreConsented"]),u=e=>C(e,["PreConsented"]),p=e=>b(e,["RequireConsent"]),k=e=>C(e,["RequireConsent"]),g=e=>b(e,["NotInstalled"]),N=e=>e&&(v(e.definition,a.Bot,"Personal")||v(e.definition,a.StaticTabs,"Personal"))||!1,v=(e,n,i)=>{if(!e)return!1;switch(n){case a.Bot:return e.bots&&(0,r.first)(e.bots)&&(0,r.includes)(e.bots[0].scopes,i)||!1;case a.StaticTabs:return e.staticTabs&&(0,r.first)(e.staticTabs)&&(0,r.includes)(e.staticTabs[0].scopes,i)||!1;default:return!1}},I=(e,n)=>e.installedScope&&e.installedScope.includes(n),S=e=>l(e)&&I(e,"Personal"),A=(e,n=!1)=>{const i=m(e)||l(e)&&(I(e,"GroupChat")||I(e,"Team"));return n?i||c(e):i},T=e=>!g(e)&&"Team"===e.installedScope&&"Enabled"===e.statusInfo?.status,f=e=>!g(e)&&"Team"===e.installedScope&&"Disabled"===e.statusInfo?.status,M=e=>l(e)&&(I(e,"GroupChat")||I(e,"Team")),h=e=>{const n=e.data&&e.data.installApp;return!!n&&"InstalledApp"===n.__typename},y=e=>{const n=e.data&&e.data.installCustomApp;return!!n&&"InstalledApp"===n.__typename},F=e=>{const n=e.data&&e.data.upgradeApp;return!!n&&"InstalledApp"===n.__typename},b=(e,n)=>(0,r.includes)(n,e.installationState),C=(e,n)=>(0,r.includes)(n,e),D=e=>{let n="",i="";if(e&&e.length>0){const a=e.indexOf(t.fc.statusKey),r=e.indexOf(t.fc.errorCodeKey);n=a>-1?`Http status code: ${U(e.substr(a),t.fc.statusKey)}`:`Http status code: ${t.bF}`,i=r>-1?`Error code: ${U(e.substr(r),t.fc.errorCodeKey)}`:`Error code: ${t.kb.NoSpecificErrorMessageFound}`}return`${n}, ${i}`},U=(e,n)=>{const i=e.length>0?e.split(","):[];if(i.length>0){const e=i[0].replace(/[\\"'{}\s]/g,"").split(":");if(e.length>1&&(n===t.fc.statusKey&&e[1]in t.kG||n===t.fc.errorCodeKey&&e[1]in t.kb))return e[1]}return n===t.fc.statusKey?t.bF:t.kb.NoSpecificErrorMessageFound},E=()=>`${`Http status code: ${t.bF}`}, ${`Error code: ${t.kb.NoSpecificErrorMessageFound}`}`},403782:(e,n,i)=>{"use strict";var a,t;i.d(n,{kb:()=>a,kG:()=>t,bF:()=>r,fc:()=>l,gY:()=>o}),function(e){e.NoSpecificErrorMessageFound="NoSpecificErrorMessageFound",e.Unknown="Unknown",e.Unauthorized="Unauthorized",e.AccessDenied="AccessDenied",e.BadRequest="BadRequest",e.NotFound="NotFound",e.AppScopeIsNotAllowed="AppScopeIsNotAllowed",e.AppIsNotInstalledInTheChat="AppIsNotInstalledInTheChat",e.AppIsNotInstalledInTheTeam="AppIsNotInstalledInTheTeam",e.AppIsNotActivelyInstalled="AppIsNotActivelyInstalled",e.AppIsBlockedByAppPermissionPolicy="AppIsBlockedByAppPermissionPolicy",e.UnknownFailureToParseTeamsAppManifest="UnknownFailureToParseTeamsAppManifest",e.UnableToParseTeamsAppManifest="UnableToParseTeamsAppManifest",e.AppSideloadingForbidden="AppSideloadingForbidden",e.CreateGroupChatAppDefinitionFailed="CreateGroupChatAppDefinitionFailed",e.AppDefinitionAlreadyExists="AppDefinitionAlreadyExists",e.AppDefinitionDoesntExist="AppDefinitionDoesntExist",e.UpdateGroupChatAppDefinitionFailed="UpdateGroupChatAppDefinitionFailed",e.GetAppDefinitionFailed="GetAppDefinitionFailed",e.GetGlobalAppDefinitionsFailed="GetGlobalAppDefinitionsFailed",e.AppDefinitionUpdateNotPermitted="AppDefinitionUpdateNotPermitted",e.AppEntitlementAlreadyExists="AppEntitlementAlreadyExists",e.CreateGroupChatAppEntitlementFailed="CreateGroupChatAppEntitlementFailed",e.CreateTeamAppEntitlementFailed="CreateTeamAppEntitlementFailed",e.GroupChatEntitlementDoesntExist="GroupChatEntitlementDoesntExist",e.TeamAppEntitlementsDontExist="TeamAppEntitlementsDontExist",e.UserAppEntitlementsDontExist="UserAppEntitlementsDontExist",e.TenantAppEntitlementsDontExist="TenantAppEntitlementsDontExist",e.UpgradeTeamAppEntitlementFailed="UpgradeTeamAppEntitlementFailed",e.UpgradeUserAppEntitlementFailed="UpgradeUserAppEntitlementFailed",e.UpgradeGroupChatAppEntitlementFailed="UpgradeGroupChatAppEntitlementFailed",e.GetUserEntitlementsFailed="GetUserEntitlementsFailed",e.GetDefaultUserAppEntitlementsFailed="GetDefaultUserAppEntitlementsFailed",e.SetUserAppEntitlementFailed="SetUserAppEntitlementFailed",e.PermanentAppEntitlementUpdateNotAllowed="PermanentAppEntitlementUpdateNotAllowed",e.GetUserAggregatedAppsFailed="GetUserAggregatedAppsFailed",e.TemplatedAppNotAllowedByTenantSettings="TemplatedAppNotAllowedByTenantSettings",e.TemplatedAppNotAllowedByUserPermissionPolicy="TemplatedAppNotAllowedByUserPermissionPolicy",e.TemplatedInstanceAppNotAllowed="TemplatedInstanceAppNotAllowed",e.GetTeamThreadFailed="GetTeamThreadFailed",e.GetTeamThreadsFailed="GetTeamThreadsFailed",e.GetChatThreadFailed="GetChatThreadFailed",e.GetTenantSettingsFailed="GetTenantSettingsFailed",e.NoPermissionToInstallApp="NoPermissionToInstallApp",e.NoPermissionToUpgradeApp="NoPermissionToUpgradeApp",e.NoPermissionToUploadCustomApp="NoPermissionToUploadCustomApp",e.FailedToCheckPermissionToManageApp="FailedToCheckPermissionToManageApp",e.AppIsTenantAdminBlocked="AppIsTenantAdminBlocked",e.AppUploadNotAllowedByTenant="AppUploadNotAllowedByTenant",e.AppUpdateNotAllowedByTenant="AppUpdateNotAllowedByTenant",e.UserNotAuthorizedToPerformAppOperationOnGroupChat="UserNotAuthorizedToPerformAppOperationOnGroupChat",e.AddAppBotToChatRosterFailed="AddAppBotToChatRosterFailed",e.AddAppBotToTeamRosterFailed="AddAppBotToTeamRosterFailed",e.AddBotToRosterFailedMaxLimitReached="AddBotToRosterFailedMaxLimitReached",e.UserNotFoundInSkypeTeam="UserNotFoundInSkypeTeam",e.BotIdFormatIsIncorrect="BotIdFormatIsIncorrect",e.GuestNotAllowedToInstallApps="GuestNotAllowedToInstallApps",e.GuestNotAllowedToUpdateApps="GuestNotAllowedToUpdateApps",e.GuestNotAllowedToUpgradeApps="GuestNotAllowedToUpgradeApps",e.OperationNotAllowedOnInstalledAndDeprecatedApp="OperationNotAllowedOnInstalledAndDeprecatedApp",e.AnonymousUsersInteractionNotSupported="AnonymousUsersInteractionNotSupported",e.GetUserAppSetupPoliciesAsync="GetUserAppSetupPoliciesAsync",e.InvalidHostedAppOperationForbidden="InvalidHostedAppOperationForbidden",e.OperationNotAllowedOnArchivedTeam="OperationNotAllowedOnArchivedTeam",e.ClientNetworkOffline="ClientNetworkOffline"}(a||(a={})),function(e){e[e.OK=200]="OK",e[e.CREATED=201]="CREATED",e[e.ACCEPTED=202]="ACCEPTED",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.NOT_ALLOWED=405]="NOT_ALLOWED",e[e.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",e[e.CONFLICT=409]="CONFLICT",e[e.GONE=410]="GONE",e[e.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",e[e.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",e[e.REQUEST_ENTITY_TOO_LARGE=413]="REQUEST_ENTITY_TOO_LARGE",e[e.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",e[e.REQUEST_RANGE_NOT_SATISFIABLE=416]="REQUEST_RANGE_NOT_SATISFIABLE",e[e.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.THROTTLED=429]="THROTTLED",e[e.SERVER_ERROR=500]="SERVER_ERROR",e[e.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",e[e.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",e[e.BANDWIDTH_LIMIT_EXCEEDED=509]="BANDWIDTH_LIMIT_EXCEEDED"}(t||(t={}));const r="NoHttpStatusCode",l={statusKey:"status",errorCodeKey:"errorCode"};var o;!function(e){e[e.BotInputMenu=1]="BotInputMenu",e[e.BotMentions=2]="BotMentions",e[e.MessageExtension=3]="MessageExtension",e[e.MessageAction=4]="MessageAction",e[e.LinkUnfurling=5]="LinkUnfurling",e[e.Webhooks=6]="Webhooks",e[e.BotCards=7]="BotCards",e[e.ChatPane=8]="ChatPane",e[e.MeetingAppNotifications=9]="MeetingAppNotifications",e[e.AppDetails=10]="AppDetails",e[e.TcPickerNavigation=11]="TcPickerNavigation",e[e.Scenes=12]="Scenes",e[e.CallEscalation=13]="CallEscalation",e[e.VivaFeedback=14]="VivaFeedback",e[e.InContextStore=15]="InContextStore",e[e.MeetingAppsFlyout=16]="MeetingAppsFlyout",e[e.AppsFlyout=17]="AppsFlyout",e[e.FreDialog=18]="FreDialog",e[e.Compose=19]="Compose",e[e.Connectors=20]="Connectors",e[e.PreviewCardFooter=21]="PreviewCardFooter",e[e.ACV2CardJITInstall=22]="ACV2CardJITInstall",e[e.MessageExtensionCardFooter=23]="MessageExtensionCardFooter",e[e.TaskModule=24]="TaskModule",e[e.MessageExtensionFlyoutCommand=25]="MessageExtensionFlyoutCommand",e[e.MessageExtensionFlyoutCommandPostInstall=26]="MessageExtensionFlyoutCommandPostInstall",e[e.GetFetchCommandApps=27]="GetFetchCommandApps",e[e.PinnedMessageExtensions=28]="PinnedMessageExtensions",e[e.ChatRoster=29]="ChatRoster",e[e.NewChat=30]="NewChat"}(o||(o={}))},132097:(e,n,i)=>{"use strict";i.d(n,{N6:()=>X,vx:()=>q,Z1:()=>J,NM:()=>Q,at:()=>E,pW:()=>w,xR:()=>C,a:()=>D,KC:()=>U,S:()=>j,oD:()=>P,vc:()=>b,tN:()=>W,i4:()=>O,Y3:()=>G,M9:()=>x,HI:()=>Y,Pe:()=>M,gF:()=>B,c2:()=>y});var a=i(364819),t=i(812228),r=i(802756),l=i(355515),o=i(34655),d=i(404355),s=i(953186),m=i(725087);const c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appImpressions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"impressionProperty"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appImpressions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"impressionProperty"},value:{kind:"Variable",name:{kind:"Name",value:"impressionProperty"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"count"}}]}}]}}]};var u=i(70887);const p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"installApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installParameters"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallParametersInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installScope"},value:{kind:"Variable",name:{kind:"Name",value:"installScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"installParameters"},value:{kind:"Variable",name:{kind:"Name",value:"installParameters"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...u.B.definitions]},k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"upgradeApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"upgradeApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installScope"},value:{kind:"Variable",name:{kind:"Name",value:"installScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...u.B.definitions]},g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"deleteApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"deleteParameters"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppDeleteParametersInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScope"},value:{kind:"Variable",name:{kind:"Name",value:"installedScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"deleteParameters"},value:{kind:"Variable",name:{kind:"Name",value:"deleteParameters"}}}]}]}}]};var N=i(455182),v=i(557555),I=i(491722),S=i(403782),A=i(747199),T=i(334878),f=i(355552);const M=(e,n,i,a,t,r,l,o,s,m,c,u)=>{const k={installScope:t,appId:a,conversationId:o,installParameters:m||u?{isCopilotPlugin:m,hasAppEnableConsent:u}:void 0},g=n.newScenario(i);return g.appendEventData({"Thread.Id":o,"App.Id":a}),s&&g.appendEventData(s),X(g,o),e.mutate({mutation:p,variables:k,update:h(e,k,r,l),context:{callerInfo:c}}).then((e=>{if(!(0,d.WX)(e)||!e.data?.installApp?.definition)throw new Error("unexpected response, install app failed");return g.stop(),e.data.installApp})).catch((e=>{const n=e&&e.message?(0,d.zh)(e.message):(0,d.TW)();throw n.includes(S.kb.ClientNetworkOffline)?g.cancel({errors:n}):g.fail({errors:n}),e}))},h=(e,{installScope:n,conversationId:i},a,t)=>(r,l)=>{try{const r=(0,d.WX)(l)&&l.data;r&&r.installApp?(0,N.Cg)({client:e,installedScope:n,conversationId:i,logger:a,enableAppsQueryOptimization:t},r.installApp):a.error("mutation update, install app failed")}catch(e){a.error("Failed to add app to client cache")}},y=(e,n,i,a,t,r,l,o,s)=>{const m={installScope:t,appId:a,conversationId:o},c=n.newScenario(i);return e.mutate({mutation:k,variables:m,update:F(e,m,r,l)}).then((e=>{if(!(0,d.LY)(e)||!e.data?.upgradeApp?.definition)throw new Error("unexpected response, upgrade app failed");return s?c.stop(s):c.stop(),e.data.upgradeApp})).catch((e=>{const n=e&&e.message?(0,d.zh)(e.message):(0,d.TW)();throw s?c.fail({...s,errors:n}):c.fail({errors:n}),e}))},F=(e,{installScope:n,conversationId:i},a,t)=>(r,l)=>{try{const r=(0,d.LY)(l)&&l.data;r&&r.upgradeApp?(0,N.Cg)({client:e,installedScope:n,conversationId:i,logger:a,enableAppsQueryOptimization:t},r.upgradeApp):a.error("mutation update, upgrade app failed")}catch(e){a.error("Failed to add app to client cache")}},b=async(e,n,i,a)=>{const t=["Personal"],l=a?.conversation,o={installedScopes:l?[...t,l.scope]:t,conversationId:l&&l.id,options:{capabilityFilter:a?.capabilityFilter}},d=n.newScenario(r.Cu.ExtInstalledApps);try{const n=await(0,A.hX)(e,o,"no-cache");d.mark(r.BQ.ExtAppsFetched);const a=n?.filter((e=>e&&e.definition&&e.id===i));return d.mark(r.BQ.ExtAppsProcessed),d.stop(),a}catch(e){return d.fail({errors:`failed to get installed app id: ${i}`}),[]}},C=async(e,n,i,a,t,r)=>{let d;i&&(d=a||"GroupChat");const{data:s,error:c}=await e.query({query:m.y,variables:{appId:n,scope:d,conversationId:i,options:{allowBlockedApps:r}},context:{callerInfo:`${t}-getAppDefinition`}});if(!s||!s.appDefinition||c){const e="Get AppDefinition failed";throw(0,l.$5)("AppsHelper",o.O4.NotPresent,"getAppDefinition",void 0,c?.message??e)}return s.appDefinition},D=async(e,n,i,a,t)=>{const{data:r,error:l}=await e.query({query:s.T,variables:n,context:{callerInfo:i}});if(!r||!r.appDefinitions){const e="Get AppDefinitions failed";if(t){t(`Fail to get App definitions, error message: ${l?.message}`)}throw new Error(e)}return a&&a(),r.appDefinitions},U=async(e,n,i,a)=>{const t=await D(e,{options:{capabilityFilter:["Messaging"]},conversationId:i,scope:a},"getAppDefinitionsByContext");return E(t,n)},E=(e,n)=>e.filter((e=>L(e,n))),w=(e,n,i,t,r,l)=>{if((0,a.isEmpty)(e))return e;if((0,a.isEmpty)(n))return[];let o=e.filter((e=>!!e&&!!e.name?.toLocaleLowerCase().includes(n?.toLocaleLowerCase())));if(i&&t&&(o=o.filter((e=>!!e&&!(0,a.includes)(e.blockedConfigurations,f.H.Federation))),r)){const e=l.map((e=>e.id));o=o.filter((n=>!!n&&(0,a.includes)(e,n.id)))}return o},L=(e,n)=>{if(!n)return!0;const i=e.messageExtensions??[];if(!(0,a.isEmpty)(i))for(const e of i)if((0,a.some)(e.commands,(e=>(0,I.kS)(e,n))))return!0;return!1},x=async e=>{const{client:n,logger:i,scenarioFactory:a,enableInstalledAppsV2:t,enableAppsQueryOptimization:r,entryPoint:l,isOneOnOneBotChat:o,scope:d,convId:s,botId:m}=e;let c={};s&&(c={conversation:o?void 0:{scope:d||"GroupChat",id:s},capabilityFilter:["Bot"],shouldFetchPersonalApps:o,botId:m,entryPoint:l});const u=t?await Y(n,i,a,r,c,void 0):await V(n,i,a,c);if(t&&m){const e=u?.filter((e=>e.definition?.bots?.[0]?.id===m));return e}return u},O=async(e,n,i,a,t,r,l,o)=>a?await Y(e,n,i,t,r,l,void 0,void 0,o):await V(e,n,i,r,l),P=async(e,n,i,a)=>{const t=i.newScenario(r.Cu.ExtGetSimpleAppModel);try{const n=await(0,A.Az)(e,a??"cache-only");return t.stop(),n}catch(e){const i="getAppInstalledByCurrentUser failed";return t.fail({errors:i}),n.warn(`${i} ${e}`),[]}},V=async(e,n,i,a,t)=>{const l=i.newScenario(r.Cu.ExtInstalledApps);try{const n=[];a?.shouldFetchPersonalApps&&n.push("Personal"),a?.conversation&&n.push(a.conversation.scope);const i=await(0,A.hX)(e,{installedScopes:n,conversationId:a?.conversation?.id,options:{capabilityFilter:a?.capabilityFilter,botId:a?.botId}},a?.fetchPolicy);l.mark(r.BQ.ExtAppsFetched);const o=B(i,t);return l.mark(r.BQ.ExtAppsProcessed),l.stop(),o}catch(e){const i=`getInstalledApps failed: ${a?.botId??""}`;return l.fail({errors:i}),n.warn(`${i} ${e}`),[]}},j=async(e,n,i,a,t)=>{const d={query:c,fetchPolicy:t??"network-only",variables:{impressionProperty:a}},s=i.newScenario(r.Cu.ExtGetAppImpression),m="Get AppImpressions failed";try{const{data:n}=await e.query(d);if(!n||!n.appImpressions)throw(0,l.$5)("AppsHelper",o.O4.NotPresent,"getAppImpressions",void 0,m);return s.stop(),n.appImpressions}catch(e){return s.fail({errors:m}),n.warnToTelemetry?.(`${m} ${e}`,"platform_appsframework_appscore_apps_helper"),[]}},B=(e,n,i)=>(0,t.compose)(a.compact,(0,t.map)((e=>z(e,n))),(0,t.filter)((e=>(0,d.xK)(e)&&H(e,i))))(e),z=(e,n)=>{if(!n)return e;let i=!1,t=[];if(e.definition.messageExtensions&&(t=e.definition.messageExtensions.map((e=>{let t=e;const r=e.commands??[];return(0,a.isEmpty)(e.commands)||(t={...e,commands:r.filter((e=>!!(0,I.kS)(e,n)&&(i=!0,!0)))}),t}))),!i)return null;const r=t.length?{...e.definition,messageExtensions:t}:e.definition;return{...e,definition:r}},R=(e,{appId:n,installedScope:i,conversationId:a},t,r)=>(l,{data:o})=>{try{o&&o.deleteApp?(0,N.G7)({client:e,installedScope:i,conversationId:a,logger:t,enableAppsQueryOptimization:r},n):t.error("mutation update, delete app failed")}catch(e){t.error("Failed to remove app from client cache")}},Q=async(e,n,i,a,t,r)=>{const l=n.newScenario(i);l.appendEventData({"Thread.Id":t.conversationId??void 0,"App.Id":t.appId}),X(l,t.conversationId);try{const n=await e.mutate({mutation:g,variables:t,update:R(e,t,a,r)});if(!n?.data?.deleteApp)throw new Error("unexpected response, delete app failed");return l.stop(),n}catch(e){throw l.fail({errors:`failed to delete app ${t.appId}`}),e}},W=async(e,n,i,a,t,l,o)=>{const d=o||{},s=i.newScenario(r.Cu.ExtInstalledAppsV2);try{const i=[];if(o?.enableInstalledAppQueryOptimization){if(s.appendEventData({dataSource:"installedApp query",correlationId:l}),d.shouldFetchPersonalApps){const n=e.query({query:T.p,variables:{installedScope:"Personal",appId:a},context:{callerInfo:`${l}-getInstalledAppsByIdV2`}}).then((e=>e.data?.installedApp));i.push(n)}if(d.conversation&&d.conversation.id){const n=e.query({query:T.p,variables:{installedScope:d.conversation.scope,appId:a,conversationId:d.conversation.id},context:{callerInfo:`${l}-getInstalledAppsByIdV2`}}).then((e=>e.data?.installedApp));i.push(n)}const n=(await Promise.all(i)).filter((e=>!!e));return s.mark(r.BQ.ExtAppsProcessed),s.stop({appCount:n.length}),n}{s.appendEventData({dataSource:"installedAppsV2 query",correlationId:l});const i=(await Z(e,s,n,t,`${l}-getInstalledAppsByIdV2`,d)).filter((e=>e&&e.definition&&e.id===a));return s.mark(r.BQ.ExtAppsProcessed),s.stop(),i}}catch(e){return s.fail({errors:`failed to get installed app id: ${a}`}),[]}},Y=async(e,n,i,a,t,l,o,d,s)=>{const m=i.newScenario(r.Cu.ExtInstalledAppsV2),c={"Thread.Id":t?.conversation?.id};t?.entryPoint&&(c["App.EntryPoint"]=S.gY[t.entryPoint]);try{const i=await Z(e,m,n,a,t?.entryPoint?S.gY[t.entryPoint]:"getInstalledAppsV2",t,s),d=B(i,l,t);return m.mark(r.BQ.ExtAppsProcessed),m.stop(c),o&&o(),d}catch(e){const i=`getInstalledAppsV2 failed convId: ${t?.conversation?.id??""} botId: ${t?.botId??""}`;return m.fail({...c,errors:i}),d&&d(i),n.warn(`${i}`),[]}},G=async(e,n,i,a,t)=>{const r=i.newScenario(a);try{const i=await(0,A.gZ)(e,n,"network-only"),a=B(i);return r.stop(),a}catch{const e=`failed to get hosted installed apps for ${n}`;return r.fail({errors:e}),t.error(e),[]}},Z=async(e,n,i,a,t,l,o)=>{let d;const{fetchPolicyForScope:s,fetchOptions:m}=await(0,v.HW)(e,i,l);let c=null,u=null;if(l?.shouldFetchPersonalApps){d={scope:"Personal",conversationId:l?.conversation?.id};c=(o?A.L5:A.kJ)(e,{installedContext:d,options:{includeUnconsentedApps:l.includeUnconsentedApps}},t,(0,v.or)(s.Personal)).then((e=>(n.mark(r.BQ.ExtAppsFetchedPersonalScope),i.log(`installedApps: ${e.length} scope: ${d.scope}`),e)))}l?.conversation&&l?.conversation.id&&(u=_(e,n,i,a,l.conversation,s,t,o,l.capabilityFilter));const p=[c||Promise.resolve([]),u||Promise.resolve([])],[k,g]=await Promise.all(p);return(0,v.J7)(e,i,m),k.concat(g)},_=(e,n,i,a,t,l,o,d,s)=>{let m;const c=t.scope,u="Team"===t.scope,p={scope:c,conversationId:t.id},k=(0,v.or)(l[c]);return a&&!u?(m=(0,A.Am)(e,{conversationId:t.id},k),n.mark(r.BQ.ExtAppsQueryInstalledAppsWithPreCheck)):(m=d?(0,A.L5)(e,{installedContext:p,options:{capabilityFilter:s}},o,k):(0,A.Tw)(e,{installedContext:p,options:{capabilityFilter:s}},o,k),n.mark(r.BQ.ExtAppsQueryInstalledAppsV2)),m=m.then((e=>{i.log(`installedApps: ${e.length} scope: ${p.scope} conversationId: ${p.conversationId} enableInstalledAppsMsgActionsQueryOptimization: ${d}`);const a="Team"===c?r.BQ.ExtAppsFetchedTeamScope:r.BQ.ExtAppsFetchedGroupScope;return n.mark(a),e})),m},H=(e,n)=>{if((0,a.isEmpty)(n?.capabilityFilter))return!0;const i=e.definition;return(0,a.some)(n?.capabilityFilter,(e=>{switch(e){case"Messaging":return!(0,a.isEmpty)(i.messageExtensions);case"Tab":return!(0,a.isEmpty)(i.galleryTabs)||n?.enableStaticTabsPhase1&&!(0,a.isEmpty)(i.staticTabs);case"Bot":return!(0,a.isEmpty)(i.bots);case"Connector":return!(0,a.isEmpty)(i.connectors);case"CUSTOMBOT":return!(0,a.isEmpty)(i.customBots)}}))},J=(e,n)=>{let i=q(e,n.bots)||q(e,n.connectors)||q(e,n.galleryTabs)||q(e,n.staticTabs);if("Team"===e)return i;if(i||(i=q(e,n.messageExtensions)),"Personal"!==e)return i;const a=(n.meetingExtensionDefinition?.scenes?.length??0)>0,t=(n.meetingExtensionDefinition?.filters?.length??0)>0;return i||a||t},q=(e,n)=>(0,a.some)(n,(n=>(0,a.includes)(n.scopes,e))),X=(e,n)=>{(e=>!!e&&(e.toLowerCase().includes("replychainid")||e.toLowerCase().includes("messageid")))(n)&&e.appendEventData({"Thread.Type":"Channel"})}},767393:(e,n,i)=>{"use strict";i.d(n,{N:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appsInstalledByCurrentUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appsInstalledByCurrentUser"}}]}}]}},475846:(e,n,i)=>{"use strict";i.d(n,{n:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appsUsage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appsUsage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appsUsageFields"}}]}}]}},...i(214919).j.definitions]}},557555:(e,n,i)=>{"use strict";i.d(n,{HW:()=>l,or:()=>m,J7:()=>d,zy:()=>s});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"platformAppsBatchFetchPolicy"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PlatformAppsFetchPolicyOptions"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"platformAppsBatchFetchPolicy"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"},arguments:[{kind:"Argument",name:{kind:"Name",value:"always"},value:{kind:"BooleanValue",value:!0}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"scope"}},{kind:"Field",name:{kind:"Name",value:"convId"}},{kind:"Field",name:{kind:"Name",value:"forceNetworkFetch"}}]}}]}}]},t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DataClientPlatformUpdateAllAppsFetchPoliciesMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fetchSource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PlatformAppsFetchSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateAllPlatformAppsFetchPolicies"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fetchSource"},value:{kind:"Variable",name:{kind:"Name",value:"fetchSource"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};var r=i(328789);const l=async(e,n,i)=>{const a={};let t=[];try{i?.shouldFetchPersonalApps&&(t=[{scope:"Personal"}]),i?.conversation&&i?.conversation.id&&(t=[...t,{scope:i.conversation.scope,convId:i.conversation.id}]);const a=await o(e,t);return n.log("getFetchPolicy for installedApps",a),{fetchPolicyForScope:a,fetchOptions:t}}catch(e){return n.error("getFetchPolicy for installedApps failed"),{fetchPolicyForScope:a,fetchOptions:t}}},o=async(e,n)=>{const{data:i}=await e.query({query:a,variables:{options:n}}),t={},r=i?.platformAppsBatchFetchPolicy?.reduce(((e,n)=>({...e,[n.scope]:n.forceNetworkFetch})),t);return r??t},d=(e,n,i,a)=>{const t=a??"Cache",l=i.map((e=>({...e,fetchSource:t})));return e.mutate({mutation:r.J,variables:{input:l}}).catch((e=>(n.error("failed to set fetch policy to ",t),Promise.resolve(void 0))))},s=(e,n,i)=>{e.mutate({mutation:t,variables:{fetchSource:i}}).catch((e=>{n.error("failed to update all fetch policies to ",i)}))},m=e=>e?"network-only":"cache-first"},334878:(e,n,i)=>{"use strict";i.d(n,{p:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScope"},value:{kind:"Variable",name:{kind:"Name",value:"installedScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...i(70887).B.definitions]}},663482:(e,n,i)=>{"use strict";i.d(n,{s:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedAppsV2"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}},{kind:"Field",name:{kind:"Name",value:"statusInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}}]}}]}}]}},...i(70887).B.definitions]}},747199:(e,n,i)=>{"use strict";i.d(n,{Az:()=>v,g_:()=>N,Am:()=>p,hX:()=>S,gZ:()=>I,kJ:()=>g,Tw:()=>k,L5:()=>A});var a=i(663482),t=i(70887);const r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedAppsForContainerApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"containerAppId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsForContainerApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"containerAppId"},value:{kind:"Variable",name:{kind:"Name",value:"containerAppId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...t.B.definitions]},l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...t.B.definitions]},o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedApps"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedApps"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScopes"},value:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...t.B.definitions]};var d=i(475846),s=i(767393);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonAppDefinitionMsgActionFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"largeImageUrl"}},{kind:"Field",name:{kind:"Name",value:"validDomains"}},{kind:"Field",name:{kind:"Name",value:"accentColor"}},{kind:"Field",name:{kind:"Name",value:"isFullScreenApp"}},{kind:"Field",name:{kind:"Name",value:"isFullTrustApp"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"externalId"}},{kind:"Field",name:{kind:"Name",value:"isMicrosoftOwned"}},{kind:"Field",name:{kind:"Name",value:"webApplicationInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"resource"}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"fetchCommands"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"initialRun"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"parameters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"isRequired"}},{kind:"Field",name:{kind:"Name",value:"inputType"}},{kind:"Field",name:{kind:"Name",value:"choices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"appKey"}},{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"authorization"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authType"}},{kind:"Field",name:{kind:"Name",value:"microsoftEntraConfiguration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"supportsSingleSignOn"}}]}}]}}]}}]}}]},c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAppsPlatformQueriesInstalledAppsV2MessageActionsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsForMesssageAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonInstalledAppMsgActionFragment"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonInstalledAppMsgActionFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InstalledApp"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"installationState"}},{kind:"Field",name:{kind:"Name",value:"messageExtensionStates"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageExtensionState"}}]}},{kind:"Field",name:{kind:"Name",value:"definition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAppDefinitionMsgActionFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"statusInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}}]}}]}},...i(590438).O.definitions,...m.definitions]}.definitions]},u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAppsPlatformQueriesInstalledAppsForMessageActionQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsForMesssageAction"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}},{kind:"Field",name:{kind:"Name",value:"statusInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}}]}}]}}]}},...t.B.definitions]},p=async(e,n,i)=>{const{data:a}=await e.query({query:l,variables:n,fetchPolicy:i});return a&&a.installedChatAppsWithPreCheck?a.installedChatAppsWithPreCheck:[]},k=async(e,n,i,t)=>{const{data:r}=await e.query({query:a.s,variables:n,fetchPolicy:t,context:{callerInfo:i}});return r&&r.installedAppsV2?r.installedAppsV2:[]},g=async(e,n,i,a)=>{const{data:t}=await e.query({query:u,variables:n,fetchPolicy:a,context:{callerInfo:i}});return t&&t.installedAppsForMesssageAction?t.installedAppsForMesssageAction:[]},N=async(e,n)=>{const{data:i}=await e.query({query:d.n,fetchPolicy:n});return i?.appsUsage?i.appsUsage:{__typename:"AppsUsage",appIds:[],appActions:[],appScenes:[],appsMru:[]}},v=async(e,n)=>{const i=await e.query({query:s.N,fetchPolicy:n}),{data:a}=i;return a?.appsInstalledByCurrentUser?a.appsInstalledByCurrentUser:[]},I=async(e,n,i)=>{const{data:a}=await e.query({query:r,variables:{containerAppId:n},fetchPolicy:i});return a?.installedAppsForContainerApp?a.installedAppsForContainerApp:[]},S=async(e,n,i)=>{const{data:a}=await e.query({query:o,variables:n,fetchPolicy:i});return a&&a.installedApps?a.installedApps:[]},A=async(e,n,i,a)=>{const{data:t}=await e.query({query:c,variables:n,fetchPolicy:a,context:{callerInfo:i}});return t?.installedAppsForMesssageAction?t.installedAppsForMesssageAction:[]}},455182:(e,n,i)=>{"use strict";i.d(n,{Cg:()=>k,JU:()=>c,G7:()=>p});var a=i(364819);const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedAppsIdList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"installedVersion"}}]}}]}}]};var r=i(557555);const l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedChatAppsIdsList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"installedVersion"}}]}}]}}]};var o=i(334878);const d=(e,n,i)=>"Personal"===e?{installedScope:e,appId:n}:{installedScope:e,appId:n,conversationId:i},s=(e,n)=>({installedContext:"Personal"===e?{scope:e}:{scope:e,conversationId:n}}),m=e=>({conversationId:e}),c=(e,n,i,a,t)=>{const r=i.newLogger("UpdateAppsCache","components-apps-platform-queries");try{if(!n.installedAppsUpdateEventV2)return;const{installedAppsUpdateEventV2:{installedScope:i,app:l,appId:o,eventType:d,conversationId:s}}=n,m={client:e,installedScope:i,conversationId:s,logger:r,enableAppsQueryOptimization:a};if(t&&"Personal"===i)return void u(i,s,e,r,t);switch(d){case"Added":k(m,l);break;case"Removed":p(m,o);break;case"Synced":u(i,s,e,r,t)}}catch(e){r.error("update apps cache failed")}},u=(e,n,i,a,t)=>{if(n&&("GroupChat"===e||"Team"===e)||!n&&"Personal"===e){if(t&&"Personal"===e)return void(0,r.zy)(i,a,"Network");let l=[];l=[{scope:e,convId:n}],(0,r.J7)(i,a,l,"Network")}},p=(e,n)=>{const{logger:i,client:t,installedScope:r,conversationId:l}=e;if((0,a.isNull)(n)||"Personal"!==r&&!l)return void i.warn("removeAppFromCache - invalid input",n,r,l);const s=d(r,n,l);try{t.writeQuery({query:o.p,variables:s,data:{installedApp:null}})}catch(e){throw i.error("removeAppFromCache - failed to update installedApp query",n,r,l),e}const m=N(e);if((0,a.isNull)(m))return void i.warn("removeAppFromCache - no apps in cache",n);const c=(0,a.filter)(m,(e=>null===e||e.id!==n));c.length!==m.length?(i.log("Removing from apps cache "),v(e,c)):i.warn("app to delete already removed from cache")},k=(e,n)=>{const{logger:i,client:t,installedScope:r,conversationId:l}=e;if((0,a.isNull)(n)||"Personal"!==r&&!l)return void i.warn("addAppToCache - invalid input",n,r,l);const{id:s,installedVersion:m,conversationId:c,__typename:u}=n,p=d(r,s,l);try{t.writeQuery({query:o.p,variables:p,data:{installedApp:n}})}catch(e){throw i.error("addAppToCache - failed to update installedApp query",n,r,l),e}const k=N(e);if((0,a.isNull)(k))return void i.warn("addAppToCache - no apps in cache",n);const g=n.id,I=(0,a.find)(k,(e=>e?.id===g));(0,a.isNil)(I)?(i.log("Adding to apps cache"),v(e,[...k,{id:s,conversationId:c,installedVersion:m,installedScope:r,__typename:u}])):i.warn("app to add already in cache",I)},g=(e,n)=>"GroupChat"===e&&n,N=({client:e,installedScope:n,conversationId:i,logger:a,enableAppsQueryOptimization:r})=>{try{if(g(n,r)){if(i){const n=e.readQuery({query:l,variables:m(i)});return n&&n.installedChatAppsWithPreCheck?n.installedChatAppsWithPreCheck:(a.warn("readQuery for group scope returned no results"),null)}return a.error("invalid convid for cache read"),null}{const r=e.readQuery({query:t,variables:s(n,i)});return r&&r.installedAppsV2?r.installedAppsV2:(a.warn("readQuery returned no results"),null)}}catch(e){throw e}},v=({client:e,installedScope:n,conversationId:i,enableAppsQueryOptimization:a,logger:r},o)=>{try{g(n,a)?i?e.writeQuery({query:l,variables:m(i),data:{installedChatAppsWithPreCheck:o}}):r.error("invalid convid for cache update"):e.writeQuery({query:t,variables:s(n,i),data:{installedAppsV2:o}})}catch(e){throw e}}},694527:(e,n,i)=>{"use strict";var a;i.d(n,{i:()=>a}),function(e){e.None="none",e.ApiSecretServiceAuth="apiSecretServiceAuth",e.MicrosoftEntra="microsoftEntra"}(a||(a={}))},491722:(e,n,i)=>{"use strict";i.d(n,{Dr:()=>c,YB:()=>p,e1:()=>k,rh:()=>g,u2:()=>N,Ze:()=>v,dP:()=>I,Bd:()=>S,kS:()=>f,js:()=>h,Nv:()=>y,Jm:()=>C,OH:()=>D,sr:()=>w});var a=i(364819),t=i(812228),r=i(694527),l=i(46377),o=i(30728),d=i(988536);const s="Required",m=["Compose","Commandbox"],c=(e,n,i)=>{if(!n.id)return null;const a=S(n),r=A(n),l=a?u(a):null,[o,d]=(0,t.compose)((0,t.partition)(M),(0,t.map)((n=>F(e,n))),(0,t.filter)((e=>f(e,i))),T)(a);return{appInfo:r,validDomains:n.validDomains||[],type:a?.type,botId:a&&a.botId||"",actionCommands:o,queryCommands:d,authorization:l||void 0,galleryTabs:n.galleryTabs||[]}},u=e=>{if("ApiBased"!==e.type)return null;const{authorization:n}=e;return n&&"microsoftEntra"===n.authType&&n.microsoftEntraConfiguration?{authType:r.i.MicrosoftEntra,microsoftEntraConfiguration:{supportsSingleSignOn:!!n.microsoftEntraConfiguration.supportsSingleSignOn}}:{authType:r.i.None}},p=e=>!(0,a.isEmpty)(e.appInfo.tenantId),k=e=>{const n=(0,t.first)(e.messageExtensions),i=n&&n.botId||"";return`${l.gN.BotPrefix}${i}`},g=e=>e&&(0,a.isEmpty)(e.queryCommands)&&(0,a.isArray)(e.actionCommands)&&e.actionCommands.length>=1,N=e=>e&&(0,a.isEmpty)(e.queryCommands)&&(0,a.isArray)(e.actionCommands)&&1===e.actionCommands.length,v=e=>e&&(0,a.isEmpty)(e.queryCommands)&&(0,a.isArray)(e.actionCommands)&&e.actionCommands.length>1,I=e=>e&&(0,a.isArray)(e.queryCommands)&&e.queryCommands.length>1,S=e=>e&&(0,t.first)(e.messageExtensions),A=e=>({accentColor:e.accentColor||"",appId:e.id,appName:e.name||"",appIcon:e.largeImageUrl||"",isFullScreenApp:e.isFullScreenApp||!1,isFullTrustApp:e.isFullTrustApp||!1,tenantId:e.tenantId||"",externalId:e.externalId||"",resource:e.webApplicationInfo?.resource||"",isMicrosoftOwned:e.isMicrosoftOwned||!1}),T=e=>e&&e.commands||[],f=(e,n)=>(0,a.isEmpty)(e.context)?(0,a.includes)(m,n):(0,a.includes)(e.context,n),M=e=>e&&(0,a.isString)(e.type)&&e.type.toLowerCase()==="Action".toLowerCase(),h=e=>{const n=S(e);if(n)return"ApiBased"===n.type?"ApiBased":"BotBased"},y=(e,n)=>(e=>"ApiBased"===e.type)(n)?e?`${l.gN.TeamsAppPrefix}${n.appInfo.appId}`:"":`${l.gN.BotPrefix}${n.botId}`,F=(e,n)=>({id:n.id,type:n.type||"Query",context:n.context,fetchTask:!!n.fetchTask,description:n.description,initialRun:!!n.initialRun,parameters:n.parameters,title:n.title||"",appKey:n.appKey,taskInfo:C(e,n.taskInfo,n.parameters)}),b=(e,n)=>{const i={};return e&&(i.title=e.title||"",i.height=w(e.height),i.width=w(e.width)||n),i},C=(e,n,i)=>{if(n?.url)return{...b(n),url:n.url};const a=U(i);if(a){const i=e.stringTranslate("extensibility","inputExtension_task_module_button_title");return a.addSubmitAction("submitButton",i,{id:"submitButton"}),{...b(n,o.j4.Large),card:a.getCard()}}return n?{...b(n)}:void 0},D=e=>U(e)?.getRawJson()??null,U=e=>{if(!e||(0,a.isEmpty)(e))return null;const n=new d.a;return e.forEach((e=>E(n,e))),n},E=(e,n)=>{if(!n)return;const i=n.title||"",a=n.name||"",t=n.description||"",r=n.value??void 0,l=n.isRequired??!1;switch(n.inputType||"Text"){case"Text":e.addTextInput(a,t,r,200,!1,{label:i,isRequired:l,errorMessage:s});break;case"Textarea":e.addTextInput(a,t,r,1e3,!0,{label:i,isRequired:l,errorMessage:s});break;case"Number":e.addNumberInput(a,t,r,{label:i,isRequired:l,errorMessage:s});break;case"Date":e.addDateInput(a,t,r,{label:i,isRequired:l,errorMessage:s});break;case"Time":e.addTimeInput(a,t,r,{label:i,isRequired:l,errorMessage:s});break;case"Toggle":e.addToggle(a,i,r,{isRequired:l,errorMessage:s});break;case"Choiceset":const o=(n.choices??[]).map((e=>({title:e.title??"",value:e.value??""})));e.addChoiceSet(a,i,!1,!0,o,r,{label:i,isRequired:l,errorMessage:s})}},w=e=>{if(!(0,a.isNil)(e))return L(e)?(0,a.isNil)(e.customValue)?void 0:e.customValue:x(e)?O(e):void 0},L=e=>"DimensionInFloat"===e.__typename,x=e=>"DimensionInString"===e.__typename,O=e=>{if((0,a.isNil)(e.predefinedValue))return;switch(e.predefinedValue.toLowerCase()){case"small":return o.j4.Small;case"medium":return o.j4.Medium;case"large":return o.j4.Large;default:return}}},862474:(e,n,i)=>{"use strict";var a,t,r;i.d(n,{It:()=>a,xi:()=>t,wk:()=>r}),function(e){e.User="User",e.Group="Group",e.Team="Team",e.MsaUser="MsaUser",e.MsaGroup="MsaGroup",e.Bot="Bot",e.Unknown="Unknown",e.TFLOffNetwork="TFLOffNetwork",e.TFLSMSUnverified="TFLSMSUnverified",e.Initials="Initials",e.MergedGroup="MergedGroup",e.Connector="Connector",e.OutgoingWebhook="OutgoingWebhook",e.VoiceApp="VoiceApp",e.App="App",e.Mail="Mail",e.Pstn="Pstn",e.SharedChannelInviteeTeam="SharedChannelInviteeTeam",e.Communities="Communities",e.Simple="Simple",e.SubCommunity="SubCommunity"}(a||(a={})),function(e){e.Large="HR196x196",e.Medium="HR96x96",e.Small="HR64x64",e.XMedium="HR120x120",e.XSmall="HR32x32"}(t||(t={})),function(e){e.Icon="icon",e.Url="url",e.Name="name",e.Label="label"}(r||(r={}))},203056:(e,n,i)=>{"use strict";i.d(n,{Ch:()=>h,Qc:()=>Y,vG:()=>V,Dm:()=>w,UI:()=>R,eB:()=>O,BY:()=>x,Ng:()=>D,WF:()=>z,C0:()=>E,EO:()=>T,L9:()=>j,uC:()=>C,iU:()=>Q,oG:()=>F,X3:()=>U,xG:()=>B,oz:()=>W});var a=i(364819),t=i(332752),r=i(802756),l=i(785053),o=i(243507),d=i(194649),s=i(46377),m=i(586892),c=i(210071),u=i(862474);class p{static getAvatarLoggingAndTelemetryRef(){return{loggingCount:this.loggingCount,lastThrottleTime:this.lastThrottleTime}}static setAvatarLoggingAndTelemetryRef(e){this.loggingCount=e.loggingCount,this.lastThrottleTime=e.lastThrottleTime}}p.loggingCount=0,p.lastThrottleTime=0;var k=i(742640),g=i(522277);const N=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,v=/^(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})([/\w .-]*)*\/?$/,I=/^[\w.-:]+$/,S=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/i,A=/^[^\p{Letter}]/u,T=(e,n,i,a,t,r,l,o,s,c)=>{let p=u.It.Unknown;const k=P(s,e,c);return o&&i?p=u.It.SharedChannelInviteeTeam:!a&&i?p=u.It.Team:r?p=u.It.App:l?p=u.It.Mail:t?p=u.It.MergedGroup:k||e&&(0,d.FL)(e)||(0,d.$l)(e)?p=u.It.Initials:b(e)?p=u.It.Connector:e&&(0,d.BG)(e)?p=u.It.OutgoingWebhook:F(e)?p=u.It.VoiceApp:y(e)?p=u.It.Bot:m.af.isTFLOffNetworkUser(e)?p=u.It.TFLOffNetwork:m.af.isTFLSmsUnVerifiedMri(e)?p=u.It.TFLSMSUnverified:e&&(0,d.Ku)(e)?p=u.It.Pstn:a?p=f(p,e,n,i):a||(p=M(p,e,s)),p},f=(e,n,i,a)=>(n?e=u.It.MsaUser:i?e=u.It.MsaGroup:a&&(e=u.It.Communities),e),M=(e,n,i)=>{const a=((0,d.AF)(n)||n&&N.test(n.toLowerCase()))&&!Array.isArray(i),t=!(0,d.AF)(n)&&Array.isArray(i);return a||t?e=n?u.It.User:u.It.Group:e},h=e=>{const n=e?.type?.toUpperCase(),i=e?.id;return n===c.Pk.botType||y(i)},y=e=>!!e&&e.startsWith(s.gN.BotPrefix),F=e=>!!e&&(0,d.oG)(e,s.LE),b=e=>!!e&&e.startsWith(s.Vg),C=(e,n)=>!!e&&(e===n.audienceBotId||e===n.largeGridBotId),D=(e,n,i)=>{if(n)return i?k.G:k.GX;switch(e){case u.It.Mail:return k.m$;case u.It.App:case u.It.Connector:case u.It.Bot:case u.It.OutgoingWebhook:return k.B9;case u.It.User:case u.It.MsaUser:case u.It.Initials:case u.It.Unknown:return k.Rl;case u.It.Group:case u.It.MsaGroup:case u.It.MergedGroup:case u.It.Team:case u.It.Communities:case u.It.SubCommunity:return k.Mz;case u.It.TFLOffNetwork:case u.It.TFLSMSUnverified:return k.hE;case u.It.VoiceApp:return k.S2;case u.It.Pstn:return k.Yt;default:return k.Rl}},U=e=>-1!==e?.indexOf("profilePictureV2ForSharedChannel"),E=(e,n,i,a)=>{if(!e||e&&(0,l.p_)(e))return;return void 0===n||n?i.getPresenceUserId(a):void 0},w=(e,n,i)=>e&&n?.id===e.id&&i===e.id&&"avatar"===e.updateType?e.updatedTime:void 0,L=new Map([["smallest",20],["smaller",24],["small",28],["medium",32],["medium-large",36],["large",48],["larger",64],["largest",96]]),x=e=>e&&L.get(e)||32,O=(e,n,i)=>{if(i&&e)try{const i=new URL(e);if("https:"!==i.protocol)return e;const a=i.searchParams.get("size"),t=n||u.xi.Small;return null!==a&&a!==t?e.replace(`size=${a}`,`size=${t}`):e}catch(n){return e}return e},P=(e,n,i)=>{const a=i?.get(t.w.People).enableInitialsImageForPstn,r=i?.get(t.w.Messaging).enablePaidSmsChat,l=!!e?.isInitialsImage,o=!!a&&!!r&&!!n&&m.af.isValidNameForInitialsAvatarForPstnUser(n,e?.displayName);return l||o};function V(e,n){const i=n?.stringTranslate("peoplePicker","unknown_user")??"Unknown User",a=encodeURIComponent(i);return e.includes(a)}const j=(e,n)=>{if(!e&&n&&1===n.length&&n[0].id){const e=n[0].id;return e!==o.i2&&e!==o.j8?e:void 0}},B=(e,n,i,a)=>{const t=a&&encodeURIComponent(a);return!!e&&!!t&&!!i&&V(i,n)},z=(e,n)=>{const i=!!((e,n)=>{if(!e&&n&&1===n.length&&n[0].id){const e=n[0].id;return e!==o.i2&&e!==o.j8}return!1})(e,n),a=((e,n,i)=>n||(i?e?i[0]:i:[]))(i,e,n),t=((e,n)=>e?g.y9:n?g.Ul:g._Z)(e,i),r=((e,n)=>e&&n?.[0]?.displayName?n[0]?.displayName:void 0)(i,n);return{entity:a,generator:t,displayName:r}},R=(e,n,i)=>n?k.Rl:i?k.Mz:e,Q=async(e,n)=>{try{return await fetch(e,{method:"GET",mode:"same-origin",cache:"only-if-cached",credentials:"include",headers:{"x-ms-client-caller":n||"image-cache-check"}}),!0}catch(e){return!1}},W=e=>e.some((e=>(0,a.isEmpty)(e.displayName)||!(0,d.AF)(e.userId)||(0,d.FL)(e.userId)||(0,d.Ku)(e.userId))),Y=({callerInfo:e,skipGeneratingUrl:n,propsAvatarUrl:i,cachedUrl:a,generatedUrl:t,baseImageUrl:l,isCookieValid:o,profilePictureType:s,isSelfProfileAvatar:m,forSharedChannel:c,isXtapUserUrl:k,logger:g,scenarioFactory:N})=>{const T=Date.now(),{loggingCount:f,lastThrottleTime:M}=p.getAvatarLoggingAndTelemetryRef();if(M>0&&T-M>36e5&&p.setAvatarLoggingAndTelemetryRef({loggingCount:0,lastThrottleTime:0}),f<=4){const h=i||a||t,{isValidDomain:y,isValidPath:F,isValidOid:b,isValidMri:C,isFirstCharSpecial:D,isValidUserInfo:U,isValidTeamId:E,queryParamsLength:w}=((e,n)=>{if(!e)return null;if(e.startsWith("data:image"))return{isValidDomain:!1,isValidPath:"N/A",isValidOid:!1,isValidMri:"N/A",isFirstCharSpecial:"N/A",isValidUserInfo:"N/A",isValidTeamId:"N/A",isDataUriImageApplied:!0,queryParamsLength:0};const i=new URL(e),a=`${i.protocol}//${i.hostname}`,t=v.test(a),r=i.pathname.split("/").filter((e=>""!==e)),l=r.every((e=>I.test(e))),o=r.some((e=>S.test(e))),s=i.searchParams.get("usersInfo"),m=Array.from(i.searchParams.entries()).length;let c="N/A",p="N/A";if(n===u.It.User){const e=i.pathname.split("/"),n=e.indexOf("profilepicturev2");let a=null;-1!==n&&n+1<e.length&&(a=e.slice(n+1).join("/")),c=a&&(0,d.AF)(a)?"VALID":"INVALID";const t=i.searchParams.get("displayName");p=t?A.test(t)?"YES":"NO":"INVALID"}let k=n===u.It.Group?"INVALID":"N/A";if(s&&n===u.It.Group){const e=decodeURIComponent(s),n=JSON.parse(e);k=W(n)?"VALID":"INVALID"}let g="N/A";if(n===u.It.Team){const e=r.indexOf("teams");g=-1!==e&&void 0!==r[e+1]&&S.test(r[e+1])?"VALID":"INVALID"}return{isValidDomain:t,isValidPath:l,isValidOid:o,isValidMri:c,isFirstCharSpecial:p,isValidUserInfo:k,isValidTeamId:g,isDataUriImageApplied:!1,queryParamsLength:m}})(h,s)||{},L=`Avatar load failed :: BaseImageUrl: ${l} - CallerInfo: ${e} - IsCookieValid: ${o} - IsFirstCharSpecial: ${D} - IsSharedChannel: ${c} - IsValidDomain: ${y} - IsValidMri: ${C} - IsValidOid: ${b} - IsValidPath: ${F} - IsValidTeamId: ${E} - IsValidUserInfo: ${U} - IsXtapUserUrl: ${k} - ProfilePictureType: ${s} - QueryParamsLength: ${w} - SkipGeneratingUrl: ${n}`;g.error(L);const x={callerInfo:e,profilePictureType:s,isSelfProfileAvatar:!!m,errorMessage:L};N.newScenario(r.Cu.AvatarStatus).stop(x,"failure");const O=f+1;4===O?p.setAvatarLoggingAndTelemetryRef({loggingCount:4,lastThrottleTime:T}):p.setAvatarLoggingAndTelemetryRef({loggingCount:O,lastThrottleTime:M})}}},742640:(e,n,i)=>{"use strict";i.d(n,{Rl:()=>a,Mz:()=>t,$M:()=>r,Yt:()=>l,S2:()=>o,m$:()=>d,GX:()=>s,G:()=>m,hE:()=>c,B9:()=>u,Vd:()=>p,T:()=>k,$Z:()=>g});const a="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9IiM5NDk0OTQiIHg9Ii02IiB5PSItNiIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSI+PC9yZWN0PjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0xMCAyQzcuNzkwODYgMiA2IDMuNzkwODYgNiA2QzYgOC4yMDkxNCA3Ljc5MDg2IDEwIDEwIDEwQzEyLjIwOTEgMTAgMTQgOC4yMDkxNCAxNCA2QzE0IDMuNzkwODYgMTIuMjA5MSAyIDEwIDJaTTcgNkM3IDQuMzQzMTUgOC4zNDMxNSAzIDEwIDNDMTEuNjU2OSAzIDEzIDQuMzQzMTUgMTMgNkMxMyA3LjY1Njg1IDExLjY1NjkgOSAxMCA5QzguMzQzMTUgOSA3IDcuNjU2ODUgNyA2Wk01LjAwODczIDExQzMuOTAzMTUgMTEgMyAxMS44ODY5IDMgMTNDMyAxNC42OTEyIDMuODMyODEgMTUuOTY2MyA1LjEzNDk5IDE2Ljc5NjZDNi40MTY5NyAxNy42MTQgOC4xNDUyNiAxOCAxMCAxOEMxMS44NTQ3IDE4IDEzLjU4MyAxNy42MTQgMTQuODY1IDE2Ljc5NjZDMTYuMTY3MiAxNS45NjYzIDE3IDE0LjY5MTIgMTcgMTNDMTcgMTEuODk1NiAxNi4xMDQ1IDExIDE1IDExTDUuMDA4NzMgMTFaTTQgMTNDNCAxMi40NDY3IDQuNDQ3ODYgMTIgNS4wMDg3MyAxMkwxNSAxMkMxNS41NTIyIDEyIDE2IDEyLjQ0NzggMTYgMTNDMTYgMTQuMzA4OCAxNS4zNzc3IDE1LjI4MzcgMTQuMzI3NCAxNS45NTM0QzEzLjI1NjggMTYuNjM2IDExLjczNTEgMTcgMTAgMTdDOC4yNjQ4OSAxNyA2Ljc0MzE4IDE2LjYzNiA1LjY3MjYyIDE1Ljk1MzRDNC42MjIyNiAxNS4yODM3IDQgMTQuMzA4OCA0IDEzWiIvPjwvc3ZnPg==",t="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9IiM5NDk0OTQiIHg9Ii02IiB5PSItNiIgaGVpZ2h0PSIxMDAlIiB3aWR0aD0iMTAwJSIvPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0xMi40NzQ3IDguMDE0MzFDMTIuOTg3NiA4LjAxNDMxIDEzLjQxMDIgOC40MDAzNSAxMy40NjggOC44OTc2OUwxMy40NzQ3IDkuMDE0MzFWMTMuMzgxN0MxMy40NzQ3IDE1LjMwNiAxMS45MTQ4IDE2Ljg2NiA5Ljk5MDQ0IDE2Ljg2NkM4LjEzMDI3IDE2Ljg2NiA2LjYxMDU2IDE1LjQwODMgNi41MTEzMSAxMy41NzI4TDYuNTA2MTYgMTMuMzgxN1Y5LjAxNDMxQzYuNTA2MTYgOC41MDE0OCA2Ljg5MjIgOC4wNzg4IDcuMzg5NTQgOC4wMjEwNEw3LjUwNjE2IDguMDE0MzFIMTIuNDc0N1pNMTIuNDc0NyA5LjAxNDMxSDcuNTA2MTZWMTMuMzgxN0M3LjUwNjE2IDE0Ljc1MzcgOC42MTg0MSAxNS44NjYgOS45OTA0NCAxNS44NjZDMTEuMzA3NiAxNS44NjYgMTIuMzg1MyAxNC44NDA5IDEyLjQ2OTQgMTMuNTQ1TDEyLjQ3NDcgMTMuMzgxN1Y5LjAxNDMxWk01Ljc3NDA3IDguMDEzNzJDNS42MzIwOCA4LjI1ODk3IDUuNTQwNjkgOC41MzcxOCA1LjUxNDE3IDguODM0MDZMNS41MDYxNiA5LjAxNDMxSDMuMDE2ODVWMTIuNzUzNEMzLjAxNjg1IDEzLjc3ODYgMy44NDc5MyAxNC42MDk3IDQuODczMTIgMTQuNjA5N0M1LjE0NDMzIDE0LjYwOTcgNS40MDE5NiAxNC41NTE1IDUuNjM0MjEgMTQuNDQ3QzUuNzEzNDcgMTQuNzc1NiA1LjgzMDA1IDE1LjA5MDcgNS45Nzg1IDE1LjM4NzFDNS42Mzg4NyAxNS41MzA3IDUuMjY1MjIgMTUuNjA5NyA0Ljg3MzEyIDE1LjYwOTdDMy4zNTE5OCAxNS42MDk3IDIuMTA4NTcgMTQuNDIwNiAyLjAyMTY5IDEyLjkyMTJMMi4wMTY4NSAxMi43NTM0VjkuMDE0MzFDMi4wMTY4NSA4LjUwMTQ4IDIuNDAyODkgOC4wNzg4IDIuOTAwMjIgOC4wMjEwNEwzLjAxNjg1IDguMDE0MzFMNS43NzQwNyA4LjAxMzcyWk0xNC4yMDY4IDguMDEzNzJMMTYuOTkxMiA4LjAxNDMxQzE3LjUwNCA4LjAxNDMxIDE3LjkyNjcgOC40MDAzNSAxNy45ODQ0IDguODk3NjlMMTcuOTkxMiA5LjAxNDMxVjEyLjc1NDJDMTcuOTkxMiAxNC4zMzEyIDE2LjcxMjcgMTUuNjA5NyAxNS4xMzU3IDE1LjYwOTdDMTQuNzM0OCAxNS42MDk3IDE0LjM1MzIgMTUuNTI3MSAxNC4wMDY5IDE1LjM3NzlDMTQuMTU1MSAxNS4wODAzIDE0LjI3MDkgMTQuNzY0OCAxNC4zNTAzIDE0LjQzNTFDMTQuNTg4NyAxNC41NDczIDE0Ljg1NDkgMTQuNjA5NyAxNS4xMzU3IDE0LjYwOTdDMTYuMTExNiAxNC42MDk3IDE2LjkxMTYgMTMuODU2MiAxNi45ODU2IDEyLjg5OTJMMTYuOTkxMiAxMi43NTQyVjkuMDE0MzFIMTQuNDc0N0wxNC40NjkyIDguODY1MDVDMTQuNDQ2NSA4LjU1NjU0IDE0LjM1MzcgOC4yNjc0OSAxNC4yMDY4IDguMDEzNzJaTTkuOTg4NTcgMi45ODkyNkMxMS4yMTg3IDIuOTg5MjYgMTIuMjE1OSAzLjk4NjQ4IDEyLjIxNTkgNS4yMTY2MkMxMi4yMTU5IDYuNDQ2NzYgMTEuMjE4NyA3LjQ0Mzk4IDkuOTg4NTcgNy40NDM5OEM4Ljc1ODQzIDcuNDQzOTggNy43NjEyMSA2LjQ0Njc2IDcuNzYxMjEgNS4yMTY2MkM3Ljc2MTIxIDMuOTg2NDggOC43NTg0MyAyLjk4OTI2IDkuOTg4NTcgMi45ODkyNlpNMTQuOTc1NyAzLjYxNzM5QzE2LjAzMjQgMy42MTczOSAxNi44ODkgNC40NzQgMTYuODg5IDUuNTMwNjlDMTYuODg5IDYuNTg3MzcgMTYuMDMyNCA3LjQ0Mzk4IDE0Ljk3NTcgNy40NDM5OEMxMy45MTkxIDcuNDQzOTggMTMuMDYyNCA2LjU4NzM3IDEzLjA2MjQgNS41MzA2OUMxMy4wNjI0IDQuNDc0IDEzLjkxOTEgMy42MTczOSAxNC45NzU3IDMuNjE3MzlaTTUuMDE3MTcgMy42MTczOUM2LjA3Mzg2IDMuNjE3MzkgNi45MzA0NyA0LjQ3NCA2LjkzMDQ3IDUuNTMwNjlDNi45MzA0NyA2LjU4NzM3IDYuMDczODYgNy40NDM5OCA1LjAxNzE3IDcuNDQzOThDMy45NjA0OSA3LjQ0Mzk4IDMuMTAzODggNi41ODczNyAzLjEwMzg4IDUuNTMwNjlDMy4xMDM4OCA0LjQ3NCAzLjk2MDQ5IDMuNjE3MzkgNS4wMTcxNyAzLjYxNzM5Wk05Ljk4ODU3IDMuOTg5MjZDOS4zMTA3MiAzLjk4OTI2IDguNzYxMjEgNC41Mzg3NyA4Ljc2MTIxIDUuMjE2NjJDOC43NjEyMSA1Ljg5NDQ3IDkuMzEwNzIgNi40NDM5OCA5Ljk4ODU3IDYuNDQzOThDMTAuNjY2NCA2LjQ0Mzk4IDExLjIxNTkgNS44OTQ0NyAxMS4yMTU5IDUuMjE2NjJDMTEuMjE1OSA0LjUzODc3IDEwLjY2NjQgMy45ODkyNiA5Ljk4ODU3IDMuOTg5MjZaTTE0Ljk3NTcgNC42MTczOUMxNC40NzEzIDQuNjE3MzkgMTQuMDYyNCA1LjAyNjI5IDE0LjA2MjQgNS41MzA2OUMxNC4wNjI0IDYuMDM1MDkgMTQuNDcxMyA2LjQ0Mzk4IDE0Ljk3NTcgNi40NDM5OEMxNS40ODAxIDYuNDQzOTggMTUuODg5IDYuMDM1MDkgMTUuODg5IDUuNTMwNjlDMTUuODg5IDUuMDI2MjkgMTUuNDgwMSA0LjYxNzM5IDE0Ljk3NTcgNC42MTczOVpNNS4wMTcxNyA0LjYxNzM5QzQuNTEyNzcgNC42MTczOSA0LjEwMzg4IDUuMDI2MjkgNC4xMDM4OCA1LjUzMDY5QzQuMTAzODggNi4wMzUwOSA0LjUxMjc3IDYuNDQzOTggNS4wMTcxNyA2LjQ0Mzk4QzUuNTIxNTcgNi40NDM5OCA1LjkzMDQ3IDYuMDM1MDkgNS45MzA0NyA1LjUzMDY5QzUuOTMwNDcgNS4wMjYyOSA1LjUyMTU3IDQuNjE3MzkgNS4wMTcxNyA0LjYxNzM5WiIvPjwvc3ZnPg==",r="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iI0U4RUJGQSIgZD0iTTAgMzJWMGgzMnYzMkgwWiIvPjxwYXRoIGZpbGw9IiM0RjUyQjIiIGQ9Ik0xNS41IDEyLjUwMmEuNS41IDAgMSAxIDEgMHYxLjAwMmEuNS41IDAgMCAxLTEgMHYtMS4wMDJabTMuMzUuOTQxYS41LjUgMCAwIDAtLjcwNyAwbC0uNzA4LjcwOWEuNS41IDAgMCAwIC43MDcuNzA3bC43MDktLjcwOWEuNS41IDAgMCAwIDAtLjcwN1ptLTQuOTk4IDBhLjUuNSAwIDAgMC0uNzA3LjcwN2wuNzA4LjcwOWEuNS41IDAgMSAwIC43MDctLjcwN2wtLjcwOC0uNzA5Wk0xNiA4YzMuMzE0IDAgNiAyLjU5NyA2IDUuOCAwIDEuNjc3LS43NDUgMy4yMTYtMi4yMDQgNC41OTRhLjU5OS41OTkgMCAwIDAtLjE0NS4yMTNsLS4wMjYuMDgxLS45MzYgMy45MTdjLS4xODQuNzcxLS44NjUgMS4zMy0xLjY3IDEuMzlsLS4xNDQuMDA1aC0xLjc1Yy0uODE5IDAtMS41MzUtLjUxNi0xLjc3Ni0xLjI2MmwtLjAzOC0uMTMzLS45MzUtMy45MTZhLjU5Ni41OTYgMCAwIDAtLjE3LS4yOTVjLTEuMzktMS4zMTItMi4xMzMtMi43Ny0yLjItNC4zNTVMMTAgMTMuOGwuMDAzLS4xOTFDMTAuMTA4IDEwLjQ5NCAxMi43NTMgOCAxNiA4Wm0tMi4wNDUgMTMgLjMxOSAxLjMzNC4wMjYuMDk2Yy4wOTcuMy4zNzYuNTIyLjcxMi41NjNsLjExNC4wMDdoMS43MTJsLjEwNi0uMDAzYS44NTYuODU2IDAgMCAwIC43NDEtLjUyNWwuMDMyLS4xLjMyOC0xLjM3MmgtNC4wOVpNMTYgOWMtMi42MzIgMC00Ljc4OCAxLjk1My00Ljk4NSA0LjQxNGwtLjAxMi4yMTItLjAwMy4xNTMuMDA0LjIxN2MuMDU2IDEuMzA0LjY3NCAyLjUyNSAxLjg4OCAzLjY3MS4xODguMTc4LjMzLjM5OC40MTQuNjRsLjA0My4xNS4zNjcgMS41NDNIMTUuNXYtNC41MDNhLjUuNSAwIDEgMSAxIDBWMjBoMS43ODVsLjM4Ny0xLjYxNS4wNTEtLjE1Yy4wODYtLjIxNS4yMTgtLjQwOS4zODYtLjU2OEMyMC4zODIgMTYuNDY1IDIxIDE1LjE4IDIxIDEzLjhjMC0yLjY0My0yLjIzMS00LjgtNS00LjhaIi8+PC9zdmc+",l="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9Im1lZGl1bXR1cnF1b2lzZSIgeD0iLTYiIHk9Ii02IiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjwvcmVjdD48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMTAgMkM3Ljc5MDg2IDIgNiAzLjc5MDg2IDYgNkM2IDguMjA5MTQgNy43OTA4NiAxMCAxMCAxMEMxMi4yMDkxIDEwIDE0IDguMjA5MTQgMTQgNkMxNCAzLjc5MDg2IDEyLjIwOTEgMiAxMCAyWk03IDZDNyA0LjM0MzE1IDguMzQzMTUgMyAxMCAzQzExLjY1NjkgMyAxMyA0LjM0MzE1IDEzIDZDMTMgNy42NTY4NSAxMS42NTY5IDkgMTAgOUM4LjM0MzE1IDkgNyA3LjY1Njg1IDcgNlpNNS4wMDg3MyAxMUMzLjkwMzE1IDExIDMgMTEuODg2OSAzIDEzQzMgMTQuNjkxMiAzLjgzMjgxIDE1Ljk2NjMgNS4xMzQ5OSAxNi43OTY2QzYuNDE2OTcgMTcuNjE0IDguMTQ1MjYgMTggMTAgMThDMTEuODU0NyAxOCAxMy41ODMgMTcuNjE0IDE0Ljg2NSAxNi43OTY2QzE2LjE2NzIgMTUuOTY2MyAxNyAxNC42OTEyIDE3IDEzQzE3IDExLjg5NTYgMTYuMTA0NSAxMSAxNSAxMUw1LjAwODczIDExWk00IDEzQzQgMTIuNDQ2NyA0LjQ0Nzg2IDEyIDUuMDA4NzMgMTJMMTUgMTJDMTUuNTUyMiAxMiAxNiAxMi40NDc4IDE2IDEzQzE2IDE0LjMwODggMTUuMzc3NyAxNS4yODM3IDE0LjMyNzQgMTUuOTUzNEMxMy4yNTY4IDE2LjYzNiAxMS43MzUxIDE3IDEwIDE3QzguMjY0ODkgMTcgNi43NDMxOCAxNi42MzYgNS42NzI2MiAxNS45NTM0QzQuNjIyMjYgMTUuMjgzNyA0IDE0LjMwODggNCAxM1oiLz48L3N2Zz4=",o="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSIjMjkzODRGIi8+CjxwYXRoIGQ9Ik0xMS45OTAyIDMuMjVDMTIuNTgyNyAzLjI1IDEzLjE0OTEgMy4zMjgxMiAxMy42ODk1IDMuNDg0MzhDMTQuMjI5OCAzLjYzNDExIDE0LjczMTEgMy44NDU3IDE1LjE5MzQgNC4xMTkxNEMxNS42NTU2IDQuMzkyNTggMTYuMDcyMyA0LjcyNDYxIDE2LjQ0MzQgNS4xMTUyM0MxNi44MjEgNS41MDU4NiAxNy4xNDMyIDUuOTM1NTUgMTcuNDEwMiA2LjQwNDNDMTcuNjc3MSA2Ljg3MzA1IDE3Ljg4MjIgNy4zODA4NiAxOC4wMjU0IDcuOTI3NzNDMTguMTY4NiA4LjQ2ODEgMTguMjQwMiA5LjAzMTI1IDE4LjI0MDIgOS42MTcxOUMxOC40MjkgOS42ODIyOSAxOC41OTgzIDkuNzczNDQgMTguNzQ4IDkuODkwNjJDMTguOTA0MyAxMC4wMDc4IDE5LjAzNDUgMTAuMTQ0NSAxOS4xMzg3IDEwLjMwMDhDMTkuMjQ5MyAxMC40NTA1IDE5LjMzNCAxMC42MTk4IDE5LjM5MjYgMTAuODA4NkMxOS40NTc3IDEwLjk5MDkgMTkuNDkwMiAxMS4xNzk3IDE5LjQ5MDIgMTEuMzc1VjEzLjg3NUMxOS40OTAyIDE0LjEyODkgMTkuNDQxNCAxNC4zNjk4IDE5LjM0MzggMTQuNTk3N0MxOS4yNDYxIDE0LjgyNTUgMTkuMTA5NCAxNS4wMjczIDE4LjkzMzYgMTUuMjAzMUMxOC43NjQzIDE1LjM3MjQgMTguNTY1OCAxNS41MDU5IDE4LjMzNzkgMTUuNjAzNUMxOC4xMSAxNS43MDEyIDE3Ljg2OTEgMTUuNzUgMTcuNjE1MiAxNS43NUgxNi4zNjUyQzE2LjE5NiAxNS43NSAxNi4wNDk1IDE1LjY4ODIgMTUuOTI1OCAxNS41NjQ1QzE1LjgwMjEgMTUuNDQwOCAxNS43NDAyIDE1LjI5NDMgMTUuNzQwMiAxNS4xMjVWMTAuMTI1QzE1Ljc0MDIgOS45NDkyMiAxNS43ODI2IDkuODE5MDEgMTUuODY3MiA5LjczNDM4QzE1Ljk1MTggOS42NDMyMyAxNi4wNTYgOS41ODEzOCAxNi4xNzk3IDkuNTQ4ODNDMTYuMzAzNCA5LjUwOTc3IDE2LjQzNjggOS40OTM0OSAxNi41ODAxIDkuNUMxNi43Mjk4IDkuNSAxNi44NjY1IDkuNSAxNi45OTAyIDkuNUMxNi45OTAyIDguODA5OSAxNi44NTY4IDguMTYyMTEgMTYuNTg5OCA3LjU1NjY0QzE2LjMyOTQgNi45NTExNyAxNS45NzE0IDYuNDIzODMgMTUuNTE1NiA1Ljk3NDYxQzE1LjA2NjQgNS41MTg4OCAxNC41MzkxIDUuMTYwODEgMTMuOTMzNiA0LjkwMDM5QzEzLjMyODEgNC42MzM0NiAxMi42ODAzIDQuNSAxMS45OTAyIDQuNUMxMS4zMDAxIDQuNSAxMC42NTIzIDQuNjMzNDYgMTAuMDQ2OSA0LjkwMDM5QzkuNDQxNDEgNS4xNjA4MSA4LjkxMDgxIDUuNTE4ODggOC40NTUwOCA1Ljk3NDYxQzguMDA1ODYgNi40MjM4MyA3LjY0Nzc5IDYuOTUxMTcgNy4zODA4NiA3LjU1NjY0QzcuMTIwNDQgOC4xNjIxMSA2Ljk5MDIzIDguODA5OSA2Ljk5MDIzIDkuNUg3LjI3MzQ0QzcuMzg0MTEgOS41IDcuNDk4MDUgOS41MDY1MSA3LjYxNTIzIDkuNTE5NTNDNy43MzI0MiA5LjUyNjA0IDcuODM2NTkgOS41NTIwOCA3LjkyNzczIDkuNTk3NjZDOC4wMTg4OCA5LjYzNjcyIDguMDkzNzUgOS42OTg1NyA4LjE1MjM0IDkuNzgzMkM4LjIxMDk0IDkuODY3ODQgOC4yNDAyMyA5Ljk4MTc3IDguMjQwMjMgMTAuMTI1VjE1LjEyNUM4LjI0MDIzIDE1LjMwMDggOC4xOTc5MiAxNS40MzQyIDguMTEzMjggMTUuNTI1NEM4LjAyODY1IDE1LjYxIDcuOTI0NDggMTUuNjcxOSA3LjgwMDc4IDE1LjcxMDlDNy42NzcwOCAxNS43NDM1IDcuNTQwMzYgMTUuNzU5OCA3LjM5MDYyIDE1Ljc1OThDNy4yNDc0IDE1Ljc1MzMgNy4xMTM5MyAxNS43NSA2Ljk5MDIzIDE1Ljc1VjE3Ljk3NjZDNi45OTAyMyAxOC4xMzI4IDcuMDM5MDYgMTguMjYzIDcuMTM2NzIgMTguMzY3MkM3LjI0MDg5IDE4LjQ2NDggNy4zNzEwOSAxOC41NDYyIDcuNTI3MzQgMTguNjExM0M3LjY5MDEgMTguNjc2NCA3Ljg2OTE0IDE4LjcyNTMgOC4wNjQ0NSAxOC43NTc4QzguMjU5NzcgMTguNzkwNCA4LjQ1NTA4IDE4LjgxNjQgOC42NTAzOSAxOC44MzU5QzguODQ1NyAxOC44NDkgOS4wMjc5OSAxOC44NTg3IDkuMTk3MjcgMTguODY1MkM5LjM2NjU0IDE4Ljg2NTIgOS41MDMyNiAxOC44NjUyIDkuNjA3NDIgMTguODY1MkM5LjY3OTA0IDE4LjY4MjkgOS43NzM0NCAxOC41MTY5IDkuODkwNjIgMTguMzY3MkMxMC4wMDc4IDE4LjIxNzQgMTAuMTQxMyAxOC4wODcyIDEwLjI5MSAxNy45NzY2QzEwLjQ0NzMgMTcuODY1OSAxMC42MTY1IDE3Ljc4MTIgMTAuNzk4OCAxNy43MjI3QzEwLjk4MTEgMTcuNjU3NiAxMS4xNjk5IDE3LjYyNSAxMS4zNjUyIDE3LjYyNUgxMS45OTAyQzEyLjI0NDEgMTcuNjI1IDEyLjQ4NSAxNy42NzM4IDEyLjcxMjkgMTcuNzcxNUMxMi45NDA4IDE3Ljg2OTEgMTMuMTM5MyAxOC4wMDU5IDEzLjMwODYgMTguMTgxNkMxMy40ODQ0IDE4LjM1MDkgMTMuNjIxMSAxOC41NDk1IDEzLjcxODggMTguNzc3M0MxMy44MTY0IDE5LjAwNTIgMTMuODY1MiAxOS4yNDYxIDEzLjg2NTIgMTkuNUMxMy44NjUyIDE5Ljc1MzkgMTMuODE2NCAxOS45OTQ4IDEzLjcxODggMjAuMjIyN0MxMy42MjExIDIwLjQ1MDUgMTMuNDg0NCAyMC42NTIzIDEzLjMwODYgMjAuODI4MUMxMy4xMzkzIDIwLjk5NzQgMTIuOTQwOCAyMS4xMzA5IDEyLjcxMjkgMjEuMjI4NUMxMi40ODUgMjEuMzI2MiAxMi4yNDQxIDIxLjM3NSAxMS45OTAyIDIxLjM3NUgxMS4zNjUyQzEwLjk2MTYgMjEuMzc1IDEwLjYwMDMgMjEuMjYxMSAxMC4yODEyIDIxLjAzMzJDOS45NjIyNCAyMC43OTg4IDkuNzM0MzggMjAuNDkyOCA5LjU5NzY2IDIwLjExNTJDOS4zNTAyNiAyMC4xMDg3IDkuMDgwMDggMjAuMDk5IDguNzg3MTEgMjAuMDg1OUM4LjUwMDY1IDIwLjA3MjkgOC4yMTQxOSAyMC4wNDY5IDcuOTI3NzMgMjAuMDA3OEM3LjY0MTI4IDE5Ljk2MjIgNy4zNjQ1OCAxOS44OTcxIDcuMDk3NjYgMTkuODEyNUM2LjgzNzI0IDE5LjcyMTQgNi42MDYxMiAxOS41OTc3IDYuNDA0MyAxOS40NDE0QzYuMjAyNDcgMTkuMjc4NiA2LjAzOTcxIDE5LjA4MDEgNS45MTYwMiAxOC44NDU3QzUuNzk4ODMgMTguNjA0OCA1Ljc0MDIzIDE4LjMxNTEgNS43NDAyMyAxNy45NzY2VjE1LjYzMjhDNS41NTc5NCAxNS41Njc3IDUuMzg4NjcgMTUuNDc2NiA1LjIzMjQyIDE1LjM1OTRDNS4wNzYxNyAxNS4yNDIyIDQuOTQyNzEgMTUuMTA4NyA0LjgzMjAzIDE0Ljk1OUM0LjcyNzg2IDE0LjgwMjcgNC42NDMyMyAxNC42MzM1IDQuNTc4MTIgMTQuNDUxMkM0LjUxOTUzIDE0LjI2MjQgNC40OTAyMyAxNC4wNzAzIDQuNDkwMjMgMTMuODc1VjExLjM3NUM0LjQ5MDIzIDExLjE3OTcgNC41MTk1MyAxMC45OTA5IDQuNTc4MTIgMTAuODA4NkM0LjY0MzIzIDEwLjYxOTggNC43Mjc4NiAxMC40NTA1IDQuODMyMDMgMTAuMzAwOEM0Ljk0MjcxIDEwLjE0NDUgNS4wNzYxNyAxMC4wMDc4IDUuMjMyNDIgOS44OTA2MkM1LjM4ODY3IDkuNzczNDQgNS41NTc5NCA5LjY4MjI5IDUuNzQwMjMgOS42MTcxOUM1Ljc0MDIzIDkuMDMxMjUgNS44MTE4NSA4LjQ2ODEgNS45NTUwOCA3LjkyNzczQzYuMDk4MzEgNy4zODA4NiA2LjMwMzM5IDYuODczMDUgNi41NzAzMSA2LjQwNDNDNi44MzcyNCA1LjkzNTU1IDcuMTU2MjUgNS41MDU4NiA3LjUyNzM0IDUuMTE1MjNDNy45MDQ5NSA0LjcyNDYxIDguMzI0ODcgNC4zOTI1OCA4Ljc4NzExIDQuMTE5MTRDOS4yNDkzNSAzLjg0NTcgOS43NTA2NSAzLjYzNDExIDEwLjI5MSAzLjQ4NDM4QzEwLjgzMTQgMy4zMjgxMiAxMS4zOTc4IDMuMjUgMTEuOTkwMiAzLjI1Wk0xMS4zNjUyIDE4Ljg3NUMxMS4xOTYgMTguODc1IDExLjA0OTUgMTguOTM2OCAxMC45MjU4IDE5LjA2MDVDMTAuODAyMSAxOS4xODQyIDEwLjc0MDIgMTkuMzMwNyAxMC43NDAyIDE5LjVDMTAuNzQwMiAxOS42NjkzIDEwLjgwMjEgMTkuODE1OCAxMC45MjU4IDE5LjkzOTVDMTEuMDQ5NSAyMC4wNjMyIDExLjE5NiAyMC4xMjUgMTEuMzY1MiAyMC4xMjVIMTEuOTkwMkMxMi4xNTk1IDIwLjEyNSAxMi4zMDYgMjAuMDYzMiAxMi40Mjk3IDE5LjkzOTVDMTIuNTUzNCAxOS44MTU4IDEyLjYxNTIgMTkuNjY5MyAxMi42MTUyIDE5LjVDMTIuNjE1MiAxOS4zMzA3IDEyLjU1MzQgMTkuMTg0MiAxMi40Mjk3IDE5LjA2MDVDMTIuMzA2IDE4LjkzNjggMTIuMTU5NSAxOC44NzUgMTEuOTkwMiAxOC44NzVIMTEuMzY1MlpNNi4zNjUyMyAxMC43NUM2LjE5NTk2IDEwLjc1IDYuMDQ5NDggMTAuODExOCA1LjkyNTc4IDEwLjkzNTVDNS44MDIwOCAxMS4wNTkyIDUuNzQwMjMgMTEuMjA1NyA1Ljc0MDIzIDExLjM3NVYxMy44NzVDNS43NDAyMyAxNC4wNDQzIDUuODAyMDggMTQuMTkwOCA1LjkyNTc4IDE0LjMxNDVDNi4wNDk0OCAxNC40MzgyIDYuMTk1OTYgMTQuNSA2LjM2NTIzIDE0LjVINi45OTAyM1YxMC43NUg2LjM2NTIzWk0xNi45OTAyIDEwLjc1VjE0LjVIMTcuNjE1MkMxNy43ODQ1IDE0LjUgMTcuOTMxIDE0LjQzODIgMTguMDU0NyAxNC4zMTQ1QzE4LjE3ODQgMTQuMTkwOCAxOC4yNDAyIDE0LjA0NDMgMTguMjQwMiAxMy44NzVWMTEuMzc1QzE4LjI0MDIgMTEuMjA1NyAxOC4xNzg0IDExLjA1OTIgMTguMDU0NyAxMC45MzU1QzE3LjkzMSAxMC44MTE4IDE3Ljc4NDUgMTAuNzUgMTcuNjE1MiAxMC43NUgxNi45OTAyWiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg==",d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAACxKAAAsSgF3enRNAAAEuElEQVR42u2cwUsjVxzHv9tVKZs9uJTEg5cY0JaNI97W4DFpb41eWjbrYVkQ/4bSRSjI9r50T9arG+iyVNNrAr1I0ps467JViLmkkJHSHHakNND2sEzIrskaWzVvZj6fk5igM/M+83vv++a9ufbF3R//EYSWD7gECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAg2bIpIPJpOPKpONKTIwG8mJXj5oqlmoqlmrGHNM1E14WHYkMa/XhfGAbvpsIa4925LotugBJoWp8SUpMjGr14TxjAK/sh6nxOyXIpOMIkLozHtoBGAJI2szvy7aPQ9f4tn2s9e93GQR6WFZUK8uzGotFAt3wDcfV0/xLlSt1UkA3FrKTWsxOKRIZDlzjb+b3VSzVjBj9GyuAFwuXckkj+sgLK/cbu2o4rnHHNnABLCvacwxgWVEt5ZK+TQlnlfv3nftVcT05ffebQR7Ak8ef6datD/Xq19/Vav391meOc6JiqaY/mn/qk48/0sjIdV+V+/WNXVWPml0r3IP7M3pwf0bPnr8a6HEaMRWcSceVmhvXVuFA24XDU58XSzWVK3UtZqe0kJ30dbk3bYxjzLOAzn5/fWP3VGl03VZ7ELWyPCvLivqu3JuYcoZMu4PGYhGtfj3f805qOK7Wvt1Ram5c93K3B35BXbfVs3J552OisMYK0HnHfPf4057RqVypq1ypD7Sklit1Pc2/7FruI5FhZdJxLeWSRndZQzKcpVxSi9mptgjvsl04VKXymxayk1cWG6tHzffOYHoN74e5DOMF8O6mleVZpe6Ma+ung1MXvuG4Wt/YVfmX+qXGxrPKvWVFtfj5lLHl3rcCdF5gy4qqWKppM79/qluw7WN9Zf98Kd1Cr//57gDWbwzJh5wVG7cLhyqWahcSG237WJv5/a553sRYFwoBzhMby5U33cJ5y7JfY11oBOg3NlaPmueKjf3Eunu520rNBWMdw5ACQj+xcc92lEnHe5bs7cKhtgoHPft5P8S60ArQT2x03VY7NnbexcVSTduFw57Tt5l0XAvZyUCuVRj408Af8ouX9rdt+7hrbOws515/343ExOh/Gj+chy9zW1SAQcXGXg0ftPUIoRWg39gYpFiHAH3ERm+eoBNTHi4hwBXExpXlWS3lkqpW30zuJBKjobnjQy9AZ0Xw05z9ZcHuYAQABAAEGBQmrpUP07kPXIAw7gs06dyN2Bxq0lapq8J7XB16AVy3pbVHO6HqChqOa8wbQozZG+g9bg3yNKy31sCkDaJGbg713hqSmhv3vQyu21K5Um+/IMo0jBSgk8TEaHuqdmY6ptjYDWPn6xuOK6dxor0Xjly3pWq12XMtIQJcgBiRm8O6GRlRLHaj/fuZ6dhb3/s/wngN2sneC6f9s+Oc6LX7l9zXLeMbOnACQEBSACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAPwL3XwvzOsJdhMAAAAASUVORK5CYII=",s="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwNiAzMDY7IiB2aWV3Qm94PSIwIDAgMzA2IDMwNiIgeD0iMHB4IiB5PSIwcHgiIHhtbG5zOnhtbD0iaHR0cDovL3d3dy53My5vcmcvWE1MLzE5OTgvbmFtZXNwYWNlIiB4bWw6c3BhY2U9InByZXNlcnZlIj4KICA8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgogICAgLnN0MHtmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtmaWxsOnJnYigyMTksIDQxLCA1Myk7fQogICAgLnN0MXtlbmFibGUtYmFja2dyb3VuZDpuZXc7fQogICAgLnN0MntmaWxsOnJnYigyNTUsIDI1NSwgMjU1KTt9CiAgPC9zdHlsZT4KICA8Zz4KICA8Zz4KICAgIDxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0gMTUzIDAgTCAxNTMgMCBjIDg0LjUgMCAxNTMgNjguNSAxNTMgMTUzIGwgMCAwIGMgMCA4NC41IC02OC41IDE1MyAtMTUzIDE1MyBsIDAgMCBDIDY4LjUgMzA2IDAgMjM3LjUgMCAxNTMgbCAwIDAgQyAwIDY4LjUgNjguNSAwIDE1MyAwIFoiLz4KICAgIDxnIGNsYXNzPSJzdDEiPgogICAgPHBhdGggY2xhc3M9InN0MiIgZD0iTSAxNTQuOCA4My42IGMgMi42IDAgNS4xIDAuNyA3LjUgMi4xIGMgMi4zIDEuNCA0LjEgMy4zIDUuNCA1LjYgbCA1MS45IDk2LjQgYyAxLjIgMi4yIDEuOCA0LjUgMS44IDYuOSBjIDAgMiAtMC40IDMuOSAtMS4yIDUuNiBjIC0wLjggMS44IC0xLjggMy4zIC0zLjIgNC42IGMgLTEuMyAxLjMgLTIuOSAyLjQgLTQuNiAzLjIgYyAtMS44IDAuOCAtMy43IDEuMiAtNS42IDEuMiBIIDEwMi44IGMgLTIgMCAtMy44IC0wLjQgLTUuNiAtMS4yIGMgLTEuOCAtMC44IC0zLjMgLTEuOSAtNC42IC0zLjIgYyAtMS4zIC0xLjMgLTIuNCAtMi45IC0zLjIgLTQuNiBjIC0wLjggLTEuOCAtMS4yIC0zLjYgLTEuMiAtNS42IGMgMCAtMi40IDAuNiAtNC43IDEuOCAtNi45IGwgNTEuOSAtOTYuNCBjIDEuMyAtMi4zIDMuMSAtNC4yIDUuNCAtNS42IEMgMTQ5LjcgODQuMyAxNTIuMiA4My42IDE1NC44IDgzLjYgWiBNIDE1NC44IDkzLjMgYyAtMSAwIC0xLjkgMC4zIC0yLjYgMC44IGMgLTAuNyAwLjYgLTEuNCAxLjIgLTEuOSAyLjEgYyAtMC42IDAuOCAtMSAxLjcgLTEuNCAyLjYgYyAtMC40IDAuOSAtMC44IDEuOCAtMS4yIDIuNSBjIC0wLjggMS41IC0yIDMuOSAtMy44IDcuMiBjIC0xLjggMy40IC0zLjkgNy4zIC02LjQgMTEuNyBjIC0yLjUgNC41IC01LjIgOS4zIC04LjEgMTQuNiBjIC0yLjkgNS4zIC01LjggMTAuNiAtOC43IDE1LjkgcyAtNS43IDEwLjUgLTguNCAxNS41IGMgLTIuNyA1IC01LjEgOS41IC03LjIgMTMuNiBjIC0yLjEgNCAtMy44IDcuMyAtNSA5LjkgYyAtMS4yIDIuNiAtMS45IDQuMiAtMS45IDQuOCBjIDAgMS4zIDAuNSAyLjUgMS40IDMuNCBjIDEgMSAyLjEgMS40IDMuNCAxLjQgaCAxMDMuOSBjIDEuMyAwIDIuNSAtMC41IDMuNCAtMS40IGMgMSAtMSAxLjQgLTIuMSAxLjQgLTMuNCBjIC0xLjUgLTMuNyAtMy4xIC03LjIgLTUgLTEwLjYgYyAtMS45IC0zLjQgLTMuNyAtNi45IC01LjUgLTEwLjQgYyAtMi40IC00LjUgLTQuNyAtOSAtNyAtMTMuNCBjIC0yLjMgLTQuNSAtNC43IC05IC03IC0xMy40IGMgLTIuNCAtNC42IC00LjkgLTkuMiAtNy4zIC0xMy43IGMgLTIuNCAtNC41IC00LjkgLTkuMSAtNy4zIC0xMy43IGMgLTEuOCAtMy4yIC0zLjUgLTYuNSAtNS4zIC05LjcgYyAtMS44IC0zLjIgLTMuNiAtNi40IC01LjQgLTkuNiBjIC0wLjQgLTAuNyAtMC44IC0xLjQgLTEuMiAtMi4xIGMgLTAuNCAtMC43IC0wLjkgLTEuMyAtMS40IC0xLjkgYyAtMC42IC0wLjcgLTEuMiAtMS4zIC0xLjggLTEuOCBDIDE1Ni42IDkzLjYgMTU1LjggOTMuMyAxNTQuOCA5My4zIFogTSAxNTQuOCAxNzcuNiBjIDEgMCAxLjkgMC4yIDIuNyAwLjYgYyAwLjkgMC40IDEuNiAxIDIuMyAxLjYgcyAxLjIgMS41IDEuNiAyLjMgYyAwLjQgMC45IDAuNiAxLjggMC42IDIuNyBjIDAgMSAtMC4yIDEuOSAtMC42IDIuNyBjIC0wLjQgMC45IC0xIDEuNiAtMS42IDIuMyBzIC0xLjUgMS4yIC0yLjMgMS42IGMgLTAuOSAwLjQgLTEuOCAwLjYgLTIuNyAwLjYgYyAtMSAwIC0xLjkgLTAuMiAtMi43IC0wLjYgYyAtMC45IC0wLjQgLTEuNiAtMSAtMi4zIC0xLjYgcyAtMS4yIC0xLjUgLTEuNiAtMi4zIGMgLTAuNCAtMC45IC0wLjYgLTEuOCAtMC42IC0yLjcgYyAwIC0xIDAuMiAtMS45IDAuNiAtMi43IGMgMC40IC0wLjkgMSAtMS42IDEuNiAtMi4zIHMgMS41IC0xLjIgMi4zIC0xLjYgQyAxNTIuOSAxNzcuOCAxNTMuOCAxNzcuNiAxNTQuOCAxNzcuNiBaIE0gMTU5LjcgMTcwLjIgaCAtOS44IHYgLTQ4LjggaCA5LjggViAxNzAuMiBaIi8+CiAgICA8L2c+CiAgPC9nPgogIDwvZz4KPC9zdmc+",m="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ0IiBoZWlnaHQ9IjE0NCIgdmlld0JveD0iMCAwIDE0NCAxNDQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgo8Y2lyY2xlIGN4PSI3MiIgY3k9IjcyIiByPSI3MiIgZmlsbD0idXJsKCNwYXR0ZXJuMCkiLz4KPGNpcmNsZSBjeD0iNzIiIGN5PSI3MiIgcj0iNzIiIGZpbGw9IiNEMTM0MzgiLz4KPHBhdGggZD0iTTQ1LjEyMTQgODdDMzkuMTIyIDg3IDM1IDgzLjI5ODcgMzUgNzguMzc3M0g0MC42NzI5QzQwLjcxMzcgODAuMzcwMyA0Mi42NzI3IDgyLjAzNzkgNDUuMjg0NyA4Mi4wMzc5QzQ3LjgxNSA4Mi4wMzc5IDQ5LjQ4ODMgODAuNjU1IDQ5LjQ4ODMgNzguNjYyQzQ5LjQ4ODMgNzcuMTE2NCA0OC4zNDU2IDc2LjAxODIgNDUuOTM3NyA3NS4yODYxTDQyLjUwOTQgNzQuMzFDMzYuMzQ2OCA3Mi42ODMgMzUuMjQ0OSA2OC45ODE4IDM1LjI0NDkgNjYuNDZDMzUuMjQ0OSA2MS40NTcyIDM5LjU3MSA1OCA0NC45NTgyIDU4QzUwLjI2MzggNTggNTQuMzQ1IDYxLjIxMzIgNTQuMzQ1IDY2LjU0MTRINDguNjcyMUM0OC42NzIxIDY0LjU0ODQgNDcuMjg0NSA2My4wMDI4IDQ0LjgzNTcgNjMuMDAyOEM0Mi42MzE5IDYzLjAwMjggNDAuOTU4NiA2NC40NjcgNDAuOTU4NiA2Ni4zMzhDNDAuOTU4NiA2Ny4wMjk1IDQxLjE2MjYgNjguNDUzIDQ0LjEwMTEgNjkuMzA3Mkw0Ny4yNDM3IDcwLjIwMkM1MS40ODgxIDcxLjQ2MjggNTUuMjAyMSA3My42MTg1IDU1LjIwMjEgNzguMzc3M0M1NS4yMDIxIDgzLjk0OTUgNTAuNDI3IDg3IDQ1LjEyMTQgODdaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNzIuOTE1OCA4N0M2NC45MTY2IDg3IDU4LjYzMTYgODAuNDUxNiA1OC42MzE2IDcyLjUyMDNDNTguNjMxNiA2NC41NDg0IDY0LjkxNjYgNTggNzIuOTE1OCA1OEM4MC44NzQyIDU4IDg3LjI0MDkgNjQuNTQ4NCA4Ny4yNDA5IDcyLjUyMDNDODcuMjQwOSA4MC40NTE2IDgwLjg3NDIgODcgNzIuOTE1OCA4N1pNNzIuOTE1OCA4MS42NzE4Qzc3LjkzNTcgODEuNjcxOCA4MS41MjcyIDc3LjU2MzggODEuNTI3MiA3Mi41MjAzQzgxLjUyNzIgNjcuNDc2OSA3Ny45MzU3IDYzLjMyODIgNzIuOTE1OCA2My4zMjgyQzY3Ljg1NTEgNjMuMzI4MiA2NC4zMDQ0IDY3LjQ3NjkgNjQuMzA0NCA3Mi41MjAzQzY0LjMwNDQgNzcuNTYzOCA2Ny44NTUxIDgxLjY3MTggNzIuOTE1OCA4MS42NzE4WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTEwMC45MTkgODdDOTQuOTIgODcgOTAuNzk4IDgzLjI5ODcgOTAuNzk4IDc4LjM3NzNIOTYuNDcwOUM5Ni41MTE3IDgwLjM3MDMgOTguNDcwNyA4Mi4wMzc5IDEwMS4wODMgODIuMDM3OUMxMDMuNjEzIDgyLjAzNzkgMTA1LjI4NiA4MC42NTUgMTA1LjI4NiA3OC42NjJDMTA1LjI4NiA3Ny4xMTY0IDEwNC4xNDQgNzYuMDE4MiAxMDEuNzM2IDc1LjI4NjFMOTguMzA3NCA3NC4zMUM5Mi4xNDQ4IDcyLjY4MyA5MS4wNDI4IDY4Ljk4MTggOTEuMDQyOCA2Ni40NkM5MS4wNDI4IDYxLjQ1NzIgOTUuMzY4OSA1OCAxMDAuNzU2IDU4QzEwNi4wNjIgNTggMTEwLjE0MyA2MS4yMTMyIDExMC4xNDMgNjYuNTQxNEgxMDQuNDdDMTA0LjQ3IDY0LjU0ODQgMTAzLjA4MiA2My4wMDI4IDEwMC42MzQgNjMuMDAyOEM5OC40Mjk4IDYzLjAwMjggOTYuNzU2NSA2NC40NjcgOTYuNzU2NSA2Ni4zMzhDOTYuNzU2NSA2Ny4wMjk1IDk2Ljk2MDYgNjguNDUzIDk5Ljg5OTEgNjkuMzA3MkwxMDMuMDQyIDcwLjIwMkMxMDcuMjg2IDcxLjQ2MjggMTExIDczLjYxODUgMTExIDc4LjM3NzNDMTExIDgzLjk0OTUgMTA2LjIyNSA4NyAxMDAuOTE5IDg3WiIgZmlsbD0id2hpdGUiLz4KPGRlZnM+CjxwYXR0ZXJuIGlkPSJwYXR0ZXJuMCIgcGF0dGVybkNvbnRlbnRVbml0cz0ib2JqZWN0Qm91bmRpbmdCb3giIHdpZHRoPSIxIiBoZWlnaHQ9IjEiPgo8dXNlIHhsaW5rOmhyZWY9IiNpbWFnZTBfODA2N18yMjc5NzkiIHRyYW5zZm9ybT0ic2NhbGUoMC4wMDI1KSIvPgo8L3BhdHRlcm4+CjxpbWFnZSBpZD0iaW1hZ2UwXzgwNjdfMjI3OTc5IiB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgeGxpbms6aHJlZj0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFaQUFBQUdRQ0FZQUFBQ0F2emJNQUFBQldHbERRMUJKUTBNZ1VISnZabWxzWlFBQUtKRnRrRUZMQWxFVWhjK1laYVJSUkxzYUdGcEV4Q1JsQnUzQ0RDeHlNVTBHRmtHTm8ya3dUcS9uUkFqOWlQYlJyaDhSMHFKZEJPNkNJbWlieXphQkJDWFRmVTZsVmc4dTUrTnczdVZ5QUYrdndaamxCMUMwSGE0bkZwWDA1cFlTcUNFSUdRUHdZY3d3U3l5bWFVbUs0RnM3WC8wZWt0QzdLYkZyNTdsblpsSk5MTnltNWF0YTlXWGtiNzdqOVdWekpaUDBneVpzTXU0QWtrcXNIVHRNOEFueE1LZWppRThGNXoyK0VKengrTEtaU2VseDRpcnhvRmt3c3NSUHhHcW16YyszY2RFNk1yOXVFTmVIY3ZiR091a1F6U2lTU0VEQk1wYWdrMGF4U3YzOG40ODI4M0VjZ0tFTWpuM2tVWUJEdjJMa01GaklFYS9BaG9rd1ZPSUlwbWtpb3VmZi9iVzg4Z013djBhdzNmSlNqMEJGQTRKbkxXOWlIT2pmQlc3bW1NR05uMWFsdXIrME54dnhPTVNCN2pmWGZaV0JRQVZvY05kOVAzZmRCblhZUlR1dkR6OEIwTzloQ0xDY1g0UUFBQUE0WlZoSlprMU5BQ29BQUFBSUFBR0hhUUFFQUFBQUFRQUFBQm9BQUFBQUFBS2dBZ0FFQUFBQUFRQUFBWkNnQXdBRUFBQUFBUUFBQVpBQUFBQUFPUGxOOWdBQVB4MUpSRUZVZUFIdG5WdVFGY2VaNTdPcVc3dGN0SFNmdG9VdE5ERTYzWUIyck81WkkyNStHR1Exc3VCQkY0UTlJZkNUUUx6SURpbFdXRHUyTi9aQmdOL0dudFVsd2hySjh5QkEreUpRaEhXeDVJaXhKdFF0SVQ4c1lJSFgzZkpZWExxSk1DZ0VOdFhJeldWWG5GUDdmVVZYYy9yMHVWUmxaVlZsWmY0ekFrNmRPcFczWCtZNS8vN3l5NHNqRUVEQUlBSmpudGROMWVtK0trVFpwMzljTlg1MVhMZmJkWnl1OEgzdzZ2dGxmZzJETS9WOCtMN1pLNlUzSG41R2NTYUU0MHhNdlovZzkxWGZ2K0JYcTN3OVRzOU91UFNQWDIrZzk3MmxVdmhzbUFSZVFhQ3dCS2lQSTRCQWNRaVFRSlQvbnhETHFPTjJzekIwZEhUY3lxOCtpUUhmbzVyd1A5M0RVUllkRnBoS3BYS0tYL2xmNXpXQkdkZTk4Q2dmQ0lRRXFOOGlnSUJlQk5pSytKeEVnVXExVExqdU1zZHhiaVdCWU5IZ2V6WUVGcGh4cXZNcHNtU0cyWUloY1RrSzY4V0dwaTlXSFNFZ3hXb3Y0MG9iV2hTZHJudHIxWEVHTFJPS3VPMFpDRXUxVXZrdGljb3dSQ1V1UGp5dm1nQUVSRFZScE5lVUFGc1c1SnRZNXJydVZ5RVdUVEhGK29DK3dPTys0eHgxZlgrNFdxMytGcUlTQ3g4ZVRrZ0FBcElRSUtJM0o4Q0NRZjZLUVhKZ0QxSkh1NHVlWE5iOGFYeWlrTUJSOGd1OXg4TmYvNEVzRlF4OUtTU0xwR1lRZ0lETXdJRTNTUWhBTUpMUVN6VXVCQ1ZWdlBZbURnR3h0KzJWMVB5WTV3Mkt6czY3aE84UEJ2K1VwSXBFVWlYZ09NTTA1UFY2cFZwOTc3WlM2V2lxZVNGeG93bEFRSXh1WHZXVkMvMFl2dXR1cE02emhYSW93clJaOVNBTVNaSGFjSnhtZkEzVGRPSTMvbk9wOUxvaDFVSTFNaUlBQWNrSWRKR3pZZEdnYWJVYm5ZNk9MV1Jsc0I4RG9sSGtCbTFWZHNkNW5YNFVYdThnUVlIdnBCVW9mTVlFSUNEb0J3MEoxSW5HWU1PSGNOTnNBbVNaMEEvRUhvaUoyYzJjcEhZUWtDVDBESXNiRGsrSmpvNGRzRFFNYTl5azFTSExoTmFmN01Vd1YxS1Fac1dIZ0pqVm5sSzFZVWM0ZkJwUzZLeUxSRDhZZ2MvRUp6RlpXaW9OV3djQUZaNUJBQUl5QTRjOWJ3SnJvN1B6Q1ZHdGJxUmFzMThEQVFSaUVhRFY4R08waUhFWERYRzlSLzZTOFZpUjhiQVJCQ0FnUmpSajlFb0UwMjZ2RFZFTlJvK0ZKMEdnTlFIYXIyd1BySkxXakV6OEZBSmlZcXZXMVltdGphcnJicWtLc1pVK2dyVlJ4d2R2MVJHQVZhS09aUkZTZ29BVW9aVWt5MGpDVWY3Y2RiZFRJMk85aGlSRFJKTW1NRUZXQ1U4SDNvWGhMV21HMmtlRWdHamZSUEVMaUdHcStNd1FJejBDR041S2oyM2VLVU5BOG00QmhmbERPQlRDUkZKcEVEaENZdkxja2dVTDlxYVJPTkxNbmdBRUpIdm15blA4MlBPMjBoYnBPMmdIMXJMeXhKRWdDQ2dtRVBwSklDU0t3ZWFRSEFRa0IraXFzb1J3cUNLSmRQSWdBQ0hKZzdyYVBDRWdhbmxta2hxRUl4UE15Q1FqQWhDU2pFQ25rQTBFSkFXb2FTVUo0VWlMTE5MVmdRQ0VSSWRXaUZjR0NFZzhYcms4SFRqSFhmY1p5aHhyT0hKcEFXU2FKUUVJU1phMGsrVUZBVW5HTDlYWW1GV1ZLbDRrcmorQkkzUXM3elljZXFWdlEwRkFOR3diWGdCWTZlaDR4dmQ5M3FjS0FRU3NKc0RyU0xBZ1VjOHVBQUhScUYxcU5qamNUc1hxMXFob0tBb0k1RTNBRjY2N2EvTHExZWZ1S0pVbThpNE04cjlHQUFLaVNVOWdCN2x6emM4QjRkQ2tUVkFNL1FqQVA2SlhtMEJBY200UEVvNWxkRlRzTTNTQTAyRE9SVUgySUZBa0FrYzZxOVZ2WVordGZKc01BcElULzZuaHFoMTBIZ2NQVnlHQUFBaklFSENjWnlZcmxSOWhXRXNHWHZJNEVKRGtER09ud0xPcmFMaHFON1llaVkwT0VVQmdGZ0VNYTgxQ2t0a05DRWhtcU9uNE5wcGRkYldqWXplR3F6S0VqcXlzSVlEWld0azNOWWszUWhZRVRreE9QbkhWZFk5QVBMS2dqVHhzSkVEVDNyZlN3V252SHYvc016Ny9CaUVEQXJCQVVvWU1xeU5sd0VnZUJCb1FvTFBhWDd1aFVua1NUdllHY0JUZWdnV2lFR1o5VXJBNjZvbmdQUWhrUThEeC9XL0NHa21mTlN5UUZCZ0hNNnc2T2w3RGNGVUtjSkVrQ01Ra0FOOUlUR0F4SG9lQXhJQVY1ZEdwalE5Zm8yZXhJREFLTUR3REFoa1F3RXl0ZENCRFFCUnh4Ym9PUlNDUkRBaWtTWURXalN4ZHNPREpOTE93S1cwSWlJTFdaa2Q1eFhXSHNLNURBVXdrQVFJcEUyQnJ4SzFXNzRhRFBUbG9PTkVUTWd3ZDVSQ1BoQ0FSSFFReUlsQVZvcGVtMUgvNDc1NkhYU0FTTW9jRklna1FRMWFTNEJBTkJIUWlnSzFRRXJVR0JFUUNINGFzSktBaENnaG9TZ0JEV3ZJTmd5R3NtT3lPVDA1dTRSWGxHTEtLQ1E2UGc0Q21CTUloTGF4Z2o5OUFFSkFZekk3OTVTODcvRXBsRDBYQkZOMFkzUEFvQ0JTQVFJbTJRdG5OMy9FQ2xGV2JJbUlJSzBKVEJQNE9MQXlNUUFxUGdFRHhDV0FibE9odENBRnB3d3IramphQThERUlHRWdBZnBGb2pZb2hyQmFjZUZVNS9CMHRBT0VqRURDVVFPZ1grWVBuYlRTMGlrcXFCUUZwZ3BIWGR3aGFIRWdmdzkvUmhCRnVnNERoQkVxdTYvNGNmcEhtclF3QmFjQ0dPMHkxVW5tMndVZTRCUUlnWUJjQmg0NmQzZ0VSYWR6bzhJSFVjR0ZuK2VjZEhjL1FWdEJiYTI3akVnUkFBQVNFY0p6ZGRQNzZremgvL1hwbmdJQk1zV0JuT2ZrN2VCZmRaZGZ4NEFvRVFBQUVaaEE0MGxtdGZndjdhRjFqQWdFaERwaHBOZU1MZ2pjZ0FBSXRDR0NHMW5VNDFnc0l4T042WjhBVkNJQkFOQUlRa1d1Y3JIYWlmK3g1eXpCTk45b1hCaytCQUFoY0o4RFRmUG5JWFA0TnVYN1h2aXRyTFJCdWVBZlRkTzNyOGFneENLZ2w0UGwwdHNodHBkSlJ0Y2tXSXpVckxSRGVFSkhFNHdnMVVYY3htZ21sQkFFUTBKUkFpWDVMUHJSMUkwYnJMQkFXajZrTkVUWHRqeWdXQ0lCQUFRblFGbHJPSTBzV0xOaGJ3TEpMRjlrcUFZRjRTUGNUUkFRQkVHaFB3RG9Sc1VaQUlCN3RleitlQUFFUVNFekFLaEd4UWtBZ0hvbS9GRWdBQkVBZ09nRnJSTVI0QVlGNFJPLzFlQklFUUVBWkFTdEV4R2dCZ1hnbyt6SWdJUkFBZ2ZnRWpCY1JZd1ZrYXAwSFQ5VkZBQUVRQUlHOENQaTBUbVM1cWV0RWpGd0hVck5JTUs5T2czeEJBQVJBZ0FrNHRFN0UyQlhyeGxrZzJOc0szMW9RQUFFTkNYaTBpKzl5MDNieE5jb0NnWGhvK0xWQmtVQUFCSmhBaWZmTzR0OG9rM0FZWTRGQVBFenFscWdMQ0poSmdQNWlIM05wN3l4VExCRWpMQkFTajI0K0RNb1hvbXhtdDBPdFFBQUVUQ0RBdS9qU2I5WFBqOUJ2bGduMU1VSkErQmhhYWd5cnQxVTJvVE9pRGlCZ0NZRTdidXpvZU5xRXVoWmVRUGl3ZTV4aGJrSlhSQjFBd0NJQ3ZyK1ZmN3VLWHVOQyswQ0NCcWhXZHhhOUVWQitFQUFCS3duNGxXcjF5YjhwbFo0dGF1MExLeUIvOEx5Tkx2azlpZ29lNVFZQkVBQUJJdUFMY3FvdkxaV0dpMGlqa0FMQ002NzRLRm9DYm9RanFvZ2RCMlVHQVJCUVJxQ3dhMFFLNXdNSnArdFMwMEU4bFBWZkpBUUNJSkFqZ1dDTlNCRm5aaFZPUUNvMDR3clRkWFBzNnNnYUJFQkFPUUdlM2tzenMzNnVQT0dVRXl5VWdMRFQzUGY5alNrelFmSWdBQUlna0QwQjN4OHMyc3lzd3ZoQWFJUEVyYlFwMmU3c1d4VTVnZ0FJZ0VCbUJBcTFCWHdoQkFSTzg4dzZMeklDQVJESW4wQmhuT3JhRDJIeE5pVVYxeDJpTm9YVFBQK09qUktBQUFpa1Q2QXdUblh0QmVScVorY09PTTNUNzdISUFRUkFRQjhDVTA3MXAvUXBVZU9TYUMwZ0p5WW5uNkJGTnRzYkZ4MTNRUUFFUU1CZ0FyNi8vZDg5VCt2ZlAyMTlJUEI3R1B6RlFOVkFBQVNpRXREYUg2S3RCUUsvUjlUK2hlZEFBQVFNSnFDMVAwUkxBYUc1MEZnc2FQQTNBbFVEQVJDSVRrQm5mNGgyUTFoWTd4RzlZK0ZKRUFBQmF3aG91ZW1pVmdJUzduT0ZXVmZXZkNsUVVSQUFnZWdFdk1scXRlK09VbWtpZXBSMG45UnFDT3R6MTkwSjhVaTN3WkU2Q0lCQVlRbVVkTnN2U3hzQkNZYXVoTmhTMktaRndVRUFCRUFnYlFLMFg1Wk9VM3UxR01MQzBGWGF2UTdwZ3dBSUdFUkFtNm05V2xnZzJLTGRvSzZOcW9BQUNLUk5vSFMxbytPbHRET0prbjd1QXNKRFY5aWlQVXBUNFJrUUFBRVFtQ0tneVZCV3JrTllHTHJDMXdFRVFBQUVwQW5rUHBTVnF3V0NXVmZTSFFjUlFRQUVRS0QwZVVmSDAzbGl5TTBDd1lMQlBKc2RlWU1BQ0JoQ0lOY0ZocmtJQ0ExZDhSa2ZSN0RtdzVBdWpHcUFBQWprUm9DR2tjWStxMWFYNTdIQU1KY2hMSnp4a1Z0ZlE4WWdBQUtHRWNoenI2ek1MUkIybkY5MTNUSEQyaERWQVFFUUFJRThDZmcrV1NHM2xVcEhzeXhFNWhZSWljZHJXVllRZVlFQUNJQ0FCUVFjSndlSGVxWUN3bzV6YXNobEZqUW1xZ2dDSUFBQzJSS2d0U0hIUC9zczArMmdNaHZDd3BxUGJQc1NjZ01CRUxDU1FLWTc5blptaFpnYzUxdm9mUE55VnZraEh4Qm9SdURpNWN0aTlNUkpjZmI4ZVhITzg4UlorbmZ1dkNmNGZ2RHZ5cFVaVWVmUG1TUG16NTByYnVvcEJmZDdGeTBTTjVWS29uekxJc0hYL0JrQ0NHaENvRFJQQ0Q1SGZXY1c1Y25FQW9IalBJdW1SQjdOQ0xCQUhQemRpQmo3NUJQeDBmRVRnV0EwZTFibS9zSXBNVm5kM3kvNkYvZUpoVDA5TXNrZ0RnaW9JcERaQ3ZWTUJPVGpDeGYyVUVhWmpzMnBhZ21rVTB3Q1kyZk9pSU1qbytJUS9lUHJMQU5iSlN3azk5MjVCbUtTSlhqa05VM0FkNXpYYmx1dzRGdlROMUs2U0YxQXlIRyt6S0ZGZ3ltVkg4bUN3RFFCSG40YU9uUllIQndkRFlhb3BqL0k4WUxGaElWazlVQS9ocnB5YkFjTHM4NWtoWHJxQW5Mc3dnVVdEOHk4c3JBSFoxVmxGbzYzRG53ZzNuNy9nTGhZNTcvSXFnenQ4dUZocnY3Rmk4V205ZmZBS21rSEM1K3JJZUE0UTBzWExMaGJUV0tOVTBsVlFMRGZWV1BvdUt1R1FCR0VvMUZOMTY1Y0NTRnBCQWIzVkJOSTNRcEpWVUNPWDdndzVndFJWazBGNmRsTm9LakNVZHRxYkpFTXJsb3BOcTlmVjNzYjF5Q2dtc0NScFYxZHkxVW5HcWFYbW9EQStnZ1I0MVVsZ1pFVEo4VHpyK3hYUHBOS1pSbmpwTVZDOHNpREQ1Q1BaQ0JPTkR3TEFsRUprRC9kZVdUSmdnVjdvMGFJODF4cUFnTHJJMDR6NE5sMkJOanEyUGVyZDhUYjVPc3dNZkN3RmdzSjFwU1kyTHI1MW9tMkd4bGIzTlhWbDBZcFVoRVFXQjlwTkpXOWFZNmRQaTErdk9kbFk2eU9aaTNKMXNpdTd6NEtKM3N6UUxndlN5QTFLeVFWQVlIMUlkdk9pRmRQNEswREI4VHVOMzVSZjl2bzk1dklMd0xmaU5GTm5IbmwwckpDS0YyMWdhMFBPTTdWTXJVMXRaZmVlTk02OGVDMjNrOURkYnVwN2dnZ29Jb0FuUmxTVG1PalJlVVdDS3dQVlUxdWJ6cVQ1Ty80OFo2OTJpd0d6S3NsK21nUjRrNGEwb0pmSks4V01DdmZOS3dRcFJZSXJBK3pPbHdldGZtVU5qamMrY0xQckJjUFpuK1N0bUQ1aDZlZkRUWjl6S010a0tkWkJOS3dRcFJhSUxBK3pPcHdXZGNtRkEvZS9EQ3J3STVyM2xWM1lhbUhkdGp0bnY1clA5d1E4ZUxsUzdSRDc1WEFnWCtKWHNmT25BNnVlZmZlckFLYzYxbVJOajhmMVZhSU1nSEJ6Q3Z6TzErYU5jeEtQT2JOblNQdVhybUt0aFhwcFg5TFNERG1TRldMUldYMHhISGFzUEVqTVhMeVJMQWR2RlJDRVNOOWlZVHVKMDl1bnhhNGlOSHdHQWpVRTFDNk9sMlpnR0RQcS9wMnd2dW9CQ1l2WFJZN1gveFphcnZtaHFLeGV1RDJZRCtxcU9XSzh4eWZMOEliT2FZcEp2Q0p4R2tSUE51VWdNSTlzcFFJeURIUEd4U3VPOVMwd1BnQUJGb1ErT2tyKzhUUTRkKzBlRUx1SXo0QTZ2NDFhOFRhVmF1a0xRMlpuRmxJOXIzelRpcFd5ZHBWSzhUam16ZkxGQXR4UUNBa29Nd0tVU0lnT084amJCZTh4aVhBVTFaNWhibkt3QmJIdGcwYlNEaFdxa3cyZGxwcENRbldpY1J1Q2tTb0o2RElDa2tzSURodHNMNWw4RDRxZ2Y5Tmh6M3hkRjJWNFg0NmUyUFQrdldaV2h5dHlzOWJzUEQySzZwRmtsZXNEOUQyOEFnZ0lFbkE3NnhXKzNwTHBYSEorRUcweE5ONFAzZmRuVWtLZ0xoMkVtQ24rUjZGaStWNHVPcWZ2cmVkOXBQYW9JMTRjTXZ5R2c2MkdQNzVmL3ozNlRQVlZiVDRUM2hyRjJLSUFBS1NCSnpQaFhoQ011NTB0RVFXeUpUMXdRZEdkVStuaUFzUWFFT0FkaW9RTzE1NFVkbGFEOTJzam1iVloydUVoK3o0OENzVmdZL04vZEYzdjZNaUthUmhKd0Z2a3F5UU8wcWxDZG5xSjdKQVNNRUdLV09JaHl4OVMrTzlUZnRiOGF3bEZXRWJXUnk2V1IzTjZzWFdDSmRWMVQ1WHpGQ1ZHRFVyTSs0YlRhQjdyaEJiazlRd2tZQzRycnNqU2VhSWF4OEJIcnJhLzYvSm5lYnNLUC9oMWkzQmVlTkZvOGhEV2ovWStyRGdPaVFOcjVKRmc2R3NwQlN0amU5MHVPN0RTV292TFNBOGRSZWJKaVpCYjJkYy9zRkxlbTQ1Ly9EKzZEdmZvVU9ZK2dzTDhXdDBnTlF1R241S0tpSzhiOWp1TiszYXJiaXdqYTVud1pjRnl6QWt5eVl0SUw3cmJwWE1FOUVzSmNCN095VmQ3OEZPT3hhUFh0cCtwT2lCRndheWlDUU5CMmsyRzUvVWlBQUNFZ1FjMGRIeGxFUzhJSXFVZ0xEem5MN0lXMlF6UlR6N0NQaGtydkpSdEVuRFk5L2VaSVI0aEJ4WVJCN2Z2Q2w4Sy8zS3pua0VFSkFpNFB1RFJ6eFB5cGN0SlNCVHpuT3BzaUtTblFTR0R4OFc0MlNCSkFuc08rQ2pYMDBMdk9BeHFXT2RIZXF3UWt6ckdablZ4NWtueEhhWjNLUUVCTTV6R2RUMnhpSGpnNGF1RGljQ3NMcS9QL0dQYktJQ3BCejVJUkpIbnBhYkpNQUtTVUxQN3JqMG03NUJoa0JzQVlIelhBYXozWEg0citNazAzWjVrU0JQZnpVNXNHL25CMXVTemN5Q0ZXSnlEMG05YmxMTzlOZ0NBdWQ1NmcxcFhBYkRodzRscXRQbWRldkVRaElSMDhPTjgrWWw5b2ZBQ2pHOWw2UldQNGRHQ2g2TW0zcHNBYUVJZDhYTkJNL2JTNERYZlNTWmVjVStqN3czUmN5eTlWYlQ5TjRrUTFrZmtiWEhLOTRSUUNBdUFjZDF0OFIxcHNjU2tPT2V0NUZVcWh5M1lIamVYZ0w4Z3lZYmVGaUhIZWMyQmE3ell3bG1aYkcvQ2F2VGJlb3hTdXZhZmFNUXkrS2tHRXRBYUw3d2xqaUo0MW03Q2ZEVTNTUS9ab05rZmRnd2RGWGZTNzdVMDVOb3dzQW8xb1RVSThYN2FBUmlyd21KTENDMDlxUGI5LzJOMGNxQnAwQkEwTm5oNTZXbjd0cG9mZFQybVh2WC9KMzBLblcyK3JJOFY3NjIzTGd1T0FIZlh4Wm5HQ3V5Z05EYUQ0aEh3ZnRHMXNVL05Eb3FuYVd0MWtjSWpCM3FYK3NmQ04vR2V1VmhMRjZkamdBQ0VnUzY1OGY0clk4c0lBNkdyeVRhd3Q0b1BId2wreVBtT0k2NDcrdHI3SVUzVmZNa2t3Y09qb3hZenc4QXBBZzQ5RnNmZVlQRlNBTEN3MWVDbHJ0TEZRZVJyQ1J3OGZJbDZiVWY1VVUzaTE3YTRzUDJjRHN0TEpTZGtZWFpXTGIzbmdUMWo3RzFTU1FCd2ZCVmdzYXdOT3I0bVUra2E4N0RWd2hDc0I5STl0aGFIc1lhUzdoMUROckFYZ0pSaDdFaUNZamIwUkY3Z1ltOTZGRnpKakJ5VW03NkxnOWY4YllsQ05jSTNMVnloVFNLSkNJdW5Ta2lta0FnOGpCV0pBSEI3Q3NUK2tTMmRUaDFXbTdqeFBLaUwxczVkYmRaNnl3c2xRVC9rd2xKdG8rUnlROXhEQ0lRY1RaV1d3SGh4WU1HWVVGVk1pREFEblRaYWFTOU45K1NRUW1Ma3dWYlpLc2tEODRhUDMyNk9CVkZTWFVqRUdsUllWc0JxYm91QkVTM3B0VytQTDcwK285VkE3ZHJYN3VzQ3lnN29lQ2M1MkZiazZ3Ynk1ejhJdTJOMVZaQTZJRzd6R0dDbW1SQllFeHkrSXFkeGpmUktteUVtUVI0TnBac1NIcDhzR3kraUZkOEFydzNWcnRhdEJRUW1yNjdqRVlqeXUwU3dlY2dVRXZnMHBVcnRXK2pYOU53amV4ZjI5RXpLZDZUc2o0USt1NEtER01WcjcwMUtuRjN1L1BTV3dySVZTRUdOYW9NaWxJUUFyTCtqL0xOWHk1SURiTXZwcXlJWEx3c0tlYlpWeEU1NmtmQXFiYlJnSllDUXBzbll2cXVmbzJxZllsNDdGMG16Sjg3VnlhYStYSElNdU5EdFdTQ3JKakw1SVU0NWhHZ0pSeGZiMVdycGdLQzFlZXRzT0d6TkFqTW0wc25NeVBNSWdEZjBDd2t1SkVWZ1RhcjBwc0tTS1dONlpKVitaRlA4UWpJSG1nMGIrNmM0bFZXOHhKZnd1RlNtcmVRL3NXN3NhT2o2VVNxcGdMU2J1eEwvMnFqaEhrUndNeWZ2TWpQem5kU2RrTEQ3S1J3eDA0Q2psK3BERGFyZWxNQm9TbGNUVlduV1dLNER3SWdBQUlnWUJpQkZsclFVRURJLzFFbUJNc013NERxWkVSZy9od01SV1dFdW0wMk42SXQyakxDQTYwSmtBK3U2U0ZURFFXRS9COFFqOVpNOFdrTEFwaE4xUUtPNUVlWExsMldpamtQTTl1a3VDSFNUQUxOL0NBTkJRVCtqNW53OEM0YkF1Zk9uODhtbzRMbHdnc0NMMTZSRTVDQ1ZSWEYxWk5BVXo5SVF3R0IvMFBQVml4S3FXUVh2WjA3TDdkK3BDaGNwTXRKQ2lLN0lGQzJMYVRMaW9obUVtamlCNWtsSU1INkR3eGhtZGtKTXFyVmZNbnB1T2NtSmpJcVlkR3lrZCtjVW5ZQll0RUlvYnpwRW1qbUI1a2xJTFI5Q2Z3ZjZiYUY4YW5mS25zY0xlMERqNVhUczd0SGtzMHA0WSthelJOMzVBamMyRUFiWmdrSUpRMEJrZU9MV0ZNRVpHZGg4VmovNlBFVDRGaEg0SnduNlJ2QzVwUjFKUEUyQ1lGR2s2dG1DWWpUWXRWaGtzd1IxeDRDL0ZldjdOajdPTTd4bnRWUkRvMStOT3RlbEJ0OHVpTUNDQ2dpUUgrT3pEN2FZNWFBQ0RyS1VGR0dTTVpTQW55S1hsbHlHT3ZneUtpbDFCcFhtNDZURnJKSDB5NHNmYUZ4b3JnTEFoSUVPbDMzcS9YUlpnZ0lMeUNrWVlSeS9VTjREd0p4Q2ZRdjZZc2JKWGllZC9LRkgrUTZ1ck0wdFZtV3g2MkxicjZlRUs1QUlDRUJXdDVSUHVKNTNiWEp6QkFRY3FDWGF6L0VOUWpJRXVoZEpIZTJPZnRCaGc0ZGxzM1d1SGdIUitVdHN2NEVKeGthQnhJVlVrS2dma0hoREFIQkFrSWxqSkVJRWJnMXdlRlFveWZnU09kT3hNTlh3NGMvbE9wUFBJeUkweDJsMENGU0N3S1ZTcVczOXVNWkF0TFIwVEZyakt2MllWeURRRlFDOCtmTkU3Si9BZk9ZL3doRVJQRDBYZGxKQmYxOXZRSlRlS1AyVmp3WGtjQXNSL29NQWFHL2VNb1JFOEpqSU5DU0FNM1lFS3NIK2xzKzArckQ0VU8vYWZXeDhaL3hVTjdiSDN3Z1hjOVZBd1BTY1JFUkJKb1JxSGVrVHdzSVZxQTNRNGI3c2dSVzljc0x5Q0VhKzVjOW1FcTJ2RHJGTy92blA5UHdsWnlJOHZEVjZnVHNkZUtBc3VoRm9ONlJQaTBnV0lHdVYwT1pVSnFGUFQzU3cxaVRkSkxlV3dmay93SXZNaisyUHZhLzgyL1NWU2pUN0t1RmttZW9TMmVLaU5ZUW1GOHoyV3BhUUdqSVljYjBMR3Rvb0tLcEVlQmhySUhGaTZYVGYvVlg3d2lleG1wYlNHSjlNS3Y3MXF5eERSbnFteTJCNmJXQzB3S0NHVmpadG9BdHVkMjc1dStrcThwL2lmOTAzMzdwK0VXTXlET3ZrbGdmUEh6Vm4wQzBpOGdNWmM2VUFQOWRPRDNaYWxwQTNJNk9Xek10QmpLemdrQ1MyVmdNaUdkazJiUTZuZGZBeVBvK21OZmFsU3N4Zk1VZ0VGSWpRSC9ZbGNQRXB3VUVNN0JDSkhoVlNZRC9YTm04Zm4yaUpKOG5LOFFHaC9xbjVEaC9OWUh2ZzYyUHUxWXVUOFFha1VHZ0hZSGFtVmpUQWtLUnBzZTEyaVdBejBFZ0RvSGJhVVcwN0pvUXpvY2Q2dis0WjIrY0xBdjNMQTlkN1huekxlbHRTN2pDekRpSno2bHcwRkRnWEFqd1RLd3c0MEJBZms5N1lJVTM4QW9DcWdtb3NFSjRLR3NmT2RWTkRJSGZnK3FXWk5zU1pqeTRZb1dKZUZBbkRRbUVtaEVJU0dlTm9taFlWaFRKQUFKSnJSQkdzSjkrWkljT203ZFAxbHNIRGlSeW5ET2IzbHR1RVd0WHJlUkxCQkJJblVEbjFLNGxnWURVT2tWU3p4a1pXRWxBaFJYQzRKNS9aYi8wOWg0NmdqLzV4ejhHUTFkSnlzYStqOGMyUDVRa0NjUUZnVmdFL0VxbHhCRWdJTEd3NGVFa0JIaU1Qc24ySnB3M1QrMTk2b1dmR1NFaUxCNDdYL3lYSkVpRHVEenpTdmI4bGNTWkl3RWJDVGloMFJFSUNCRW8yMGdCZGM2ZXdOWU5HOFM4dVhNU1pjd3pzbGhFaWpxOWwwWHczVU9IQXZHNGVPVktJaFlMdjlBakhscDNUNkkwRUJrRTRoSndIZWV2T1U0Z0lGZ0RFaGNmbnBjbDhDWGFZbVB6dW1UVGVqbHZGaEdlbVZVMHh6bzd6Tjk2LzMzeC9MNVhSVkx4NEdIQkIyalZPYll0a2UyTmlKZUFRSm5qWHJOQWZCL2JtQ1FnaWFqeENOejM5VFdKcHZYVzVzYU85ZDF2dkNrbUwxMnV2YTNsOWVTbFMrSWxLaXRQMTFVUitwY3NGdmZlaVcxTFZMQkVHdkVJa0FWUzVoamhFQmJXZ0RBTmhFd0k4Ri9PajIzZW5IZ29LeXdzYjdyNC9XZWVGWjlxdW04V0QxbXh2K1A3enp3bmZ2bkJyOE5pSjNybG9hdkhObTFLbEFZaWc0QXNBVm9MRWhnZERtL2pmdFYxUGRtRUVBOEVaQW53Mm82blhuaFJObnJEZUp2V3J3czJFN3h4M3R5R24yZDlrNjBPSG1aVEpSeGNmcDUxOVlNdER5ZWVrSkExQytSbkZBRi9zbHJ0WVFGWlJnSnl4S2lxb1RLRkljQkRVS3I5R0F0TEpjRkNNcmh5UmZCam13Y005blh3dmxaNzN2eEZZbDlIYmZuWmV1TzY4VDhFRU1pUmdIKzFXdTF6am5uZW9IRGRvUndMZ3F3dEovRFRWL2JSQWtHNXc1TmFvY3REU05qaVlPRmdpK09zcDk2d3Y1c1dDejYyR1VOWHJkb2RuMlZDd0JmVjZ0M09jYy9iNkx2dWE1bGtpVXhBb0FFQjN1dHFSNHByTzFoSWVJdnp3VlVyUkg5Zm4zS3JoSzBOUHNQOTBNaG9zSk51MHRsVkRSQUZ0M3IvNmhheDY5Rkg2YXp6Wk5PZ202V1AreUFRZzREdlY2dmJuSTg5YjZ2anVydGpSTVNqSUtDY0FJdklQNUFqL054NTlYKzExeFkyRkJOZTBIZ3JuOXhINGtLS0luaG9LR3Bnd2VCcHhPekRHU1hoNE8zWDB4S05zRXpzTkdmeHdKVGRrQWhlY3lad1RVRCs0SGs3WGRmZGtYTmhrRDBJMEN3cVQreDQ4Y1hVUmFRV05RdklUYlEycFhmUklwb1ZOamNRRkg0TkZqdVNVUHpKbXdnZVo0SDdFdzFKOGJEVStPa3pxUXhQMVphcjlocmlVVXNEMTdvUXFGYXJ1OWdDZVpZc2tDZDBLUlRLWVRlQlBFUkVaK0k4YlBXRGh4K0c1YUZ6STFsYU5ockNldGFsT2VwWVJHaHBCOUN4MnJ4Uy9aKyt0eDE3TzFIakROQkNRUXhiNmRoTFVTWW1RTlBKdTJnWGs0NHU0QUFCblFqY1NFTkkvL1BKN2VKK1MxZFo4enFQQjJpMS9xN3Z3R0d1VTc5RVdXWVNvSDdxZE1JQ21Ra0Y3L1FoOE1pREcyakcwZHpnSEJEcXAxWUVGbzl0R3g3QUZpVld0SGF4SzBtVFNXNTFqbjMyMlpEdy9jRmlWd1dsTjVtQUxYNFJkcGF6djZQM2xrVW1OeWZxWmdvQjN4OXlqbDI0Y0lUcWc3MndUR2xVUSt2QjAyWjUxVHJ2ZTJWYVlLdmovalYvSng1YXZ4NXJQRXhyWElQclF4c3Bqam5ITDF3WW8rR0Jzc0gxUk5VTUluQndaRVM4Uk51RHBMMWVKQ3RrYkhVOHZ1bWhZS0ZqVm5raUh4QlFRUUFDb29JaTBzaUZBRnNqNzlMNTZFVVZrdm0wMlNPZjVYSHZuWGZDNnNpbEJ5SFRwQVFnSUVrSkluNnVCTTdTd2tNV2ttRVNrcUk0MlNFY3VYWVpaSzZRUUNBZzVBTXB5bmRQWWRXUmxFa0VRaUVaT1hsQ1c0c0V3bUZTajBOZHBnajQ3RVNIZ0tBL0dFSGc0dVVyZEU3NlNPQm9QM1htVE81V0NUdkgrL3Q2eGFyK2ZyRjIxU29NVlJuUnkxQ0pHZ0lRa0JvWXVEU0lBRnNsYjlPTUxkNGxOMHN4WWRFbzB5YU5xMGswZU1QR011MnhoUUFDaGhLQWdCamFzS2hXRFFFV0U5NDE5K0RvcUJnankrUlA5SjZEQ3RPYkJZTTNaTHg5Y1o4bzMwekM4YmNEMTNiNHJja2ZseUJnS0FFSWlLRU5pMnExSU1CRFhlTWtKR09uVDR0enROdnVXZTk4c0QwN3oraTZlT1d5dUhUbC84Nkl6VHZ6M3ZnZjU0aDVOSE1xMkwyMzFDTnVLblVIR3h6MkwxNkNvYWtadFBER0lnSVFFSXNhRzFVRkFSQUFBWlVFZkpxSmhRQUNJQUFDSUFBQzhRbEFRT0l6UXd3UUFBRVFBQUVpQUFGQk53QUJFQUFCRUpBaUFBR1J3b1pJSUFBQ0lBQUNyaVBFT0RDQUFBaUFBQWlBUUJ3Q1pIMk13d0tKUXd6UGdnQUlnQUFJVEJPQWdFeWp3QVVJZ0FBSWdFQWNBaENRT0xUd0xBaUFBQWlBUUVDZ0lzU0U2enZPT0hpQUFBaUFBQWlBUUJ3Q2p1OVB3QUtKUXd6UGdnQUlnQUFJVEJOd3E1WEtxZWwzdUFBQkVBQUJFQUNCQ0FTcXZuOEJGa2dFVUhnRUJFQUFCRUJnSmdIWGNieE9XZ2N5TWZNMjNvSEFiQUlxdGo2Zm5TcnU2RWFBZmc4UVFDQVNBWjhza0U3NllaaEFwNG5FeTRxSHFGUFE5dWFlK09qRXllQ1Zyem1jTzMvZWl2cmJYc241YytlS2VmU1B0NjN2cGNPd2J1b3BCZWVjOExrbkNDQlFTNEMxZ3kyUThkcWJ1TGFQQUl2R3lNbVQ0dkRJcUJnNmRKak94TGhpSHdUVXVDa0JGcFAreFl2RjRLb1ZkRVJ2bjRDWU5FVmwwd2MrYWNjcDUyUFAyK3E0N202YmFvNjZYaU13ZWVtU2VQdURYNHUzM3o4QTBVQ25pRVNBeFdUVCtuWEJDWXhmNnVtSkZBY1BHVW5BcDc4a3Z1a2M4N3hCNGJwRFJsWVJsV3BJZ0F3T0VvNERZdisvdmdQaGFFZ0lOOXNSQ0lWa2NPVUtXQ1R0WUpuNXVTK3ExYnVkMzN0ZXVkTjF4OHlzSTJwVlQrQWtIZVA2ei90ZURjNEdyLzhNNzBFZ0xnRVdrcDNmZlZUQUdvbExydkRQKzM2MXV0d1o4N3p1cTY1N3pWTmErRHFoQXEwSXZIVUFWa2NyUHZoTW5zQWpEMjRROTkrNVJqNEJ4Q3dhQVgreVd1MEpwbFljdTNDQkJhUzdhRFZBZWFNVDJQK3JkOFErK29jQUFta1JZTi9JWnZxSFlBVUJmMmxYbDl2SlZTVVZtYUJoY1FpSW9lMyswMWYyaWFIRHZ6RzBkcWlXTGdUNGo1UkxseThMdGtZUXpDWkFlbkdVYXhpc1JNZUdpdVkyTm4rcElSN210cTl1Tlh2cndBZXdkSFZybEJUS3d4c3BjcktCZ0dBL3JCUUlhNUFraHEwMGFBUUxpOEQ5am9VRXdXZ0M0MXk3Y0MrczRBM2ZRRENEd0tlMGNodytEelBhc29pMTJQM0dtMkxreElraUZoMWxqa0NBTmxJOHhZOEZBa0kra1BFSWNmQklnUWpzZk9GbkJTb3RpbW9pZ2VkZjJTOHVrazhFd1RnQ3dTcDBybFVnSVBSZk1KNWxYRFV0clJBUElZUjdXRm1LQU5YV2dBRDNRUXhsYWRBUUtSUWhORG9DQWZsOHlxT2VRajVJTW1NQ1p6RjBsVEZ4Wk5lS3dDL0pGd0lycEJXaFluNTJkV3JVS3BqRys1VlNhWnpXZ2hTekppajFEQUpzZmFnSzlGZUdLTit5U054S3U3SWkyRUdBcCtHZVBlK0pVMmZPQ0pxcW1UaE1VbnBzaFdCOVNHS1VXaVhBbXNFRkNnU0VMOWdrb1E1VDVtdUVZaEpnNjBQRmxOMzVjK2ZRcXVJN3hYMzBqNjhSN0NQQUlqSjgrTEI0bC82ZG8rc2tnYTBRWHFYT1c4VWpGSjlBdUFhRWF6SXRJTFFqMmxIaCsrWGlWOC9lR296U0dSNUp3MXJhSE8rUkJ4K0VjQ1FGV2ZENEMra2NFRjVaUHJoeXBXQ3Jkb2lFUkRhd0ZjSi8yR0NyRTFtQ2VzV2pQYkJPaFNVS2ZDRDhCbXRCUWlURmZVM3lKZWRhOHcvRzQ5L2VEUEVvYmhkUVhuSVdrc2UvdlNueEVOVEJrUkhsWlVPQytSRGcwYW93NTJrQm9SdkIwdlR3QTd3V2l3QVBYeVd4UUxDUFViSGFPK3ZTY3Y5SVlrSHdDWmR3cG1mZGFxbms1enNkSGNOaHl0TUNjZ01FSkdSU3lOZHhjbnJLQmo2MkZFNU9XWHIyeE51NllZTW9TMDZvWUlmOFFUcnhFc0VBQXBYSzlJeXJhUUdoYW8wYlVEVnJxekNTd1AreGVSMTJVTFcyNDhTb09CK0x2aTNCUm9sSi9zaUpVVXc4bWpLQnlScGpZMXBBZWt1bGlkcXhyWlRMZ09RVkU1RDljckwxc1hiVlNzV2xRWEttRXJpOXIxZndJVkl5NGF5SDljb3kzSFNLd3pPdzdpQ3RDTXMwTFNEQkRaNkpoVkJJQWhjdlg1RXE5OWY2KzZYaUlaS2RCQnd5UTFZTnlQV1pVM1FhSmtLeENkVE93T0thekJBUXYxSjVyOWpWczdmMFo3M3pVcFh2WDl3bkZRK1I3Q1V3SU5sbkxsNlIreVBIWHRKYTFueUdrVEZEUURDRXBXV0RSU3JVSlVrTFpCNFdkMFhpaTRldUUvaGlxZWY2bXhoWEVKQVlzUFI4MUNmQm1HRmt6QkNRRGlHRzlTdzNTcFVXZ1lVOWNqOEdhWlVINmVwUEFMc1Q2TjlHYVpXdzFvSE9lY3dRRURqUzA4S09kRUVBQkVDZzJBVElnVDVlNjBEbjJzd1FrS0I2Y0tRWHU1VlJlaEFBQVJCSWdRQTUwSDlibit3c0FZRWp2UjRSM29NQUNNd2d3S3NDRVd3ajRGT3pEOWRYZXBhQTBBTXp2T3oxRWZBZUJFREFiZ0xZa3NUTzlpY2ZlWHNMaExibmhZQlkxRDk0RHkwRUVJaEQ0QkttNDhiQlpjeXo5UTUwcnRnc0M0UWQ2WFFmSWxLd1pwZGRIY3dIQ0NHQVFCd0NGeTlmaXZQNDlMTUx1N3VucjNGUkxBTDFLOUREMHM4U0VQNkFuQ1V6NXZxR0QrUFZQQUxZWHNLOE5rMjdSbWNuK0cvTStHRWVEaWVMRDAyWEdFMDBvYUdBME0xaFhjcU5ja1FqSUx0TDZsaUNYWHlqbFF4UG1VWkE5b1JDbkVoWTJKN0FXN2dQTlNwOVF3SEJnc0pHcVBTK04yK2UzSEdoNDlpZlNPK0cxYXgwUHMzRmtUMTNSdmFQSE0wUVdGbWN5VXJsL1VZVmJ5Z2c4SU0wUXFYM3ZkNUZOMHNWY1B6TUp6am9SNHFjblpGNEJwYjh6cy9ZOWFDSXZhYVovNFByMGxCQStBUDRRWmhDY1VMdm9sdWtDNHVEZnFUUldSY3hTVjhwUy82Ull4MWszU3JjeFAvQnhXd3FJUFRCc0c3MVFIbWFFMGp5NVV4NmxucnpVdUVUa3dqd1NySkRveDlKVlltM2dlK1ZQTTFRS2tORVVrV2dxZitETTJncUlQQ0RxT0tmVFRyc29KUWRZOFl3VmpadFZQUmN6cDcvc3pnNEtuY3NiWG5SbHdXYzZNWHNBYzM4SDF5YnBnSVMrRUVjWjdpWVZiYXoxTEpuZS9DNDlsc0hQckFUR21vZG1ZQ3M4NXd6R09oYkhEa2ZQS2dSQWQ4ZnJ0OUFzYlowVFFXRUg2cmlnS2xhVnRwZmYyMWdRTHFNYjVPQVlJc0thWHpHUitUWlY2Kys4MjlTOWFSemhzUkt5Vk1NcFRKRUpGVUUvSXJ2djlFcXNaWUNRaDhPdDRxTXovUWl3SDRRMmNWYXNFTDBha3ZkU2pOOCtEZmlyT2RKRldzK1RURWZXQXdMUkFwZXpwRklBMW91S204cElFdExwV0Vxdjl5eTA1d3JibVAyUE1hOGR1Vks2YXJEQ3BGR1ozVEVULy84WjdIL1YrOUkxM0Yxdjd4bExKMHBJaVltUUhNbXhtOHJsVnB1YTlWU1FMZ0VOSjEzYitLU0lJSE1DQ1FaeG1JckpNa1BSV2FWUkVhWkVtRC9tS3oxd2NOWGQ2MWNubWw1a1prYUFnNzVQOXFsMUZaQXFBTzgzaTRSZks0UEFYYWt5ODdHNGxyd2o4WElpUlA2VkFnbHlaVUFXeCsvL09EWDBtVzQ2UXM5R0w2U3BwZHJSRis0YnR2Zi9yWUNNclc5TzRheGNtM0xlSm12WGJVaVhvUzZwNTkvWlQ4YzZuVk1iSHc3ZWVtUzJQbml2eVNxK3FaNzdra1VINUh6STdCMHdZSTMyK1hlVmtDbXB2TzJIQWRybHdrK3o1WUErMEZrbmVsY1VoNnV3RkJXdG0ybVcyNDg2Mm9mK1Qxa2g2NjRQZ3ZKK2xpN1N0NG5weHNUbThwVHJWWmJ6cjRLV2JRVkVINlFqcm1GSHlRa1ZvQlhkcVkvY09lZGlVcktRMWxZRzVJSVlXRWprL00wK0FNaXlkQVZWeDdXUjNHN1FJZnJ2aGFsOUpFRTVBYjRRYUt3MU9xWisrNWNrOGdLNGNyc2Z1Tk44VHY0UTdScTF5d0tNM0w4dU5ndnVlWWpMQitzajVCRU1WLy9VcTIySGI3aW1rVVNFS3hLTDE0bllDdGs4N3IxaVF2K2t6MHZTKysrbWpoekpKQTVnWk4vL0tQZ05rOGFZSDBrSlpoai9EYXJ6MnRMRmtsQU9BS0dzV3F4RmVQNi9xK3ZFYkxibTRRMTVLbTkvN2g3ci9nVVo2ZUhTSXg5NVJsWFA5bjd2OFRGaEdlZXcvb29kQmZ4YWVQTFBWRnJFRmxBcG9heE1Cc3JLbGxObnR1OFBya1Z3bzdVblMvOERDS2lTWnVtVVF5MlBIakdWUktuT1plTGQ5M2Q5ZWlqYVJRUmFXWkVJT3J3RlJjbnNvQmdObFpHcmFjNEc3WkE3aWQvU05MQVB5emZmK1k1REdjbEJhbGgvTitSejBPRmVIRFZOcTI3Unl6c0tXbFlTeFFwQ2dHZWZkVnE4OFQ2TkNJTFNCQ3hVdGxWbndEZTYwOWcwL3AxaVJZWGhqWGs0YXovOXZTem1KMFZBakhnOVJmdnZ4K0lSOUpoSzBiQlExZmMxeEFLUzhCM096cDJ4eWw5TEFIQm9zSTRhUFY1bGgzcVA5eTZKZkdzckxCR1BEdUwxd2p3ZEUrRVloTGdkUjR2VVR2dWVmTXRKUlhnRFJNeGRLVUVaVzZKOE41WFVSWVAxaFl3bG9Ed01CYjJ4cXJGVjV4ckhsWlFNU3NyckRFdk5Oenh3b3Z3aTRSQUN2VEt6dklkTC81TThPYVpLZ0w3UGI2OWJoMkdybFRBekRHTktIdGYxUmN2bG9Cd1pPeU5WWSt3T085NVZwWUtmMGhZWXo1Z2lKM3JRNGNPaDdmd3FqRUJQcEtXL1Izc3kwcHlPRlI5RmRudmNhOENQMXQ5dW5pZktRRmYrUDdMY1hNa1BZZ2ZqbDI0Y0lSaUxZc2ZFekYwSVBBVVdRNHFmMEM0VHJ4OXlrUHI3eEZmNnVuUm9Zb29ReDBCM3RlS2h4MlRyaTZ2UzFZTUxGa3NkbjBIczY3cXVSVHRQZjF0TVhaYlYxZGYzSExIdGtBNGc2ajdwTVF0REo3UGhnRDdRMjVTUEZObTZQQmhXQ1BaTkYrc1hOalhFVm9kcXNXRG5lWS8yTElsVm5ud3NKWUVmQktDblRJbGs3SkF4anl2KzZycnloMVBKbE5LeEZGTzRPeDVUenoxNG92aUhMMnFEckJHVkJPVlM0OTlIYy92ZjFXNXRjbWxZZkZncHptbTdNcTFqV2F4L0t2VmF0OVhTcVh4dU9XU0VoRE81TmhubnczUm1ObGczQXp4dkQ0RTBoUVJyaVg3VzNoc0hNTmEyYlk1RDFmeFJwaXlaNWkzS3kzRW94MmhnbjN1Kzd1WGRuZHZreW0xdklCNDNpQWRPRElra3luaTZFTWdiUkZaV0NxSlFkclNlM0RsQ2doSnlzMGVDc2N2U1R4VXJPdG9WRnlJUnlNcWhiN25rMC9pN3FuankyTlhSRnBBT0NjNDAyUHoxakpDMmlMQ2xZYVFwTmYwV1FoSDBJWVl0a3F2RVhOS1dkWjVIaFkzbVlCNDNuYXlRcDRKRThOcmNRbXdpUHg0ejE0eGR1Wk1xcFdZUDJlT1dEMHdnQmxiQ1NtemMvd3NiWEE1ZFBnM0lrMkxJeXhtNzEvZEV2Zzg1cytkRTk3Q2EvRUorQ1FBVzVkMGRiMHNXNVZFQWpMbFRCK2p6THRsQzRCNGVoSGdWZVpaSFNTMWVxQS9tUDY3cXYvMllCTSt2VWpvV1JvV0RqNnpudjBicXFkaU42b3gvMER3cVlKYk4yd1FFSTlHaEFwOXp5UG4rWElaNTNsWTYwUUN3b2w4N0huUE9xNzdSSmdnWG90UGdGZVo4NXFCckFJUGIvVXZYaHhZSlF0TFBTUW1XZVZjakh4QzBXREJ5TUxhQ0tud0NuTmVKSWo5clVJaWhyMG1jSjZISkJKL1ZYL3ZlZVZPMTJVckJNRWdBZ2RIUnNSTGIvNGlsV20rclREMUxsb1VPTnhYa1hYQ3dzSS9ZamFHWUlpS2RrRG1JYXFQeU9MSXd0cW81Y3g3Vy8xd3k4T0JzTmZleDdVeEJLU243dFlTVVBMdHhKVGVXcVRtWEdmbEYybEdqQVdFaDdsWVRQcjcrdml3Q2Q1S3g4aEF6a3c2dGUzYThOU2hrVkZ4YVBTanhHZHp5SUJpdnYyMHV2eXhUWnV3eGtNR1lGSGlLTEErdUtwS3ZvL0hNS1czS04xR3FwdzhwTVgvZ2g4NXFSU1NSMkxuZS9tV1JXSjFmMy93V25SQnFSV004ZE5ueEtHUFBoTDhtdGIwMnlndHdOYmV0ZzBQWUYrcktMQ0svVXlpcWJ1MVZWY2lJSndnckpCYXJPWmRmMHF6dEhha3RISmRobFlvS0R6a3hmNFQzcHFsZlBQTldsb3BaRmhRb0ZsVE5DVEZRMUduYUtZYnozYkxXekJxdWZNc3E4Y2Vla2owa2tnam1FMkF1dU1SMnZkcXVZcGFxaE1RV0NFcTJrUDdOSFN3UnBwQkNrV0Z6ejhwazdEd1A1NDV4TUxDOTRLUXdqQllhRTF3K256b0ZndkZxVE9maUVtNkh2L2tFM0dLTEF1ZWNwdW5kWEd0OHJQL1oxL0hBMnZXMEFRR0hBUTFtNDZSZHhKUDNhMmxva3hBT05HUEwxd1lvd1RMdFJuZzJqd0M3QnRoSWVFTkZJc1UyS2ZDbGdxTHlUejZ4Kzg1aEs5OHpmZm4xYTUxSVBQaFQ5NEVmeFFFRm90ekpCRGhLOTg4UitMQWU0cXhlT2dvRWtIQjYvN2o0YXJiKzNyRjQ1czN3OWRSeDhia3Q5UnZwWGJkYmNaRXJZQjQzbGFhMHJ1N1dXYTRieFlCUGdkazN6dnZaRDVUeXl5SzJkZUd0eU41Zk5ORG1HR1ZQZnE4YzFScWZYQmxsQW9JSndncmhDbllGU0FreFdodkhxN2lrd054K0ZNeDJrdDFLVlZiSDF3KzlRSUNLMFIxdXhjbVBRaUpuazBWK2pudXZmTk9yQ2JYczRteUtKVnk2NE1MclZ4QU9GRllJVXpCM2dBaDBhUHRJUng2dElNT3BVakQrdUI2cFNNZ3NFSjA2RE81bHlFVWtqK1JnNWs2TUVJR0JOZzUzcis0VHd5dVdCRnNXb245cXpLQXJuOFdxVmdmWE8xVUJJUVRoaFhDRkJDWUFLOTlZREVacGxsYkVKSjAra1FvSEx4M0ZhK0xRUUNCa0VCYTFnZW5uNTZBd0FvSjJ3K3ZVd1I0K3U4bzdldkVNN2RnbFNUdkZvRm8wRlRjQVJJTStEZVM4elEwaGRTc0QrYVZtb0J3NG5UZzFJZjBjZ2RmSTRCQUxRRmVpZjMyK3grSWtaTW5JQ2ExWU5wYzh4ZDJIczJtdW52RlN0b2o3SFpZRzIxNDJmNXhtdFlIczAxWFFMQTYzZmIrRzZuKzRSQVh4S1F4THJZMGdvMGxhUjh3aUVaalJyamJrRUNxMWdmbm1LcUFjQWJZSTRzcElFUWx3SmJKNlBFVDR1RG9xUGpvNUZpd1E2MXRmcFBReXVpbExWaFdrV2lzL3R1QkdhdmxvN0xFYzVZVDhQMFBsM1ozcjBpVFF2b0NBaXNremZZelBtMjJUdmdFUHZhZG1Db290WUxCRG5DZVJWVmVkQXZXYkJqZnUxT3RvSkx6UHRxVk1IVUI0UUljLyt5em45TUJPZDlzVnhoOERnTHRDTENnakowK0xjWnBzMEsyVms3UlpvVjhqa1pSckpUZ0MwZERVdVZGTjEvYjhKR3NERDUvZzNjVlJnQUJaUVFVbmZmUnJqeVpDTWpVcVlWSHFEQTRPNzFkaStEejJBUllTSGhEd3pFU2xYRzY1dGxlNTd6ejR0TGxLOU5wWlNrd29Vandwb3pzdStCZGdXK2kxK0NhdGt1SFdFdzNDeTdTSVpDSjljRkZ6MFJBT0tNL2VONU8xM1YzOERVQ0NHUkI0Q0lKeU5rcEllSHQxSG1iZFJhVnlTdVhBOEhoTXZCMFlnNHNNT2NtcnUrNkc5eXMrMjloOTlUZlAyUkJmTEhVSFh4NXZ0alRJMjZjYzIwSFh4WUlYcmgzRTkzanM5MnhpSzhPSU41bVFZQVBpOXExdEZUYWxVVm1tUW5JbU9kMVgzWGRrMVNwYTN0b1oxRTc1QUVDSUFBQ0ZoR2dQNFRHTGxhcnkrOG9sVnIvTmFTSWlhc29uYmJKOUZLRi9HcjF5YllQNGdFUUFBRVFBQUVaQWo3OW9PL01Tank0Z0psWklDRU5tdGI3TGprOTE0YnY4UW9DSUFBQ0lLQ0FRQWJUZHV0TG1aa0ZFbWJzVnlxd1FrSVllQVVCRUFBQk5RVDhxNzcvOTJxU2lwNUs1Z0p5VzZsMGxKdzh6MFl2SXA0RUFSQUFBUkJvUWNBbjk4QnpYeW1WeGxzOGs4cEhtUXNJMTZKVGlGM3M3RW1sUmtnVUJFQUFCQ3dpUUwrbDR4ZnBOeldQS3VjaUlPeFFkNnJWYlhsVUdIbUNBQWlBZ0VFRU1uZWMxN0xMUlVDNEFEUlBlVmc0emxCdFlYQU5BaUFBQWlBUW1RQnR3ZUR2V2RMVjlYTGtHSW9mekUxQXVCNVhLeFcyUXE2dDVGSmNNU1FIQWlBQUFpWVQ0S0VyY3B6L0tNODY1aW9nZ2RPbldzMFZRSjd3a1RjSWdBQUlTQklJaHE3eWNKelhsamZ6ZFNDMW1ZZlhXQnNTa3NBckNJQUFDTFFsRUF4ZDBWYnRQSUtUYThqVkFnbHJqcUdza0FSZVFRQUVRS0ExQVIyR3JzSVNhaUVnR01vS213T3ZJQUFDSU5DU2dCWkRWMkVKdFJqQ0NndURvYXlRQkY1QkFBUkFZQllCYllhdXdwSnBZWUdFaGVtc1ZMNUYxNWlWRlFMQkt3aUFBQWhNRWRCcDZDcHNGSzBFaEJjWTBqWW5MQ0lJSUFBQ0lBQUMxd2xvTlhRVkZrc3JBZUZDQlFzTXNWZFcyRDU0QlFFUUFJRmdyNnM4Rnd3MmF3S3RmQ0JoSWZud3FjOWQ5ME1xWEc5NEQ2OGdBQUlnWUNNQkdybzZlVnRYMTJJZDY2NmRCY0tRZUNpclVxM2VUWmZ3aCtqWWExQW1FQUNCckFoNDlGdjRqYXd5aTV1UGxnTENsY0RVM3JoTmllZEJBQVFNSThCRFY3dnlYbTNlaXFtMkFzS0ZKbi9Jc3pnN3BGWHo0VE1RQUFGRENRUitEem8vNlRtZDY2ZTFnREE0bkIyaWMvZEIyVUFBQk5JZ1FINlBzYnpPK0loVEgrMEZCUDZRT00ySlowRUFCQXdnRVBnOTd1QmxEWm9IN1FXRStmRVlJSTBGNGl4MXpUc1RpZ2NDSUpDWWdFK3pUN2ZyN1Blb3JXRWhCSVFMVEdPQmU4Z2ZzcXUyOExnR0FSQUFBWU1JK1B3YnArTjZqMmFNU2V5S0ZiQmZWckhhQzZVRkFSQ0lSc0R4L2RlV2RIY1hhaWVPd2xnZ1lSUHdmbG5zWUFyZjR4VUVRQUFFaWs2QWY5TSs5LzNDRGRNWHpnTGhqdko3enl0MzBrcDF1aXdWdmVPZy9DQUFBdFlUOEs1V3E4dUw0dmVvYmEzQ1dTQmMrQUQwdFUwWFNiZ1JRQUFFUUtDd0JIeGFhZjVJRWNXRGlSZFNRTGpnVTVzdUZzN2s0N0lqZ0FBSWdBQVJDSnptZjFNcXZWRlVHb1VWRUFZK3RWSWRNN09LMnZ0UWJoQ3dsMEFnSHZRYlZ1amZyMEw2UU9yNzNNY1hMdXltaW15dHY0LzNJQUFDSUtBaEFkNm1aQzh0VFhoRXc3TEZLbEtoTFpDd3BqZFVxOStqNnlQaGU3eUNBQWlBZ01ZRWp0STJKZnliVmZoZ2hBWENyY0F6c3pwYzkxMnFVRy9oV3dVVkFBRVFNSklBVDlmbG95cUs2alN2YnhSakJJUXJCaEdwYjE2OEJ3RVEwSVdBYWVMQlhJMFNFSzRRMW9nd0JRUVFBQUdkQ0pnb0hzelhDQjlJYlVkaDA1QWNWSGZUUFp4bVdBc0cxeUFBQW5rUk9FOTdYSDNMbEdHcldvakdXU0JoNVQ3MnZHWE90ZFhxeHRZeHJDdGVRUUFFdENYQU02NlcwNHlybzlxV01FSEJqTE5BUWhiY1lOUncyK2c5VnF1SFVQQUtBaUNRSlFIZm9WWG1wb29IZ3pUK3IzT3lSTGFTSmZLU0RYWE44cHVCdkVBQUJGb1NDTVJqU2FtMHQrVlRCZi9RZUFIaDlvR0lGTHlYb3ZnZ1VDd0NWb2dITjRrVkFzSVZoWWd3QlFRUUFJR1VDVmdqSHN6UkdnSGh5a0pFbUFJQ0NJQkFTZ1NzRWc5bWFKV0FjSVVoSWt3QkFRUkFRREVCNjhTRCtWa25JRnhwaUFoVFFBQUJFRkJFd0VyeFlIWldDZ2hYbkVTRTE0bThTNWM0MVpDQklJQUFDTWdRT0UvTEJiNWg4bFRkVmxDTVhRZlNxdEw4MmRRNmtidDVpNEYyeitKekVBQUJFR2hBd0dyeFlCN1dXaUJoWjhBR2pDRUp2SUlBQ0VRbFlPcmVWbEhySHo1bnZZQXdDSWhJMkIzd0NnSWcwSTRBeE9NNklXdUhzSzRqRUlJM09lTTkrdWtlRHFXcUJZTnJFQUNCV2dLa0hlS0lTZWQ1MUZaTzVob0NNa1dOUmFTVFJJUjZ5QjRaa0lnREFpQmdOSUhnR05wSmd3NkRVdEZhR01KcVFQR1k1KzBVcnJ1andVZTRCUUlnWUI4Qm43WmozN1cwVk5wbFg5VmIxeGdDMG9UUGxJZzhSUitEVVJOR3VBMENGaEJneStON05HdnpPUXZxR3J1SytIRnNnZXk0NTIzMHIrM2tpN1VpTFRqaEl4QXdsQUFmQlBYM1pIa01HMXEveE5XQ2dMUkJpQmxhYlFEaFl4QXdrQUQ1UWsrU3Mvd2JKcDRpcUxLNTRFUnZRek9jb2VVNHptdHRIc1hISUFBQ3hTZmdDOThmdWxpdHJvQjR0RzlNV0NEdEdVMC9BYi9JTkFwY2dJQ0pCT0FzajltcUVKQ1l3S1kyWW55YW9zRXZFcE1kSGdjQmpRbDRkUHpzOTB3L1FWQTFmd2lJQkZINFJTU2dJUW9JNkVuQUozL0hHUHdkY28wREg0Z0VOeDRidmFGYVhVNHpOSjZsNk5UL0VFQUFCQXBJZ0tmb1BnZC9oM3pMd1FLUlp4ZkVKTC9JZGxwMHlPdEZNS1NWa0NXaWcwQ0dCRHdTajExWTM1R01PQVFrR2I4Z05vYTBGRUJFRWlDUURRRU1XU25rakNFc0JUQjVTT3UycnE0K0RHa3BnSWtrUUNBOUFoaXlVc3dXRm9oaW9EeExpNGUwQ0d5djRxU1JIQWlBZ0R3QnJDcVhaOWMwSml5UXBtamtQcUF4MVQyODNUT05yKzZoRk9CZ2w4T0lXQ0NnaWtDd01KQjIwVjJNTFVsVUliMmVEaXlRNnl5VVg4RWFVWTRVQ1lKQUhBSndsTWVoSmZFc0JFUUNXcHdvN0dDL3dYR2U5aDFuSThVRDd6anc4Q3dJeUJGZ3EyUDRxdTl2dzNZa2NnQ2p4c0lQV2xSU0NaK0ROWklRSUtLRFFEUUNzRHFpY1ZMeUZBUkVDY1pvaVFUVGZZWFk0Ymp1Rm9vQjl0R3c0U2tRaUVMQWQzei85Yzk5LzBsWUhWRndxWGtHUDJKcU9NWktCZFpJTEZ4NEdBUmFFZUIxSGVPMGo5VTJPTWxiWVVybk04ekNTb2RyeTFSNXBoYTJRbW1KQ0IrQ1FCUUM0YnFPNVJDUEtMalVQd01MUkQzVFdDbnlzRmFuNi82Y0lpMmpmMmlQV1BUd3NLVUVBaWU1VDhOVjlNZllVVXNaYUZGdC9HQnAwUXhDWUZoTGs0WkFNWFFtd091cUp1aEhhL3VTcnE2WGRTNm9MV1dEZ0dqVTBvRTFJa1N3a3AyS2hiYlJxRzFRbE53SmVMUlYwSE9UUWp4M1I2azBrWHRwVUlDQUFINmtOT3dJbUsybFlhT2dTSGtSd095cXZNaEh5QmNDRWdGU1hvL0FQNUlYZWVTckFZSEF6MEVMQW44RUI3a0dyZEdrQ0JDUUptQjB1bDNqSHlsVHVkQm1PalVPeXFLYUFQczVqdEp3MVpNUUR0Vm8xYWVISHlQMVRGTkxFVUtTR2xva25EK0JZRDBIclN2WUNRZDUvbzBSdFFRUWtLaWtOSG9PUXFKUlk2QW9TUWxBT0pJU3pERStCQ1JIK0VtemhwQWtKWWo0T1JLQWNPUUlYMVhXRUJCVkpITk1CMEtTSTN4a0haY0FoQ011TVkyZmg0Qm8zRGh4aThaQzRqak9meFdPZzFYdGNlSGgrYlFKWUZaVjJvUnpTQjhDa2dQMHRMTTg1bm1ETkpWbEMzYjlUWnMwMG85QUFNSVJBVkpSSDRHQUZMWGxJcFM3WmtIaWcvUjROLzFEZTBmZ2hrY1NFd2kySEtGam5mZFdhT1U0dGxkUHpGUGJCUENEb20zVHFDdllsSkFNQ3RkOWlocThUQ21qM2RYaFJVclhDYkMxY1pTR1VmZjhwVnA5R1Z1T1hBZGo2aFYrU0V4dDJTYjFxaHZlNHFmUUI1cXd3dTNJQkRCTUZSbVZXUS9peDhPczlveGNHMWdsa1ZIaHdjWUVBbXVETEk0M3NNRmhZMEEyM0lXQTJOREtiZW9ZV2lVMHhIVVhkWWd5UFk1KzBZYVpwUjlQK3phb2c3eUJyVVlzN1FVMTFjWVBSUTBNWEFweDNQTTIwalRnaDMzSDJUakZBMzNFN280UmlBYjdObmhqUTdJMmpzSzNZWGVIcUswOWZoeHFhZUI2bXNBUnordWVMOFJHY29nK1RJSXlPUFVCK3NzMElhTXZwa1dqNnZ0N0w1RzFBZEV3dXIybEs0Y2ZCR2wwOWtRTXhjUjFuQTJ3VEl4dGQ0aUdzVTJiWHNVZ0lPbXhOVFpsSHVhcUN2RmdqYytFNjRxK1ZMd1duK0hUd1BCVThSb3c3eExqUzU5M0N4UThmOW8rWlZrSE9kOXBxT05CREhWcDM1Z3NHSUo4R2NQMDd6MjZlZytPOElBSS9wTWtBQUdSQklkb3N3bndVTmQvRW1LUXJKTzd5SGR5MTlTZVhQd2crdGxzWEZuY0NRWGpxRStDUVkwd1RGYkdlL0JuWklIZWpqend4YmFqblhPcFpRdEI0ZktnNzZsdGxXdGl3V25TakNrSWhscTRTSzB4QVh5SkczUEIzUlFJc0tEY0tNUXkxM1cvU2o5d2QxVnAxMkRxZ09XcHJOQVhvek9mRmd2aU9FNm4rQjBsYTIrWTlwNzZQL0JqUkllSUo1TVR3SmMyT1VPa2tJQkFLQ28wN0RYWTRUai9oWDRaeXpWRFg1eXk3WDIwbVZpY3duQlVnbzZIcUVvSTJQN2xWQUlSaWFnbEVJb0tkYzV1OXFmUTlPRmJHd2dMWjJwSy81MFdDYTVVYUZYUXhJUlQ5TUZScXVSdkx3b3hEdDhGMDBIUWlZQXBYMENkbUtJc0tSSVk4N3p5VmJKU1dGRDRING5MWDFOMlpmclhYV2U1MUpZaXIzNCtReGltQ2pSQkFqRkJCUnFuOStNc0VuUjlpb2FoSmpwSUxIcExKYjZQQUFLRklKRFhGNnNRY0ZESTRoRmc2NFZXMEplcFkzZnpQN0pndWxsbzZMcUxab1oxOFQxNnoyZWpjS2k5SnYxeHlueXpYV0FMb2ZZWlNqTjhIN3pTNXhjb0R4YUpVL3djZjk1Si95Ym9IcXdJSm9KZ0NvSC9EM1krcjcrNVEwQ3RBQUFBQUVsRlRrU3VRbUNDIi8+CjwvZGVmcz4KPC9zdmc+",c="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSItNiAtNiAzMiAzMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxMCIgY3k9IjEwIiByPSIxNiIgZmlsbD0iI0UxREZERCIvPjxwYXRoIGZpbGw9IiM2MDVlNWMiIGQ9Ik0xMCAyQzcuNzkwODYgMiA2IDMuNzkwODYgNiA2QzYgOC4yMDkxNCA3Ljc5MDg2IDEwIDEwIDEwQzEyLjIwOTEgMTAgMTQgOC4yMDkxNCAxNCA2QzE0IDMuNzkwODYgMTIuMjA5MSAyIDEwIDJaTTcgNkM3IDQuMzQzMTUgOC4zNDMxNSAzIDEwIDNDMTEuNjU2OSAzIDEzIDQuMzQzMTUgMTMgNkMxMyA3LjY1Njg1IDExLjY1NjkgOSAxMCA5QzguMzQzMTUgOSA3IDcuNjU2ODUgNyA2Wk01LjAwODczIDExQzMuOTAzMTUgMTEgMyAxMS44ODY5IDMgMTNDMyAxNC42OTEyIDMuODMyODEgMTUuOTY2MyA1LjEzNDk5IDE2Ljc5NjZDNi40MTY5NyAxNy42MTQgOC4xNDUyNiAxOCAxMCAxOEMxMS44NTQ3IDE4IDEzLjU4MyAxNy42MTQgMTQuODY1IDE2Ljc5NjZDMTYuMTY3MiAxNS45NjYzIDE3IDE0LjY5MTIgMTcgMTNDMTcgMTEuODk1NiAxNi4xMDQ1IDExIDE1IDExTDUuMDA4NzMgMTFaTTQgMTNDNCAxMi40NDY3IDQuNDQ3ODYgMTIgNS4wMDg3MyAxMkwxNSAxMkMxNS41NTIyIDEyIDE2IDEyLjQ0NzggMTYgMTNDMTYgMTQuMzA4OCAxNS4zNzc3IDE1LjI4MzcgMTQuMzI3NCAxNS45NTM0QzEzLjI1NjggMTYuNjM2IDExLjczNTEgMTcgMTAgMTdDOC4yNjQ4OSAxNyA2Ljc0MzE4IDE2LjYzNiA1LjY3MjYyIDE1Ljk1MzRDNC42MjIyNiAxNS4yODM3IDQgMTQuMzA4OCA0IDEzWiIvPjwvc3ZnPg==",u="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAYAAAB5fY51AAAABGdBTUEAALGPC/xhBQAAIGhJREFUeAHtnQl4VuWZhj8IJCxhDZAERGQT12rVuuCCgChWQVu7zkwvO52pV2eKgKJtHTdwA3cExNmns9aZ6bRVtC6I+9YZF1wAQXErJiEJW9gCBJj3OeFUCX/Iv5z35Lzne97raiNZzv9+9/N8z/+d85+lw+iFq/c6FgmQAAkYINDRQI9skQRIgAQCAgwsGoEESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanabrS4qIO7acIAN6KsuO1fTvFvYPyzhAN4sNJFgIGVEj0xOW8/v9yNH1Hq5k2u9Da0EFYY/znCATwYWikx+L5hMLBSoCcm5RyZnCcP7haMpleXIi9DKwwrjB8FHuDC0ApwpOL/GFjGZewsCs6eWO5O2RdW4XB8C62WYRVyABfwASeWfQKU0bCGzWFV4U49tHll1XIovoRWa2EV8gCf2RMrGFohEMNfGVhGxeskyt0mk/C0IZnDKhxW2kOrrbAKOYATeIEbyy4BymdQuyCszit3o9sIq3BoaQ2tbMMq5ABetwk3hlZIxN5XBpYxzTDZbpVJd/ph3XPqPG2hlWtYhbDADfwYWiERW18ZWIb0KhK1bjm33J2RY1iFQ0xLaOUbViEH8ANH8GTZIkDJjOgVhtWZQ3NbWbUcnvXQKjSsQh7gyNAKadj5ysAyoBXC6uYJ5e6sAsMqHKrV0IoqrEIO4AmuXGmFRJL/lYGVcI1wdcmscwa4McMKW1m1HKa10Io6rEIe4Aq+vIonJJLsrwysBOsThJVcEzd2eKlKl2FoDendWWX7UW0U/eFyG/SrUeCLaw8ZWhp0o90mAytanpFtDZNnpmJYhY1+tH6nW7ulKfxnIr+iP/SpWQgt8GZoaVIufNsMrMIZRr6FjhJWN8huyjillVXY8NKq7W7GozWusWlv+K1EfkV/6BP9ahZ4gzv4s5JJgIGVMF0wWW4cPyC424Bma29XN7qrDIRVyAChhX7Rt2bhLg/gz9DSpJz/thlY+bOL/C8xSa4fJ2E1UueYVdjwOzWNsmKpdtsTvrIK+w2/ol/0jf41C/yhA0NLk3J+22Zg5cct8r/CXsh14/q7cw/XD6srH6l223YlezewNcDoG/1rhxZ0gB7cO2xNifb5PgOrfbjv96phWJ13eI/9vh/1P96VlYnlsAp5hKGF8WgW9GBoaRLOfdsMrNyZRfoXCKtr5Z184ijdsFq2ttFdYXhl1RI6Qgvjwbg0C7pAH660NClnv20GVvasIv9NTIJrxvZ35yuH1fIgrGrM7ga2Br45tGocxqdZ0Ac6MbQ0KWe3bQZWdpxUfguT4IIjdFdWK2ob3fRHatzWnXtUxtDeG8W4ML4VtTtUW4FO0IvVvgQYWO3E/2dn91MPq/fqdrjpi9IbVqF0QWgtqnYYr2YhtKAbq/0IMLDagf1Px/Rzk47sqfrKK4OwqnZbUrqyagkP45wuoYVxaxZ0g36s9iHAwIqZ+0/E7JOP0g2rVTJpp8nk3bwjnbuBrUmG8WLcGL9mQT/oyIqfAAMrRuZXn9XPXaQdVvU73FQPwyqUEaGF8a8SDpoFHaEnK14CDKyYeM84s5+7+GjdldX7MkmnPezfyqqlhMFKSziAh2ZBT+jKio8AAysG1leeUea+foxuWH2wTlZWMkkbPNsNbE0+cAAPcNEs6Ap9WfEQYGApc75CzHzJsb1UX2X1up0MqwyEw9ACH82CvtCZpU+AgaXIePrpZe4bymH1YRBWVW5To18H2LOVDVymPlzlwEmzoDP0ZukSYGAp8Z0m5v3ml3RXVh/KTe0ul8m4kWF1UBXB5/JFElrKNwGE3lNHM7QOKkaBP2RgFQgw059fPrqv+5ZyWOEOnAyrTPQzf2/jdgktCXftO5d++7heDvqzdAgwsCLmOuW0vu47x/WOeKv7b+7jDQiraodJyMqeQHNoVTvw0yzoDx+woifAwIqQ6Y/FpN89XjesPkFYPVTtNmzfHWHn/mwK3MAPHDULPoAfWNESYGBFxPMvTu3r/iiGsJoik209w6og1cAPK1Tt0IIf4AtWdAQYWBGw/NEpfd2ffFl3ZfXpxubdQIZVBILJJtZtaw4tcNUs+AL+YEVDgIFVIMfLTu7jvneCblj9fuOuYDcGk4wVHYEgtGTFCr6aBX/AJ6zCCTCwCmD4QzHhpSfqGnHNpl1uiny6Vc+wKkCp1v8UXMEXnDULPoFfWIURYGDlye/Pv9LHfT+OsHpIwmorV1Z5ypTVn4HvFOGsHVrwC3zDyp8AAysPdj84qY/7U/mfZn3WgN3AKlfHsNLE/IdtgzN4g7tmwTfwDys/AgysHLn94KTe7s+U3yWrZNJM+U2Vq2VY5ahOYb8O3uAO/poF/8BHrNwJMLByYPb9ExFWup/4VCOs5EAwwyoHYSL81SC0hD900Cz4CH5i5UaAgZUlr0vlk54fnqwbVjWbd7kfy2RZu6Upy674axoEwB86QA/Ngp/gK1b2BBhYWbD6npxLc5nyuTQMqyyEiPFX4got+Ar+YmVHgIHVBqfgxD/ls5VrNjcFu4H4ykoOgbh0+ZH4S/vE4+RQLawTBtZB+P3x8b3UL63AOznuIlDNsDqIEu33I+gCfbR303EJD/zGOjgBBlYrfL4rtwn5y9N0721Ui7CSj9KrGriyakWGRHwb+kAn6KVZ8Bt8x2qdAAMrA5vviGmmKN+IrU7Mj5MVP2NYZVAged+CTtALumkWfAf/sTITYGC14PJtufHe5dphtRWfQjGsWqBP/D+D0JLdwzrRT7PgP/iQdSABBtYXmHzz2J5uqvJ9uWF2rqy+AN3Yf67ZtG+lpRxa8CH8yNqfAANrH49viDmmn6H7jLl6MTluHgfTs+wSgH7QEXpqFvwIX7I+J8DAEhaXyLPlrlAOq3XbxORy07jfK98V4HNp+V+aBKAj9ISumgVfwp+sZgLeB1bwIEzlp/euF1PjcptPle+7RFPHSwB6BneAVQ6tK8WfX1N+ani85PJ/Na8DCybQfmovwyp/c1r4y7hCa8aZZQwtMYS3gXXRUT0cTNChQwe1ebFh3214P+HKSo1xEjYMfbF7CL21Cj6FX+Fbn8vLwJosol99Vj/dsAoedFAlj5TSvYDWZ/MmaezQGWfEaz7NCKEF38K/vpZ3gTXpyB7uJ8phtXFfWH3EsPJqXkFvhBb01yqEFvwLH/tYXgXWhUf0cD8do7uyag6rannCMFdWPk4o6I7dQ+3Qgo/hZ9/Km8D66qhS97OzdcNqU+NuN1XM+qE8Rp7lLwHoP21RtYMftAorLfgZvvapvAgsiHrN2P6qx6waxJzTJKxWM6x8mj+tjvWDdRJa4gf4QqsQWvC1T6GV+sCaeHhzWHUUcbUKppwq76jvi0lZJBASgB/gC83Qgq8RWvC5D5XqwDpPRLx2XH+nGlY7ZGWFsKpnWPkwYXIdI3wBfzSIT7QK/obP4fe0V2oD69yRpe465bDaLCacLmZcxbBK+zwpaHzwB3wCv2gVQgt+h+/TXKkMrAkxhtXKOq6s0jxBohobfBJXaMH/aa2iwRdMm5mmwY0f0d3dMH6AK+qod8xqy449Yr4a957BsCoSLIN7d3bDy4qD/3Uv7uia9ux1jU17E2uD3l07uqF9i90R/Utcv+5FrrMMAhokt+PMKOvlTPjX1jS68cNLXXEnHX9ipXXmYd3cp3JxdhpPrekweuFqa7pndoN8d/zw7u7Gc2IIq0eq3YraHa32kcQfHFNeElyLNlrM3LOk6IAWV9btcE+v3up+9e4mt21X+1uiW+cO7uvH9HLjRNNRElQtC8eEXv54m/v1sgb37lpbWhw5oMTNvbDSlZbo7eDsljehWU/VuiWiaZoqNYE1Vow9U8Kqk+LKautOrKyq3XJDYdWna5G7Ss6MPntY96x8i0tLHnh1vXv0vc1Z/b7GL10gJ0TioQzoPZt69sOt7q7n61Uvi8mmj1x+5yiE1qRKhxWuVmHlPFNC65kUhVYqdgkxGWdN0A+rK2VltcxQWI2U3b75Fw10x5R3yXpOdO3c0Z05tLvr263I/e7TbbHudmF3dYaE62XygFH0kW0d1qfYjR9R6t74bLtbr3hZTLb9ZPN7dVt3uzertssKUnYPMXCFwu7hWaIlrnNMyzWt5gNrzNBu7qZzy9VXVggrS7seg3p2cg98baAr69Ypr6mA3RascF7+ZFtef5/PH2ElmO99n0plpYLdR6y2NsvxLQtVG1NojZE39I/khOY03DUk+7exBDrg9CESVhN0w2rbrj1uxqO2wgqLk9vPr3A9u2S3S9WatBfL/cImx3SRLV4Hr1dIYbwYdw6Ls0JeLpK/xZsg/AWfaRUOk2CeYL5YL7OBNbRPZzcTu4FKy2kIG4TVIzXunRpbB3UvObZX8KlaFObEU4k1j7OgR2wfrxNF4dNEjN9SwV8zxGeqoSXzBPMF88ZymQ0sXI7QTfGtdLu84131aI17u6bRlL44HnLpCb0j67mXrFq0n97yLXnQAl4nqsL4tY4LRdVjy+3AZ/AbfKdVmC+YN5bLZGCdemhXd3QOB5JzFQimmSHmeavaVlhhnCcO6lrwrmBLXjhvSLNw4DnKwq4hOFgr+E07tDBvMH+slsnAGpvlR/T5iNIoYXX1b22GFcY7ekj0ZhwmnzaWl+Z38L4tDbBdbD/q0uAQdY+ZtrdUQgv+gw+1SnP+aPUcbtdkYB1XGf2kBJAwrN6ssreyCgUd1FPnGMVA+dRRo7S2q8VBg0HLbcJ/mqGlNX9ajkPj3yYDC5dnRF07mmRl9ViNe8NwWIFJmQKbYLtyXpZGlSltF+eRWS74EH6EL6MujfkTdY+tbc9kYGlcOIKT7EqKTOLYT9sdStcEWtvuzt0aLtkPtfo/4Ef4MuqyTMbkDK3bEv3TdnFB7W0Ty91phg9Iwtj1cjKiRuHCXY1S264SBw0GmbYJH84WP8KXUZfG/Im6x9a2ZzKwcGBSo/BR+G0TK0x/irKqPvpzxrBa+Vjp1s/YrsZqaKUCBw3PZdomPsWDDzXCCq+nNX8yjSXq75kMLNxVQKsQWrPFLCcP1jmwr9V3uN3nP4r+UprX12x325V2NbFdbD/qekGBQ9Q9ZtreKeI7+E/zPLIlH2zJ9NImvmcysF4Tgy+VC0e1CmaZI8vxkw+xF1p4YsvytdGuQB9e0aCFOthu1NtfJuO3+OQi+A27gZphhXnz+mfR+kPVHC02bjKwMIbZz9ap3nK2pFNHN+f8cvcVg6F1/yvrW8ic/z/fkTOwNVZtX+wI28frRFULIxx/VD21tR34DH6D77QKt2jGvLFcenSUqazZ1OSue7JW5fhH2DrMc7uY6CRjoYVjFL98Z1M4jLy/4v5fc2IyOF4Hr1doYdzWjtHAX/CZZljhOCHmC+aN5TIbWICOXcNrHq9RD607xEwnDMr+nlJJMMS8l9YF97PKt5ddYvAbF9fGdh8l3K8Jr4fXzbdw/y6M21LBV/CXdlhhnmC+WC/z98PCO8Yqub3vWLkeTes+7rg9xzi5HOhd2W2p3mzjHQrT/qnVW4Ib8eFe6LkU7jqKa9pelxvixVlr5D7kb8jxldPlNs653MAPPT60vMHNWlLrCsi7OIcavNYJA7u4O79a4booXsSPN4C/krB69dN4tdSCaT6wACYILXmUEq6RUgstORCPG8ThWEuNldCS1HpJbsCH+7WPkOv12rrlMG6p+9Dyze562XVor5u9rZVz7B5buSUIrJH9its8cRI3ppv9TJ178K1Nbm/+izOt+dXqdr8sYXVXHGH1xFr3SkrCCjBTc093DAY3KLv1PJ2T7bB9lNU7OeBW98fLJMEtc3E/8X7dO0kodHDr5YTQqoYmeQfeJgfXtzrcujcp1V8uM0K/px7azeGaQ1xus10ekFG/tSm4rz76XSqXsEjOmqrjKru4uy+oyHkVmcsgsbK6VsIKb1hpqlQFFoQ5Q3YnbsUtk2VFpFVWQ0uLB7ebPYE4wqoJYfXkWveiPFUobWX6oHsmMSDSdSIWRNMqHF+5S94hv1Rh60C8Fg9uNzsC8At8k+vxuey23vxb8D38n8awwghTF1gY1AsSWtcv1g0t3L3x7gsr3LEVuR3QRn8s/wjAJ/CL5l1yEVbwPfyf1kplYEEsnIx4ozyTDQeStSoIrQsq5TFaDC0txmnYLvxxt/hENazE5/C79km+7a1HagMLYPHIJ5zboxlaeIDCPfIU36MZWu3t5US+PnwBf2g+yAP+hs/h97RXqgML4kFEPP1WO7TuFVPi0zcWCYQE4Af4Qjus4G8fwgpcUx9YGCQe1X2TiLpbcfcQpoQ58QBSFgnAB9phBT/D12l6FH1bzvEisABhiYRWcCa0YmiVlnR0cyW0cj2zvC2R+HNbBKA/fAA/aBXCCn6Gr30qPaIJpLjkg63u5qfrVFdaQWhNqpDQiv5JMAlEypZaEIDuc0V/7bCCj+Fn38qrwIK4i9/f4m4RsfcoXsfRo6RITFvpRjG0vJpP0Bu6Q3+tgm/hX/jYx/IusCDykzGG1uFyPRwr/QSgc1xhBf/6Wl4GFsR+YtUWd6vySqunvNPeJ++4uIiXlV4C0Bc6Q2+twsoKfoVvfS5vAwuiPy7i40p/zd1DPDZ9npgZd0tgpY8AdIW+0Fmr4E/4FH71vbwOLIj/W7mVCcywV/GYVhBakyvd8L4MrTRNOOg5T3TVDCv4Ev6ET1menIfVltAww5xn61VDqxdWWmLuYQyttuQw8XPoCD2hq1YhrOBLhtXnhL1fYYUoHnlvs7v9Od3Q6t21yM0Xkw/t2zl8WX41SAD6Iaygp1YhrOBH+JL1OQEG1ucs3KIVm90dz8cRWgPd0D4MrS+gN/Of0G3+5IFt3r21kAEhrOBD+JG1PwEG1v483MNyi+A7lUMLtyqG6Q9jaLWgn+x/Qq84wgr+gw9ZBxJgYB3IJLiv+d0v6D59pY/c7he7h0N6c6WVQYLEfQs6QS/oplVYWcF3uK8+KzMBBlZmLu7XyxrEPPWt/DSab/ft1sktuKjSHcrQigao0lagD3SCXpp1z4vrAt9pvob1bTOwDqLgr95tcPcwtA5CKP0/ii2sxGfwG+vgBBhYB+fj/kdMdO+LuiutMnnnxu7G4F7cPWxDjlh/DD2gC/TRLPgLPmO1TYCB1TYjeex7g7vvJd3QwmO35stuxyG9dCdHFsPlrwgB6AA9oItmwVfwFys7Agys7Di5/3q7Qf0x6P1lciyQTw8HyTP4WO1HAPyhA/TQrHkvrQt8pfkaads2AysHRf/z7U1u/su6nx72L+3k7r+IoZWDLJH+KsIK/KGDZsFH8BMrNwIMrNx4BY9EXxBDaC1gaOWoTOG/HqysYggr+OfBtxhW+SjGwMqD2i/EbAtf0V1pDZB3+PkyefCIdpY+AXAGb3DXLPgG/mHlR4CBlR839+9LN7kHXl2f519n92flCC05llLZQ3cSZddNen8LfMEZvDULfoFvWPkTYGDlz87925sb3d/8Tje0KmQy4aRFfGVFTyAuvvAJ/MIqjAADqzB+7l/e2Oj+Vj205ExrOR9IewVQIApzfw6e4FrRQ/f8N/gDPmEVToCBVThD989ixr/7X92VVmXPzvLpFUMrArmCTSCswBNcNQu+gD9Y0RBgYEXD0f389Y3uH/5PP7Swezigu94FuBHhSPRmwA8ctcMKfoAvWNERYGBFx9L942sIrQ0RbvHATQ2UFcGCi3FSI0PrQDptfwfcwA8cNQs+gB9Y0RJgYEXLU0y6wf2T/E+zBiG0cL4QQysnzEFYCTfw0yzoDx+woifAwIqeqft7eXf9+eu6hj1ELsxFaPVjaGWlIDiBF7hpFnSH/iwdAgwsHa5yEH6DfDKka9wgtOT8oX6KN5VTwhPrZsEH1wZqhxX0hu4sPQIMLD22co7WBvevyp8QDcadMOUAchlDK6OS4AI+4KRZ0Bl6s3QJMLB0+bq/juGEwUN7Fwf3beqr+BQXZUwqmwcP3M8KfDQLJ4RCZ5Y+AQaWPuPgEp7/WKr7idGQPsXBR/UMrWZBwQGnLoCLZkFX7Uu0NPu3tm0GVkyK3f/KeveLGEILuz94Ko/PFTyVKIawgp7QlRUfAQZWfKzdAjH3g2/prrQOkxUFdoN6d/VTWowb4wcHzYKO0JMVLwE/XR0v4/1ebf7L6+Uuk7pX7A+Vx6jj7gO9u/glL8aLcWP8mgX9oCMrfgJ+OTp+vhlf8T65Ne5/K4fWMM9CKwwrjFuzoBv0Y7UPAQZW+3B3c8X0v3xHd6U1rKzYzZMVR6+Ur7QwPowT49Us6AXdWO1HgIHVfuzl8WHr5Fl0uqE1PAitStezJJ1SY1zz5JgVxqlZ0Al6sdqXQDpd3L5Mc3p1PJpc+wGaI8pKgkmdttAKwwrj0yzoA51Y7U+AgdX+GshkqHe/Wab7bLqR/UrcfbIS6ZGSlRbGgfFgXJoFXaAPKxkEGFjJ0MHd+Xy9e2i5bmgdLpN73iT7oYWwwjgwHs2CHtCFlRwCDKzkaOHueK7ePawdWv1lpWU4tIKVFcJKxqFZ0AF6sJJFgIGVLD3c7TJJFq3QXWmNksl+74WVrrTYlvzoF32jf80Cf+jASh4BW45NHj+VjuY8W+8efW+zyrbDjR45oMTNnVThuhsJLfSJftG3ZoE7+LOSSYCBlUxd3Oxn6mIIrS5u7oUVrrioQ0IpNLeF/tDnkQO6qPaJsAJ3VnIJMLASqs1e6QuT57GVuiutpdWNbuduvFpyC/29WdWo2iA4g3eySagiMLFxBlaCZcLkufXpOve4Umjh1ihW7jawEE9NVnoQKfiCM8MqwZNhX2sMrIRrhEl0i0ymJ1ZFu9KyFFahRBqhBa7gy7AKKSf7KwMr2foE3YWh9eSqLZF0azGswoFHGVrgybAKydr4ysCyoZPbI6l189O17qn3Cwsty2EVShVFaIEjeIIryw4BBpYdrYLJNWuJhNYH+YVWGsIqlKuQ0AI/cGRYhTTtfGVg2dEq6BST7Kanat3Tq3MLrTSFVShZPqEFbuDHsAop2vrKwLKlV9AtzkKYubjWPZNlaKUxrELZcgkt8AK3hJ/FEQ6NXzMQYGBlgGLhW5h0N8rke/bDrQdtN81hFQ48m9ACJ/BiWIXUbH5lYNnULegak++GxWvdc62Elg9hFcp3sNACH3BiWIW07H5lYNnVLuh89x7nrpfJ+PxH+6+0cJKllZNCo5IgU2iBC/iAE8s+AQaWfQ2DyXjdk2vdC/tCC2GFyetjfTG0wANcGFbpcUKH0QtXy44FKw0EOsnbz4SRpXL9YW6fIKZh7C3HcP6oUrdYzrVq4sqqJRrT/2ZgmZaPzZOAXwS4S+iX3hwtCZgmwMAyLR+bJwG/CDCw/NKboyUB0wQYWKblY/Mk4BcBBpZfenO0JGCaAAPLtHxsngT8IsDA8ktvjpYETBNgYJmWj82TgF8EGFh+6c3RkoBpAgws0/KxeRLwiwADyy+9OVoSME2AgWVaPjZPAn4RYGD5pTdHSwKmCTCwTMvH5knALwIMLL/05mhJwDQBBpZp+dg8CfhFgIHll94cLQmYJsDAMi0fmycBvwgwsPzSm6MlAdMEGFim5WPzJOAXAQaWX3pztCRgmgADy7R8bJ4E/CLAwPJLb46WBEwTYGCZlo/Nk4BfBBhYfunN0ZKAaQIMLNPysXkS8IsAA8svvTlaEjBNgIFlWj42TwJ+EWBg+aU3R0sCpgkwsEzLx+ZJwC8CDCy/9OZoScA0AQaWafnYPAn4RYCB5ZfeHC0JmCbAwDItH5snAb8IMLD80pujJQHTBBhYpuVj8yTgFwEGll96c7QkYJoAA8u0fGyeBPwiwMDyS2+OlgRME2BgmZaPzZOAXwQYWH7pzdGSgGkCDCzT8rF5EvCLAAPLL705WhIwTYCBZVo+Nk8CfhFgYPmlN0dLAqYJMLBMy8fmScAvAgwsv/TmaEnANAEGlmn52DwJ+EWAgeWX3hwtCZgmwMAyLR+bJwG/CDCw/NKboyUB0wQYWKblY/Mk4BcBBpZfenO0JGCaAAPLtHxsngT8IsDA8ktvjpYETBNgYJmWj82TgF8EGFh+6c3RkoBpAgws0/KxeRLwiwADyy+9OVoSME2AgWVaPjZPAn4RYGD5pTdHSwKmCTCwTMvH5knALwIMLL/05mhJwDQBBpZp+dg8CfhFgIHll94cLQmYJsDAMi0fmycBvwgwsPzSm6MlAdMEGFim5WPzJOAXAQaWX3pztCRgmgADy7R8bJ4E/CLAwPJLb46WBEwTYGCZlo/Nk4BfBP4fdKKKT3sfOPsAAAAASUVORK5CYII=",p="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmlld0JveD0iMCAwIDQ1IDQ1Ij4KPHBhdGggZmlsbD0iI2E3MjAzNyIgc3Ryb2tlPSIjZmZmIiBkPSJNMjIuNSw0NC41YzEyLjE1LDAsMjItOS44NSwyMi0yMlMzNC42NSwuNSwyMi41LC41LC41LDEwLjM1LC41LDIyLjVzOS44NSwyMiwyMiwyMloiLz4KPHBhdGggY2xhc3M9ImNscy0zIiBkPSJNMjAuOTMsMzAuNDJsMy41Ni0xLjUxYy4xMywuODgtLjM0LDEuNzctMS4yLDIuMTQtLjg2LC4zNi0xLjgzLC4wOC0yLjM3LS42MlptNS40My0xNy44M2MyLjA5LDEuMTQsMy42NSwyLjYsNC42OCw0LjM5LDEuMDMsMS43OCwxLjUxLDMuODcsMS40Niw2LjI1LDAsLjQxLS4zNSwuNzQtLjc3LC43My0uNDEsMC0uNzQtLjM1LS43My0uNzcsLjA1LTIuMTEtLjM3LTMuOTMtMS4yNi01LjQ2LS44OS0xLjU0LTIuMjUtMi44MS00LjEtMy44Mi0uMzYtLjItLjUtLjY1LS4zLTEuMDIsLjItLjM2LC42NS0uNSwxLjAyLS4zWm0tOS4xNSw0LjQyYzIuODYtMS4yNyw2LjItLjA3LDcuNiwyLjc1bC4xLC4yMSwxLjI5LDIuODksMS43LDEuNDdjLjA5LC4wOCwuMTcsLjE3LC4yNywuMzJsLjA2LC4xMWMuMjgsLjYzLDAsMS4zNy0uNjQsMS42NWwtMTAuMzMsNC41N2MtLjE2LC4wNy0uMzMsLjExLS41MSwuMTEtLjY5LDAtMS4yNS0uNTYtMS4yNS0xLjI1di0yLjM0cy0xLjI0LTIuNzktMS4yNC0yLjc5Yy0xLjMxLTIuOTUsMC02LjM5LDIuOTUtNy43Wm0tMS41OCw3LjA5bDEuMzcsMy4wOHYyLjI4czkuNjItNC4yNiw5LjYyLTQuMjZsLTEuNjUtMS40My0xLjQyLTMuMTgtLjA4LS4xOGMtMS4wMy0yLjA4LTMuNTEtMi45Ny01LjY0LTIuMDMtMi4xOSwuOTctMy4xNywzLjUyLTIuMTksNS43MlptMTAuNS03LjkxYy45NywuNTMsMS43NCwxLjI5LDIuMzIsMi4yOSwuNTcsLjk5LC44NSwyLjA1LC44MiwzLjE1LS4wMSwuNDEtLjM1LC43NC0uNzcsLjczLS40MS0uMDEtLjc0LS4zNS0uNzMtLjc3LC4wMi0uODItLjE5LTEuNi0uNjItMi4zNi0uNDQtLjc2LTEuMDEtMS4zMy0xLjc0LTEuNzItLjM2LS4yLS41LS42NS0uMy0xLjAyLC4yLS4zNiwuNjUtLjUsMS4wMi0uM1oiLz4KPHBhdGggZmlsbD0iI2ZmZiIgZD0iTTIwLjkzLDMwLjQybDMuNTYtMS41MWMuMTMsLjg4LS4zNCwxLjc3LTEuMiwyLjE0LS44NiwuMzYtMS44MywuMDgtMi4zNy0uNjJabTUuNDMtMTcuODNjMi4wOSwxLjE0LDMuNjUsMi42LDQuNjgsNC4zOSwxLjAzLDEuNzgsMS41MSwzLjg3LDEuNDYsNi4yNSwwLC40MS0uMzUsLjc0LS43NywuNzMtLjQxLDAtLjc0LS4zNS0uNzMtLjc3LC4wNS0yLjExLS4zNy0zLjkzLTEuMjYtNS40Ni0uODktMS41NC0yLjI1LTIuODEtNC4xLTMuODItLjM2LS4yLS41LS42NS0uMy0xLjAyLC4yLS4zNiwuNjUtLjUsMS4wMi0uM1ptLTkuMTUsNC40MmMyLjg2LTEuMjcsNi4yLS4wNyw3LjYsMi43NWwuMSwuMjEsMS4yOSwyLjg5LDEuNywxLjQ3Yy4wOSwuMDgsLjE3LC4xNywuMjcsLjMybC4wNiwuMTFjLjI4LC42MywwLDEuMzctLjY0LDEuNjVsLTEwLjMzLDQuNTdjLS4xNiwuMDctLjMzLC4xMS0uNTEsLjExLS42OSwwLTEuMjUtLjU2LTEuMjUtMS4yNXYtMi4zNHMtMS4yNC0yLjc5LTEuMjQtMi43OWMtMS4zMS0yLjk1LDAtNi4zOSwyLjk1LTcuN1ptOC45MS0uODJjLjk3LC41MywxLjc0LDEuMjksMi4zMiwyLjI5LC41NywuOTksLjg1LDIuMDUsLjgyLDMuMTUtLjAxLC40MS0uMzUsLjc0LS43NywuNzMtLjQxLS4wMS0uNzQtLjM1LS43My0uNzcsLjAyLS44Mi0uMTktMS42LS42Mi0yLjM2LS40NC0uNzYtMS4wMS0xLjMzLTEuNzQtMS43Mi0uMzYtLjItLjUtLjY1LS4zLTEuMDIsLjItLjM2LC42NS0uNSwxLjAyLS4zWiIvPgo8L3N2Zz4=",k="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMCAyMCI+DQogIDxyZWN0IHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0iI2ZhZWNlYiIvPg0KICA8cGF0aCBmaWxsPSIjYmMyZjMyIiBkPSJNMi44NTM1NSAyLjE0NjQ2QzIuNjU4MjkgMS45NTEyIDIuMzQxNzEgMS45NTEyIDIuMTQ2NDUgMi4xNDY0NkMxLjk1MTE4IDIuMzQxNzIgMS45NTExOCAyLjY1ODMxIDIuMTQ2NDUgMi44NTM1N0wyLjkwOTM0IDMuNjE2NDZDMi4zNTI3MiA0LjA4NzA1IDIgNC43ODU3OSAyIDUuNTY1ODJWMTIuMjc2NEMyIDEzLjY5MzUgMy4xNjQwNiAxNC44NDIzIDQuNiAxNC44NDIzSDUuMTk5MzdMNS4yIDE3LjAxMzNDNS4yIDE3LjIyNjIgNS4yNjk4OSAxNy40MzM1IDUuMzk5MjEgMTcuNjA0MkM1LjczIDE4LjA0MDYgNi4zNTY2OCAxOC4xMjk4IDYuNzk4OTUgMTcuODAzNEwxMC44MSAxNC44NDIzSDE0LjEzNTFMMTcuMTQ2NCAxNy44NTM2QzE3LjM0MTcgMTguMDQ4OCAxNy42NTgzIDE4LjA0ODggMTcuODUzNiAxNy44NTM2QzE4LjA0ODggMTcuNjU4MyAxOC4wNDg4IDE3LjM0MTcgMTcuODUzNiAxNy4xNDY1TDE1LjU0NTQgMTQuODM4M0MxNS41NDU0IDE0LjgzODMgMTUuNTQ1NCAxNC44MzgzIDE1LjU0NTQgMTQuODM4M0wzLjgyMzUgMy4xMTYzOEMzLjgyMzUgMy4xMTYzOCAzLjgyMzUxIDMuMTE2MzggMy44MjM1IDMuMTE2MzhMMi44NTM1NSAyLjE0NjQ2Wk0xMy4xMzUxIDEzLjg0MjNIMTAuNDgwOUw2LjIwNTAyIDE2Ljk5ODhMNi4yMDM0NiAxNi45OTk3TDYuMiAxN0w2LjE5OTA4IDEzLjg0MjNINC42QzMuNzAzODMgMTMuODQyMyAzIDEzLjEyODggMyAxMi4yNzY0VjUuNTY1ODJDMyA1LjA2NzE0IDMuMjQwOTMgNC42MTU5OSAzLjYyMDM0IDQuMzI3NDZMMTMuMTM1MSAxMy44NDIzWiIvPg0KICA8cGF0aCBmaWxsPSIjYmMyZjMyIiBkPSJNMTcgMTIuMjc2NEMxNyAxMi45NjU4IDE2LjUzOTYgMTMuNTY0NCAxNS44ODk0IDEzLjc2OEwxNi42NDg4IDE0LjUyNzVDMTcuNDU0MSAxNC4wOTE1IDE4IDEzLjI0NjkgMTggMTIuMjc2NFY1LjU2NTgyQzE4IDQuMTQ4NzYgMTYuODM1OSAzIDE1LjQgM0g1LjEyMTM0TDYuMTIxMzQgNEgxNS40QzE2LjI5NjIgNCAxNyA0LjcxMzQ4IDE3IDUuNTY1ODJWMTIuMjc2NFoiLz4NCjwvc3ZnPg0K",g="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTIiIGhlaWdodD0iNTIiIHZpZXdCb3g9IjAgMCA1MiA1MiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik0yNiA1MC45NkMzOS43ODUgNTAuOTYgNTAuOTYgMzkuNzg1IDUwLjk2IDI2QzUwLjk2IDEyLjIxNSAzOS43ODUgMS4wNCAyNiAxLjA0QzEyLjIxNSAxLjA0IDEuMDQgMTIuMjE1IDEuMDQgMjZDMS4wNCAzOS43ODUgMTIuMjE1IDUwLjk2IDI2IDUwLjk2WiIgZmlsbD0iI0ZERjZGMyIgc3Ryb2tlPSIjRjRCRkFCIiBzdHJva2Utd2lkdGg9IjEuOTIiLz4NCjxwYXRoIGQ9Ik0yMy40OTk0IDE1Ljk0NTdDMjQuNTY1NyAxNC4wMTgxIDI3LjMzNjcgMTQuMDE4MSAyOC40MDMgMTUuOTQ1NkwzOC4wNDg4IDMzLjM4MTdDMzkuMDgxOSAzNS4yNDkyIDM3LjczMTMgMzcuNTQgMzUuNTk3MSAzNy41NEgxNi4zMDZDMTQuMTcxOCAzNy41NCAxMi44MjExIDM1LjI0OTMgMTMuODU0MSAzMy4zODE4TDIzLjQ5OTQgMTUuOTQ1N1pNMjcuMTk1IDMyLjU2MDVDMjcuMTk1IDMxLjg3MzcgMjYuNjM4MiAzMS4zMTY5IDI1Ljk1MTQgMzEuMzE2OUMyNS4yNjQ2IDMxLjMxNjkgMjQuNzA3OCAzMS44NzM3IDI0LjcwNzggMzIuNTYwNUMyNC43MDc4IDMzLjI0NzMgMjUuMjY0NiAzMy44MDQxIDI1Ljk1MTQgMzMuODA0MUMyNi42MzgyIDMzLjgwNDEgMjcuMTk1IDMzLjI0NzMgMjcuMTk1IDMyLjU2MDVaTTI2Ljg3MjMgMjIuNzgwOEMyNi44MTAxIDIyLjMyNSAyNi40MTkgMjEuOTczOSAyNS45NDYyIDIxLjk3NDNDMjUuNDMwMyAyMS45NzQ3IDI1LjAxMjUgMjIuMzkzMiAyNS4wMTI5IDIyLjkwOUwyNS4wMTc0IDI4LjUxNDlMMjUuMDI2IDI4LjY0MTZDMjUuMDg4MyAyOS4wOTc0IDI1LjQ3OTMgMjkuNDQ4NSAyNS45NTIxIDI5LjQ0ODFDMjYuNDY4IDI5LjQ0NzcgMjYuODg1OCAyOS4wMjkyIDI2Ljg4NTQgMjguNTEzNEwyNi44ODA5IDIyLjkwNzVMMjYuODcyMyAyMi43ODA4WiIgZmlsbD0iI0RBM0IwMSIvPg0KPC9zdmc+"},522277:(e,n,i)=>{"use strict";i.d(n,{kv:()=>m,kk:()=>c,Ul:()=>u,_Z:()=>g,y9:()=>N});var a=i(364819),t=i(243507),r=i(529442),l=i(97882),o=i(862474),d=i(203056),s=i(742640);const m="beta/users/defaultProfilePictureV2?displayName={displayName}",c=3,u={profilePictureType:o.It.User,generateUrl(e,n,i,a,t=o.xi.Small,r,d,c,u,g,N,v,I){if(r)return s.GX;if((0,l.Ku)(e.id)&&!N)return s.Yt;let S="";const A=u&&!g&&e.id?e.id.split("|")[0]:e.id,T=A&&A.indexOf("#")>=0?encodeURIComponent(A):A,f=e.displayName?encodeURIComponent(e.displayName):"";return S=""===e.id||N?m.replace("{displayName}",f):g?k(f,T,d,c,i,a):p(f,T,i,a),S=`${S}&size=${t}`,v&&I&&!N&&(S=`${S}&ETag=${I}`),`${n}${S}`},getPresenceUserId:e=>e.id},p=(e,n,i,t)=>{let r="";return r=i&&t&&!(0,a.isEmpty)(t)?"beta/users/{currentUserObjectId}/profilepicturev2/{id}?displayname={displayname}".replace("{currentUserObjectId}",t).replace("{id}",n).replace("{displayname}",e):"beta/users/{id}/profilepicturev2?displayname={displayname}".replace("{id}",n).replace("{displayname}",e),r},k=(e,n,i,t,r,l)=>{let o="";return o=r&&l&&!(0,a.isEmpty)(l)?"beta/users/{currentUserObjectId}/profilePictureV2ForSharedChannel/{id}?displayName={displayName}&conversationId={conversationId}&hostTenantId={hostTenantId}".replace("{currentUserObjectId}",l):"beta/users/{id}/profilePictureV2ForSharedChannel?displayName={displayName}&conversationId={conversationId}&hostTenantId={hostTenantId}",i&&t?o=o.replace("{id}",n).replace("{displayName}",e).replace("{conversationId}",i||"").replace("{hostTenantId}",t||""):(o=r&&l&&!(0,a.isEmpty)(l)?"beta/users/{currentUserObjectId}/profilePictureV2ForSharedChannel/{id}?displayName={displayName}".replace("{currentUserObjectId}",l):"beta/users/{id}/profilePictureV2ForSharedChannel?displayName={displayName}",o=o.replace("{id}",n).replace("{displayName}",e)),o},g={profilePictureType:o.It.Group,generateUrl(e,n,i,r,l=o.xi.Small){let m="";const u=(e.length>c?e.slice(0,c):e).map((e=>({userId:e.id,displayName:e.displayName}))),p=(e=>{if(1===e.length){const n=e[0].id;if(n===t.j8)return{shouldUseProjectGroupImage:!0,shouldUseDefaultGroupImage:!1};if(n===t.i2)return{shouldUseProjectGroupImage:!1,shouldUseDefaultGroupImage:!0}}return{shouldUseProjectGroupImage:!1,shouldUseDefaultGroupImage:!1}})(e);let{shouldUseDefaultGroupImage:k}=p;const{shouldUseProjectGroupImage:g}=p;if(k=!!g||(0,d.oz)(u),k||(0,a.isEmpty)(u))return s.Mz;if(g)return s.$M;m=encodeURIComponent(JSON.stringify(u));let N="";return N=i&&r&&!(0,a.isEmpty)(r)?"beta/users/{currentUserObjectId}/mergedProfilePicturev2?usersInfo={usersArray}&size={size}".replace("{currentUserObjectId}",r).replace("{usersArray}",m).replace("{size}",l):"beta/users/mergedProfilePicturev2?usersInfo={usersArray}&size={size}".replace("{usersArray}",m).replace("{size}",l),`${n}${N}`},getPresenceUserId(){}},N={profilePictureType:o.It.Team,generateUrl(e,n,i,a){const{displayName:t,groupId:l,pictureETag:o}=e;return(0,r.UB)(n,t,o||"",l,i,a)},getPresenceUserId(){}}},412967:(e,n,i)=>{"use strict";i.d(n,{J:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaGroupProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MsaGroupProfilePictureInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaGroupProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"msaGroupInfo"},value:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}]}]}}]}},431117:(e,n,i)=>{"use strict";i.d(n,{T:()=>D,g:()=>F});var a=i(34412),t=i.n(a),r=i(364819),l=i(513432),o=i(132097),d=i(50467),s=i(487167),m=i(43037),c=i(607002),u=i(862474),p=i(203056);const k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarChatAvatarUrlQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}}]},g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarChatTypeQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"picture"}},{kind:"Field",name:{kind:"Name",value:"chatType"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}}]}}]}}]},N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarCommunityProfilePictureQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"threadId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"imageUri"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"community"},arguments:[{kind:"Argument",name:{kind:"Name",value:"threadId"},value:{kind:"Variable",name:{kind:"Name",value:"threadId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"profilePictureUrl"},arguments:[{kind:"Argument",name:{kind:"Name",value:"imageUri"},value:{kind:"Variable",name:{kind:"Name",value:"imageUri"}}}]}]}}]}}]},v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarDownloadAmsItemQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"urlOrObjectId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BlobType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"applyRetry"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"downloadAmsItem"},arguments:[{kind:"Argument",name:{kind:"Name",value:"urlOrObjectId"},value:{kind:"Variable",name:{kind:"Name",value:"urlOrObjectId"}}},{kind:"Argument",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"type"}}},{kind:"Argument",name:{kind:"Name",value:"applyRetry"},value:{kind:"Variable",name:{kind:"Name",value:"applyRetry"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"blob"}}]}}]}}]},I={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarGetUsersQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mriOrEmailArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mriOrEmailArray"},value:{kind:"Variable",name:{kind:"Name",value:"mriOrEmailArray"}}},{kind:"Argument",name:{kind:"Name",value:"isMailAddress"},value:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}}]},S={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarIsSharedChannelQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelByID"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isShared"}},{kind:"Field",name:{kind:"Name",value:"substrateGroupId"}}]}}]}}]},A={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarUrlPreviewQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"urlPreview"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}}]}}]}}]},T={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"connectorProfile"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"integrationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorProfile"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"integrationId"},value:{kind:"Variable",name:{kind:"Name",value:"integrationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}}]},f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"isTenantVerifiedDomain"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"domain"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isTenantVerifiedDomain"},arguments:[{kind:"Argument",name:{kind:"Name",value:"domain"},value:{kind:"Variable",name:{kind:"Name",value:"domain"}}}]}]}}]};var M=i(412967);const h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaUserProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"imageUri"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"renderInitials"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"Argument",name:{kind:"Name",value:"imageUri"},value:{kind:"Variable",name:{kind:"Name",value:"imageUri"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}},{kind:"Argument",name:{kind:"Name",value:"renderInitials"},value:{kind:"Variable",name:{kind:"Name",value:"renderInitials"}}}]}]}}]},y={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"user"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}},{kind:"Field",name:{kind:"Name",value:"imageUri"}},{kind:"Field",name:{kind:"Name",value:"selfAvatarLastupdatedTime"}}]}}]}}]},F=(e,n="avatar-container-hook")=>{const{profilePictureType:i,defaultAvatarUrl:a}=b(e);return C(e,i,n)||a},b=e=>{const{userId:n,conversationId:i,teamId:a,enableMSAProfilePicture:t,showMergedAvatarForGroup:r,isTeamsApp:l,isUnresolvedEmail:o,sharedChannelId:s,entity:m,isEmergencyCallTarget:c}=e,{coreSettings:u}=(0,d.ur)(),k=(0,p.EO)(n,i,a,t,r||!1,l,o,s,m,u);return{profilePictureType:k,defaultAvatarUrl:(0,p.Ng)(k,c)}},C=(e,n,i)=>{const{skipGeneratingUrl:a}=e,[t,r]=l.useState(""),o=l.useRef(!1);return l.useEffect((()=>(o.current=!0,()=>{o.current=!1})),[]),l.useEffect((()=>{if(a)return;(async()=>{const a=await D(e,n,i);o.current&&a&&r(a)})()}),[e,n,i,a]),t},D=async(e,n,i)=>{const{baseImageUrl:a,isEmergencyCallTarget:l,isImageAuthCookieValid:o,enableCachedAvatarCheck:d,isAnonymousAccount:s,enableSampleAvatarFetch:m,enableAvatarUrlQuery:c,profilePictureSize:k,i18n:g}=e,N=(0,p.Ng)(n,l);let v;if(e.avatarUrl?v=(0,p.eB)(e.avatarUrl,k,n===u.It.User):c&&(v=await Q(e,n,i)),e.enableFBSTelemetryForAvatarStatus&&e.scenarioFactory&&((0,r.isEmpty)(a)||!o)){const n={callerInfo:i,skipGeneratingUrl:!!e.skipGeneratingUrl,propsAvatarUrl:e.avatarUrl,cachedUrl:void 0,generatedUrl:N,baseImageUrl:(0,r.isEmpty)(a)?"INVALID":a,isCookieValid:!!o,profilePictureType:e.generator.profilePictureType,isSelfProfileAvatar:!!e.isSelfProfileAvatar,forSharedChannel:!!e.isSharedChannel,isXtapUserUrl:!1,logger:e.logger,scenarioFactory:e.scenarioFactory};(0,p.Qc)(n)}if((0,r.isEmpty)(v)||v&&(0,p.vG)(v,g)){if((0,r.isEmpty)(a))return N;v=await U(e,n,i)}if(!v)return N;if(o||s||n===u.It.Initials)return o&&((e,n,i)=>{e&&t()(n,{method:"GET",credentials:"include",headers:{"x-ms-client-caller":i}}).catch((()=>{}))})(!!m,v,i),v;if(d){if(await(0,p.iU)(v))return v}return N},U=async(e,n,i)=>{const{userId:a,conversationId:t,entity:r,client:l,logger:o,profilePictureSize:d,isSelfProfileAvatar:s,showUpdatedGroupAvatar:m,enableConnectorsProfileInChannels:c,onBehalfOfId:p,scenarioFactory:k}=e;let g;switch(n){case u.It.Communities:g=await R(r,l,o,m);break;case u.It.Connector:const n=await B(l,t,a,o,c);g=n?.data?.connectorProfile?.avatarUrl;break;case u.It.OutgoingWebhook:g=await z(l,t,o,p,k);break;case u.It.App:case u.It.Bot:g=await W(l,a,o,i);break;case u.It.MsaUser:case u.It.MsaGroup:g=await x(a,t,d||u.xi.Small,r,l,o,i,s,m);break;case u.It.User:case u.It.Group:case u.It.Team:case u.It.SharedChannelInviteeTeam:g=await E(e,l,i);break;case u.It.MergedGroup:g=await j(e);break;case u.It.Initials:g=await V(e)}return g},E=async(e,n,i)=>{const{entity:a,profilePictureSize:t,isEmergencyCallTarget:r,generator:l,baseImageUrl:o,logger:d,isSelfProfileAvatar:s,avatarEtag:m}=e;let c,u=m;const{conversationId:p}=e;if(!Array.isArray(a)){const e=a;c=e.upn,e&&!e.displayName&&d.warn(`Avatar without display name, callerInfo: ${i}`)}if(e.isSharedChannel&&p){const{data:a}=await n.query({query:S,variables:{convId:p},context:{callerInfo:"avatar-url-shared-channel"}});if(a?.channelByID?.substrateGroupId||a?.channelByID?.isShared)return w(c,e,n,i)}if(s&&!u){const e=a,t=await n.query({query:y,variables:{userId:e.id},context:{callerInfo:i}});t?.data?.user?.selfAvatarLastupdatedTime&&(u=t?.data?.user?.selfAvatarLastupdatedTime)}return l.generateUrl(a,o||"",!!e.isProfilePictureWithObjectIdEnabled,e.currentUserOid,t,r,void 0,void 0,void 0,void 0,void 0,s,u)},w=async(e,n,i,a)=>{const{entity:t,profilePictureSize:r,isEmergencyCallTarget:l,generator:o,baseImageUrl:d,logger:s}=n;if(e){const a=!await L(i,e);return o.generateUrl(t,d||"",!!n.isProfilePictureWithObjectIdEnabled,n.currentUserOid,r,l,n.conversationId,n.hostTenantId,!0,a,void 0)}return s.warn(`Avatar: upn not provided for sharedChannel, callerInfo: ${a}`),o.generateUrl(t,d||"",!!n.isProfilePictureWithObjectIdEnabled,n.currentUserOid,r,l,n.conversationId,n.hostTenantId,!0,!0,void 0)},L=async(e,n)=>{const i=n.substring(n.indexOf("@")+1);try{const{data:n}=await e.query({query:f,variables:{domain:i}});return n&&n.isTenantVerifiedDomain}catch{return!1}},x=async(e,n,i,a,t,r,l,o=!1,d=!1)=>{const s=(0,m.Fz)(n);let c;if(e&&n&&Array.isArray(a)||s){const{data:e}=await t.query({query:g,variables:{convId:n},context:{callerInfo:"get-msa-avatar-url"}});if(s&&e?.chat?.picture)return e.chat.picture;c="Chat"===e?.chat?.chatType&&!e?.chat?.isOneOnOne}if(e&&!c){const n=await O(t,e,a.displayName,i,r,l,o);return n?.data?.msaUserProfilePicture}if(n){const e=[],i=a;Array.isArray(i)&&i.forEach((n=>{e.push({userId:n.id,displayName:n.displayName?n.displayName:""})}));const l=await P(t,n,e,r,d);return l?.data?.msaGroupProfilePicture}},O=async(e,n,i,a,t,r,l,o)=>{try{return await e.query({query:h,variables:{userId:n,displayName:i,callerInfo:"avatar-container",profilePictureSize:a,renderInitials:o},fetchPolicy:l?"network-only":"cache-first"})}catch(e){return void t.errorToTelemetry?.(`msaUserProfilePictureQuery failed for msa user: ${e.message}, callerInfo: ${r}`,"msa_user_profile_picture_query",void 0,!0)}},P=async(e,n,i,a,t)=>{i.forEach((e=>{e&&(0,r.isEmpty)(e.displayName)&&n&&a.warn(`Avatar without display name for conversationId: ${n}`)}));try{const a={conversationId:n,pictureReadyUsers:i};return await e.query({query:M.J,variables:{msaGroupInfo:a,callerInfo:"avatar-container"},fetchPolicy:t?"network-only":"cache-first"})}catch{return void a.error(`msaGroupProfilePictureQuery failed for conversationId:  ${n}`)}},V=async e=>{const{entity:n,profilePictureSize:i,isEmergencyCallTarget:a,generator:t,baseImageUrl:r}=e;return t.generateUrl(n,r,!!e.isProfilePictureWithObjectIdEnabled,e.currentUserOid,i,a,void 0,void 0,!1,!1,!0)},j=async e=>{const{entity:n,profilePictureSize:i,isEmergencyCallTarget:a,generator:t,baseImageUrl:r}=e;return t.generateUrl(n,r,!!e.isProfilePictureWithObjectIdEnabled,e.currentUserOid,i,a,void 0,void 0,!1,!1,!0)},B=async(e,n,i,a,t)=>{try{if(t&&n&&i){return await e.query({query:T,variables:{convId:n,integrationId:i}})}return}catch(e){return void a.error(`connectors query failed for conversationId: ${n}`)}},z=async(e,n,i,a,t)=>{if(t&&a&&n)try{const r=await(0,s.DW)(e,n);return(await(0,o.tN)(e,i,t,a,!0,"outgoing-webhook-avatar-url",{conversation:{scope:"Team",id:r||""}}))[0].definition.largeImageUrl}catch(e){i.error(`installed apps query failed for conversationId: ${n}`)}},R=async(e,n,i,a)=>{const t=e.teamThreadId||"",r=e.pictureETag;if(r)try{const e=await n.query({query:N,variables:{threadId:t,imageUri:r},fetchPolicy:a?"network-only":"cache-first"});return e?.data?.community?.profilePictureUrl}catch(e){return void i.errorToTelemetry?.(`community profile picture query failed for this : ${t}`,"community_profile_picture_query_failed")}else i.infoToTelemetry?.(`getCommunitiesAvatarUrl function returned undefined for this threadId : ${t}, and imageUri: ${r}`,"get_communities_avatar_url_returned_undefined",void 0,!0)},Q=async(e,n,i)=>{const{client:a,profilePictureSize:t}=e;if(n===u.It.User&&e.userId){const{data:n}=await a.query({query:I,variables:{mriOrEmailArray:[e.userId]},context:{callerInfo:i}});return(0,p.eB)(n.getUsers?.[0].avatarUrl,t,!0)}if(n===u.It.Group&&e.conversationId){const{data:n}=await a.query({query:k,variables:{convId:e.conversationId},context:{callerInfo:i}});return n.chat?.avatarUrl}},W=async(e,n,i,a)=>{const t=await(async(e,n,i,a)=>{try{return await e.query({query:y,variables:{userId:n},context:{callerInfo:a}})}catch(e){return void i.error(`userQuery failed: ${e.message}`)}})(e,n,i,a),r=t?.data?.user?.avatarUrl||t?.data?.user?.imageUri;if(r){if(r.startsWith("blob:"))return r;let n;if((0,c.D$)(r))n=r;else{const i=await e.query({query:A,variables:{url:r},context:{callerInfo:a}});n=i?.data.urlPreview?.thumbnail||i?.data.urlPreview?.url}if(n){const{data:i}=await e.query({query:v,variables:{urlOrObjectId:n,type:"Url",applyRetry:!0}});return i?.downloadAmsItem?.blob}}}},313314:(e,n,i)=>{"use strict";i.d(n,{A:()=>I});var a=i(369847),t=i(466548),r=i(308696),l=i(441065),o=i(255368),d=i(690686),s=i(189737),m=i(703566),c=i(361891),u=i(858863),p=i(24706),k=i(502393),g=i(627750),N=i(566424),v=i(40341);const I={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsChatQueriesChatQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"shortTitle"}},{kind:"Field",name:{kind:"Name",value:"groupTemplate"}},{kind:"Field",name:{kind:"Name",value:"themeId"}},{kind:"Field",name:{kind:"Name",value:"picture"}},{kind:"Field",name:{kind:"Name",value:"isBotBlocked"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOneBotChat"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}},{kind:"Field",name:{kind:"Name",value:"disabledReason"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}},{kind:"Field",name:{kind:"Name",value:"newlyCreatedUserId"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingChatPolicy"}},{kind:"Field",name:{kind:"Name",value:"chatSubType"}},{kind:"Field",name:{kind:"Name",value:"chatType"}},{kind:"Field",name:{kind:"Name",value:"isSfB"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMeeting"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"isMuted"}},{kind:"Field",name:{kind:"Name",value:"isFederated"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isChannel"}},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"isRead"}},{kind:"Field",name:{kind:"Name",value:"isRetentionHorizonSet"}},{kind:"Field",name:{kind:"Name",value:"isModerator"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"isAdmin"}},{kind:"Field",name:{kind:"Name",value:"isUserAnonymous"}},{kind:"Field",name:{kind:"Name",value:"substrateGroupId"}},{kind:"Field",name:{kind:"Name",value:"lastMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"lastMessageFields"}}]}},{kind:"Field",name:{kind:"Name",value:"me"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizonBookmark"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"userConsumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"memberIds"}},{kind:"Field",name:{kind:"Name",value:"membersLimited"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"memberDisplayNamesLimited"}},{kind:"Field",name:{kind:"Name",value:"oneOnOneChatHeaderCallButtonValue"}},{kind:"Field",name:{kind:"Name",value:"hasFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"cfet"}},{kind:"Field",name:{kind:"Name",value:"hasEnterpriseUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnknownConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnknownEnterpriseUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnresolvedFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"isImpersonation"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsUnverifiedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsVerifiedUser"}},{kind:"Field",name:{kind:"Name",value:"nonTeamsFederatedUserLimitedNames"}},{kind:"Field",name:{kind:"Name",value:"nonTeamsFederatedUsersLength"}},{kind:"Field",name:{kind:"Name",value:"isPrivateChatPolicyDefinedScenario"}},{kind:"Field",name:{kind:"Name",value:"isChatDisabledForRecipients"}},{kind:"Field",name:{kind:"Name",value:"guardianChatInfo"}},{kind:"Field",name:{kind:"Name",value:"quarantineCounter"}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUserLength"}},{kind:"Field",name:{kind:"Name",value:"hasBotMember"}},{kind:"Field",name:{kind:"Name",value:"isUserMember"}},{kind:"Field",name:{kind:"Name",value:"botMembers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"userAdminSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"adminDeleteEnabled"}},{kind:"Field",name:{kind:"Name",value:"deleteMessagesEnabled"}}]}},{kind:"Field",name:{kind:"Name",value:"creator"}},{kind:"Field",name:{kind:"Name",value:"meetingInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"meetingType"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"meetingData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meetingCode"}},{kind:"Field",name:{kind:"Name",value:"passcode"}},{kind:"Field",name:{kind:"Name",value:"meetingUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"resolvedSensitivityLabelId"}},{kind:"Field",name:{kind:"Name",value:"isCopyRestrictionEnforced"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"scenario"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonRecordingMessageMiFragment"}},{kind:"Field",name:{kind:"Name",value:"messagingPolicy"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"textOnlyChat"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"chatDisabledContext"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUIDisabled"}},{kind:"Field",name:{kind:"Name",value:"disabledReason"}},{kind:"Field",name:{kind:"Name",value:"extendedData"}},{kind:"Field",name:{kind:"Name",value:"lastUpdatedTime"}}]}},{kind:"Field",name:{kind:"Name",value:"interopConversationStatus"}},{kind:"Field",name:{kind:"Name",value:"extendedDirectoryRedemptionRequired"}},{kind:"Field",name:{kind:"Name",value:"hasExtendedDirectoryUsers"}},{kind:"Field",name:{kind:"Name",value:"chatScheduleSuggestionSuppressUntil"}},{kind:"Field",name:{kind:"Name",value:"chatHistoryHiddenTime"}},{kind:"Field",name:{kind:"Name",value:"clearHistoryTime"}},{kind:"Field",name:{kind:"Name",value:"userProperties"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userProperties"}}]}},{kind:"Field",name:{kind:"Name",value:"pinnedConversationItems"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"pinnedMessageItemFields"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"addedBy"}},{kind:"Field",name:{kind:"Name",value:"addedByTenantId"}},{kind:"Field",name:{kind:"Name",value:"identityMaskEnabled"}},{kind:"Field",name:{kind:"Name",value:"sensitivityLabel"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isCopyBlocked"}}]}},{kind:"Field",name:{kind:"Name",value:"createdAt"}},{kind:"Field",name:{kind:"Name",value:"lastJoinAt"}},{kind:"Field",name:{kind:"Name",value:"isCommentStream"}},{kind:"Field",name:{kind:"Name",value:"isCommentStreamMeetingStarted"}},{kind:"Field",name:{kind:"Name",value:"isConversationThreadDeleted"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}},{kind:"Field",name:{kind:"Name",value:"meetingChatType"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonUseExternalTagFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonChatMtoTelemetryFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonChatWithMtoUserBannerFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonChatRecapFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonUseMtoUserBannerFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonChatPaneLayoutFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonChatAddMembersFragment"}},{kind:"Field",name:{kind:"Name",value:"awarenessLiveState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}},{kind:"Field",name:{kind:"Name",value:"groupCopilotInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"allowInstallation"}},{kind:"Field",name:{kind:"Name",value:"allowInteraction"}}]}},{kind:"Field",name:{kind:"Name",value:"pendingBots"}},{kind:"Field",name:{kind:"Name",value:"isConversationalUXEnabled"}},{kind:"Field",name:{kind:"Name",value:"isChatPartialHistoryShared"}},{kind:"Field",name:{kind:"Name",value:"meetingChatType"}},{kind:"Field",name:{kind:"Name",value:"showRedDot"}},{kind:"Field",name:{kind:"Name",value:"activeCall"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonActiveCallFragment"}}]}}]}}]}},...a.L.definitions,...t.x.definitions,...r.U.definitions,...l.q.definitions,...o.x.definitions,...d.p.definitions,...s.M.definitions,...m.n.definitions,...c.Y.definitions,...u.I.definitions,...p.W.definitions,...k.P.definitions,...g.F.definitions,...N.h.definitions,...v.n.definitions]}},780689:(e,n,i)=>{"use strict";i.d(n,{DW:()=>t,bE:()=>r,XF:()=>l,Yp:()=>o,u0:()=>d,gL:()=>s});var a=i(336307);const t=()=>(0,a.h)("amsV2Domain")||"",r=()=>(0,a.h)("baseImageUrl")||"",l=()=>(0,a.h)("isImageAuthCookieValid")||!1,o=()=>(0,a.h)("postCriticalPhaseReached")||!1,d=()=>(0,a.h)("completePhaseReached")||!1,s=()=>(0,a.h)("meControlAvatarSrc")||""},336307:(e,n,i)=>{"use strict";i.d(n,{h:()=>r});var a=i(513432),t=i(877568);const r=e=>{const{stateManagementServices:{userWindowStore:n}}=(0,t.C)();return l(n,e)},l=(e,n)=>{const[i,t]=(0,a.useState)(e?.get(n));return(0,a.useEffect)((()=>{const i=e?.subscribe(n,(e=>{t(e)}));return()=>i&&i()}),[e,t,n]),i}},877997:(e,n,i)=>{"use strict";i.d(n,{r$:()=>p,Os:()=>k,Dh:()=>S,wQ:()=>c,wS:()=>v,fm:()=>u});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getUsersForConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mriArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isShortProfileRequested"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"peoplePickerFilters"}},type:{kind:"NamedType",name:{kind:"Name",value:"PeoplePickerFiltersInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isSharedChannel"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hostTenantId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getUsersForConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mriArray"},value:{kind:"Variable",name:{kind:"Name",value:"mriArray"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"isShortProfileRequested"},value:{kind:"Variable",name:{kind:"Name",value:"isShortProfileRequested"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}},{kind:"Argument",name:{kind:"Name",value:"peoplePickerFilters"},value:{kind:"Variable",name:{kind:"Name",value:"peoplePickerFilters"}}},{kind:"Argument",name:{kind:"Name",value:"isSharedChannel"},value:{kind:"Variable",name:{kind:"Name",value:"isSharedChannel"}}},{kind:"Argument",name:{kind:"Name",value:"hostTenantId"},value:{kind:"Variable",name:{kind:"Name",value:"hostTenantId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userProfileData"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userProfileData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"User"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}},{kind:"Field",name:{kind:"Name",value:"companyName"}},{kind:"Field",name:{kind:"Name",value:"tenantName"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"userType"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"xtapUser"}}]}}]}.definitions]};var t=i(478522),r=i(586892),l=i(210071),o=i(332752),d=i(97882);const s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsPersonaUserTypeQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"userType"}},{kind:"Field",name:{kind:"Name",value:"profileType"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]},m="Topic",c=e=>{const{ariaLabel:n,behavior:i,disableAccessibilityDefaults:a,externalAppSessionCorrelationId:t,hostConversationId:r,hostTenantId:l,isSharedChannel:o,tabIndex:d,userId:s,handleOnCardOpen:c,handleOnCardClose:u,personaType:p,topicId:k,contextId:g,highlightedText:N,shouldDeferCardOpenToParentWindow:v,displayName:S}=e,A=p===m?{contextId:g,highlightedText:N,hideEntityAndContextQuestion:!0}:void 0;return{cardParameters:{disableAccessibilityDefaults:!!a,personaInfo:{identifiers:{PersonaType:p||"NotResolved",HostAppPersonaId:I({userId:s,isSharedChannel:!!o,hostTenantId:l,hostConversationId:r}),TeamsMri:p!==m?s:void 0,TopicId:k},topicMetadata:A,displayName:S},behavior:{onCardOpen:c,onCardClose:u,disableHover:!1,cardPlacementMode:"AnchorSide",shouldDeferCardOpenToParentWindow:!!v,...i},externalAppSessionCorrelationId:t,ariaLabel:n,clientScenario:"MicrosoftTeams_MultiWindow",cardOpenTime:Date.now()},tabIndex:d}},u=(e,n,i)=>{e.LPC.openCard(n,{...c(i).cardParameters})},p=(e,n)=>{e.LPC.dismissCard((()=>{}),n)},k=async(e,n,i,t,l,d,s,m,c)=>{const{enableTflSms:u}=s.get(o.w.Messaging),{showPersonCardForSMSUser:p,showPersonCardForXTapUser:k}=s.get(o.w.People),{disablePstnPersonaCard:I,disablePersonaCard:S}=s.get(o.w.Calling),{enableFlyoutInlineChat:A,enableSimplifiedFeaturesInFlyoutChat:T}=s.get(o.w.Flyout);if(S||A&&T)return!1;if(e&&r.af.isTFLSmsMri(e))return!!u&&!!p;if(e&&r.af.isTFLOffNetworkUser(e))return!1;if(n&&"attendee"===i&&r.af.isAnonymousTfwUser(e))return!1;if(g(e,s))return!1;if(N(!!I,e))return!1;if(t&&!k){const n=v(e,l||"",d,c,t);if(!n)return c.warn("xTap profile Query variables are not defined for a shared channel"),!1;const{data:i}=await m.query({query:a,variables:n,context:{callerInfo:"lpc-persona-container"}});if(!i||!i.getUsersForConversation)return c.warn("xTap profile Query returned null data"),!1;const o=i.getUsersForConversation,s=!!(o.length>0&&o[0]&&r.af.isFederatedUser(o[0])&&o[0].xtapUser);return!s||!!k&&s}return!0},g=(e,n)=>{const i=n.get(o.w.Metadata).environment===t.B.life,a=n.get(o.w.PhonelinkSms).enablePhonelinkSms||!1,r=n.get(o.w.HostCapabilities).phoneLinkingBlocked||!1,l=a&&!r;return e&&(0,d.Ku)(e)&&i&&l},N=(e,n)=>e&&(0,d.Ku)(n);function v(e,n,i,a,t){if(!n&&t)return void a.warn("Host conversation Id is not defined for a shared channel");return{mriArray:[e],conversationId:t?n:"",isShortProfileRequested:!1,peoplePickerFilters:void 0,isSharedChannel:t,hostTenantId:i}}const I=({userId:e,isSharedChannel:n,hostTenantId:i,hostConversationId:a})=>JSON.stringify({userId:e,isSharedChannel:n,hostTenantId:i,hostConversationId:a});const S=async(e,n,i)=>{const{data:a}=await i.query({query:s,variables:{userId:e},context:{callerInfo:"lpc-persona-container:on-hover"}}),{user:t}=a,{userType:o,profileType:d,type:m}=t||{},c=r.af.isMTOUser({profileType:d})?l.$o.MTOUser:r.af.isB2BMember({profileType:d,userType:o})?l.$o.B2BMember:r.af.isAcsUserMri(e)?l.$o.ACSUser:r.af.isAnonymousTfwUser(e)?l.$o.anonymousUser:o||m,u=n.createDatabag?.();let p;return o&&(p=r.af.getTfwExtendedDirectoryMembership({mri:e,userType:o})),u&&(u.isEDUser=!!p,u.EDUserState=p,u.userTypeSelected=c),u}},331923:(e,n,i)=>{"use strict";i.d(n,{S:()=>N});var a=i(50467),t=i(332752),r=i(727780),l=i(277362),o=i(89517),d=i(132097),s=i(139150),m=i(364819),c=i(513432),u=i(127066),p=i(659385),k=i(554186),g=i(278197);const N=()=>{const e=(0,s.m)(),{entityCommanding:n}=(0,a.ur)(),{enableAppDetailsToChatNavigation:i}=(0,u.w2)(t.w.Extensibility,["enableAppDetailsToChatNavigation"]),m=(0,g.u)();return c.useCallback((async(a,t,s)=>{const c=await(0,d.xR)(e,a,void 0,void 0,"launch-personal-app"),u=c.bots?.[0]?.id,g=I(u),{isM365BotPostInstallNavEnabled:N,navigateToM365BotChat:T}=m(a,g);if(v(c))t?N()?await T(!1):n.platform.launchPersonalPlatformApp(a,!!s):n.platform.launchPersonalApp({appId:a,botMri:g,isNewlyInstalled:!1});else if(S("Personal",c.messageExtensions)){const t=n.platform.launchAppDetailsTutorial({appName:c.name??"",isFirstInstallation:!1,hasCommandBoxCapability:A(c,"Commandbox"),hasComposeCapability:A(c,"Compose")}).subscribe({next:t=>{t.containerState&&t.containerState===r.iW.Confirmed&&(i?n.chat.default({correlation:{source:l.p.PlatformAppDetailsDialog},stateTransition:r.Ar.flush,visibilityState:r.Rp.show}).then((()=>{e.mutate({mutation:p.S,variables:{input:{appId:a,id:(0,k.v4)(),capability:o.$E.MessagingExtension}}})})):n.platform.appDetailsPostInstall({name:"navigateToLastChatState",appCapability:o.$E.MessagingExtension,appId:a,externalId:c.externalId??""}).then((()=>{e.mutate({mutation:p.S,variables:{input:{appId:a,id:(0,k.v4)(),capability:o.$E.MessagingExtension}}})})))},complete:()=>{t.unsubscribe()}})}else;}),[e,m,n.platform,i,n.chat])},v=e=>{const n=(e.meetingExtensionDefinition?.scenes?.length??0)>0,i=(e.meetingExtensionDefinition?.filters?.length??0)>0;return S("Personal",e.staticTabs)||S("Personal",e.bots)||n||i},I=e=>{if(e){const n=e?.startsWith("28:");return n?e:`28:${e}`}},S=(e,n)=>(0,m.some)(n,(n=>(0,m.includes)(n.scopes,e))),A=(e,n)=>e.messageExtensions?.some((e=>e.commands?.some((e=>e.context?e.context.some((e=>e===n)):"Commandbox"===n||"Compose"))))??!1},278197:(e,n,i)=>{"use strict";i.d(n,{u:()=>g});var a=i(513432),t=i(50467),r=i(881360),l=i(727780),o=i(277362),d=i(127066),s=i(332752),m=i(139150),c=i(451281);const u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsPlatformSharedHooksGetConversationForBotIdQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScope"},value:{kind:"Variable",name:{kind:"Name",value:"installedScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"conversationForBot"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]},p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsPlatformSharedHooksGetPinnedChatIdsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pinnedChats"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]}}]},k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ComponentsPlatformSharedHooksSetChatPinnedMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pinned"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setChatPinned"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"pinned"},value:{kind:"Variable",name:{kind:"Name",value:"pinned"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConversationPinnedUpdate"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"convId"}},{kind:"Field",name:{kind:"Name",value:"pinned"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SetChatPinnedMaxLimitReachedError"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"maxPinnedChats"}}]}}]}}]}}]},g=()=>{const e=(0,m.m)(),{entityCommanding:n}=(0,t.ur)(),{enableM365BotPostInstallNavigation:i,m365ChatBotIds:g}=(0,d.w2)(s.w.Messaging,["enableM365BotPostInstallNavigation","m365ChatBotIds"]),[N]=(0,c.n)(k),v=(0,r.U)("useLaunchBizChatNavigation");return a.useCallback(((a,t="")=>({isM365BotPostInstallNavEnabled:()=>{const e=[...g||[]];return i&&e.includes(t)},navigateToM365BotChat:async i=>{try{const{data:t}=await e.query({query:u,variables:{appId:a,installedScope:"Personal"},fetchPolicy:"no-cache"});if(t.installedApp?.conversationForBot?.id){let r=!1;const d=t.installedApp.conversationForBot.id;try{const{data:n}=await e.query({query:p});r=!!n?.pinnedChats.edges.some((e=>e.node.id===d))}catch{v.errorToTelemetry?.("failed to get pinned chat ids for bot post install navigation.","platform_userlifecycle_details_dialog_event",{appId:a,conversationId:d})}if(i&&!r)try{await N({variables:{convId:t.installedApp.conversationForBot.id,pinned:!0}})}catch{v.errorToTelemetry?.("failed to set chat pinned for bot post install navigation.","platform_userlifecycle_details_dialog_event",{appId:a,conversationId:d})}await n.chat.chatById(t.installedApp.conversationForBot.id,{entityCommand:{stateTransition:l.Ar.forceFlush,visibilityState:l.Rp.show,correlation:{source:o.p.PlatformAppDetailsDialog}}})}}catch(e){throw v.errorToTelemetry?.(`failed to grab the conversation id from the installed app. appId: ${a}`,"platform_userlifecycle_details_dialog_event",{appId:a}),e}}})),[e,i,n.chat,v,g,N])}},371174:(e,n,i)=>{"use strict";i.d(n,{z:()=>l});var a=i(332752),t=i(127066),r=i(364819);const l=e=>{const{enableGetMeetingDetails:n,enableMeetingAudioAPIs:i,enableMeetingApisAccessForSideloadedApp:l,appsWithMeetingApisPermissions:o}=(0,t.w2)(a.w.Extensibility,["enableGetMeetingDetails","enableMeetingAudioAPIs","enableMeetingApisAccessForSideloadedApp","appsWithMeetingApisPermissions"]);if(e&&(n||i)){const n=e.externalId&&!e.tenantId;if(l&&n||(0,r.includes)(o,e.id))return!0}return!1}},736629:(e,n,i)=>{"use strict";i.d(n,{QA:()=>t,YT:()=>r,lb:()=>l,t2:()=>o,P3:()=>d,Lv:()=>s,dy:()=>m,TU:()=>c});var a=i(355552);const t="com.microsoft.teamspace.tab.web",r="com.microsoft.teamspace.tab.file.staticviewer.pdf",l="com.microsoft.teams.callable-channel",o="44263ed4-f1ac-4e96-93aa-d24dd50459ea",d="b85718a3-6d15-4f59-8fad-b6809c6fc6a9",s="com.microsoft.chattabs.storyline",m="683f3525-d193-4a67-8d91-22093beab1ca",c=[a.b5.PersonalTab,a.b5.ChannelTab,a.b5.PrivateChatTab,a.b5.MeetingChatTab,a.b5.MeetingDetailsTab]},336113:(e,n,i)=>{"use strict";i.d(n,{u:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsPlatformTabUtilsChannelByIdQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelByID"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"channelType"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"defaultOneNoteSectionId"}},{kind:"Field",name:{kind:"Name",value:"defaultFileSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filesRelativePath"}}]}},{kind:"Field",name:{kind:"Name",value:"hostTeamGroupId"}},{kind:"Field",name:{kind:"Name",value:"hostTeamId"}},{kind:"Field",name:{kind:"Name",value:"hostTenantId"}},{kind:"Field",name:{kind:"Name",value:"owningTeam"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"teamSiteInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"isArchived"}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"teamType"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}}]}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}},{kind:"Field",name:{kind:"Name",value:"isGeneral"}}]}}]}}]}},829775:(e,n,i)=>{"use strict";i.d(n,{W_:()=>s,IW:()=>m,fk:()=>c,RD:()=>u,vd:()=>k,Fs:()=>N,ZB:()=>v,gn:()=>A,Ql:()=>T});var a,t=i(848020),r=i(998606),l=i(719156),o=i(355552),d=i(75914);!function(e){e.Member="member",e.Guest="guest",e.External="external",e.Anonymous="anonymous",e.Unknown="unknown"}(a||(a={}));const s=(e,n,i)=>n===d.vW.None&&e===l.CallType.Conference&&!i,m=(e,n,i)=>n===d.vW.None&&e===l.CallType.P2P&&i,c=(e,n)=>{if(u(e))return a.Anonymous;if(p(e))return a.Guest;if(e&&n){if(k(e.profile?.tenantId,n))return a.External;if(g(e.profile?.tenantId,n))return a.Member}return a.Unknown},u=e=>e?.role===t.a7.Anonymous,p=e=>e?.role===t.a7.Guest,k=(e,n,i)=>(i?.log(`isExternalUser: tenantId-${n}, currentTenantId-${e}`),!(!n||!e||e===n)),g=(e,n)=>!!n&&!!e&&e===n,N=(e,n,i,a,t)=>{const r=e?.baseInfo?.id,l=n?.appDefinition;if(t?.log(`(isValidTabForInMeetingExperience) Tab: ${r}, App: ${l?.name} ${l?.id}, isAnonymousUser: ${i}, enableMeetingSurfaces: ${a}`),!a||((e,n,i)=>{const a=n.appDefinition?.galleryTabs?.[0];let t=!1;if("StaticExtensionTab"===e.__typename){const a=n.appDefinition?.staticTabs?.find((n=>n.entityId===e?.entityId));t=a?.context?.some((e=>e===o.b5.MeetingSidePanel)),i?.log(`(isMeetingOptimizeApp) Static tab ${e?.baseInfo?.id} isMeetingOptimized: ${t}`)}else t=a?.context?.some((e=>e===o._N.MeetingSidePanel))||a?.meetingSurfaces?.some((e=>e===o.H$.SidePanel)),i?.log(`(isMeetingOptimizeApp) Gallery Tab ${e?.baseInfo?.id} isMeetingOptimized: ${t}. `);return!!t})(e,n,t)){const e=!i||(e=>e?.appDefinition?.meetingExtensionDefinition?.isAnonymousAccessAllowed)(n);return t?.log(`(isValidTabForInMeetingExperience) is access to tab '${r}', valid: ${e}`),e}return!1},v=(e,n,i,a,o,d,m,c,u,p)=>{if(!d)return!1;const k=e?.type===t.aS.MsaLife;if(p&&k)return!0;if(A(e,d))return!1;const g=s(i,m,a);if(S(a,g,o))return!1;const N=n===r.A2.Organizer||n===r.A2.Presenter,v=c&&i===l.CallType.P2P;return N||v||u&&I(n,g)},I=(e,n)=>e===r.A2.Attendee&&n,S=(e,n,i)=>i&&(e||n),A=(e,n)=>{if(u(e))return!0;if(p(e))return!0;return!!k(e?.profile.tenantId,n)},T=(e,n)=>`${e};replyChainId=${n}`},487167:(e,n,i)=>{"use strict";i.d(n,{dx:()=>T,Y2:()=>f,ZK:()=>M,ZT:()=>h,DW:()=>y,Xc:()=>F,ZB:()=>C,re:()=>U,gf:()=>E,rP:()=>w,gL:()=>L,Ot:()=>x,V:()=>O,JU:()=>V,SN:()=>j,Hz:()=>B,Zc:()=>z,BJ:()=>R,HD:()=>Q,Os:()=>W,eT:()=>Y,V7:()=>G,iq:()=>Z,Sb:()=>_,vU:()=>H,R7:()=>J,t_:()=>q,$Y:()=>X,Zm:()=>K,JY:()=>$,yA:()=>ee,bF:()=>ne,JT:()=>ie,b5:()=>ae,Fs:()=>te,V_:()=>re,td:()=>le,Vg:()=>oe,DJ:()=>de,ef:()=>me,RL:()=>ce,yL:()=>ue,Rx:()=>pe,Q2:()=>ke,BU:()=>ge,W2:()=>Ne,Cm:()=>ve,C1:()=>Ie,kH:()=>Se,Wo:()=>Te,yJ:()=>fe,CR:()=>he,pZ:()=>ye,LQ:()=>Fe,uh:()=>be});var a=i(725087),t=i(763973),r=i(49960),l=i(942016),o=i(59550),d=i(28654),s=i(802756),m=i(440320),c=i(355552),u=i(947521),p=i(75914),k=i(719156),g=i(336113),N=i(829775),v=i(585730),I=i(355515),S=i(43037),A=i(736629);const T=async(e,n,i,a,t)=>{const{data:r,error:l}=await e.query({query:o.$,variables:i?.isChannelMeeting&&i?.messageId?{id:n,queryType:"QueryByMessage",storageOptions:{messageStorage:{messageId:i.messageId},platformTabsQueryType:"QueryByMessage"},options:a}:{id:n,queryType:"QueryByThread",options:a},fetchPolicy:"network-only"});return l&&t?.error(`(getTabsData) Error fetching tabs: ${l.message}`),r},f=async(e,n,i,t,r,l,o)=>{const d=V(t),s=o?"Personal":d?"Team":"GroupChat",m=d?await h(e,n):void 0,{data:c,error:u}=await e.query({query:a.y,variables:{scope:s,conversationId:d?m:n,appId:i}});return u&&(l?.fail({errors:`Error getting app data for app ${i}: ${u.message}`,"App.Id":i,reason:"AppDefinitionError"}),r?.error(`(getAppData) Error getting app data for app ${i}: ${u.message}`)),c&&c.appDefinition||(l?.fail({errors:`App definition not found for app ${i}`,"App.Id":i,reason:"AppDefinitionMissing"}),r?.error(`(getAppData) App definition not found for app ${i}`)),c},M=async(e,n,i,t)=>{const{data:r}=await e.query({query:a.y,variables:{scope:t,conversationId:n,appId:i}});return r},h=async(e,n)=>y(e,n),y=async(e,n)=>{if(!n)return;const{conversationId:i}=U(n);if(!i)return;const a=await e.query({query:g.u,variables:{conversationId:i}}),t=a.data?.channelByID.owningTeam?.id;return t||void 0},F=(e,n,i)=>{if(b(n)){if(!i)return{botMri:e,appId:n.id};{const a=n.definition?.staticTabs?.some((e=>e.entityId===i));if(a)return{botMri:e,appId:n.id,tabEntityId:i}}}},b=e=>!!(e.definition?.galleryTabs?.some((e=>e?.context?.some((e=>e===c._N.MeetingSidePanel))))||e.definition?.galleryTabs?.some((e=>e?.meetingSurfaces?.some((e=>e===c.H$.SidePanel))))||e.definition?.staticTabs?.some((e=>e?.context?.some((e=>e===c.b5.MeetingSidePanel))))),C=async(e,n,i,a)=>{const{data:t,error:r}=await e.query({query:d.F,variables:{tabId:n,threadId:i}});return r&&a?.error(`(getPlatformTab) Error fetching tab: ${r.message}`),t},D=";messageid=",U=e=>{const n=e?.split(";replyChainId=")??[];let i=n[0];const a=n[1];if(i?.includes("channelId")){i=JSON.parse(i).channelId}return i?.includes(D)&&(i=i.split(D)[0]),{conversationId:i,replyChainId:a}},E=e=>{const{replyChainId:n}=U(e);return V(n)?"Team":"GroupChat"},w=async(e,n,i,a,t,r,l,o,d,m,c)=>{const u=[],p=[];if(!e)return u;for(const o of e)if(d&&"StaticExtensionTab"===o.__typename||"ExtensionTab"===o.__typename){const e={tabId:o.baseInfo.id,displayName:decodeURIComponent(o.baseInfo.displayName||""),entityId:o.entityId,tabType:o.__typename,tabPinnedState:o.pinnedState||"UserPinned"},d=await f(n,i,o.baseInfo.appId,r,l,m,c);if((0,N.Fs)(o,d,a,!!t,l)){const n={appId:o.baseInfo.appId,appName:d.appDefinition?.name||"",iconUrl:d.appDefinition?.smallImageUrl||""};e.displayName||(e.displayName=decodeURIComponent(n.appName));const i={tabInfo:e,appInfo:n};u.push(i)}else p.push(o.baseInfo.appId)}return p?.length>0&&(m?.mark(s.BQ.PlatformTabFetchUbarDroppedTabsDueToMeetingContext),l?.log(`convertToTabButtons(${o}) dropped apps: ${p.join(",")}`)),u},L=async(e,n,i,a,t,r,l,o,d,m,c)=>{m?.mark(s.BQ.PlatformTabFetchStart);const u=await T(e,n,t,o,r);r?.log(`getPlatformTabs(${l}): fetched ${u.platformTabs?.length} tabs`),m?.mark(s.BQ.PlatformTabFetchDataComplete);return await w(u.platformTabs,e,n,i,a,t?.messageId,r,l,d,m,c)},x=(e,n)=>{const i=[],a=[];for(const n of e.platformTabsEvent)if("StaticExtensionTab"===n?.__typename||"ExtensionTab"===n?.__typename){const e=n.baseInfo.appId??"",t=n.baseInfo.id??"";i.push(e),a.push(t)}n.log(`tabsEvent appData: ${i.join(",")}`),n.log(`tabsEvent tabData: ${a.join(",")}`)},O=(e,n,i,a,t,r,l,o,d,s)=>{const m=e&&["Scheduled","Recurring"].includes(e)&&(!r||s),c=o&&P(e,n,i),u=l&&(0,N.W_)(n,i,a),p=d&&(0,N.IW)(n,i,a);return t?.log(`isSupportedMeeting: meetingType-${e}, isChannelMeeting- ${r}, isSupportedInPrivateOrChannelMeeting-${m}, \n    callType -${n}, isSupportedInCalendarMeetNow: ${c}, isSupportedInGroupCall: ${u},\n    isSupportedInOneOnOneCall: ${p}: chatSubType - ${i}, isOneOnOne - ${a}`),!!(m||c||u||p)},P=(e,n,i)=>e&&"MeetNow"===e&&n===k.CallType.Conference&&i===p.vW.Meeting,V=e=>!!e&&"0"!==e;function j(e){return V(e)?{platformTabsQueryType:"QueryByMessage",messageStorage:{messageId:e}}:void 0}function B(e){return e?{appInstallScope:"Team"}:{appInstallScope:"GroupChat"}}const z=e=>V(e)?"QueryByMessage":"QueryByThread",R=e=>{switch(e){case t.v.Channel:case t.v.ChannelMeeting:case t.v.ChannelMeetingSchedulingForm:case t.v.SelectAppEntity:return"Team";default:return"GroupChat"}},Q=(e,n)=>n?{appInstallScope:"Personal"}:e?{appInstallScope:"Team",platformTabsEntryPoint:"ChannelMeeting"}:{appInstallScope:"GroupChat",platformTabsEntryPoint:"PrivateMeeting"},W=e=>{switch(e){case u.hB.privateMeetingSchedulingForm:return{appInstallScope:"GroupChat",platformTabsEntryPoint:"PrivateMeetingSchedulingForm"};case u.hB.chatTab:return{appInstallScope:"GroupChat",platformTabsEntryPoint:"GroupChat"};case u.hB.channelMeetingSchedulingForm:return{appInstallScope:"Team",platformTabsEntryPoint:"ChannelMeetingSchedulingForm"};case u.hB.channelTab:return{appInstallScope:"Team",platformTabsEntryPoint:"Channel"};default:return}},Y=e=>{const n=new Error(e.message);return n.name=e.name,n},G=e=>{switch(e){case"GroupChat":return r.bY.group;case"Personal":return r.bY.personal;case"Team":return r.bY.team;default:return}},Z=e=>_({chatId:e?.chatId,teamId:e?.teamId,channelId:e?.channelId}),_=e=>{const{chatId:n,teamId:i,channelId:a}=e||{};return n?"GroupChat":i||a?"Team":"Personal"},H=e=>K(e)||ne(e)?e.baseInfo.id:"",J=e=>K(e)||ne(e)?e.baseInfo.appId:"",q=e=>ne(e)&&e.entityId||"",X=e=>(K(e)||ne(e))&&e.websiteUrl?e.websiteUrl:null,K=e=>"WebsiteTab"===e?.__typename,$=e=>"FileViewTab"===e?.__typename,ee=e=>e===A.YT,ne=e=>"ExtensionTab"===e?.__typename||ie(e),ie=e=>"StaticExtensionTab"===e?.__typename,ae=e=>"StaticExtensionTab"===e,te=e=>"PlaceholderTab"===e?.__typename,re=e=>!!ie(e)&&e.baseInfo?.context?.includes(c.b5.TeamLevelApp),le=(e,n)=>e?.linkedEntity?.type===l.ck.extensions&&!n,oe=(e,n,i,a,t)=>({threadId:e,tab:{id:n,displayName:"",tabType:"StaticExtensionTab",appInstallScope:i,externalId:t},storageOptions:j(a)}),de=(e,n,i)=>{if(e)return se(e.id,e.isMeeting,e.isOneOnOne,e.isOneOnOneBotChat,n,i)},se=(e,n,i,a,t,r)=>{if(e)return n?m.bF.Meeting:i?a?m.bF.Botchat:m.bF.OneOnOneChat:t||"channelTab"===r?m.bF.Channel:m.bF.GroupChat},me=[A.lb,A.t2,A.P3,A.YT,A.QA],ce=(e,n,i,a,t,r,l,o)=>{if(me.includes(n))return;const d=(0,I.Mr)(n),m=(0,v.A)(),c=n=>{const o=e.findScenario(n);o&&(o.cancel({errors:"NewScenarioStarting"}),e.clearScenario(o));const s=e.newScenario(n,{clientId:`${n};${m}`});e.hoistScenarioToCore&&e.hoistScenarioToCore(s),s.appendEventData({"App.Id":d,"App.EntryPoint":l?`${i}DefaultLaunch`:i,"PlatformApp.IsMultiWindow":!!t,"PlatformApp.IsDefaultCommand":!!l,"PlatformApp.FromOpenFileInTeams":!!r}),a.log(`phase 1 scenario marker started for entryPoint ${i}`)};!o&&c(s.Cu.PlatformTabFrameLoading),c(s.Cu.PlatformTabLaunch)},ue=(e,n,i)=>{(a=>{e.findScenario(a)?.cancel();const t=(0,v.A)();e.newScenario(a,{clientId:t}).appendEventData({"App.EntryPoint":n}),i?.log(`fetch platform tabs - scenario marker started for entryPoint ${n}`)})(s.Cu.PlatformTabFetchData)},pe=(e,n)=>{switch(e){case t.v.Meeting:case t.v.ChannelMeeting:return c.b5.MeetingSidePanel;case t.v.PrivateMeetingSchedulingForm:case t.v.ChannelMeetingSchedulingForm:return c.b5.MeetingDetailsTab;case t.v.Channel:return c.b5.ChannelTab;case t.v.Chat:return n&&Me(n)?c.b5.MeetingChatTab:c.b5.PrivateChatTab;case t.v.MeetingChat:return c.b5.MeetingChatTab;default:return c.b5.Unknown}},ke=e=>{switch(e){case t.v.Chat:return u.hB.chatTab;case t.v.Channel:return u.hB.channelTab;case t.v.PrivateMeetingSchedulingForm:return u.hB.privateMeetingSchedulingForm;case t.v.ChannelMeetingSchedulingForm:return u.hB.channelMeetingSchedulingForm;default:return u.hB.platformAppView}},ge=(e,n)=>"Desktop"===e&&!1===n,Ne=e=>{switch(e){case r.bY.group:return"GroupChat";case r.bY.personal:return"Personal";case r.bY.team:return"Team";default:return}},ve=(e,n,i)=>({threadId:e.threadId,messageId:e.messageId||i?.messageId,appId:n.appId||e.appId,tabId:e.tabId||n.tabId,tabEntityId:n.tabEntityId||e.tabEntityId}),Ie=(e,n)=>n.find((n=>"StaticExtensionTab"===n.__typename&&n?.baseInfo?.appId===e)),Se=(e,n,i)=>Boolean(e&&e.length>0&&e.filter((e=>Ae(e,n)&&-1!==e.scopes?.indexOf(i))).length>0),Ae=(e,n)=>{const i=e?.context;return i&&0!==i.length?-1!==i.indexOf(n):-1!==A.TU.indexOf(n)},Te=(e,n,i)=>{let a;if(n)try{a=e.id&&JSON.parse(e.id)}catch(n){i.error(`entity id ${e.id} json parsing failed`)}else{const n=e.id&&decodeURIComponent(e.id);a=n&&JSON.parse(n)}return a},fe=(e,n,i)=>i?.entryPoint===u.hB.botChat||!(e&&n||i?.chatId),Me=e=>!!e&&e.includes("meeting"),he=(e,n)=>(n&&e===u.E2.content)??!1,ye=e=>"WebsiteTab"===e?.platformTab?.__typename&&e?.platformTab?.websiteUrl||"",Fe=(e,n,i)=>e&&(n||(0,S.Fz)(i)),be=e=>e===A.dy},57912:(e,n,i)=>{"use strict";i.d(n,{i:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"baseInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BaseTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"externalAppId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"dateAdded"}},{kind:"Field",name:{kind:"Name",value:"order"}},{kind:"Field",name:{kind:"Name",value:"replyChainId"}},{kind:"Field",name:{kind:"Name",value:"displayNameLocalizationKey"}},{kind:"Field",name:{kind:"Name",value:"teamInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"teamSiteDomain"}},{kind:"Field",name:{kind:"Name",value:"teamSitePath"}},{kind:"Field",name:{kind:"Name",value:"teamSiteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"channelInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"channelRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"channelType"}}]}},{kind:"Field",name:{kind:"Name",value:"tabPermission"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canUpdateConfig"}},{kind:"Field",name:{kind:"Name",value:"canHaveTabConversation"}},{kind:"Field",name:{kind:"Name",value:"definedDevicePermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"isPredefinedTab"}}]}}]}},969352:(e,n,i)=>{"use strict";i.d(n,{V:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesCalendarTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CalendarTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...i(57912).i.definitions]}},471685:(e,n,i)=>{"use strict";i.d(n,{o:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesPlaceholderTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PlaceholderTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...i(57912).i.definitions]}},577878:(e,n,i)=>{"use strict";i.d(n,{H:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"legacyDocumentLibraryTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LegacyDocumentLibraryTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"libraryId"}},{kind:"Field",name:{kind:"Name",value:"libraryServerRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"selectedSiteImageUrl"}},{kind:"Field",name:{kind:"Name",value:"selectedDocumentLibraryTitle"}},{kind:"Field",name:{kind:"Name",value:"selectedSiteTitle"}}]}},...i(57912).i.definitions]}},383998:(e,n,i)=>{"use strict";i.d(n,{r:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"extensionTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"removeUrl"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"isPlaceholderTab"}}]}},...i(57912).i.definitions]}},164641:(e,n,i)=>{"use strict";i.d(n,{N:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"fileViewTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FileViewTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serviceName"}},{kind:"Field",name:{kind:"Name",value:"providerMetadata"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}}]}},...i(57912).i.definitions]}},8919:(e,n,i)=>{"use strict";i.d(n,{H:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"legacyWikiTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LegacyWikiTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"wikiTabId"}},{kind:"Field",name:{kind:"Name",value:"wikiDefaultTab"}},{kind:"Field",name:{kind:"Name",value:"hasContent"}},{kind:"Field",name:{kind:"Name",value:"scenarioName"}},{kind:"Field",name:{kind:"Name",value:"isMyWiki"}},{kind:"Field",name:{kind:"Name",value:"isPrivateMeetingWiki"}},{kind:"Field",name:{kind:"Name",value:"meetingNotes"}},{kind:"Field",name:{kind:"Name",value:"hasMigratedToOneNote"}}]}},...i(57912).i.definitions]}},137401:(e,n,i)=>{"use strict";i.d(n,{i:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"oneNoteTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OneNoteTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"oneNoteId"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"sectionUrl"}},{kind:"Field",name:{kind:"Name",value:"notebookId"}},{kind:"Field",name:{kind:"Name",value:"notebookLocation"}},{kind:"Field",name:{kind:"Name",value:"service"}},{kind:"Field",name:{kind:"Name",value:"subtype"}}]}},...i(57912).i.definitions]}},528836:(e,n,i)=>{"use strict";i.d(n,{F:()=>I});var a=i(190374),t=i(57912);const r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"extensionTabInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}}]}},...t.i.definitions]};var l=i(867922);const o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"basicTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BasicTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}},{kind:"Field",name:{kind:"Name",value:"displayNameLocalizationKey"}}]}}]}},...t.i.definitions]};var d=i(633097),s=i(164641),m=i(740456),c=i(137401),u=i(8919),p=i(577878),k=i(471685),g=i(969352);const N={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesDocumentLibraryTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DocumentLibraryTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...t.i.definitions]},v={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesWikiTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WikiTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...t.i.definitions]},I={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"platformTabInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PlatformTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTabInfo"}},{kind:"FragmentSpread",name:{kind:"Name",value:"extensionTabInfo"}},{kind:"FragmentSpread",name:{kind:"Name",value:"websiteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"basicTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"fileViewTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"powerBiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"oneNoteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyWikiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyDocumentLibraryTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesPlaceholderTabFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesCalendarTabFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesDocumentLibraryTabFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesWikiTabFragment"}}]}},...a.V.definitions,...r.definitions,...l.F.definitions,...o.definitions,...d.L.definitions,...s.N.definitions,...m.i.definitions,...c.i.definitions,...u.H.definitions,...p.H.definitions,...k.o.definitions,...g.V.definitions,...N.definitions,...v.definitions]}},740456:(e,n,i)=>{"use strict";i.d(n,{i:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"powerBiTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PowerBiTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"originatingTeam"}},{kind:"Field",name:{kind:"Name",value:"originatingTeamId"}},{kind:"Field",name:{kind:"Name",value:"reports"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}}]}},...i(57912).i.definitions]}},633097:(e,n,i)=>{"use strict";i.d(n,{L:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"staticExtensionTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StaticExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"pinnedState"}}]}},...i(57912).i.definitions]}},190374:(e,n,i)=>{"use strict";i.d(n,{V:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"staticExtensionTabInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StaticExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"pinnedState"}}]}},...i(57912).i.definitions]}},867922:(e,n,i)=>{"use strict";i.d(n,{F:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"websiteTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WebsiteTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}}]}},...i(57912).i.definitions]}},28654:(e,n,i)=>{"use strict";i.d(n,{F:()=>k});var a=i(633097),t=i(383998),r=i(867922),l=i(190374),o=i(164641),d=i(740456),s=i(137401),m=i(8919),c=i(577878),u=i(471685),p=i(969352);const k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Tab"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"tabId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"threadId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"PlatformTabsStorage"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"TabOptionInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"platformTab"},arguments:[{kind:"Argument",name:{kind:"Name",value:"tabId"},value:{kind:"Variable",name:{kind:"Name",value:"tabId"}}},{kind:"Argument",name:{kind:"Name",value:"threadId"},value:{kind:"Variable",name:{kind:"Name",value:"threadId"}}},{kind:"Argument",name:{kind:"Name",value:"storageOptions"},value:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"extensionTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"websiteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTabInfo"}},{kind:"FragmentSpread",name:{kind:"Name",value:"fileViewTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"powerBiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"oneNoteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyWikiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyDocumentLibraryTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesPlaceholderTabFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesCalendarTabFragment"}}]}}]}},...a.L.definitions,...t.r.definitions,...r.F.definitions,...l.V.definitions,...o.N.definitions,...d.i.definitions,...s.i.definitions,...m.H.definitions,...c.H.definitions,...u.o.definitions,...p.V.definitions]}},59550:(e,n,i)=>{"use strict";i.d(n,{$:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"PlatformTabsInfo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"queryType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PlatformTabsQueryType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"PlatformTabsStorage"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"TabOptionInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"platformTabs"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"platformTabsQueryType"},value:{kind:"Variable",name:{kind:"Name",value:"queryType"}}},{kind:"Argument",name:{kind:"Name",value:"storageOptions"},value:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"platformTabInfo"}}]}}]}},...i(528836).F.definitions]}},191596:(e,n,i)=>{"use strict";i.d(n,{C:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ComponentsPresenceSubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PresenceSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"presenceUpdateEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userPresenceData"}},{kind:"Field",name:{kind:"Name",value:"isBlocked"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}}]}}]}},...i(217098).x.definitions]}},660060:(e,n,i)=>{"use strict";var a,t;i.d(n,{cw:()=>a,f0:()=>t,$3:()=>r}),function(e){e[e.IS_GREATER_THAN_0=1]="IS_GREATER_THAN_0",e[e.IS_AT_LEAST_240=240]="IS_AT_LEAST_240",e[e.IS_AT_LEAST_290=290]="IS_AT_LEAST_290",e[e.IS_AT_LEAST_320=320]="IS_AT_LEAST_320",e[e.IS_AT_LEAST_360=360]="IS_AT_LEAST_360",e[e.IS_AT_LEAST_375=375]="IS_AT_LEAST_375",e[e.IS_AT_LEAST_414=414]="IS_AT_LEAST_414",e[e.IS_AT_LEAST_480=480]="IS_AT_LEAST_480",e[e.IS_AT_LEAST_640=640]="IS_AT_LEAST_640",e[e.IS_AT_LEAST_720=720]="IS_AT_LEAST_720",e[e.IS_AT_LEAST_768=768]="IS_AT_LEAST_768",e[e.IS_AT_LEAST_834=834]="IS_AT_LEAST_834",e[e.IS_AT_LEAST_947=947]="IS_AT_LEAST_947",e[e.IS_AT_LEAST_1000=1e3]="IS_AT_LEAST_1000",e[e.IS_AT_LEAST_1024=1024]="IS_AT_LEAST_1024",e[e.IS_AT_LEAST_1280=1280]="IS_AT_LEAST_1280",e[e.IS_AT_LEAST_1350=1350]="IS_AT_LEAST_1350",e[e.IS_AT_LEAST_1440=1440]="IS_AT_LEAST_1440",e[e.IS_AT_LEAST_1500=1500]="IS_AT_LEAST_1500",e[e.IS_AT_LEAST_1680=1680]="IS_AT_LEAST_1680",e[e.IS_AT_LEAST_1920=1920]="IS_AT_LEAST_1920",e[e.IS_AT_LEAST_2048=2048]="IS_AT_LEAST_2048",e[e.IS_AT_LEAST_2560=2560]="IS_AT_LEAST_2560",e[e.IS_AT_LEAST_3840=3840]="IS_AT_LEAST_3840"}(a||(a={})),function(e){e[e.IS_GREATER_THAN_0=1]="IS_GREATER_THAN_0",e[e.IS_AT_LEAST_320=320]="IS_AT_LEAST_320",e[e.IS_AT_LEAST_480=480]="IS_AT_LEAST_480",e[e.IS_AT_LEAST_568=568]="IS_AT_LEAST_568",e[e.IS_AT_LEAST_667=667]="IS_AT_LEAST_667",e[e.IS_AT_LEAST_768=768]="IS_AT_LEAST_768",e[e.IS_AT_LEAST_1024=1024]="IS_AT_LEAST_1024",e[e.IS_AT_LEAST_1280=1280]="IS_AT_LEAST_1280",e[e.IS_AT_LEAST_1366=1366]="IS_AT_LEAST_1366",e[e.IS_AT_LEAST_1440=1440]="IS_AT_LEAST_1440",e[e.IS_AT_LEAST_1500=1500]="IS_AT_LEAST_1500",e[e.IS_AT_LEAST_1680=1680]="IS_AT_LEAST_1680",e[e.IS_AT_LEAST_1920=1920]="IS_AT_LEAST_1920",e[e.IS_AT_LEAST_2160=2160]="IS_AT_LEAST_2160",e[e.IS_AT_LEAST_4320=4320]="IS_AT_LEAST_4320"}(t||(t={}));const r=(e,n={})=>{const{isMinWidthBreakpointAtLeast360:i,isMinWidthBreakpointAtLeast480:a,isMinWidthBreakpointAtLeast720:t,isMinWidthBreakpointAtLeast768:r}=e,{offsetForMinWidthBreakpointIsGreaterThan0:l,offsetForMinWidthBreakpointAtLeast360:o,offsetForMinWidthBreakpointAtLeast480:d,offsetForMinWidthBreakpointAtLeast720:s,offsetForMinWidthBreakpointAtLeast768:m}=n,c=(({isMinWidthBreakpointAtLeast240:e,isMinWidthBreakpointAtLeast290:n,isMinWidthBreakpointAtLeast320:i,isMinWidthBreakpointAtLeast360:a,isMinWidthBreakpointAtLeast375:t,isMinWidthBreakpointAtLeast414:r,isMinWidthBreakpointAtLeast480:l,isMinWidthBreakpointAtLeast640:o,isMinWidthBreakpointAtLeast720:d,isMinWidthBreakpointAtLeast768:s,isMinWidthBreakpointAtLeast834:m,isMinWidthBreakpointAtLeast947:c,isMinWidthBreakpointAtLeast1000:u,isMinWidthBreakpointAtLeast1024:p,isMinWidthBreakpointAtLeast1280:k,isMinWidthBreakpointAtLeast1350:g,isMinWidthBreakpointAtLeast1440:N,isMinWidthBreakpointAtLeast1500:v,isMinWidthBreakpointAtLeast1680:I,isMinWidthBreakpointAtLeast1920:S,isMinWidthBreakpointAtLeast2048:A,isMinWidthBreakpointAtLeast2560:T,isMinWidthBreakpointAtLeast3840:f})=>f?3840:T?2560:A?2048:S?1920:I?1680:v?1500:N?1440:g?1350:k?1280:p?1024:u?1e3:c?947:m?834:s?768:d?720:o?640:l?480:r?414:t?375:a?360:i?320:n?290:e?240:239)(e);let u=l??0;r&&"number"==typeof m?u=m:t&&"number"==typeof s?u=s:a&&"number"==typeof d?u=d:i&&"number"==typeof o&&(u=o);const p=(c-u)/10+"rem";return{"--width":p,width:[p,"var(--width)"]}}},7800:(e,n,i)=>{"use strict";i.d(n,{PY:()=>l,eo:()=>o,Lg:()=>d,pM:()=>s,A7:()=>m,ok:()=>c});var a=i(660060),t=i(364819);const r=({dimension:e,MinDimensionBreakpoint:n})=>{let i=n.IS_GREATER_THAN_0;for(const a in n)if(!isNaN(Number(n[a]))){const r=Number(n[a]);if(!((0,t.round)(e)>=r))break;i=r}return i},l=({height:e,width:n,host:i,setWidthCallback:t})=>{const{self:{innerHeight:l,innerWidth:o}}=i;t?.(n);return{minHeightBreakpoint:r({dimension:e,MinDimensionBreakpoint:a.f0}),minWidthBreakpoint:r({dimension:n,MinDimensionBreakpoint:a.cw}),minHeightViewportBreakpoint:r({dimension:l,MinDimensionBreakpoint:a.f0}),minWidthViewportBreakpoint:r({dimension:o,MinDimensionBreakpoint:a.cw})}},o=({minHeightBreakpoint:e,minWidthBreakpoint:n,minHeightViewportBreakpoint:i,minWidthViewportBreakpoint:t}={minHeightBreakpoint:a.f0.IS_GREATER_THAN_0,minWidthBreakpoint:a.cw.IS_GREATER_THAN_0,minHeightViewportBreakpoint:a.f0.IS_GREATER_THAN_0,minWidthViewportBreakpoint:a.cw.IS_GREATER_THAN_0})=>({...u({minHeightBreakpoint:e,minHeightViewportBreakpoint:i}),...g({minWidthBreakpoint:n,minWidthViewportBreakpoint:t})}),d=({minHeightBreakpoint:e}={minHeightBreakpoint:a.f0.IS_GREATER_THAN_0})=>({...p({minHeightBreakpoint:e})}),s=({minHeightViewportBreakpoint:e}={minHeightViewportBreakpoint:a.f0.IS_GREATER_THAN_0})=>({...k({minHeightViewportBreakpoint:e})}),m=({minWidthBreakpoint:e}={minWidthBreakpoint:a.cw.IS_GREATER_THAN_0})=>({...N({minWidthBreakpoint:e})}),c=({minWidthViewportBreakpoint:e}={minWidthViewportBreakpoint:a.cw.IS_GREATER_THAN_0})=>({...v({minWidthViewportBreakpoint:e})}),u=({minHeightBreakpoint:e,minHeightViewportBreakpoint:n})=>({...p({minHeightBreakpoint:e}),...k({minHeightViewportBreakpoint:n})}),p=({minHeightBreakpoint:e})=>({isMinHeightBreakpointAtLeast320:e>=a.f0.IS_AT_LEAST_320,isMinHeightBreakpointAtLeast480:e>=a.f0.IS_AT_LEAST_480,isMinHeightBreakpointAtLeast568:e>=a.f0.IS_AT_LEAST_568,isMinHeightBreakpointAtLeast667:e>=a.f0.IS_AT_LEAST_667,isMinHeightBreakpointAtLeast768:e>=a.f0.IS_AT_LEAST_768,isMinHeightBreakpointAtLeast1024:e>=a.f0.IS_AT_LEAST_1024,isMinHeightBreakpointAtLeast1280:e>=a.f0.IS_AT_LEAST_1280,isMinHeightBreakpointAtLeast1366:e>=a.f0.IS_AT_LEAST_1366,isMinHeightBreakpointAtLeast1440:e>=a.f0.IS_AT_LEAST_1440,isMinHeightBreakpointAtLeast1500:e>=a.f0.IS_AT_LEAST_1500,isMinHeightBreakpointAtLeast1680:e>=a.f0.IS_AT_LEAST_1680,isMinHeightBreakpointAtLeast1920:e>=a.f0.IS_AT_LEAST_1920,isMinHeightBreakpointAtLeast2160:e>=a.f0.IS_AT_LEAST_2160,isMinHeightBreakpointAtLeast4320:e>=a.f0.IS_AT_LEAST_4320}),k=({minHeightViewportBreakpoint:e})=>({isMinHeightViewportBreakpointAtLeast320:e>=a.f0.IS_AT_LEAST_320,isMinHeightViewportBreakpointAtLeast480:e>=a.f0.IS_AT_LEAST_480,isMinHeightViewportBreakpointAtLeast568:e>=a.f0.IS_AT_LEAST_568,isMinHeightViewportBreakpointAtLeast667:e>=a.f0.IS_AT_LEAST_667,isMinHeightViewportBreakpointAtLeast768:e>=a.f0.IS_AT_LEAST_768,isMinHeightViewportBreakpointAtLeast1024:e>=a.f0.IS_AT_LEAST_1024,isMinHeightViewportBreakpointAtLeast1280:e>=a.f0.IS_AT_LEAST_1280,isMinHeightViewportBreakpointAtLeast1366:e>=a.f0.IS_AT_LEAST_1366,isMinHeightViewportBreakpointAtLeast1440:e>=a.f0.IS_AT_LEAST_1440,isMinHeightViewportBreakpointAtLeast1500:e>=a.f0.IS_AT_LEAST_1500,isMinHeightViewportBreakpointAtLeast1680:e>=a.f0.IS_AT_LEAST_1680,isMinHeightViewportBreakpointAtLeast1920:e>=a.f0.IS_AT_LEAST_1920,isMinHeightViewportBreakpointAtLeast2160:e>=a.f0.IS_AT_LEAST_2160,isMinHeightViewportBreakpointAtLeast4320:e>=a.f0.IS_AT_LEAST_4320}),g=({minWidthBreakpoint:e,minWidthViewportBreakpoint:n})=>({...N({minWidthBreakpoint:e}),...v({minWidthViewportBreakpoint:n})}),N=({minWidthBreakpoint:e})=>({isMinWidthBreakpointAtLeast240:e>=a.cw.IS_AT_LEAST_240,isMinWidthBreakpointAtLeast290:e>=a.cw.IS_AT_LEAST_290,isMinWidthBreakpointAtLeast320:e>=a.cw.IS_AT_LEAST_320,isMinWidthBreakpointAtLeast360:e>=a.cw.IS_AT_LEAST_360,isMinWidthBreakpointAtLeast375:e>=a.cw.IS_AT_LEAST_375,isMinWidthBreakpointAtLeast414:e>=a.cw.IS_AT_LEAST_414,isMinWidthBreakpointAtLeast480:e>=a.cw.IS_AT_LEAST_480,isMinWidthBreakpointAtLeast640:e>=a.cw.IS_AT_LEAST_640,isMinWidthBreakpointAtLeast720:e>=a.cw.IS_AT_LEAST_720,isMinWidthBreakpointAtLeast768:e>=a.cw.IS_AT_LEAST_768,isMinWidthBreakpointAtLeast834:e>=a.cw.IS_AT_LEAST_834,isMinWidthBreakpointAtLeast947:e>=a.cw.IS_AT_LEAST_947,isMinWidthBreakpointAtLeast1000:e>=a.cw.IS_AT_LEAST_1000,isMinWidthBreakpointAtLeast1024:e>=a.cw.IS_AT_LEAST_1024,isMinWidthBreakpointAtLeast1280:e>=a.cw.IS_AT_LEAST_1280,isMinWidthBreakpointAtLeast1350:e>=a.cw.IS_AT_LEAST_1350,isMinWidthBreakpointAtLeast1440:e>=a.cw.IS_AT_LEAST_1440,isMinWidthBreakpointAtLeast1500:e>=a.cw.IS_AT_LEAST_1500,isMinWidthBreakpointAtLeast1680:e>=a.cw.IS_AT_LEAST_1680,isMinWidthBreakpointAtLeast1920:e>=a.cw.IS_AT_LEAST_1920,isMinWidthBreakpointAtLeast2048:e>=a.cw.IS_AT_LEAST_2048,isMinWidthBreakpointAtLeast2560:e>=a.cw.IS_AT_LEAST_2560,isMinWidthBreakpointAtLeast3840:e>=a.cw.IS_AT_LEAST_3840}),v=({minWidthViewportBreakpoint:e})=>({isMinWidthViewportBreakpointAtLeast240:e>=a.cw.IS_AT_LEAST_240,isMinWidthViewportBreakpointAtLeast290:e>=a.cw.IS_AT_LEAST_290,isMinWidthViewportBreakpointAtLeast320:e>=a.cw.IS_AT_LEAST_320,isMinWidthViewportBreakpointAtLeast360:e>=a.cw.IS_AT_LEAST_360,isMinWidthViewportBreakpointAtLeast375:e>=a.cw.IS_AT_LEAST_375,isMinWidthViewportBreakpointAtLeast414:e>=a.cw.IS_AT_LEAST_414,isMinWidthViewportBreakpointAtLeast480:e>=a.cw.IS_AT_LEAST_480,isMinWidthViewportBreakpointAtLeast640:e>=a.cw.IS_AT_LEAST_640,isMinWidthViewportBreakpointAtLeast720:e>=a.cw.IS_AT_LEAST_720,isMinWidthViewportBreakpointAtLeast768:e>=a.cw.IS_AT_LEAST_768,isMinWidthViewportBreakpointAtLeast834:e>=a.cw.IS_AT_LEAST_834,isMinWidthViewportBreakpointAtLeast947:e>=a.cw.IS_AT_LEAST_947,isMinWidthViewportBreakpointAtLeast1000:e>=a.cw.IS_AT_LEAST_1000,isMinWidthViewportBreakpointAtLeast1024:e>=a.cw.IS_AT_LEAST_1024,isMinWidthViewportBreakpointAtLeast1280:e>=a.cw.IS_AT_LEAST_1280,isMinWidthViewportBreakpointAtLeast1350:e>=a.cw.IS_AT_LEAST_1350,isMinWidthViewportBreakpointAtLeast1440:e>=a.cw.IS_AT_LEAST_1440,isMinWidthViewportBreakpointAtLeast1500:e>=a.cw.IS_AT_LEAST_1500,isMinWidthViewportBreakpointAtLeast1680:e>=a.cw.IS_AT_LEAST_1680,isMinWidthViewportBreakpointAtLeast1920:e>=a.cw.IS_AT_LEAST_1920,isMinWidthViewportBreakpointAtLeast2048:e>=a.cw.IS_AT_LEAST_2048,isMinWidthViewportBreakpointAtLeast2560:e>=a.cw.IS_AT_LEAST_2560})},533622:(e,n,i)=>{"use strict";i.d(n,{l:()=>r});var a=i(364819),t=i(513432);const r=(e,n,i)=>{const r=(0,t.useCallback)((0,a.debounce)(e,n,i),[e,n,i]);return(0,t.useEffect)((()=>r.cancel),[r]),r}},72168:(e,n,i)=>{"use strict";i.d(n,{s:()=>o});var a=i(513432),t=i(691457),r=i(539299),l=i(50467);const o=(e,n,i=!1,r="Url",o="",s=!1,m=!0,c)=>{const u=a.useCallback(((n,i,a,r,l)=>(0,t.z)(e,n,i,a,r,l)),[e]);return d(l.ur,u,n,i,r,o,s,m,c)},d=(e,n,i,t=!1,l="Url",o="",d=!1,s=!0,m)=>{const c=a.useRef(!1),{host:u,amsImageCache:p,user:k}=e(),g=a.useRef(),N=a.useRef(d&&k?.id&&p?.has(i,k.id)),[v,I]=a.useState((()=>{const e=N.current&&k?.id?p?.get(i,k.id):void 0;return{result:e,loading:!e,error:void 0}})),S=a.useCallback((e=>c.current&&I(e)),[]),A=a.useCallback((()=>{(async()=>{if(""!==i&&!(0,r.nA)(i,u.location.origin)){let e=await n(i,l,t,o,m);if(g.current&&"Url"===l&&URL.revokeObjectURL(g.current),k?.id&&d&&p?.has(i,k.id)){const n=e.result?.blob,a=p?.get(i,k.id),t=n&&a?.blob&&n!==a.blob;e.result&&s&&t&&URL.revokeObjectURL(n),e={result:a,loading:!1},N.current=!0}else e.result&&k?.id&&!e?.error&&d&&"Url"===l&&(N.current=p?.add(i,k.id,e.result));g.current=e?.result?.blob??void 0,S(e)}})()}),[n,p,t,l,u.location.origin,o,d,s,S,i,k?.id,m]);return a.useEffect((()=>{c.current=!0,N.current=d&&k?.id&&p?.has(i,k.id),N.current||A()}),[A,N,p,d,i,k]),a.useEffect((()=>()=>{c.current=!1,"Url"===l&&g.current&&!N.current&&URL.revokeObjectURL(g.current)}),[A,l,N]),[v,A]}},173061:(e,n,i)=>{"use strict";i.d(n,{BR:()=>m,Us:()=>c,ny:()=>u,JO:()=>p,QG:()=>k,In:()=>g});var a=i(957032),t=i(364819),r=i(513432),l=i(553882),o=i(879462),d=i(188468),s=i(37868);const m=r.createContext({}),c=(m.Consumer,()=>r.useContext(m)),u="Microsoft Teams",p=e=>`${e} | ${u}`;class k extends r.PureComponent{constructor(e){super(e),this.currentTitle="",this.currentName="",this.currentBadgeCount=0,this.applyBadgeCount=e=>{this.currentBadgeCount=e,this.applyTitleToDocument()},this.applyTitle=(e,n)=>{this.currentName=e,this.currentTitle=n,this.applyTitleToDocument()},this.applyTitleToDocument=()=>{if(this.props.document){let e=[this.currentName,this.currentTitle,this.props.mtmaPrefix,u].filter(Boolean).join(" | ");this.currentBadgeCount&&(e=`(${this.currentBadgeCount}) ${e}`),this.props.document.title=e}};const n=new l.t(e.defaultAppTitle||""),i=new l.t(""),a=new l.t(0);this.state={biLogger:e.biLogger,chatServiceSubscriptionFilter:{convId:null},setI18nProviderLocale:()=>{},titleObservable:n,nameObservable:i,badgeObservable:a},this.titleSubscription=n.pipe((0,o.p)((e=>!!e)),(0,d.F)(((e,n)=>this.currentTitle===n))).subscribe({next:()=>{const e=this.state.nameObservable.getValue(),n=this.state.titleObservable.getValue();this.applyTitle(e,n)}}),this.nameSubscription=i.pipe((0,o.p)((e=>!!e)),(0,d.F)(((e,n)=>this.currentName===n))).subscribe({next:()=>{const e=this.state.nameObservable.getValue();this.applyTitle(e,"")}}),this.badgeSubscription=a.pipe((0,d.F)(((e,n)=>this.currentBadgeCount===n))).subscribe({next:()=>{const e=this.state.badgeObservable.getValue();this.applyBadgeCount(e)}})}componentWillUnmount(){this.titleSubscription.unsubscribe(),this.state.titleObservable.complete(),this.nameSubscription.unsubscribe(),this.state.nameObservable.complete(),this.badgeSubscription.unsubscribe(),this.state.badgeObservable.complete()}componentDidMount(){this.props.document&&!this.props.document.title&&(this.props.document.title=u)}render(){return(0,a.Y)(N,{children:this.props.children,value:this.state})}}const g=r.memo((({chatServiceSubscriptionFilter:e,children:n})=>{const i=r.useContext(m),t=r.useMemo((()=>({...i,chatServiceSubscriptionFilter:e})),[e,i]);return(0,a.Y)(N,{children:n,value:t})})),N=r.memo((({children:e,value:n})=>(0,a.Y)(m.Provider,{value:(0,s.F)(n,t.isEqual),children:e})))},675580:(e,n,i)=>{"use strict";i.d(n,{by:()=>ni});var a=i(957032),t=i(513432),r=i(362208),l=i(504820),o=i(659917),d=i(835895),s=i(951860),m=i(947640),c=i(959515),u=i(98313),p=i(795001),k=i(867774),g=i(786255),N=i(49664),v=i(727572),I=i(127066),S=i(332752);const A={isActionButton:!0},T=({isBotSupportCalling:e,startChat:n,startAudioCall:i,startVideoCall:r,isVideoAvailableForConversation:l,videoNotAvailableForConversationReason:o,isAudioAvailableForConversation:d,audioNotAvailableForConversationReason:s})=>{const m=(0,v.PO)(),c=t.useMemo((()=>f(m,o,l,!0)),[m,o,l]),T=t.useMemo((()=>f(m,s,d)),[m,s,d]),{enableBotsCallingSupport:M}=(0,I.w2)(S.w.Extensibility,["enableBotsCallingSupport"]),h=m.stringTranslate("extensibility","app_profile_card_toggleChat_on");return(0,a.Y)(u.s,{hAlign:"start",fill:!0,gap:"gap.small",children:[(0,a.Y)(p.$,{iconOnly:!0,text:!0,icon:(0,a.Y)(k.o,{outline:!0,size:"medium"}),onClick:n,title:h,disabled:!1,variables:A}),M&&e?(0,a.Y)(t.Fragment,{children:[(0,a.Y)(p.$,{iconOnly:!0,text:!0,icon:(0,a.Y)(g.p,{outline:!0,size:"medium"}),onClick:r,title:c,disabled:!l,variables:A}),(0,a.Y)(p.$,{iconOnly:!0,text:!0,icon:(0,a.Y)(N.q,{outline:!0,size:"medium"}),onClick:i,title:T,disabled:!d,variables:A})]}):null]})},f=(e,n,i,a)=>!i&&n?e.stringTranslate("calling",n):e.stringTranslate("messaging",a?"calling_video":"calling_call");var M=i(509336);const h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"videoAvailableForConversationChanged"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"videoAvailableForConversationChangedEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"isAvailable"}},{kind:"Field",name:{kind:"Name",value:"notAvailableReason"}}]}}]}}]};var y=i(675784),F=i(50467),b=i(881360),C=i(440320),D=i(840122),U=i(802756),E=i(173061),w=i(49960);const L=(e,n,i,a,t,r,l)=>({actionGesture:e,actionOutcome:n,actionScenario:i,actionScenarioType:C.DB.appMgmt,moduleName:a,panelRegion:C.rP.popover,panelType:C.HP.AppProfileCardPopover,appName:t,extensibilityData:{id:r,capabilityId:l,scenarioCapability:w.n3.bots}}),x=t.memo((({client:e,appProfile:n,botCallingCapabilities:i})=>{const{entityCommanding:r,scenarioFactory:l}=(0,F.ur)(),o=(0,b.U)(x.name),{startChat:d,startCall:s}=(0,y.wM)(r,e,o),m=(0,E.Us)(),{convId:c}=m.chatServiceSubscriptionFilter,{isBotAudioSupported:u,isBotVideoSupported:p,botAudioNotAvailableForConversationReason:k,botVideoNotAvailableForConversationReason:g}={...B(i)},{recordPanelAction:N}=(0,D.ib)(),v=u||p,I=n.botIdOrAppId,S=t.useCallback((()=>{const e=l.newScenario(U.Cu.AppProfileCardStartChat);N(L(C.Od.click,C.nd.select,C.vB.appProfileCardChat,C.Sn.appProfileCardStartChat,n.appName)),d(I,e)}),[I,n.appName,N,d,l]),A=t.useCallback((()=>{const e=l.newScenario(U.Cu.AppProfileCardStartAudioCall);P(n,!1,N),s(I,!1,e)}),[I,n,s,l,N]),f=t.useCallback((()=>{const e=l.newScenario(U.Cu.AppProfileCardStartVideoCall);P(n,!0,N),s(I,!0,e)}),[I,n,s,l,N]),{videoNotAvailableForConversationReason:M,isVideoAvailableForConversation:h}=V(e,c,p,g,o);return(0,a.Y)(T,{startChat:S,startVideoCall:f,startAudioCall:A,isBotSupportCalling:!!v,videoNotAvailableForConversationReason:M,isVideoAvailableForConversation:h&&!!p,audioNotAvailableForConversationReason:k??null,isAudioAvailableForConversation:!!u})})),O=(0,M.W)(x),P=(e,n,i)=>{i(L(C.Od.click,C.nd.nav,C.vB.appProfileCardCall,n?C.Sn.appProfileCardVideoCall:C.Sn.appProfileCardAudioCall,e.appName))},V=(e,n,i,a="bot_calling_video_not_supported",r)=>{const[l,o]=t.useState(null);t.useEffect((()=>{if(!i)return;const a=e.subscribe({query:h,variables:{conversationId:n}}).subscribe((({data:e,errors:n})=>{n&&r.error("Error on callQuery for video conversation subscription"),o(e)}));return()=>{a.unsubscribe()}}),[e,r,n,i]);const d=l?.videoAvailableForConversationChangedEvent;let s=!1,m="calling_video_disabled";return d&&(s=d.isAvailable,m=s?i?null:a:j(d.notAvailableReason,r)),{isVideoAvailableForConversation:s,videoNotAvailableForConversationReason:m}},j=(e,n)=>{switch(e){case"calling_video_disabled":case"calling_video_disabled_by_admin":case"calling_video_disabled_no_device":case"calling_video_disabled_vdi":case"bot_calling_video_not_supported":case"bot_calling_audio_not_supported":return e;default:return n.warn(`_queryVideoAvailableForConversation: wrong videoDisabledReason received: ${e}`),"calling_video_disabled"}},B=e=>{if(!e)return;const n=!!e?.supportsVideo,i=!!e?.supportsCalling;let a="bot_calling_audio_not_supported",t="bot_calling_video_not_supported";return a=i?null:a,t=n?null:t,{isBotVideoSupported:n,isBotAudioSupported:i,botAudioNotAvailableForConversationReason:a,botVideoNotAvailableForConversationReason:t}};var z=i(786394),R=i(245434),Q=i(460413),W=i(104586),Y=i(965804);const G=(0,Y.O)({isAppProfileCardTextInput:{a9b677:"fly5x3f"}}),Z=({sendMessage:e,appName:n,className:i})=>{const r=(0,v.PO)(),[l,o]=t.useState(""),d=""===l,s=t.useCallback((e=>{const n=e.target.value;o(n)}),[o]),m=t.useCallback((()=>{e(l),o("")}),[l,e]),c=r.stringTranslate("extensibility","app_profile_card_icons_send"),p=r.stringTranslate("extensibility","app_profile_card_quickMessage",{appName:n}),k=G();return(0,a.Y)(u.s,{column:!0,gap:"gap.small",className:i,children:(0,a.Y)(Q.l,{onSubmit:m,children:(0,a.Y)(u.s,{className:k.isAppProfileCardTextInput,gap:"gap.smaller",children:[(0,a.Y)(z.p,{placeholder:p,onChange:s,value:l}),(0,a.Y)(R.$,{icon:(0,a.Y)(W.q,{}),appearance:"transparent",disabled:d,title:c,type:"submit"})]})})})};var _=i(194649),H=i(46377);const J=({client:e,appProfile:n,...i})=>{const{entityCommanding:r,scenarioFactory:l}=(0,F.ur)(),o=(0,b.U)(J.name),{sendMessage:d}=(0,y.wM)(r,e,o),{recordPanelAction:s}=(0,D.ib)(),{appName:m,botIdOrAppId:c,appId:u}=n,p=(0,_.Iz)(c)?c.substring(H.gN.BotPrefix.length):void 0,k=t.useCallback((e=>{const n=l.newScenario(U.Cu.AppProfileCardSendQuickMessage);s(L(C.Od.click,C.nd.submit,C.vB.quickIM,C.Sn.appProfileCardQuickIM,m,u,p)),d(c,e,n)}),[c,m,u,p,s,d,l]);return(0,a.Y)(Z,{sendMessage:k,appName:m,...i})},q=(0,M.W)(J);var X=i(908482),K=i(116011),$=i(302086),ee=i(795631),ne=i(526521),ie=i(408148),ae=i(132305);const te=({children:e})=>(0,a.Y)(t.Fragment,{children:t.Children.map(e,(e=>t.cloneElement(e,{styles:{clipPath:"polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%)"}})))});var re=i(63801),le=i(31698);const oe=({title:e})=>(0,a.Y)(re.n,{state:"success",title:e,variables:{appProfileCardPresenceImage:le.Y.Online}});var de=i(895207),se=i(725797),me=i(942016);const ce=(0,Y.O)({isBotSettingsButton:{a9b677:"f14z66ap",Bqenvij:"f11ysow2",Bf4jedk:"fy77jfu",qb2dma:"f1locze1"},isAppProfileCardPresence:{Be2twd7:"fy9rknc",B6of3ja:"f10kaskc"},isAppProfileShortCardDescription:{Be2twd7:"fy9rknc"},isAppProfileCardTitle:{Be2twd7:"fod5ikn",Bhrd7zp:"flh3ekv"},isAppProfileCardDeveloper:{Be2twd7:"fy9rknc"},isSceneProfileCardDesc:{jrapky:"f1sq5vfh",Be2twd7:"fy9rknc",cr1yyl:"f1r4h3gm"},isContentClamped:{mc9l5x:"f1rvi9lw",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",B6of3ja:"f1hu3pq6",ygn44y:"f1cmbuwj",a9b677:"fly5x3f",Bh9c35c:"fd4kbmi",Fd1uvx:"fpfc2by"},isAppProfileCardDescription:{a9b677:"fqva8l3",Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew"},listStyleBullet:{Bhrd7zp:"flh3ekv",Be2twd7:"f1fjxbv2"},isAppProfileCardPermission:{uwmqm3:["f1pui2vs","f1xqnc6q"]},isAppProfileCard:{a9b677:"ffyt4a4",Bqenvij:"f1l02sjl",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fuvn4gy"},isAppProfileCardImageContainer:{a9b677:"f190kgpo",Bqenvij:"fvi13kb",qhf8xq:"f10pi13n"},isAppProfileCardBasicPermission:{Be2twd7:"fy9rknc",jrapky:"f12kb92q",B6of3ja:"ficmxd5",Bg96gwp:"f7yhwew"},sceneAppProfileCard:{jrapky:"f1c0w631",B6of3ja:"fvrswf7"},isAppProfileCardDetail:{uwmqm3:["f1pui2vs","f1xqnc6q"]},isAppProfileCardActionButton:{z8tnut:"f1tdj2vy",Byoj8tv:"foxqkq2"},flexItemAlign:{qb2dma:"fjgzulp"},flexItemGrow:{Bh6795r:"fqerorx"},flexItemPush:{Frg6f3:["fcgxt0o","f1ujusj6"]},isAppProfileCardLink:{Be2twd7:"f14d40fx",dvvfom:0,w71qe1:0,I8pafv:0,Bkioxbp:0,dwov6y:"ff6ntgw"},isAppProfileCardPermissionFlex:{uwmqm3:["f1pui2vs","f1xqnc6q"]},messageAppDivider:{B6of3ja:"f14f5g9s",jrapky:"f1kd9ml8"}});var ue=i(139150),pe=i(72168),ke=i(836617),ge=i(607002);const Ne=({botName:e,iconUrl:n,description:i,developerName:r,privacyUrl:l,termsOfUseUrl:o,botIdOrAppId:d,isShortProfileCard:s,sceneCount:m,showActionButtons:c,isSceneApp:u,sceneName:p,showRectAppImage:k,botCallingCapabilities:g,appId:N,supportsMeetingStreaming:v,botConfiguration:A,appDef:T})=>{const f=t.useMemo((()=>({botIdOrAppId:d,appName:e,appId:N})),[N,d,e]),{host:M}=(0,F.ur)(),h=(0,de.rO)(),{entity:y}=(0,se.At)(),b=y.type===me.ck.channels?"Team":"GroupChat",C=(0,de.r8)(T,b),D=y.type===me.ck.channels?(e=>e.id&&(e=>{try{JSON.parse(e)}catch(e){return!1}return!0})(e.id)?JSON.parse(e.id).channelId:e.id)(y):y.id,U=t.useCallback((()=>{h(D,b,T,de.uk.ReConfig)}),[T,D,h,b]),{enableFetchAPIForNonAdaptiveCardImages:E}=(0,I.w2)(S.w.Extensibility,["enableFetchAPIForNonAdaptiveCardImages"]),w=(0,ue.m)(),[{result:L}]=(0,pe.s)(w,E&&(0,ke.d$)(n,M.location.origin)||(0,ge.D$)(n)?n:"",!0,"Url",void 0,!0),x=L?.blob??n;return u?(0,a.Y)(Ie,{botName:e,description:i,iconUrl:x,sceneCount:m,sceneName:p,showRectAppImage:k,privacyUrl:l,termsOfUseUrl:o}):(0,a.Y)(ve,{appProfile:f,botName:e,description:i,iconUrl:x,isShortProfileCard:s,developerName:r,showRectAppImage:k,botCallingCapabilities:g,supportsMeetingStreaming:v,privacyUrl:l,termsOfUseUrl:o,showActionButtons:c,botConfiguration:C?A:null,launchBotConfig:U})},ve=({appProfile:e,botName:n,iconUrl:i,description:r,developerName:l,privacyUrl:o,termsOfUseUrl:d,isShortProfileCard:s,showActionButtons:m,showRectAppImage:c,botCallingCapabilities:p,supportsMeetingStreaming:k,botConfiguration:g,launchBotConfig:N})=>{const{enableBotConfiguration:v}=(0,I.w2)(S.w.Extensibility,["enableBotConfiguration"]),A=ce();return(0,a.Y)(K.s,{className:A.isAppProfileCard,children:[(0,a.Y)(u.s,{vAlign:"start",children:(0,a.Y)(Ae,{botName:n,description:r,iconUrl:i,isShortProfileCard:s,developerName:l,showRectAppImage:c})}),(0,a.Y)(u.s,{column:!0,children:[v&&g?(0,a.Y)(R.$,{appearance:"transparent",className:A.isBotSettingsButton,onClick:N,icon:(0,a.Y)(ae.Z,{outline:!0,size:"medium"})}):(0,a.Y)(t.Fragment,{}),(0,a.Y)(Ue,{isShortProfileCard:s,supportsMeetingStreaming:k}),s?null:(0,a.Y)(De,{privacyUrl:o,termsOfUseUrl:d}),m?(0,a.Y)(Me,{appProfile:e,botCallingCapabilities:p}):null]})]})},Ie=({botName:e,description:n,iconUrl:i,sceneCount:t,sceneName:r,showRectAppImage:l,privacyUrl:o,termsOfUseUrl:d})=>{const s=ce();return(0,a.Y)(K.s,{className:s.isAppProfileCard,children:[(0,a.Y)(u.s,{fill:!0,vAlign:"start",children:(0,a.Y)(Se,{botName:e,description:n,iconUrl:i,sceneCount:t,sceneName:r,showRectAppImage:l})}),(0,a.Y)(u.s,{column:!0,children:(0,a.Y)(De,{privacyUrl:o,termsOfUseUrl:d})})]})},Se=({botName:e,description:n,iconUrl:i,sceneCount:r,sceneName:l,showRectAppImage:o})=>{const d=ce();return(0,a.Y)(t.Fragment,{children:[(0,a.Y)(u.s,{fill:!0,column:!0,children:[(0,a.Y)(he,{botName:l}),(0,a.Y)($.D,{size:"small",children:e}),(0,a.Y)(u.s,{gap:"gap.small",vAlign:"center",className:d.sceneAppProfileCard,children:[(0,a.Y)(X.S,{size:"smaller",outline:!0}),(0,a.Y)(Fe,{sceneCount:r})]}),(0,a.Y)(be,{description:n})]}),(0,a.Y)(Te,{iconUrl:i,showRectAppImage:o})]})},Ae=({botName:e,description:n,developerName:i,iconUrl:r,isShortProfileCard:l,showRectAppImage:o})=>{const{presence:d}=we(),s=ce();return(0,a.Y)(t.Fragment,{children:[(0,a.Y)(u.s,{fill:!0,column:!0,className:s.isAppProfileCardDetail,children:[(0,a.Y)(he,{botName:e}),(0,a.Y)(u.s,{column:!0,gap:"gap.small",children:[(0,a.Y)($.D,{className:s.isAppProfileCardPresence,children:d}),(0,a.Y)(Ce,{description:n}),l?(0,a.Y)(he,{botName:e,isShortProfileCard:l}):(0,a.Y)(ye,{developerName:i})]})]}),(0,a.Y)(Te,{iconUrl:r,showRectAppImage:o})]})},Te=({iconUrl:e,showRectAppImage:n})=>{const{appProfileImageBorderRadius:i}=Ee();return n?(0,a.Y)(fe,{iconUrl:e,width:60,height:60,variables:i}):(0,a.Y)(fe,{showStatus:!0,iconUrl:e,width:68,height:60,isHexagon:!0})},fe=({iconUrl:e,showStatus:n,width:i,height:t,isHexagon:r,variables:l})=>{const{presence:o}=we(),s=ce(),m=(0,a.Y)(d.S,{src:e,width:i,height:t,variables:l});return(0,a.Y)(K.s,{className:s.isAppProfileCardImageContainer,children:[r?(0,a.Y)(te,{children:m}):m,n&&(0,a.Y)(oe,{title:o})]})},Me=({appProfile:e,botCallingCapabilities:n})=>{const i=ce();return(0,a.Y)(u.s,{column:!0,children:[(0,a.Y)(u.s,{fill:!0,className:i.isAppProfileCardActionButton,children:(0,a.Y)(O,{appProfile:e,botCallingCapabilities:n})}),(0,a.Y)(ee.c,{className:i.messageAppDivider}),(0,a.Y)(q,{appProfile:e,className:i.flexItemAlign})]})},he=({botName:e,isShortProfileCard:n})=>{const i=ce();return(0,a.Y)($.D,{className:n?i.isAppProfileShortCardDescription:i.isAppProfileCardTitle,children:e})},ye=({developerName:e})=>{const n=(0,v.PO)().translate("extensibility","app_profile_card_developer",{developerName:e}),i=ce();return(0,a.Y)($.D,{className:i.isAppProfileCardDeveloper,children:n})},Fe=({sceneCount:e})=>{const n=(0,v.PO)().stringTranslate("extensibility","app_profile_card_scene_count_mf",{sceneCount:e});return(0,a.Y)($.D,{size:"small",children:n})},be=({description:e})=>{const n=ce();return(0,a.Y)($.D,{className:(0,ne.z)(n.isContentClamped,n.isSceneProfileCardDesc),children:e})},Ce=({description:e})=>{const n=ce();return(0,a.Y)($.D,{className:(0,ne.z)(n.isContentClamped,n.isAppProfileCardDescription),children:e})},De=({privacyUrl:e,termsOfUseUrl:n})=>{const{termsOfUse:i,privacy:t}=we(),r=ce();return(0,a.Y)(u.s,{vAlign:"end",className:r.flexItemGrow,children:[(0,a.Y)(ie.N,{target:"_blank",href:e,className:r.isAppProfileCardLink,children:t}),(0,a.Y)(ie.N,{target:"_blank",href:n,className:(0,ne.z)(r.flexItemPush,r.isAppProfileCardLink),children:i})]})},Ue=({isShortProfileCard:e,supportsMeetingStreaming:n})=>{const i=(0,v.PO)(),t=e?["app_profile_card_imsend","app_profile_card_imreceive"]:["extension_addAppDialogBasicPermission1","extension_addAppDialogBasicPermission2","extension_addAppDialogIdentityPermission1","extensibility_addAppDialogAppCardPermission1","extensibility_addAppDialogAppCardPermission2","extension_addAppDialogIdentityPermission2"];n&&!e&&t.push("extension_addAppDialog_Permission_Meeting_Streaming_Access");const r=[],l=ce();for(let n=0;n<=t.length-1;n++)r.push((0,a.Y)(u.s,{gap:"gap.smaller",children:[e?null:(0,a.Y)($.D,{className:l.listStyleBullet,children:"•"}),(0,a.Y)($.D,{children:i.translate("extensibility",t[n])})]},n));const{whatAppCanDo:o}=we();return(0,a.Y)(K.s,{className:l.isAppProfileCardBasicPermission,children:[(0,a.Y)($.D,{className:e?l.isAppProfileCardPermission:void 0,children:o}),(0,a.Y)(u.s,{column:!0,className:l.isAppProfileCardPermissionFlex,children:r})]})},Ee=()=>{const{vars:e}=(0,r.W)();return{isAppProfileCardBasicPermission:e("extensibility",["isAppProfileCardBasicPermission"]),isAppProfileCardPermission:e("extensibility",["isAppProfileCardPermission"]),isAppProfileCardLink:e("extensibility",["isAppProfileCardLink"]),isAppProfileCardDeveloper:e("extensibility",["isAppProfileCardDeveloper"]),listStyleBullet:e("extensibility",["listStyleBullet"]),isAppProfileCardPresence:e("extensibility",["isAppProfileCardPresence"]),isAppProfileCardTitle:e("extensibility",["isAppProfileCardTitle"]),isAppProfileCardDescription:e("extensibility",["isAppProfileCardDescription"]),isAppProfileCardImageContainer:e("extensibility",["isAppProfileCardImageContainer"]),isAppProfileCard:e("extensibility",["isAppProfileCard"]),isAppProfileCardDetail:e("extensibility",["isAppProfileCardDetail"]),isAppProfileCardActionButton:e("extensibility",["isAppProfileCardActionButton"]),appProfileImageBorderRadius:e("extensibility",["appProfileImageBorderRadius"]),messageAppDivider:e("extensibility",["messageAppDivider"]),isAppProfileShortCardDescription:e("extensibility",["isAppProfileShortCardDescription"]),sceneAppProfileCard:e("extensibility",["sceneAppProfileCard"]),isSceneProfileCardDesc:e("extensibility",["isSceneProfileCardDesc"])}},we=()=>{const e=(0,v.PO)();return{whatAppCanDo:e.translate("extensibility","app_profile_card_basicPermission_what_app_can_do"),privacy:e.translate("extensibility","app_profile_card_privacy"),termsOfUse:e.translate("extensibility","app_profile_card_terms_of_use"),presence:e.stringTranslate("extensibility","app_profile_card_presence")}};var Le=i(132097);var xe=i(331923),Oe=i(346429),Pe=i(371174),Ve=i(660363);const je=(e,n)=>!!n[e]?.length,Be=({appDef:e})=>{const n=je("galleryTabs",e)||(0,Le.vx)("Team",e.staticTabs),i=je("bots",e),t=je("messageExtensions",e),r=je("connectors",e),l=(0,Le.vx)("Personal",e.staticTabs);return(0,a.Y)(K.s,{children:[n&&(0,a.Y)(ze,{titleKey:"app_details_capability_tab",descriptionKey:"app_details_capability_tab_description"}),i&&(0,a.Y)(ze,{titleKey:"app_details_capability_bot",descriptionKey:"app_details_capability_bot_description"}),t&&(0,a.Y)(ze,{titleKey:"app_details_capability_message_extension",descriptionKey:"app_details_capability_message_extension_description"}),r&&(0,a.Y)(ze,{titleKey:"extension_addAppDialogV3_capability_connector_title",descriptionKey:"app_details_capability_connector_description"}),l&&(0,a.Y)(ze,{titleKey:"app_details_capability_personal_app",descriptionKey:"app_details_capability_personal_app_description"})]})},ze=({titleKey:e,descriptionKey:n})=>{const i=(0,v.PO)(),l=t.useMemo((()=>i.translate("extensibility",e)),[i,e]),o=t.useMemo((()=>i.translate("extensibility",n)),[i,n]),{vars:d}=(0,r.W)();return(0,a.Y)(K.s,{children:[(0,a.Y)(Ve.Y,{as:"h4",content:l,variables:d("extensibility",["isActionableAppProfileCardAppFeatureHeader"])}),o]})};var Re=i(533622);const Qe=(0,Y.O)({isBotSettingsButton:{a9b677:"f14z66ap",Bqenvij:"f11ysow2",Bf4jedk:"fy77jfu",qb2dma:"f1locze1"},isActionableAppProfileCardBodySection:{Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew"},isActionableAppProfileCardBodySectionTitle:{Bhrd7zp:"flh3ekv"},isActionableAppProfileCardPermissionsList:{dclx09:"fuxrj8o",B6of3ja:"f1bpxv7w"},isActionableAppProfileCardConsent:{Be2twd7:"f1hn7b42",Bj7y4cg:"f11hph32"},isActionableAppProfileCardLink:{mc9l5x:"f1w7gpdv",sj55zd:"fyind8e",Bceei9c:"f1k6fduh",ha4doy:"f1cdqgvm",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f3bhgqh",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1motb3o",Bf4jedk:"f18p0k4z",Bqenvij:"f11ysow2",Be2twd7:"fjoy568",Bhrd7zp:"ff5ikls",mn2c1h:"fuuohzo",B7m74wb:"f9oa3bk",Ba85zgr:0,Bcsz1n9:0,Bidrcva:0,yit76y:0,Bbybgqa:"fczi8j1",Beapcnx:0,i089h6:0,Bvxx0d4:0,rpb332:0,zxir6n:"fbfeg0j",lj723h:"f1bq4y7d",C4gs1y:0,Bde5pd6:0,o06tbt:0,Frfyj5:0,Fnbkun:"f154bhm6",Jwef8y:"fldu4wg",Bi91k9c:"fpwtdan"},isActionableAppProfileCardBodySectionParagraph:{z8tnut:"fz04i0k"},isActionableAppProfileCardHeaderInfoBanner:{B6of3ja:"fwdhe5f",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fc882fo",De3pzq:"f18f03hv",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"fffov48",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",sj55zd:"f19n0e5",sshi5w:"f4x5sky",Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew"},isActionableAppProfileCardDescription:{a9b677:"fly5x3f",Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",ygn44y:"f1cmbuwj",Bxyxcbc:"f1it27or",Bh9c35c:"f197wrh9"},isActionableAppProfileCardAppButton:{Bf4jedk:"f13bscln",Huce71:"fz5stix",t21cq0:["fvm675v","f1kdaspl"],Bqenvij:"f1sw78cg",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fbnecyg"},isActionableAppProfileCardAppButtonLoader:{t21cq0:["fvm675v","f1kdaspl"]},isActionableAppProfileCardImageContainer:{a9b677:"ffyv3ta",Bqenvij:"fyhdfh7",qhf8xq:"f10pi13n"},isActionableAppProfileCardFooter:{jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f8ofw6e",Eo32re:"f1ter9b9",ekhr2s:"f1jf1ovi"},isActionableAppProfileCardTitle:{Be2twd7:"fkhj508",Bhrd7zp:"flh3ekv",Bg96gwp:"f15qi916"},isActionableAppProfileCardBody:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:["fcj128b","f1ebihv0"],a9b677:"f14z66ap",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1enuhaj",jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:["f4aipn0","f1kihodc"],z9904h:["f32gfn4","f9bbbef"]},isActionableAppProfileCardDivider:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1mk8lai",jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f1q5y2p4"},isActionableAppProfileCardHeader:{jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f1ef08qj"},isActionableAppProfileCardHeaderDescription:{sshi5w:"f1s7fcag",Bxyxcbc:"fivuv6",Frg6f3:["f1e3ula6","f153xw4"],t21cq0:["fbjlher","f1wtvaye"]},isActionableAppProfileCard:{a9b677:"f5m2izs",Bqenvij:"fc4x5ql",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fykg1oz",F9q5ga:"f1bldkcc",Bugp6ci:"fyzbmc5",B60y50i:"f107ynw3",Bjq7wn2:"f4ws2lc"},isActionableAppProfileCardActionButtonsWrapper:{Bow7q3s:"fuvumhg"},isActionableAppProfileCardShort:{a9b677:"f5m2izs",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fykg1oz"},isAppProfileCardPresence:{Be2twd7:"fy9rknc",B6of3ja:"f10kaskc"},isAppProfileShortCardDescription:{Be2twd7:"fy9rknc"},isAppProfileCardTitle:{Be2twd7:"fod5ikn",Bhrd7zp:"flh3ekv"},isAppProfileCardDeveloper:{Be2twd7:"fy9rknc"},isSceneProfileCardDesc:{jrapky:"f1sq5vfh",Be2twd7:"fy9rknc"},isContentClamped:{mc9l5x:"f1rvi9lw",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",B6of3ja:"f1hu3pq6",ygn44y:"f1cmbuwj",a9b677:"fly5x3f",Bh9c35c:"fd4kbmi",Fd1uvx:"fpfc2by"},isAppProfileCardDescription:{a9b677:"fqva8l3",Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew"},listStyleBullet:{Bhrd7zp:"flh3ekv",Be2twd7:"f1fjxbv2"},isAppProfileCardPermission:{uwmqm3:["f1pui2vs","f1xqnc6q"]},isAppProfileCard:{a9b677:"ffyt4a4",Bqenvij:"f1l02sjl",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fuvn4gy"},isAppProfileCardImageContainer:{a9b677:"f190kgpo",Bqenvij:"fvi13kb",qhf8xq:"f10pi13n"},isAppProfileCardBasicPermission:{Be2twd7:"fy9rknc",jrapky:"f12kb92q",B6of3ja:"ficmxd5",Bg96gwp:"f7yhwew"},sceneAppProfileCard:{jrapky:"f1c0w631",B6of3ja:"fvrswf7"},isAppProfileCardDetail:{uwmqm3:["f1pui2vs","f1xqnc6q"]},isAppProfileCardActionButton:{z8tnut:"f1tdj2vy",Byoj8tv:"foxqkq2"},flexItemAlign:{qb2dma:"fjgzulp"},flexItemGrow:{Bh6795r:"fqerorx"},flexItemPush:{B6of3ja:"fgr6219"},isAppProfileCardLink:{Be2twd7:"f14d40fx",dvvfom:0,w71qe1:0,I8pafv:0,Bkioxbp:0,dwov6y:"fctto54"},isAppProfileCardPermissionFlex:{uwmqm3:["f1pui2vs","f1xqnc6q"]},messageAppDivider:{B6of3ja:"f14f5g9s",jrapky:"f1kd9ml8"},isActionableAppProfileCardHeaderButtons:{B6of3ja:"fwdhe5f"},isActionableAppProfileCardHeaderButtonsItem:{a9b677:"f14z66ap"}});var We=i(910316),Ye=i(102761);var Ge;!function(e){e[e.Default=0]="Default",e[e.InfoBanner=1]="InfoBanner"}(Ge||(Ge={}));const Ze=({appDef:e,botName:n,iconUrl:i,description:r,privacyUrl:l,termsOfUseUrl:o,botIdOrAppId:d,sceneCount:s,showActionButtons:m,hideAppButton:c,isSceneApp:u,sceneName:p,showRectAppImage:k,botCallingCapabilities:g,appId:N,supportsMeetingStreaming:v,isInstalled:A,hasPersonalScope:T,botConfiguration:f})=>{const M=t.useMemo((()=>({botIdOrAppId:d,appName:n,appId:N})),[N,d,n]),{host:h}=(0,F.ur)(),y=(0,de.rO)(),{entity:b}=(0,se.At)(),C=b.type===me.ck.channels?"Team":"GroupChat",D=b.type===me.ck.channels?(e=>e.id&&(e=>{try{JSON.parse(e)}catch(e){return!1}return!0})(e.id)?JSON.parse(e.id).channelId:e.id)(b):b.id,U=(0,de.r8)(e,C),E=t.useCallback((()=>{y(D,C,e,de.uk.ReConfig)}),[e,D,y,C]),{enableFetchAPIForNonAdaptiveCardImages:w}=(0,I.w2)(S.w.Extensibility,["enableFetchAPIForNonAdaptiveCardImages"]),L=(0,ue.m)(),[{result:x}]=(0,pe.s)(L,w&&((0,ke.d$)(i,h.location.origin)||(0,ge.D$)(i))?i:"",!0,"Url",void 0,!0),O=x?.blob??i;return u?(0,a.Y)(Ie,{botName:n,description:r,iconUrl:O,sceneCount:s,sceneName:p,showRectAppImage:k,privacyUrl:l,termsOfUseUrl:o}):N?(0,a.Y)(_e,{appDef:e,appProfile:M,description:r,iconUrl:O,showRectAppImage:k,botCallingCapabilities:g,supportsMeetingStreaming:v,privacyUrl:l,termsOfUseUrl:o,showActionButtons:m,hideAppButton:c,isInstalled:A,hasPersonalScope:T,botConfiguration:U?f:null,launchBotConfig:E}):(0,a.Y)(He,{appName:n,iconUrl:O,showRectAppImage:k})},_e=({appDef:e,appProfile:n,iconUrl:i,description:r,privacyUrl:l,termsOfUseUrl:o,showActionButtons:d,hideAppButton:s,showRectAppImage:m,botCallingCapabilities:c,supportsMeetingStreaming:p,isInstalled:k,hasPersonalScope:g,botConfiguration:N,launchBotConfig:v})=>{const{enableBotConfiguration:A}=(0,I.w2)(S.w.Extensibility,["enableBotConfiguration"]),T=Qe(),f=t.useRef(null),M=t.useRef(null),{recordPanelAction:h}=(0,D.ib)(),y=t.useCallback((()=>{if(M.current&&f.current){const{appId:e,appName:i}=n;M.current.scrollTo({top:f.current.offsetTop-M.current.offsetTop,behavior:"smooth"}),h({actionGesture:C.Od.click,actionOutcome:C.nd.scroll,moduleName:C.Sn.appProfileCard,panelRegion:C.rP.popover,panelType:C.HP.AppProfileCardPopover,extensibilityData:{id:e,name:i}})}}),[n,f,M,h]);return(0,a.Y)(u.s,{column:!0,className:T.isActionableAppProfileCard,"data-tid":"actionable-app-profile-card-content",children:[(0,a.Y)(Je,{appProfile:n,botCallingCapabilities:c,description:r,iconUrl:i,showActionButtons:d,hideAppButton:s,showRectAppImage:m,isInstalled:k,hasPersonalScope:g}),A&&N?(0,a.Y)(R.$,{"data-tid":"bot-settings-button",appearance:"transparent",className:T.isBotSettingsButton,onClick:v,icon:(0,a.Y)(ae.Z,{outline:!0,size:"medium"})}):(0,a.Y)(t.Fragment,{}),(0,a.Y)(ee.c,{className:T.isActionableAppProfileCardDivider}),(0,a.Y)(qe,{appDef:e,appProfile:n,bodyRef:M,permissionsRef:f,supportsMeetingStreaming:!!p}),(0,a.Y)(ee.c,{className:T.isActionableAppProfileCardDivider}),(0,a.Y)(Xe,{appProfile:n,showActionButtons:d,onPermissionsClick:y,privacyUrl:l,termsOfUseUrl:o})]})},He=({appName:e,iconUrl:n,showRectAppImage:i})=>{const t=Qe();return(0,a.Y)(u.s,{column:!0,className:t.isActionableAppProfileCardShort,children:[(0,a.Y)(u.s,{className:t.isActionableAppProfileCardHeader,children:[(0,a.Y)(Ke,{iconUrl:n,showRectAppImage:i}),(0,a.Y)(u.s,{column:!0,className:t.isActionableAppProfileCardHeaderDescription,children:(0,a.Y)(nn,{name:e})})]}),(0,a.Y)(ee.c,{className:t.isActionableAppProfileCardDivider}),(0,a.Y)(on,{isShortCard:!0})]})},Je=({appProfile:e,botCallingCapabilities:n,description:i,iconUrl:t,showActionButtons:r,hideAppButton:l,showRectAppImage:o,isInstalled:d,hasPersonalScope:s})=>{const{actionableAppProfileCardType:m}=(0,I.w2)(S.w.Extensibility,["actionableAppProfileCardType"]),c=m===Ge.InfoBanner,p=Qe();return(0,a.Y)(u.s,{column:!0,className:p.isActionableAppProfileCardHeader,children:[(0,a.Y)(u.s,{children:[(0,a.Y)(Ke,{iconUrl:t,showRectAppImage:o}),(0,a.Y)(u.s,{column:!0,className:p.isActionableAppProfileCardHeaderDescription,children:[(0,a.Y)(nn,{name:e.appName}),(0,a.Y)(an,{description:i})]})]}),(0,a.Y)(u.s,{fill:!0,className:p.isActionableAppProfileCardHeaderButtons,children:[s&&!l?(0,a.Y)(en,{appId:e.appId,appName:e.appName,isInstalled:d,isInfoBannerType:c}):null,r?(0,a.Y)(u.s,{className:p.isActionableAppProfileCardActionButtonsWrapper,children:(0,a.Y)(O,{appProfile:e,botCallingCapabilities:n})}):null]}),!c||d||l?null:(0,a.Y)(tn,{})]})},qe=({appDef:e,appProfile:{appId:n,appName:i},bodyRef:t,permissionsRef:r,supportsMeetingStreaming:l})=>{const{recordPanelAction:o}=(0,D.ib)(),d=(0,Re.l)((()=>o({actionGesture:C.Od.scroll,actionOutcome:C.nd.read,moduleName:C.Sn.appProfileCard,panelRegion:C.rP.popover,panelType:C.HP.AppProfileCardPopover,extensibilityData:{id:n,name:i}})),1e3),s=Qe();return(0,a.Y)(u.s,{column:!0,ref:t,className:s.isActionableAppProfileCardBody,onScroll:d,children:[(0,a.Y)(dn,{appDef:e}),(0,a.Y)(ee.c,{className:s.isActionableAppProfileCardDivider}),(0,a.Y)(on,{permissionsRef:r,supportsMeetingStreaming:l,appDef:e})]})},Xe=({appProfile:e,onPermissionsClick:n,privacyUrl:i,showActionButtons:t,termsOfUseUrl:r})=>{const l=Qe();return(0,a.Y)(u.s,{column:!0,className:l.isActionableAppProfileCardFooter,children:[t?(0,a.Y)(q,{appProfile:e}):null,(0,a.Y)(ln,{appName:e.appName,onPermissionsClick:n,privacyUrl:i,termsOfUseUrl:r})]})},Ke=({iconUrl:e,showRectAppImage:n})=>{const{appProfileImageBorderRadius:i}=mn();return n?(0,a.Y)($e,{iconUrl:e,width:80,height:72,variables:i}):(0,a.Y)($e,{iconUrl:e,width:80,height:72,isHexagon:!0})},$e=({iconUrl:e,width:n,height:i,isHexagon:t,variables:r})=>{const l=Qe(),o=(0,a.Y)(d.S,{src:e,width:n,height:i,variables:r}),s={src:e};return(0,a.Y)(K.s,{className:l.isActionableAppProfileCardImageContainer,children:t?(0,a.Y)(c.A,{commonImgAttributes:s,size:72}):o})},en=({appId:e,appName:n,isInstalled:i,isInfoBannerType:r})=>{const{addAppButton:l,addToYourAppsButton:o,openAppButton:d}=cn(),[s,m]=t.useState(!1),[c,u]=t.useState(!1),p=(()=>{const e=(0,ue.m)(),{scenarioFactory:n}=(0,F.ur)(),i=(0,b.U)("useInstallPersonalApp"),{enableAppsQueryOptimization:a}=(0,I.w2)(S.w.Extensibility,["enableAppsQueryOptimization"]);return t.useCallback((t=>(0,Le.Pe)(e,n,U.Cu.AppProfileCardInstallApp,t,"Personal",i,a)),[e,i,n,a])})(),k=(0,xe.S)(),{recordPanelAction:g}=(0,D.ib)(),N=(0,Oe.H)();t.useEffect((()=>(u(!0),()=>u(!1))),[]);const{enablePersonalAppNavigationV2:v}=(0,I.w2)(S.w.Extensibility,["enablePersonalAppNavigationV2"]),A=t.useCallback((()=>{s||void 0===e||(N(e),m(!0),p(e).then((()=>k(e,!!v,!0))).catch((()=>{c&&m(!1)})),g(sn({isAppInstallAction:!0,appId:e,appName:n})))}),[e,n,s,c,v,p,k,N,g]),T=t.useCallback((()=>{void 0!==e&&(N(e),k(e,!!v,!0)),g(sn({appId:e,appName:n}))}),[e,n,v,k,g,N]),f=i?d:r?l:o,M=Qe();return(0,a.Y)(R.$,{disabled:void 0===e,onClick:i?T:A,className:M.isActionableAppProfileCardAppButton,title:f,"data-tid":`app-profile-card-${i?"open":"add"}-app-button`,children:[s&&(0,a.Y)(We.y,{size:"extra-small",className:M.isActionableAppProfileCardAppButtonLoader}),f]})},nn=({name:e})=>{const n=Qe();return(0,a.Y)($.D,{className:n.isActionableAppProfileCardTitle,children:e})},an=({description:e})=>{const n=Qe();return(0,a.Y)($.D,{className:n.isActionableAppProfileCardDescription,children:e})},tn=()=>{const{addAppInfoBanner:e}=cn(),n=Qe();return(0,a.Y)(u.s,{gap:"gap.smaller",className:n.isActionableAppProfileCardHeaderInfoBanner,children:[(0,a.Y)(s.m,{}),(0,a.Y)($.D,{children:e})]})},rn=({developerName:e,developerUrl:n})=>{const i=(0,v.PO)(),r=t.useMemo((()=>i.getTransForNs("extensibility")),[i]),l=Qe();return(0,a.Y)($.D,{className:l.isActionableAppProfileCardBodySectionParagraph,children:(0,a.Y)(r,{i18nKey:"ext_actionable_app_profile_card_app_features_created_by",children:(0,a.Y)(ie.N,{target:"_blank",href:n||"",children:{developerName:e}})})})},ln=({appName:e,onPermissionsClick:n,privacyUrl:i,termsOfUseUrl:r})=>{const l=(0,v.PO)(),o=t.useMemo((()=>l.getTransForNs("extensibility")),[l]),d=t.useCallback((e=>{"Enter"===e.key&&n()}),[n]),{termsOfUse:s,privacyPolicy:m,permissions:c}=cn(),p=Qe();return(0,a.Y)(u.s,{vAlign:"end",gap:"gap.medium",children:(0,a.Y)($.D,{className:p.isActionableAppProfileCardConsent,children:(0,a.Y)(o,{i18nKey:"ext_actionable_app_profile_card_consent",children:[(0,a.Y)($.D,{children:{appName:e}}),(0,a.Y)(ie.N,{target:"_blank",href:i,children:{privacyPolicy:m}}),(0,a.Y)(ie.N,{target:"_blank",href:r,children:{termsOfUse:s}}),(0,a.Y)(R.$,{appearance:"transparent",onClick:n,onKeyPress:d,className:p.isActionableAppProfileCardLink,children:{permissions:c}})]})})})},on=({isShortCard:e,permissionsRef:n,appDef:i})=>{const r=(0,v.PO)(),{isActionableAppProfileCardPermission:l,isActionableAppProfileCardPermissionsList:o}=mn(),d=(0,Pe.z)(i),s=t.useMemo((()=>e?["app_profile_card_imsend","app_profile_card_imreceive"]:i?(0,Ye.H)(i,d,r):[]),[i,r,e,d]),c=t.useMemo((()=>s.map((e=>({key:e,content:r.translate("extensibility",e),variables:l})))),[s,r,l]),{permissionsTitle:p}=cn(),k=Qe();return(0,a.Y)(u.s,{column:!0,ref:n,className:k.isActionableAppProfileCardBodySection,children:[(0,a.Y)($.D,{className:k.isActionableAppProfileCardBodySectionTitle,children:p}),(0,a.Y)(m.B,{variables:o,items:c})]})},dn=({appDef:e})=>{const{appFeaturesTitle:n}=cn(),{developerName:i,developerUrl:t}=e,r=Qe();return(0,a.Y)(u.s,{column:!0,className:r.isActionableAppProfileCardBodySection,children:[(0,a.Y)($.D,{className:r.isActionableAppProfileCardBodySectionTitle,children:n}),(0,a.Y)(Be,{appDef:e}),(0,a.Y)(rn,{developerName:i||"",developerUrl:t||""})]})},sn=({isAppInstallAction:e,appId:n,appName:i})=>({actionGesture:C.Od.click,actionOutcome:C.nd.nav,actionScenario:e?C.vB.appCardAdd:C.vB.appCardOpen,actionScenarioType:C.DB.appCardActions,moduleName:C.Sn.appProfileCard,panelRegion:C.rP.popover,panelType:C.HP.AppProfileCardPopover,extensibilityData:{id:n,name:i}}),mn=()=>{const{vars:e}=(0,r.W)();return t.useMemo((()=>({isActionableAppProfileCardActionButtonsWrapper:e("extensibility",["isActionableAppProfileCardActionButtonsWrapper"]),isActionableAppProfileCardAppButton:e("extensibility",["isActionableAppProfileCardAppButton"]),isActionableAppProfileCardPermission:e("extensibility",["isActionableAppProfileCardPermission"]),isActionableAppProfileCardPermissionsList:e("extensibility",["isActionableAppProfileCardPermissionsList"]),isActionableAppProfileCardConsent:e("extensibility",["isActionableAppProfileCardConsent"]),isActionableAppProfileCardDeveloper:e("extensibility",["isActionableAppProfileCardDeveloper"]),isActionableAppProfileCardLink:e("extensibility",["isActionableAppProfileCardLink"]),isActionableAppProfileCardPresence:e("extensibility",["isActionableAppProfileCardPresence"]),isActionableAppProfileCardTitle:e("extensibility",["isActionableAppProfileCardTitle"]),isActionableAppProfileCardDescription:e("extensibility",["isActionableAppProfileCardDescription"]),isActionableAppProfileCardImageContainer:e("extensibility",["isActionableAppProfileCardImageContainer"]),isActionableAppProfileCard:e("extensibility",["isActionableAppProfileCard"]),isActionableAppProfileCardShort:e("extensibility",["isActionableAppProfileCardShort"]),appProfileImageBorderRadius:e("extensibility",["appProfileImageBorderRadius"]),isActionableAppProfileCardHeader:e("extensibility",["isActionableAppProfileCardHeader"]),isActionableAppProfileCardHeaderDescription:e("extensibility",["isActionableAppProfileCardHeaderDescription"]),isActionableAppProfileCardHeaderButtons:e("extensibility",["isActionableAppProfileCardHeaderButtons"]),isActionableAppProfileCardHeaderInfoBanner:e("extensibility",["isActionableAppProfileCardHeaderInfoBanner"]),isActionableAppProfileCardDivider:e("extensibility",["isActionableAppProfileCardDivider"]),isActionableAppProfileCardBody:e("extensibility",["isActionableAppProfileCardBody","customScrollbar"]),isActionableAppProfileCardBodySection:e("extensibility",["isActionableAppProfileCardBodySection"]),isActionableAppProfileCardBodySectionParagrahp:e("extensibility",["isActionableAppProfileCardBodySectionParagrahp"]),isActionableAppProfileCardBodySectionTitle:e("extensibility",["isActionableAppProfileCardBodySectionTitle"]),isActionableAppProfileCardFooter:e("extensibility",["isActionableAppProfileCardFooter"])})),[e])},cn=()=>{const e=(0,v.PO)();return t.useMemo((()=>({addAppButton:e.stringTranslate("extensibility","ext_actionable_app_profile_card_add_app_button_text"),addAppInfoBanner:e.stringTranslate("extensibility","ext_actionable_app_profile_card_add_app_info_banner_text"),addToYourAppsButton:e.stringTranslate("extensibility","ext_actionable_app_profile_card_add_to_your_apps_button_text"),appFeaturesTitle:e.stringTranslate("extensibility","ext_actionable_app_profile_card_app_features_title"),openAppButton:e.stringTranslate("extensibility","ext_actionable_app_profile_card_open_app_button_text"),permissions:e.stringTranslate("extensibility","ext_actionable_app_profile_card_permissions_link_text"),permissionsTitle:e.stringTranslate("extensibility","ext_actionable_app_profile_card_permissions_title"),privacyPolicy:e.stringTranslate("extensibility","ext_actionable_app_profile_card_privacy_policy_link_text"),termsOfUse:e.stringTranslate("extensibility","ext_actionable_app_profile_card_terms_of_use_link_text")})),[e])};var un=i(75914),pn=i(313314),kn=i(364819);const gn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"user"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"mri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"imageUri"}}]}}]}}]};var Nn=i(487167),vn=i(508411);const In={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsAppProfileCardAppDefinitionFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"bots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"capabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isNotificationOnly"}},{kind:"Field",name:{kind:"Name",value:"supportsFiles"}},{kind:"Field",name:{kind:"Name",value:"supportsCalling"}},{kind:"Field",name:{kind:"Name",value:"supportsVideo"}}]}},{kind:"Field",name:{kind:"Name",value:"configuration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"team"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsAppProfileCardAppDefinitionFragment_botConfigurationScope"}}]}},{kind:"Field",name:{kind:"Name",value:"groupChat"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsAppProfileCardAppDefinitionFragment_botConfigurationScope"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"developerName"}},{kind:"Field",name:{kind:"Name",value:"developerUrl"}},{kind:"Field",name:{kind:"Name",value:"longDescription"}},{kind:"Field",name:{kind:"Name",value:"shortDescription"}},{kind:"Field",name:{kind:"Name",value:"connectors"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorId"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"configurationUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"privacyUrl"}},{kind:"Field",name:{kind:"Name",value:"largeImageUrl"}},{kind:"Field",name:{kind:"Name",value:"termsOfUseUrl"}},{kind:"Field",name:{kind:"Name",value:"meetingExtensionDefinition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"supportsStreaming"}},{kind:"Field",name:{kind:"Name",value:"scenes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"file"}},{kind:"Field",name:{kind:"Name",value:"preview"}},{kind:"Field",name:{kind:"Name",value:"maxAudience"}},{kind:"Field",name:{kind:"Name",value:"seatsReservedForOrganizersOrPresenters"}}]}},{kind:"Field",name:{kind:"Name",value:"filters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"galleryTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"configurationUrl"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"canHaveTabConversation"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"meetingSurfaces"}},{kind:"Field",name:{kind:"Name",value:"context"}}]}},{kind:"Field",name:{kind:"Name",value:"staticTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isFullScreenApp"}},{kind:"Field",name:{kind:"Name",value:"isFullTrustApp"}},{kind:"Field",name:{kind:"Name",value:"validDomains"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"isMicrosoftOwned"}},{kind:"Field",name:{kind:"Name",value:"externalId"}},{kind:"Field",name:{kind:"Name",value:"webApplicationInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"applicationPermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"authorization"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resourceSpecific"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"devicePermissions"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsAppProfileCardAppDefinitionFragment_botConfigurationScope"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BotConfigurationScope"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}}]}.definitions]},Sn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAppProfileCardGetInstalledAppsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"definition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsAppProfileCardAppDefinitionFragment"}}]}}]}}]}},...In.definitions]},An={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAppProfileCardUseAppDefinitionsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinitions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsAppProfileCardAppDefinitionFragment"}}]}}]}},...In.definitions]},Tn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAppProfileCardUseAppDefinitionQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinition"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsAppProfileCardAppDefinitionFragment"}}]}}]}},...In.definitions]};var fn=i(390151);const Mn=[],hn=(e,n,i,a,t,r)=>{const l=Mn.find((l=>l.botOrAppId===e&&l.isWebhook===n&&(0,kn.isEqual)(l.conversationId,a)&&(0,kn.isEqual)(l.connectorSenderGuid,t)&&(0,kn.isEqual)(l.displayName,r)&&(0,kn.isEqual)(l.togetherModeParams,i)));if(l)return l;const o={botOrAppId:e,togetherModeParams:i,conversationId:a,connectorSenderGuid:t,displayName:r,isWebhook:n,isGetAppDefinitionCallInProgress:!1,listeners:[]};return Mn.push(o),o},yn=(e,n)=>{e&&(e.listeners.forEach((e=>{e(n)})),e.isGetAppDefinitionCallInProgress=!1)},Fn=(e,n,i,a,r,l,o=!1,d=!1)=>{const[s,m]=(0,t.useState)(),{loggerFactory:{newLogger:c},scenarioFactory:u,host:{location:{origin:p}},discover:k}=(0,F.ur)(),g=(0,t.useMemo)((()=>c("AppProfileCardContentContainer","app-profile-card-data")),[c]),N=(0,E.Us)(),{convId:v}=N.chatServiceSubscriptionFilter,{appDefinition:A,isSceneApp:T}=i||{},{entity:f}=(0,se.At)(),M=v||a||"",h=(0,t.useRef)(!1),{enableBotAvatarWithAppDefinition:y}=(0,I.w2)(S.w.Extensibility,["enableBotAvatarWithAppDefinition"]),{copilotAppIdForNewChat:b}=(0,I.w2)(S.w.Messaging,["copilotAppIdForNewChat"]);return(0,t.useEffect)((()=>{const e=hn(n,o,i,a,r,l);return e.listeners.push(m),()=>{e.listeners=e.listeners.filter((e=>e!==m)),0===e.listeners.length&&(e=>{const n=Mn.findIndex((n=>n.botOrAppId===e.botOrAppId&&n.isWebhook===e.isWebhook&&(0,kn.isEqual)(n.conversationId,e.conversationId)&&(0,kn.isEqual)(n.connectorSenderGuid,e.connectorSenderGuid)&&(0,kn.isEqual)(n.displayName,e.displayName)&&(0,kn.isEqual)(n.togetherModeParams,e.togetherModeParams)));n>=0&&Mn.splice(n,1)})(e)}}),[n,i,a,r,l,o]),(0,t.useEffect)((()=>{let t;h.current=!0;const d=hn(n,o,i,a,r,l);if(!d.isGetAppDefinitionCallInProgress){d.isGetAppDefinitionCallInProgress=!0,t=u.newScenario(U.Cu.AppProfileCardGetAppDefinition);const i=(0,_.Iz)(n)?"Bot.Id":"App.Id";t.appendEventData({[i]:n}),A?h.current&&(yn(d,A),t.stop()):Dn(e,n,M,f,T,r,l,o,p,k,y,b).then((e=>{h.current&&(yn(d,e),t.stop())})).catch((e=>{const i=`Unable to fetch appDefinition for BotOrAppId: ${n}, Failed with error: ${e}`;!M&&i.toLowerCase().includes("conversationId is undefined".toLowerCase())?h.current&&t&&t.stop():(g.error(i,{botOrAppId:n}),h.current&&t&&t.fail({message:i})),d.isGetAppDefinitionCallInProgress=!1}))}return()=>{h.current=!1,t&&t.cancel()}}),[e,n,p,k,T,g,m,u,A,M,r,f,l,o,a,i,d,y,b]),s},bn=async(e,n,i,a,t)=>{if((0,_.GX)(n)&&i){return{name:i,largeImageUrl:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSIjMjkzODRGIi8+CjxwYXRoIGQ9Ik0xMS45OTAyIDMuMjVDMTIuNTgyNyAzLjI1IDEzLjE0OTEgMy4zMjgxMiAxMy42ODk1IDMuNDg0MzhDMTQuMjI5OCAzLjYzNDExIDE0LjczMTEgMy44NDU3IDE1LjE5MzQgNC4xMTkxNEMxNS42NTU2IDQuMzkyNTggMTYuMDcyMyA0LjcyNDYxIDE2LjQ0MzQgNS4xMTUyM0MxNi44MjEgNS41MDU4NiAxNy4xNDMyIDUuOTM1NTUgMTcuNDEwMiA2LjQwNDNDMTcuNjc3MSA2Ljg3MzA1IDE3Ljg4MjIgNy4zODA4NiAxOC4wMjU0IDcuOTI3NzNDMTguMTY4NiA4LjQ2ODEgMTguMjQwMiA5LjAzMTI1IDE4LjI0MDIgOS42MTcxOUMxOC40MjkgOS42ODIyOSAxOC41OTgzIDkuNzczNDQgMTguNzQ4IDkuODkwNjJDMTguOTA0MyAxMC4wMDc4IDE5LjAzNDUgMTAuMTQ0NSAxOS4xMzg3IDEwLjMwMDhDMTkuMjQ5MyAxMC40NTA1IDE5LjMzNCAxMC42MTk4IDE5LjM5MjYgMTAuODA4NkMxOS40NTc3IDEwLjk5MDkgMTkuNDkwMiAxMS4xNzk3IDE5LjQ5MDIgMTEuMzc1VjEzLjg3NUMxOS40OTAyIDE0LjEyODkgMTkuNDQxNCAxNC4zNjk4IDE5LjM0MzggMTQuNTk3N0MxOS4yNDYxIDE0LjgyNTUgMTkuMTA5NCAxNS4wMjczIDE4LjkzMzYgMTUuMjAzMUMxOC43NjQzIDE1LjM3MjQgMTguNTY1OCAxNS41MDU5IDE4LjMzNzkgMTUuNjAzNUMxOC4xMSAxNS43MDEyIDE3Ljg2OTEgMTUuNzUgMTcuNjE1MiAxNS43NUgxNi4zNjUyQzE2LjE5NiAxNS43NSAxNi4wNDk1IDE1LjY4ODIgMTUuOTI1OCAxNS41NjQ1QzE1LjgwMjEgMTUuNDQwOCAxNS43NDAyIDE1LjI5NDMgMTUuNzQwMiAxNS4xMjVWMTAuMTI1QzE1Ljc0MDIgOS45NDkyMiAxNS43ODI2IDkuODE5MDEgMTUuODY3MiA5LjczNDM4QzE1Ljk1MTggOS42NDMyMyAxNi4wNTYgOS41ODEzOCAxNi4xNzk3IDkuNTQ4ODNDMTYuMzAzNCA5LjUwOTc3IDE2LjQzNjggOS40OTM0OSAxNi41ODAxIDkuNUMxNi43Mjk4IDkuNSAxNi44NjY1IDkuNSAxNi45OTAyIDkuNUMxNi45OTAyIDguODA5OSAxNi44NTY4IDguMTYyMTEgMTYuNTg5OCA3LjU1NjY0QzE2LjMyOTQgNi45NTExNyAxNS45NzE0IDYuNDIzODMgMTUuNTE1NiA1Ljk3NDYxQzE1LjA2NjQgNS41MTg4OCAxNC41MzkxIDUuMTYwODEgMTMuOTMzNiA0LjkwMDM5QzEzLjMyODEgNC42MzM0NiAxMi42ODAzIDQuNSAxMS45OTAyIDQuNUMxMS4zMDAxIDQuNSAxMC42NTIzIDQuNjMzNDYgMTAuMDQ2OSA0LjkwMDM5QzkuNDQxNDEgNS4xNjA4MSA4LjkxMDgxIDUuNTE4ODggOC40NTUwOCA1Ljk3NDYxQzguMDA1ODYgNi40MjM4MyA3LjY0Nzc5IDYuOTUxMTcgNy4zODA4NiA3LjU1NjY0QzcuMTIwNDQgOC4xNjIxMSA2Ljk5MDIzIDguODA5OSA2Ljk5MDIzIDkuNUg3LjI3MzQ0QzcuMzg0MTEgOS41IDcuNDk4MDUgOS41MDY1MSA3LjYxNTIzIDkuNTE5NTNDNy43MzI0MiA5LjUyNjA0IDcuODM2NTkgOS41NTIwOCA3LjkyNzczIDkuNTk3NjZDOC4wMTg4OCA5LjYzNjcyIDguMDkzNzUgOS42OTg1NyA4LjE1MjM0IDkuNzgzMkM4LjIxMDk0IDkuODY3ODQgOC4yNDAyMyA5Ljk4MTc3IDguMjQwMjMgMTAuMTI1VjE1LjEyNUM4LjI0MDIzIDE1LjMwMDggOC4xOTc5MiAxNS40MzQyIDguMTEzMjggMTUuNTI1NEM4LjAyODY1IDE1LjYxIDcuOTI0NDggMTUuNjcxOSA3LjgwMDc4IDE1LjcxMDlDNy42NzcwOCAxNS43NDM1IDcuNTQwMzYgMTUuNzU5OCA3LjM5MDYyIDE1Ljc1OThDNy4yNDc0IDE1Ljc1MzMgNy4xMTM5MyAxNS43NSA2Ljk5MDIzIDE1Ljc1VjE3Ljk3NjZDNi45OTAyMyAxOC4xMzI4IDcuMDM5MDYgMTguMjYzIDcuMTM2NzIgMTguMzY3MkM3LjI0MDg5IDE4LjQ2NDggNy4zNzEwOSAxOC41NDYyIDcuNTI3MzQgMTguNjExM0M3LjY5MDEgMTguNjc2NCA3Ljg2OTE0IDE4LjcyNTMgOC4wNjQ0NSAxOC43NTc4QzguMjU5NzcgMTguNzkwNCA4LjQ1NTA4IDE4LjgxNjQgOC42NTAzOSAxOC44MzU5QzguODQ1NyAxOC44NDkgOS4wMjc5OSAxOC44NTg3IDkuMTk3MjcgMTguODY1MkM5LjM2NjU0IDE4Ljg2NTIgOS41MDMyNiAxOC44NjUyIDkuNjA3NDIgMTguODY1MkM5LjY3OTA0IDE4LjY4MjkgOS43NzM0NCAxOC41MTY5IDkuODkwNjIgMTguMzY3MkMxMC4wMDc4IDE4LjIxNzQgMTAuMTQxMyAxOC4wODcyIDEwLjI5MSAxNy45NzY2QzEwLjQ0NzMgMTcuODY1OSAxMC42MTY1IDE3Ljc4MTIgMTAuNzk4OCAxNy43MjI3QzEwLjk4MTEgMTcuNjU3NiAxMS4xNjk5IDE3LjYyNSAxMS4zNjUyIDE3LjYyNUgxMS45OTAyQzEyLjI0NDEgMTcuNjI1IDEyLjQ4NSAxNy42NzM4IDEyLjcxMjkgMTcuNzcxNUMxMi45NDA4IDE3Ljg2OTEgMTMuMTM5MyAxOC4wMDU5IDEzLjMwODYgMTguMTgxNkMxMy40ODQ0IDE4LjM1MDkgMTMuNjIxMSAxOC41NDk1IDEzLjcxODggMTguNzc3M0MxMy44MTY0IDE5LjAwNTIgMTMuODY1MiAxOS4yNDYxIDEzLjg2NTIgMTkuNUMxMy44NjUyIDE5Ljc1MzkgMTMuODE2NCAxOS45OTQ4IDEzLjcxODggMjAuMjIyN0MxMy42MjExIDIwLjQ1MDUgMTMuNDg0NCAyMC42NTIzIDEzLjMwODYgMjAuODI4MUMxMy4xMzkzIDIwLjk5NzQgMTIuOTQwOCAyMS4xMzA5IDEyLjcxMjkgMjEuMjI4NUMxMi40ODUgMjEuMzI2MiAxMi4yNDQxIDIxLjM3NSAxMS45OTAyIDIxLjM3NUgxMS4zNjUyQzEwLjk2MTYgMjEuMzc1IDEwLjYwMDMgMjEuMjYxMSAxMC4yODEyIDIxLjAzMzJDOS45NjIyNCAyMC43OTg4IDkuNzM0MzggMjAuNDkyOCA5LjU5NzY2IDIwLjExNTJDOS4zNTAyNiAyMC4xMDg3IDkuMDgwMDggMjAuMDk5IDguNzg3MTEgMjAuMDg1OUM4LjUwMDY1IDIwLjA3MjkgOC4yMTQxOSAyMC4wNDY5IDcuOTI3NzMgMjAuMDA3OEM3LjY0MTI4IDE5Ljk2MjIgNy4zNjQ1OCAxOS44OTcxIDcuMDk3NjYgMTkuODEyNUM2LjgzNzI0IDE5LjcyMTQgNi42MDYxMiAxOS41OTc3IDYuNDA0MyAxOS40NDE0QzYuMjAyNDcgMTkuMjc4NiA2LjAzOTcxIDE5LjA4MDEgNS45MTYwMiAxOC44NDU3QzUuNzk4ODMgMTguNjA0OCA1Ljc0MDIzIDE4LjMxNTEgNS43NDAyMyAxNy45NzY2VjE1LjYzMjhDNS41NTc5NCAxNS41Njc3IDUuMzg4NjcgMTUuNDc2NiA1LjIzMjQyIDE1LjM1OTRDNS4wNzYxNyAxNS4yNDIyIDQuOTQyNzEgMTUuMTA4NyA0LjgzMjAzIDE0Ljk1OUM0LjcyNzg2IDE0LjgwMjcgNC42NDMyMyAxNC42MzM1IDQuNTc4MTIgMTQuNDUxMkM0LjUxOTUzIDE0LjI2MjQgNC40OTAyMyAxNC4wNzAzIDQuNDkwMjMgMTMuODc1VjExLjM3NUM0LjQ5MDIzIDExLjE3OTcgNC41MTk1MyAxMC45OTA5IDQuNTc4MTIgMTAuODA4NkM0LjY0MzIzIDEwLjYxOTggNC43Mjc4NiAxMC40NTA1IDQuODMyMDMgMTAuMzAwOEM0Ljk0MjcxIDEwLjE0NDUgNS4wNzYxNyAxMC4wMDc4IDUuMjMyNDIgOS44OTA2MkM1LjM4ODY3IDkuNzczNDQgNS41NTc5NCA5LjY4MjI5IDUuNzQwMjMgOS42MTcxOUM1Ljc0MDIzIDkuMDMxMjUgNS44MTE4NSA4LjQ2ODEgNS45NTUwOCA3LjkyNzczQzYuMDk4MzEgNy4zODA4NiA2LjMwMzM5IDYuODczMDUgNi41NzAzMSA2LjQwNDNDNi44MzcyNCA1LjkzNTU1IDcuMTU2MjUgNS41MDU4NiA3LjUyNzM0IDUuMTE1MjNDNy45MDQ5NSA0LjcyNDYxIDguMzI0ODcgNC4zOTI1OCA4Ljc4NzExIDQuMTE5MTRDOS4yNDkzNSAzLjg0NTcgOS43NTA2NSAzLjYzNDExIDEwLjI5MSAzLjQ4NDM4QzEwLjgzMTQgMy4zMjgxMiAxMS4zOTc4IDMuMjUgMTEuOTkwMiAzLjI1Wk0xMS4zNjUyIDE4Ljg3NUMxMS4xOTYgMTguODc1IDExLjA0OTUgMTguOTM2OCAxMC45MjU4IDE5LjA2MDVDMTAuODAyMSAxOS4xODQyIDEwLjc0MDIgMTkuMzMwNyAxMC43NDAyIDE5LjVDMTAuNzQwMiAxOS42NjkzIDEwLjgwMjEgMTkuODE1OCAxMC45MjU4IDE5LjkzOTVDMTEuMDQ5NSAyMC4wNjMyIDExLjE5NiAyMC4xMjUgMTEuMzY1MiAyMC4xMjVIMTEuOTkwMkMxMi4xNTk1IDIwLjEyNSAxMi4zMDYgMjAuMDYzMiAxMi40Mjk3IDE5LjkzOTVDMTIuNTUzNCAxOS44MTU4IDEyLjYxNTIgMTkuNjY5MyAxMi42MTUyIDE5LjVDMTIuNjE1MiAxOS4zMzA3IDEyLjU1MzQgMTkuMTg0MiAxMi40Mjk3IDE5LjA2MDVDMTIuMzA2IDE4LjkzNjggMTIuMTU5NSAxOC44NzUgMTEuOTkwMiAxOC44NzVIMTEuMzY1MlpNNi4zNjUyMyAxMC43NUM2LjE5NTk2IDEwLjc1IDYuMDQ5NDggMTAuODExOCA1LjkyNTc4IDEwLjkzNTVDNS44MDIwOCAxMS4wNTkyIDUuNzQwMjMgMTEuMjA1NyA1Ljc0MDIzIDExLjM3NVYxMy44NzVDNS43NDAyMyAxNC4wNDQzIDUuODAyMDggMTQuMTkwOCA1LjkyNTc4IDE0LjMxNDVDNi4wNDk0OCAxNC40MzgyIDYuMTk1OTYgMTQuNSA2LjM2NTIzIDE0LjVINi45OTAyM1YxMC43NUg2LjM2NTIzWk0xNi45OTAyIDEwLjc1VjE0LjVIMTcuNjE1MkMxNy43ODQ1IDE0LjUgMTcuOTMxIDE0LjQzODIgMTguMDU0NyAxNC4zMTQ1QzE4LjE3ODQgMTQuMTkwOCAxOC4yNDAyIDE0LjA0NDMgMTguMjQwMiAxMy44NzVWMTEuMzc1QzE4LjI0MDIgMTEuMjA1NyAxOC4xNzg0IDExLjA1OTIgMTguMDU0NyAxMC45MzU1QzE3LjkzMSAxMC44MTE4IDE3Ljc4NDUgMTAuNzUgMTcuNjE1MiAxMC43NUgxNi45OTAyWiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg=="}}const{data:r}=await e.query({query:gn,variables:{mri:n},context:{callerInfo:"app-profile-card-data"}}),l=r?.user;if(l){const e={name:l.displayName||"",largeImageUrl:l.imageUri??""};return e.largeImageUrl&&t&&a&&!Cn(e.largeImageUrl,a)&&(e.largeImageUrl=await(async(e,n)=>{let i="";try{i=new URL(await e.regionGtm("urlp")).hostname}catch{i="urlp.asm.skype.com"}return`https://${i}/v1/url/content?url=${encodeURIComponent(n)}`})(t,e.largeImageUrl)),e}return null},Cn=(e,n)=>(0,ke.d$)(e,n)||(0,ge.D$)(e),Dn=async(e,n,i,a,t,r,l,o=!1,d,s,m,c)=>{let u,p;const k=a.type===me.ck.channels;if(k)u="Team";else{const a=i?await Pn(e,i):null;if(a){p=a?.chatSubType===un.vW.Channel;const e=Vn(n,a);u=p?"Team":e||t?"Personal":"GroupChat"}}return(k||p)&&(i=await(0,Nn.DW)(e,i)??""),Un(e,n,i,r,u,l,o,d,s,m,c)},Un=async(e,n,i,a,t,r,l=!1,o,d,s,m)=>{const c=(0,_.Iz)(n),u=(0,_.GX)(n)&&!!a,p=l?await(async(e,n,i,a)=>{const{data:t}=await e.query({query:Tn,variables:{conversationId:n,scope:a||"Team",appId:i},context:{callerInfo:"app-profile-card-data-getAppDefinitionForOutgoingWebhook"}});return t?.appDefinition?t.appDefinition:null})(e,i,n,t):u?await(async(e,n,i,a)=>{if(!i)return null;const{data:t}=await e.query({query:An,variables:{conversationId:n,scope:a,options:{capabilityFilter:["Connector"],connectorId:i}},context:{callerInfo:"app-profile-card-data-getAppDefinitionForConnector"}});return t?.appDefinitions?.length&&t.appDefinitions[0]?t.appDefinitions[0]:null})(e,i,a,t):c?En(n,m)?await wn(e,n,i,t):await(s?(0,fn.fP)(e,n,i,t):(async(e,n,i,a)=>{const{data:t}=await e.query({query:An,variables:{conversationId:i,scope:a,options:{botId:(0,vn.Uf)(n)}},context:{callerInfo:"app-profile-card-data-getAppDefinitionForBot"}});return t?.appDefinitions?.length&&t.appDefinitions[0]?t.appDefinitions[0]:null})(e,n,i,t)):await(async(e,n,i,a)=>{const{data:t}=await e.query({query:Tn,variables:{conversationId:i,scope:a,appId:n},context:{callerInfo:"app-profile-card-data-getAppDefinitionForApp"}});return t?.appDefinition?t.appDefinition:null})(e,n,i,t);if(p)return p;return c?await bn(e,n,r,o,d):null},En=(e,n)=>!!n&&(0,_.Iz)(e)&&(0,vn.Uf)(e)===n,wn=async(e,n,i,a)=>{const t=(0,vn.Uf)(n),r={scope:a||"Personal",conversationId:i},{data:l}=await e.query({query:Sn,variables:{installedContext:r,options:{botId:t,includeUnlicensedApps:!0}},context:{callerInfo:"app-profile-card-data-gcp"}}),o=l?.installedAppsV2?.filter((e=>e?.definition?.bots?.some((e=>e.id===t))));return o?.[0]?.definition?o?.[0]?.definition:null},Ln=e=>e?.bots&&e.bots.length>0&&(0,kn.includes)(e.bots[0].scopes,"Personal")||!1,xn=(e,n,i)=>{const[a,r]=(0,t.useState)(!1),[l,o]=(0,t.useState)(!1),[d,s]=(0,t.useState)(!0),m=(0,E.Us)(),{scenarioFactory:c}=(0,F.ur)(),u=(0,b.U)("AppProfileCardContentContainer");return(0,t.useEffect)((()=>{const a=Bn(n);if(!a)return;const{convId:t}=m.chatServiceSubscriptionFilter;let l,d=!1;const p=t||i;return p&&(d=!0,l=c.newScenario(U.Cu.UseOneOnOneAndDisabledByTenantChecker),Pn(e,p).then((e=>{d&&(r(!e||Vn(a,e)),o(!e||jn(a,e)),s(!e||Vn(a,e)),l.stop())})).catch((()=>{const e=`Failed to get conversation with conversationId:${t} for bot/app:${a}`;u.error(e,{botMri:a}),d&&l&&l.fail({message:e})}))),()=>{d=!1,l&&l.cancel()}}),[m.chatServiceSubscriptionFilter,n,e,u,c,i]),{isDisabledByTenant:l,isOneOnOne:a,isOneOnOneBotChat:d}},On=(e,n)=>{const[i,a]=(0,t.useState)(!1),{scenarioFactory:r}=(0,F.ur)(),l=(0,b.U)("AppProfileCardContentContainer");return(0,t.useEffect)((()=>{const i=Bn(n);if(!i)return;let t=!0;const o=r.newScenario(U.Cu.UseDisabledByUserChecker);return(0,y.QL)(e,i).then((e=>{t&&(a(!e||jn(i,e)),o.stop())})).catch((()=>{const e=`Failed to get conversation for bot/app:${i}`;l.error(e,{botMri:i}),t&&o&&o.fail({message:e})})),()=>{t=!1,o&&o.cancel()}}),[n,e,l,r]),i},Pn=async(e,n)=>{const i=await e.query({query:pn.A,variables:{convId:n},context:{callerInfo:"app-profile-card-data"}});return i.data?.chat},Vn=(e,n)=>!!n&&!!n.isOneOnOne&&!!n.memberIds&&-1!==n.memberIds.indexOf(e),jn=(e,n)=>!!n&&!!n.isDisabled&&!!n.memberIds&&-1!==n.memberIds.indexOf(e),Bn=e=>{let n=e&&e.bots&&e.bots.length>0&&e.bots[0].id;if(n){const e=n?.startsWith(H.gN.BotPrefix);n=e?n:`${H.gN.BotPrefix}${n}`}return n||null},zn=e=>e&&e.meetingExtensionDefinition&&e.meetingExtensionDefinition.scenes&&e.meetingExtensionDefinition.scenes.length>0?e.meetingExtensionDefinition.scenes.length:0,Rn=e=>{const n={supportsCalling:!1,supportsVideo:!1},i=e?.bots&&e?.bots[0]?.capabilities;return n.supportsCalling=i?.supportsCalling??!1,n.supportsVideo=i?.supportsVideo??!1,n},Qn=e=>(e?.bots&&e?.bots[0]?.configuration)??null,Wn="ext_actionable_app_profile_card_use_is_app_installed_get_installed_apps",Yn=({client:e,botIdOrAppId:n,hideActionButtons:i,hideAppButton:r,appDef:l,togetherModeParams:o,convId:d})=>{const{isOneOnOne:s,isDisabledByTenant:m,isOneOnOneBotChat:c}=xn(e,l,d),u=On(e,l),p=l&&Bn(l),k=l&&zn(l),g=l&&Rn(l),N=l&&Qn(l),{id:v,name:A,privacyUrl:T,termsOfUseUrl:f,largeImageUrl:M,shortDescription:h,meetingExtensionDefinition:y}=l,C=Ln(l),D=!C&&!!i,U=((e,n)=>{const[i,a]=t.useState(null),{scenarioFactory:r}=(0,F.ur)(),l=(0,b.U)("useIsAppInstalled"),{enableAppsQueryOptimization:o,enableInstalledAppQueryOptimization:d}=(0,I.w2)(S.w.Extensibility,["enableAppsQueryOptimization","enableInstalledAppQueryOptimization"]);return t.useEffect((()=>{(0,Le.tN)(e,l,r,n,o,"use-is-app-installed",{shouldFetchPersonalApps:!0,enableInstalledAppQueryOptimization:d}).then((e=>{const n=`Loaded installed apps. Length: ${e.length}`;l.infoToTelemetry?l.infoToTelemetry(n,Wn):l.log(`${Wn}: ${n}`),a(e.length>0)})).catch((()=>{const e=`Failed to get installed apps by ID for app id: ${n}`;l.errorToTelemetry?l.errorToTelemetry(e,Wn):l.error(`${Wn}: ${e}`)}))}),[e,l,r,n,o,d]),i})(e,v),E=(e=>{const n="Personal",i=(0,Le.vx)(n,e.bots)||(0,Le.vx)(n,e.galleryTabs)||(0,Le.vx)(n,e.staticTabs),a=(0,Le.vx)(n,e.messageExtensions)&&!!e.messageExtensions?.some((e=>(e.commands?.length??0)>0)),t=(e.meetingExtensionDefinition?.scenes?.length??0)>0,r=(e.meetingExtensionDefinition?.filters?.length??0)>0;return i||t||r||a})(l);return(0,a.Y)(Ze,{appDef:l,botName:Gn(A),privacyUrl:Gn(T),termsOfUseUrl:Gn(f),iconUrl:Gn(M),description:Gn(h),botIdOrAppId:p||n,showRectAppImage:!!o?.isSceneApp||D,sceneCount:k||0,isSceneApp:!!o?.isSceneApp,showActionButtons:C&&!s&&!m&&!u&&!i,hideAppButton:r,sceneName:Gn(o?.sceneName),botCallingCapabilities:g,appId:v,supportsMeetingStreaming:y?.supportsStreaming,hasPersonalScope:E,isInstalled:!!U,botConfiguration:c?null:N})},Gn=e=>e||"",Zn=({client:e,botIdOrAppId:n,hideActionButtons:i,appDef:t,togetherModeParams:r,convId:l})=>{const{isOneOnOne:o,isDisabledByTenant:d,isOneOnOneBotChat:s}=xn(e,t,l),m=On(e,t),c=t&&Bn(t),u=t&&zn(t),p=t&&Rn(t),k=t&&Qn(t),{id:g,name:N,privacyUrl:v,termsOfUseUrl:I,developerName:S,largeImageUrl:A,longDescription:T,shortDescription:f,meetingExtensionDefinition:M}=t,h=Ln(t),y=!h&&i||!1,F=!t?.id&&!i;return(0,a.Y)(Ne,{botName:_n(N),privacyUrl:_n(v),termsOfUseUrl:_n(I),developerName:Hn(r)?"":_n(S),iconUrl:_n(A),description:Hn(r)?_n(f):_n(T),botIdOrAppId:c||n,showRectAppImage:Hn(r)||y,isShortProfileCard:F,sceneCount:u||0,isSceneApp:!!Hn(r),showActionButtons:h&&!o&&!d&&!m&&!i&&!F,sceneName:_n(r&&r.sceneName),botCallingCapabilities:p,appId:g,supportsMeetingStreaming:M?.supportsStreaming,botConfiguration:s?null:k,appDef:t})},_n=e=>e||"",Hn=e=>e&&e.isSceneApp;var Jn=i(619761);const qn=({className:e})=>(0,a.Y)(K.s,{className:e,children:(0,a.Y)(u.s,{fill:!0,vAlign:"center",hAlign:"center",children:(0,a.Y)(We.y,{})})});var Xn=i(538935);const Kn=(0,Y.O)({isAppProfileCard:{a9b677:"ffyt4a4",Bqenvij:"f1l02sjl",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fuvn4gy"}}),$n=t.memo((({children:e,client:n,botIdOrAppId:i,hideActionButtons:d,hideAppButton:s,position:m,align:c,offset:u,togetherModeParams:p,autoFocus:k,connectorSenderGuid:g,conversationId:N,onBehalfOfId:v,renderTriggerAsLink:A=!0,displayName:T,tabbableTrigger:f,nonFocusableTrigger:M})=>{const h=t.useContext(Jn.I18nContext),{recordPanelAction:y,createDatabag:F}=(0,D.ib)(),b=t.useRef(!1),{enableAppProfileCard:U,enableActionableAppProfileCard:E,enableInstalledAppQueryOptimization:w}=(0,I.w2)(S.w.Extensibility,["enableAppProfileCard","enableActionableAppProfileCard","enableInstalledAppQueryOptimization"]),x=Kn(),{vars:O}=(0,r.W)(),[P,V]=t.useState(!1),j=(0,_.BG)(i),B=Fn(n,j&&v?v:i,p,N,g,T,j,!!w),z=(0,kn.debounce)((()=>{V(!0)}),1e3),R=t.useCallback(((e,n)=>{const i=n?.open;if(z.cancel(),!0===i?z():V(!1),i&&!b.current){const e=L(C.Od.hover,C.nd.inspect,C.vB.appProfileCardAppear,C.Sn.appProfileCard,B?.name??void 0,B?.id,B?.bots?.[0]?.id);E&&(e.dataBag=F(),e.dataBag.actionableAppProfileCard=!0),y(e)}void 0!==i&&i!==b.current&&(b.current=i)}),[F,y,B,E,b,z]),Q=t.useMemo((()=>ei(!!E)),[E]);if(!U)return(0,a.Y)(t.Fragment,{children:e});if(null===B)return null;const W=((e,n,i,a)=>{if(i){const{name:t,developerName:r,longDescription:l,shortDescription:o}=i,d=a?.sceneName,s=zn(i),m=(n?o:l)||"";return e.stringTranslate("extensibility","app_profile_card_app_information_dialog_aria_label",{sceneName:d||"",name:t||"",developerName:r||"",sceneCount:s||0,longDescription:m})}return""})(h,!!E,B,p),Y=e??B?.name;return(0,a.Y)(l.z,{on:"hover",position:m||"before",align:c||"center",offset:u,open:P,onOpenChange:R,autoFocus:k,trapFocus:!k,autoSize:!0,content:{"aria-label":W,autoFocus:!0,className:Xn.n,content:B?(0,a.Y)(Q,{botIdOrAppId:i,client:n,appDef:B,hideActionButtons:d,hideAppButton:s,togetherModeParams:p,convId:N}):(0,a.Y)(qn,{className:x.isAppProfileCard}),variables:{removePopupContentPadding:!0,hasNoBorder:!0}},tabbableTrigger:f,trigger:(0,a.Y)(o.E,{"data-tid":"app-profile-card-trigger",link:!!A,content:Y,variables:O("extensibility",["isFocusableOutlineBorder"]),...M&&{tabIndex:"-1"}}),overflowBoundary:"window",flipBoundary:"window"})})),ei=(e=!1)=>e?Yn:Zn,ni=(0,M.W)($n)},499113:(e,n,i)=>{"use strict";i.d(n,{R4:()=>u,IZ:()=>c,A_:()=>p});var a=i(957032),t=i(513432),r=i(959022),l=i(50467);const o={clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",width:"1px",position:"absolute"},d=t.forwardRef((({assertive:e,targetDocument:n},i)=>{const[d,s]=t.useState(""),m=t.useRef(),c=(0,l.ur)(),u=c?c.host:window,p=/Mac|iPod|iPhone|iPad/.test(u.navigator.platform),k=t.useCallback((e=>{s(e),null!==m.current&&u.clearTimeout(m.current),m.current=u.setTimeout((()=>{s(""),null!==m.current&&u.clearTimeout(m.current),m.current=null}),2e3)}),[m,u,s]);t.useImperativeHandle(i,(()=>({announce:k}))),t.useEffect((()=>()=>{null!==m.current&&u.clearTimeout(m.current)}),[m,u]);const g=n?n.body:u.document.body;let N=null;if(p){const e=n?n.activeElement:u.document.activeElement;N=e?.closest("*[aria-modal='true']")}const v=N||g;return r.createPortal((0,a.Y)("div",{"aria-live":e?"assertive":"polite","aria-atomic":"true",style:o,children:d}),v)}));var s=i(35871),m=i(106255);const c=({children:e,targetDocument:n})=>{const i=t.useRef(),r=t.useRef(),l=t.useCallback(((e,n)=>{const a=n?r.current:i.current;a&&a.announce(e)}),[r,i]),o=t.useMemo((()=>({announce:l})),[l]),c=t.useMemo((()=>({announce:(e,n)=>{const i=!!n&&!n.polite;l(e,i)}})),[l]);return(0,a.Y)(t.Fragment,{children:[(0,a.Y)(d,{assertive:!1,ref:i,targetDocument:n}),(0,a.Y)(d,{assertive:!0,ref:r,targetDocument:n}),(0,a.Y)(s.AnnounceProvider,{value:c,children:(0,a.Y)(m.AriaLiveContext.Provider,{value:o,children:e})})]})},u=m.AriaLiveContext.Consumer,p=()=>t.useContext(m.AriaLiveContext)},98282:(e,n,i)=>{"use strict";i.d(n,{j:()=>de});var a=i(957032),t=i(364819),r=i(513432),l=i(554186),o=i(675580),d=i(881360),s=i(50467),m=i(780689),c=i(848020),u=i(727572),p=i(100318),k=i(127066),g=i(332752),N=i(169233),v=i(362208),I=i(935197),S=i(139150),A=i(194649),T=i(862474),f=i(203056),M=i(358970),h=i(772783),y=i(727780),F=i(277362),b=i(752433),C=i(431324),D=i(959515),U=i(525448),E=i(526521),w=i(792529),L=i(175030);var x=i(965804);const O=(0,x.O)({avatarObjectFit:{st4lth:"f1ps3kmd"},groupChatAvatarObjectFit:{st4lth:"f1plgu50"}}),P=(0,x.O)({mercuryHexagonalAvatarBorder:{Bw0xxkn:"f13sgyd8"}}),V=(0,x.O)({teamAvatarBorder:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5"},teamHighContrastAvatarBorder:{Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f12wbrtg"}});var j=i(522277);const B=r.memo((({simpleAvatarType:e,...n})=>{const{enableFluentV9Avatar:i}=(0,k.w2)(g.w.People,["enableFluentV9Avatar"]);return e?(0,a.Y)(ie,{enableFluentV9Avatar:!!i,simpleAvatarType:e,...n}):(0,a.Y)(z,{...n})})),z=({accessibilityLabel:e,alt:n,presenceUserId:i,profilePictureType:a,presenceSource:t,isPresencePrefetched:l,isEmergencyCallTarget:o,shouldAllowContextMenu:c,isFocusable:u,hexagonal:p,square:N,userId:v,personaType:I,hostConversationId:S,isDoubleClickDisabled:A,narrateProfilePicture:f,callerInfo:M,statusSize:h,isSharedChannel:y,isXtapUserUrl:F,draggable:D,isTeamHeaderEmblemExpanded:U,hidePersonaCard:w,v9ClassName:x,role:j,avatarUrl:B,cacheKey:z,isGroupChatAvatarPresetOrEmojiPicture:Q=!1,displayName:W,onError:Y,allowDoubleClickEventPropagation:ne,...ie})=>{const ae=(0,d.U)("AvatarRenderer"),te=r.useRef(null),re=(()=>{const{host:e}=(0,s.ur)(),{avatarDoubleClickDelayInMs:n}=(0,k.w2)(g.w.People,["avatarDoubleClickDelayInMs"]),i=r.useRef(null),a=n||0,t=e=>{l(),null!==e&&null!==e.current&&e.current.dispatchEvent(new MouseEvent("click",{bubbles:!0}))},l=()=>{i.current&&e.clearTimeout(i.current),i.current=null};return r.useEffect((()=>()=>{i.current&&(e.clearTimeout(i.current),i.current=null)}),[e,i]),(n,r,o,d)=>{a>0&&!o?(n.preventDefault(),n.stopPropagation(),i.current?l():i.current=e.setTimeout((()=>{t(r),d&&d(n)}),a)):d&&d(n)}})(),le=V(),oe=P(),de=O(),{isOnline:se}=(0,s.WB)(),{themeType:me}=(0,b.z2)(),ce=(0,m.bE)(),[ue,pe]=r.useState(!1),[ke,ge]=r.useState(B),[Ne,ve]=r.useState(!1),{entityCommanding:Ie,user:Se,avatarImageCache:Ae}=(0,s.ur)(),{enableShowPresenceInCriticalPhase:Te}=(0,k.w2)(g.w.Presence,["enableShowPresenceInCriticalPhase"]),{msgEnableSelfChat:fe,allowUserChat:Me,enableChatActionFromAvatar:he,enableFluentV9Avatar:ye,enableFailedAvatarReloadOnNetworkReconnect:Fe,enableInitialsAvatarOnError:be,enableMercuryDesign:Ce}=R(),{onClick:De,onKeyDown:Ue,onMouseEnter:Ee,onMouseLeave:we}=(0,C.q0)({userId:v,personaType:I,hostConversationId:S}),Le=H(f,e),xe=r.useCallback((e=>{pe(e.isError),ge(e.currentUrl),ve(e.shouldReload)}),[]),Oe=(0,E.z)((a===T.It.Team||N)&&le.teamAvatarBorder,me===L.SV.Contrast&&le.teamHighContrastAvatarBorder,x,!!Ce&&!!p&&oe.mercuryHexagonalAvatarBorder),Pe=ee(!!Fe,ue,se,Ne,B,a,o,!!be,ce,W||""),Ve=X(a,u,N),je={...ie.variables,...Ve},Be={profilePictureType:a,imageUrl:Pe,isEmergencyCallTarget:o,logger:ae,avatarState:{currentUrl:ke,isError:ue,shouldReload:Ne},isOnline:se,setAvatarState:xe},ze=ye?void 0:_(i,t,l,h),Re=!!p,Qe={...G(!!u,Pe,n,D,e,Q?de.groupChatAvatarObjectFit:de.avatarObjectFit),onError:e=>{$(Be,Y)},onLoad:e=>{(e=>{try{const n=new URL(e);if("https:"!==n.protocol)return!1;const i=n.searchParams.get("size");if(null!==i&&i!==T.xi.Small)return!1}catch(e){return!1}return!0})(Pe)&&Ae?.add(z||Pe,Pe),K(Be)},onContextMenu:e=>J(e,c),onDoubleClick:e=>{q(A,Me,he,v,a,Se,Ie,fe),!ne&&e.stopPropagation()},onClickCapture:e=>re(e,te,A,De),...!w&&!Re&&{onKeyDown:Ue,onMouseEnter:Ee,onMouseLeave:we}},We={root:{isTeamHeaderEmblemExpanded:U},image:{...Le,...Qe,variables:je},status:ze?{...ze,variables:je}:ze,...ie},Ye=We["data-tid"],Ge=Le["aria-label"];return Z(i,t,We,Qe,te,Oe,Ve,p,!!ye,Ye,j,!!u,Ge,!!Te,f)},R=()=>{const{msgEnableSelfChat:e}=(0,k.w2)(g.w.Host,["msgEnableSelfChat"]),{allowUserChat:n,enableChatActionFromAvatar:i}=(0,k.w2)(g.w.Messaging,["allowUserChat","enableChatActionFromAvatar"]),{enableFluentV9Avatar:a,enableFailedAvatarReloadOnNetworkReconnect:t,enableInitialsAvatarOnError:r}=(0,k.w2)(g.w.People,["enableFluentV9Avatar","enableFailedAvatarReloadOnNetworkReconnect","enableInitialsAvatarOnError"]),{enableMercuryDesign:l}=(0,k.w2)(g.w.MercuryDesign,["enableMercuryDesign"]);return{msgEnableSelfChat:e,allowUserChat:n,enableChatActionFromAvatar:i,enableFluentV9Avatar:a,enableFailedAvatarReloadOnNetworkReconnect:t,enableInitialsAvatarOnError:r,enableMercuryDesign:l}},Q=e=>{if(!(0,M.ab)(h.Jj.POST_CRITICAL)||!e.presenceUserId)return(0,a.Y)(W,{...e,isFocusable:!1});const{hexagonal:n,presenceUserId:i,presenceSource:t,avatarRef:r,commonImgAttributes:l,role:o,isFocusable:d,v9AllStyles:s,dataTid:m,ariaLabel:c,size:u,narrateProfilePicture:p}=e;return(0,a.Y)(Y,{hexagonal:!!n,presenceUserId:i,presenceSource:t||"ups",avatarRef:r,commonImgAttributes:{...l,role:o||(d?"img":"presentation")},v9AllStyles:s,dataTid:m,ariaLabel:c,size:u,narrateProfilePicture:p})},W=({hexagonal:e,dataTid:n,v9AllStyles:i,commonImgAttributes:t,size:r,isFocusable:l,role:o,avatarRef:d})=>e?(0,a.Y)(D.A,{commonImgAttributes:t,className:i,size:(0,f.BY)(r)}):(0,a.Y)(w.e,{"data-tid":n,image:{...t},ref:d,className:i,size:(0,f.BY)(r),role:o||(l?"img":"presentation")}),Y=({hexagonal:e,presenceUserId:n,presenceSource:i,avatarRef:t,commonImgAttributes:r,v9AllStyles:l,dataTid:o,size:d,ariaLabel:s,narrateProfilePicture:m,role:c})=>{const u=(0,U.qI)(n,i);let p=!0;return m&&(p=!1),e?(0,a.Y)(D.A,{"aria-label":s,badgeProps:u,commonImgAttributes:r,className:l,size:(0,f.BY)(d)}):(0,a.Y)(w.e,{"aria-hidden":p,"aria-label":s,badge:u,"data-tid":o,image:{...r},ref:t,className:l,size:(0,f.BY)(d),role:c})},G=(e,n,i,a,t,r)=>({alt:i,src:n,draggable:a,...e&&{"data-is-focusable":!0,"aria-haspopup":!0,"aria-hidden":!1,"aria-label":t,tabIndex:0},className:r}),Z=(e,n,i,t,r,l,o,d,s,m,c,u,p,k,g)=>{const N=d?D.A:I.e;return s?e&&k?(0,a.Y)(Y,{hexagonal:!!d,presenceUserId:e,presenceSource:n||"ups",avatarRef:r,commonImgAttributes:{...t,role:c||(u?"img":"presentation")},v9AllStyles:l,dataTid:m,ariaLabel:p,size:i?.size,narrateProfilePicture:g}):(0,a.Y)(Q,{hexagonal:!!d,presenceUserId:e,presenceSource:n||"ups",commonImgAttributes:t,v9AllStyles:l,size:i?.size,avatarRef:r,role:c??"presentation",isFocusable:u,dataTid:m}):(0,a.Y)(N,{...i,variables:{...i?.variables,...o},ref:r})},_=(e,n,i,t)=>e?{children:(r,l)=>{const o=t?{size:t}:{};return(0,a.Y)(U.Fd,{userId:e,ProvidedStatus:r,presenceSource:n,isPresencePrefetched:i,...l,...o})}}:void 0,H=(e,n)=>{const i={};return"boolean"==typeof e&&(i["aria-hidden"]=!e),n&&(i["aria-label"]=n),i},J=(e,n)=>{n||(e.preventDefault(),e.stopPropagation())},q=async(e,n,i,a,t,r,l,o)=>{!e&&n&&i&&a&&!(0,A.FL)(a)&&t===T.It.User&&(o||r?.id!==a)&&await l.chat.chatWithUsers({userIds:[a],entityCommand:{stateTransition:y.Ar.new,visibilityState:y.Rp.show,correlation:{source:F.p.Avatar}}})},X=(e,n,i)=>({...(e===T.It.Team||i)&&{isTeamProfilePicture:!0},...n&&{hasCursorPointer:!0}}),K=e=>{e.avatarState.isError?e.isOnline&&e.avatarState.shouldReload?e.setAvatarState({...e.avatarState,isError:!1,shouldReload:!1}):e.logger.debug("Avatar onLoad. Returning without triggering state change."):e.setAvatarState({...e.avatarState,isError:!1})},$=(e,n)=>e.avatarState.isError?(e.avatarState.shouldReload?e.setAvatarState({currentUrl:(0,f.Ng)(e.profilePictureType,e.isEmergencyCallTarget),isError:!0,shouldReload:!1}):e.logger.debug("Avatar onError. Returning without triggering state change"),!1):(e.logger.warn("Avatar load failed. Handling onError by setting currentUrl in state to default image."),e.setAvatarState({currentUrl:"",isError:!0,shouldReload:!e.isOnline}),n&&n(),!1),ee=(e,n,i,a,r,l,o,d,s,m)=>{let c=r;if(n&&(!e||!i||!a)&&(c=(0,f.Ng)(l,o),d&&l===T.It.User)){(0,t.isEmpty)(m)&&(m=ne(r));c=`${s}${j.kv.replace("{displayName}",encodeURIComponent(m))}`}return c},ne=e=>{const n=new URLSearchParams(e.slice(e.indexOf("?")));return n.get("displayName")||n.get("displayname")||""},ie=({simpleAvatarType:e,enableFluentV9Avatar:n,onError:i,...t})=>{const l=t["data-tid"];if(n)return(0,a.Y)(w.e,{className:t.v9ClassName,size:(0,f.BY)(t.size),"data-tid":l,...t.label&&{initials:{children:(0,a.Y)(r.Fragment,{children:t.label})}},...t.v9Icon&&{icon:t.v9Icon},...t.name&&{name:t.name},...t.avatarUrl&&{image:{src:t.avatarUrl,...i?{onError:i}:{}}}});{const{variables:e}=t;return(0,a.Y)(I.e,{variables:e,size:t.size,"data-tid":l,...t.label&&{label:{children:(0,a.Y)(r.Fragment,{children:t.label})}},...t.icon&&{icon:t.icon},...t.name&&{name:t.name},...t.avatarUrl&&{image:{src:t.avatarUrl,...i?{onError:i}:{},...t.variables?{variables:t.variables}:{}}}})}};var ae=i(431117);const te=[T.It.User,T.It.Group,T.It.Team],re=(e,n,i,a,t=T.xi.Small)=>{const{user:r,avatarImageCache:l,coreSettings:o}=(0,s.ur)(),{enableAvatarUrlCacheLookup:d}=(0,k.w2)(g.w.ImageCache,["enableAvatarUrlCacheLookup"]),{enableMSAProfilePicture:m}=(0,k.w2)(g.w.People,["enableMSAProfilePicture"]),c=(0,f.L9)(e,n),{entity:u}=(0,f.WF)(e,n);if(!d||!l||r?.id===c)return null;const p=(0,f.EO)(c,i,e?.groupId||e?.teamThreadId,m,a||!1,void 0,void 0,void 0,u,o);if(!te.includes(p))return null;const N=[t];if(u&&(e=>"id"in e&&!!e.id)(u))N.push("user"),N.push(u.id),N.push(u.displayName),N.push(u.imageUri);else if(u&&(e=>Array.isArray(e))(u)&&u.length>1)N.push("group"),N.push(u.map((e=>`${e.id}-${e.displayName}`)).slice(0,j.kk).join("-"));else{if(!u||!(e=>"groupId"in e&&!!e.groupId)(u))return null;N.push("team"),N.push(u.groupId),N.push(u.displayName),N.push(u.pictureETag)}const v=N.filter(Boolean).join("-"),I=l?.getUrl(v);return{cacheKey:v,cachedUrl:I}};var le=i(213991);const oe={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"msaProfileAvatarChangedEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isSelfProfileAvatar"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaProfileAvatarChangedEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"isSelfProfileAvatar"},value:{kind:"Variable",name:{kind:"Name",value:"isSelfProfileAvatar"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"updateType"}},{kind:"Field",name:{kind:"Name",value:"updatedTime"}}]}}]}}]},de=({simpleAvatarType:e,avatarUrl:n,isMeetingChat:i,...r})=>{const{vars:l}=(0,v.W)();if(e)return(0,a.Y)(B,{simpleAvatarType:e,avatarUrl:n||"",profilePictureType:T.It.Simple,...r});if(i){const e=Array.isArray(r.variables)?r.variables:[];return(0,a.Y)(I.e,{icon:(0,a.Y)(N.zJo,{}),variables:l("search",(0,t.merge)(["meetingChatAvatar"],e))})}return(0,a.Y)(se,{avatarUrl:n,...r})},se=({users:e,team:n,profilePictureSize:i,isEmergencyCallTarget:a,requesterObjectId:t,baseImageUrl:r,skipAvatarQuery:l,avatarUrl:o,onError:m,...c})=>{const u=(0,d.U)("AvatarContainer"),{user:p,scenarioFactory:k}=(0,s.ur)(),g=(0,f.L9)(n,e),N=p?.id===g,{baseUrlFromHook:v,isCookieValid:I,client:S}=pe(),T=ke(),{isAnonymousAccount:M,currentUserObjectId:h}=ge(),y=t||h,{entity:F,generator:b}=(0,f.WF)(n,e),C=r||v,D=(e=>{const n=(0,d.U)("MsaProfileAvatarSubscription"),{data:i,loading:a,error:t}=(0,le.R)(oe,{skip:!e,variables:{isSelfProfileAvatar:e}});return(t||!a&&!i&&e)&&n.error("msa profile avatar subscription failed"),i?.msaProfileAvatarChangedEvent})(N&&T.enableMsaSelfProfileAvatarUpdateSubscription);o=Ne(!!g,o,y,i,n,e);const U=ue(a?null:o||e?.[0]?.avatarUrl,i,!!g&&(0,A.AF)(g),!n&&!g&&!!c.conversationId,T.enableCacheCheckOnAvatarUrlFromCaller,I),{cacheKey:E,cachedUrl:w}=re(n,e,c.conversationId,c.showMergedAvatarForGroup,i)||{},L=l||!!U||!!w;L&&u.debug(`Skipping generating avatar URL. skipAvatarQuery: ${l}, propsAvatarUrl: ${U}, cachedUrl: ${w}, callerInfo: ${c.callerInfo}`);const x=me(c),O=(0,ae.g)({avatarEtag:(0,f.Dm)(D,p,g),baseImageUrl:C,client:S,currentUserOid:y,entity:F,generator:b,isAnonymousAccount:M,isEmergencyCallTarget:a,isImageAuthCookieValid:I,logger:u,profilePictureSize:i,scenarioFactory:k,teamId:n?.groupId||n?.teamThreadId,userId:g,skipGeneratingUrl:L,...T,...x},c.callerInfo),P=U||w||O,V=(0,f.X3)(P),{onError:j}=ce({callerInfo:c.callerInfo,skipGeneratingUrl:L,propsAvatarUrl:U,cachedUrl:w,generatedUrl:O,baseImageUrl:C,isCookieValid:I,generator:b,isSelfProfileAvatar:N,forSharedChannel:!!x.isSharedChannel,isXtapUserUrl:V,logger:u,scenarioFactory:k,onErrorFromProps:m});return ve({generator:b,entity:F,userId:g,conversationId:x.conversationId,hostTenantId:x.hostTenantId,avatarUrl:P,draggable:!1,isBotAvatar:(0,f.Ch)(g?e?.[0]:void 0),cacheKey:E,isXtapUserUrl:V,isEmergencyCallTarget:a,onError:j,...c})},me=e=>{const{conversationId:n,showMergedAvatarForGroup:i,showUpdatedGroupAvatar:a,onBehalfOfId:t,hostTenantId:r,isSharedChannel:l}=e;return{conversationId:n,showMergedAvatarForGroup:i,showUpdatedGroupAvatar:a,onBehalfOfId:t,hostTenantId:r,isSharedChannel:l}},ce=({callerInfo:e,skipGeneratingUrl:n,propsAvatarUrl:i,cachedUrl:a,generatedUrl:t,baseImageUrl:l,isCookieValid:o,generator:d,isSelfProfileAvatar:s,forSharedChannel:m,isXtapUserUrl:c,logger:u,scenarioFactory:p,onErrorFromProps:k})=>{const g=ke(),N=r.useMemo((()=>({callerInfo:e,skipGeneratingUrl:n,propsAvatarUrl:i,cachedUrl:a,generatedUrl:t,baseImageUrl:l,isCookieValid:o,profilePictureType:d.profilePictureType,isSelfProfileAvatar:s,forSharedChannel:m,isXtapUserUrl:c,logger:u,scenarioFactory:p})),[l,a,t,d.profilePictureType,o,s,c,u,m,i,e,p,n]),v=r.useMemo((()=>((e,n,i)=>n||(e?()=>{(0,f.Qc)(i)}:void 0))(g.enableFBSTelemetryForAvatarStatus,k,N)),[g.enableFBSTelemetryForAvatarStatus,N,k]);return{onErrorArgs:N,onError:v}},ue=(e,n,i,a,t,l)=>{const o=(0,f.eB)(e,n,i),d=t&&!l&&!!o,s=d?(0,f.UI)(o,i,a):o,[m,c]=r.useState(s),u=r.useRef(!1);return r.useEffect((()=>(u.current=!0,d&&s!==o?(0,f.iU)(o).then((e=>{const n=e?o:s;u.current&&c(n)})):c(o),()=>{u.current=!1})),[d,s,o]),d?m:o},pe=()=>({baseUrlFromHook:(0,m.bE)(),isCookieValid:(0,m.XF)(),client:(0,S.m)()}),ke=()=>{const{enableMSAProfilePicture:e,enableMsaSelfProfileAvatarUpdateSubscription:n,enableCachedAvatarCheck:i,enableProfilePicturesWithObjectId:a,enableSampleAvatarFetch:t,enableAvatarUrlQuery:r,enableFBSTelemetryForAvatarStatus:l,enableCacheCheckOnAvatarUrlFromCaller:o}=(0,k.w2)(g.w.People,["enableMSAProfilePicture","enableMsaSelfProfileAvatarUpdateSubscription","enableCachedAvatarCheck","enableProfilePicturesWithObjectId","enableSampleAvatarFetch","enableAvatarUrlQuery","enableFBSTelemetryForAvatarStatus","enableCacheCheckOnAvatarUrlFromCaller"]),{enableConnectorsProfileInChannels:d}=(0,k.w2)(g.w.Extensibility,["enableConnectorsProfileInChannels"]),{customViewBots:s}=(0,k.w2)(g.w.Calling,["customViewBots"]),{enableEntityMoreInfo:m}=(0,k.w2)(g.w.Core,["enableEntityMoreInfo"]),c=!!(s&&s.length>0);return{enableCachedAvatarCheck:!!i,enableConnectorsProfileInChannels:!!d,enableMSAProfilePicture:!!e,enableFBSTelemetryForAvatarStatus:!!l,isProfilePictureWithObjectIdEnabled:!!a,enableSampleAvatarFetch:!!t,enableAvatarUrlQuery:!!r,customViewBots:s||[],enableMsaSelfProfileAvatarUpdateSubscription:!!n,enableCacheCheckOnAvatarUrlFromCaller:!!o,enableEntityMoreInfo:!!m,isCustomViewBots:c,customViewBotIds:c?s[0]:{}}},ge=()=>{const{authenticationUser:e}=(0,s.ur)(),n=e?.type===c.aS.Anonymous,i=e?.type===c.aS.Msa||e?.type===c.aS.MsaLife,a=e?.id;return{isAnonymousAccount:n,isTflUser:i,currentUserObjectId:a}},Ne=(e,n,i,a,t,r)=>{const l=(0,u.PO)(),o=(0,m.bE)(),{user:d}=(0,s.ur)(),{displayName:c,entity:p,generator:k}=(0,f.WF)(t,r),g=(0,f.xG)(!!e,l,n,c),N=p?.id===d?.id,v=ke();return g?k.generateUrl(p,o,v.isProfilePictureWithObjectIdEnabled,i,a,!1,void 0,void 0,void 0,void 0,void 0,N):n},ve=({avatarUrl:e,generator:n,hidePersonaCard:i,isEmergencyCallTarget:t,isFocusable:d,role:s,shouldAllowContextMenu:m,userId:c,isDoubleClickDisabled:u,statusSize:k,isSharedChannel:g,conversationId:N,hostTenantId:v,draggable:I,connectorSenderGuid:S,onBehalfOfId:A,displayName:T,isBotAvatar:M,square:h,cacheKey:y,showPresence:F,entity:b,isXtapUserUrl:C,...D})=>{const U=r.useMemo((()=>(0,l.v4)()),[]),E=ke(),{isTflUser:w}=ge(),L=(0,f.C0)(c,F,n,b),x=(0,a.Y)(B,{accessibilityLabel:D.accessibilityLabel,presenceUserId:L,profilePictureType:n.profilePictureType,role:s||(d?"button":"presentation"),shouldAllowContextMenu:m,isEmergencyCallTarget:t,isFocusable:d,hexagonal:!h&&M&&!(0,f.uC)(c,E.customViewBotIds),square:h,userId:c,isDoubleClickDisabled:M&&w||u,statusSize:k,avatarUrl:e,draggable:I,isSharedChannel:g,isXtapUserUrl:C,hidePersonaCard:i,cacheKey:y,displayName:T,...D}),O=i||E.enableEntityMoreInfo||!c?x:(0,a.Y)(p.FN,{userId:c,isSharedChannel:g,hostConversationId:N,hostTenantId:v,disableAccessibilityDefaults:!0,externalAppSessionCorrelationId:U,displayName:T,callerInfo:D.callerInfo,"data-tid":"avatar",children:x},c);return i||!c||!(0,f.oG)(c)&&M?!i&&c&&M?(0,a.Y)(o.by,{botIdOrAppId:c,connectorSenderGuid:S,conversationId:N,onBehalfOfId:A,displayName:T,renderTriggerAsLink:!1,nonFocusableTrigger:!0,children:x},c):x:O}},895207:(e,n,i)=>{"use strict";i.d(n,{uk:()=>a,r8:()=>S,rO:()=>f});var a,t=i(513432),r=i(127066),l=i(332752),o=i(491722),d=i(50467),s=i(881360),m=i(619761),c=i(55265),u=i(30728),p=i(46377),k=i(364819),g=i(355552),N=i(554186),v=i(242362),I=i(802756);!function(e){e.InitialConfig="config",e.ReConfig="reconfig"}(a||(a={}));const S=(e,n)=>{if(e.bots?.[0]?.configuration){if(n===g.jr.Team)return A(e)?e.bots[0].configuration.team:null;if(n===g.jr.GroupChat)return T(e)?e.bots[0].configuration.groupChat:null}return null},A=e=>null!==e.bots?.[0]?.configuration?.team?.fetchTask,T=e=>null!==e.bots?.[0]?.configuration?.groupChat?.fetchTask,f=()=>{const{enableBotConfiguration:e}=(0,r.w2)(l.w.Extensibility,["enableBotConfiguration"]),{scenarioFactory:n}=(0,d.ur)(),i=(0,s.U)("BotConfigLauncher"),a=t.useContext(m.I18nContext),{entityCommanding:o}=(0,d.ur)(),c=(0,v.U)();return t.useCallback(((t,r,l,d)=>{const s=n.newScenario(I.Cu.ExtBotConfig),m=S(l,r);m&&e&&(s.appendEventData({configEntryPoint:d}),M(l,m,t,a,i,o,r,c,s))}),[e,i,o,c,a,n])},M=async(e,n,i,a,t,r,l,o,d)=>{const s=h(e,i,a,n);if(n&&s)try{const n=(0,N.v4)();r.platform.launchTaskModule(n,{taskModuleOptions:{input:s,launchContext:l===g.jr.GroupChat?{type:c.Y.chat,parentMessageId:o.replyChainId,...o,chatId:i,launchId:n}:{type:c.Y.channel,channelId:o.channelId,parentMessageId:o.replyChainId,teamId:i,launchId:n}}}).subscribe({complete:()=>{t.log(`task module complete for entrypoint ${s.entryPoint}`),d.stop({"App.Id":e.id,"Bot.Id":e.bots?.[0].id})},error:n=>{const i=`error launching task module for entry point ${s.entryPoint}. errorCode: ${n.ErrorCode}, errorName: ${n.name}, innerErrorCode: ${n.innerError?.code}`;t.error(`${i} Error:`,n),d.fail({"App.Id":e.id,"Bot.Id":e.bots?.[0].id,errors:i})}})}catch(n){t.log("error","Error while launching task module",n),d.fail({"App.Id":e.id,"Bot.Id":e.bots?.[0].id,errors:"Error in launching task module with bot config entry point"})}},h=(e,n,i,a)=>({appName:e.name||"",appIcon:e.largeImageUrl||"",appId:e.id,isFullScreenApp:e.isFullScreenApp||!1,isFullTrustApp:e.isFullTrustApp||!1,validDomains:e.validDomains||[],tenantId:e.tenantId||"",entryPoint:u.t7.BotConfig,botInvokeParams:{threadId:n,botMri:(0,k.first)(e.bots)?.id?`${p.gN.BotPrefix}${(0,k.first)(e.bots)?.id}`:""},fetchTask:a.fetchTask||!1,taskInfo:(0,o.Jm)(i,a.taskInfo)??{},isMicrosoftOwned:e.isMicrosoftOwned||!1,externalId:e.externalId||""})},646306:(e,n,i)=>{"use strict";i.d(n,{i8:()=>g,T$:()=>k});var a=i(957032),t=i(513432),r=i(234221),l=i(626388),o=i(139150),d=i(568834),s=i(553882);const m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"call"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"call"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonCallUpdateFragment"}}]}}]}},...i(617276).k.definitions]};var c=i(960128),u=i(364819);const[p,k]=(0,r.V)("CallDataProviderContext"),g=e=>{const n=(0,o.m)(),{teamsCallId:i,children:r}=e,[k,g]=t.useMemo((()=>i?((e,n)=>{const i=new s.t(n),a=e.subscribe(i);return[i,()=>a.unsubscribe()]})(n.watchQuery({query:m,variables:{id:i}}),(()=>{const e=(0,c.H)(i,n);return e?{loading:!1,error:void 0,networkStatus:l.p.ready,data:{call:e}}:{loading:!0,error:void 0,networkStatus:l.p.ready,data:{call:null}}})()):[new d.c((e=>e.complete())),u.noop]),[n,i]);return t.useEffect((()=>()=>g()),[g]),(0,a.Y)(p,{source$:k,children:r})}},194118:(e,n,i)=>{"use strict";i.d(n,{G:()=>k,Z:()=>g});var a=i(513432),t=i(646306),r=i(432720),l=i(188468),o=i(364819),d=i(127066),s=i(332752),m=i(422816),c=i(109604),u=i(37868),p=i(225558);function k(e,n){const i=(0,u.F)(e),p=a.useCallback((({loading:e,errors:n,data:a})=>({loading:e,error:n&&n.length>0&&new m.K({graphQLErrors:n})||void 0,data:a?.call&&{call:(0,o.pick)(a.call,i)}||void 0})),[i]),k=a.useCallback((e=>e.pipe((0,r.T)(p),(0,l.F)(((e,n)=>e.loading===n.loading&&(0,o.isEqual)(e.data?.call,n.data?.call)&&(0,c.a)(e.error,n.error))))),[p]),{doNotRestartObservableOnErrors:g}=(0,d.w2)(s.w.Calling,["doNotRestartObservableOnErrors"]),[N]=(0,t.T$)(k,n,p,!g&&void 0);return!N&&n?{data:void 0,loading:!1,error:void 0}:N??{data:void 0,loading:!0,error:void 0}}const g=(e,n,i)=>{const{data:t,complete:r}=(0,p.I)({fragmentName:n,fragment:e,from:{__typename:"Call",id:i}});return a.useMemo((()=>({data:r?{call:t}:null,error:void 0,complete:r})),[t,r])}},256556:(e,n,i)=>{"use strict";i.d(n,{i:()=>r,q:()=>o});var a=i(957032),t=i(513432);const r=({channelData:e,children:n,isLoadingData:i})=>{const r=t.useMemo((()=>({channelType:e?.channelType,displayName:e?.displayName,id:e?.id,createdAt:e?.createdAt,description:e?.description,isGeneral:e?.isGeneral,isArchived:e?.isArchived,isDeleted:e?.isDeleted,isUserMember:e?.isUserMember,isUserMuted:e?.isUserMuted,isShown:e?.isShown,isChannelExternallyShared:e?.isChannelExternallyShared,isLie:e?.isLie,realThreadId:e?.realThreadId,parentTeamId:e?.parentTeamId,isSharedWithParentTeam:e?.isSharedWithParentTeam,isCreationFailed:e?.isCreationFailed,substrateGroupId:e?.substrateGroupId,hostTeamId:e?.hostTeamId,hostTenantId:e?.hostTenantId,hostTeamGroupId:e?.hostTeamGroupId,memberRole:e?.memberRole,membershipSummary:e?.membershipSummary,sensitivityLabel:e?.sensitivityLabel,owningTeam:e?.owningTeam,sharepointSiteUrl:e?.sharepointSiteUrl,spaceAdminSettings:e?.spaceAdminSettings,moderation:e?.moderation,isSubCommunity:!(!e?.hostTeamId||!e?.id)&&e.hostTeamId!==e.id,ifConvUxChannel:e?.ifConvUxChannel})),[e?.channelType,e?.displayName,e?.id,e?.createdAt,e?.description,e?.isGeneral,e?.isArchived,e?.isDeleted,e?.isUserMember,e?.isUserMuted,e?.isChannelExternallyShared,e?.isLie,e?.realThreadId,e?.parentTeamId,e?.isSharedWithParentTeam,e?.isCreationFailed,e?.substrateGroupId,e?.hostTeamId,e?.hostTenantId,e?.hostTeamGroupId,e?.memberRole,e?.membershipSummary,e?.sensitivityLabel,e?.owningTeam,e?.sharepointSiteUrl,e?.spaceAdminSettings,e?.moderation,e?.ifConvUxChannel,e?.isShown]);return(0,a.Y)(l.Provider,{value:i?void 0:r,children:n})},l=t.createContext(void 0),o=()=>t.useContext(l)},358970:(e,n,i)=>{"use strict";i.d(n,{ab:()=>k,SX:()=>g,IN:()=>N,eh:()=>v,Qz:()=>I,Ur:()=>S});var a=i(957032),t=i(513432),r=i(432720),l=i(188468),o=i(997870),d=i(408650);const{useCallback:s,useEffect:m,useMemo:c,useRef:u,useState:p}=t,k=e=>{const{layoutPhaseStateMachineRef:n}=(0,d.yf)(),i=n.current,a=u(i),[t,s]=p(i.currentPhase>=e),k=c((()=>a.current.currentPhaseObservable.pipe((0,r.T)((n=>n>=e)),(0,l.F)())),[e,a]),g=(0,o.J)(k,{next:t?()=>t:s},!0);return m((()=>()=>g()),[g]),t&&g(),a.current===i||t?t||a.current.currentPhase>=e||i.currentPhase>=e:(s(!0),!0)},g=e=>{const{layoutPhaseStateMachineRef:n}=(0,d.yf)();return s((()=>n.current.currentPhase>=e),[n,e])},N=()=>{const{reportFirstPaintCallbackRef:e}=(0,d.yf)();e.current()},v=({component:e,fallback:n,minimumAppPhase:i})=>t=>k(i)?(0,a.Y)(e,{...t}):n?(0,a.Y)(n,{}):null,I=()=>{const{useAppPhasePostCriticalOnEveryPhaseCycle:e}=(0,d.yf)();return e()},S=()=>{const{useAppPhaseCompleteOnEveryPhaseCycle:e}=(0,d.yf)();return e()}},877568:(e,n,i)=>{"use strict";i.d(n,{u:()=>d,C:()=>s});var a=i(957032),t=i(364819),r=i(513432),l=i(37868);const o=r.createContext(void 0),d=e=>{const{children:n,...i}=e,r={...i,activeWindowService:i.activeWindowsService.getWindowLayoutService(i.windowId),context:{hostCommunicationService:i.hostCommunicationService}};return(0,a.Y)(o.Provider,{value:(0,l.F)(r,t.isEqual),children:n})},s=()=>r.useContext(o)},312999:(e,n,i)=>{"use strict";i.d(n,{wT:()=>m,g6:()=>c});var a=i(957032),t=i(513432),r=i(37868);const{createContext:l,memo:o,useContext:d}=t,s=l({UNSAFE_overflowAndFlipBoundaryRef:null});s.displayName="UNSAFE_OverflowAndFlipBoundaryContext";const m=o((e=>{const{children:n,...i}=e;return(0,a.Y)(s.Provider,{value:(0,r.F)(i),children:n})}));m.displayName="UNSAFE_OverflowAndFlipBoundaryContextProvider";const c=()=>d(s)},408650:(e,n,i)=>{"use strict";i.d(n,{Sz:()=>m,yf:()=>c});var a=i(957032),t=i(513432),r=i(37868);const{createContext:l,memo:o,useContext:d}=t,s=l(void 0),m=o((({children:e,...n})=>(0,a.Y)(s.Provider,{value:(0,r.F)(n),children:e}))),c=()=>d(s)},725797:(e,n,i)=>{"use strict";i.d(n,{ex:()=>s,At:()=>m,l3:()=>c});var a=i(957032),t=i(364819),r=i(513432),l=i(37868);const{memo:o}=r,d=r.createContext(void 0),s=o((({children:e,commandReportingCallbacks:n,doesChildViewEntityMatch:i=(()=>!1),UNSAFE_doesMainViewEntityMatch:r=(()=>!1),...o})=>(0,a.Y)(d.Provider,{value:(0,l.F)({...o,...n,doesChildViewEntityMatch:i,UNSAFE_doesMainViewEntityMatch:r},t.isEqual),children:e}))),m=(d.Consumer,()=>r.useContext(d)),c=e=>function(n){const i=m();return(0,a.Y)(e,{...{...n,viewContext:i}})}},752433:(e,n,i)=>{"use strict";i.d(n,{X4:()=>l,z2:()=>o});var a=i(957032),t=i(513432);const r=t.createContext({}),l=t.memo((({children:e,setCoreThemeType:n,themeType:i,themeOptions:l})=>{const o=t.useMemo((()=>({setCoreThemeType:n,themeType:i,themeOptions:l})),[n,i,l]);return(0,a.Y)(r.Provider,{value:o,children:e})})),o=()=>t.useContext(r)},410541:(e,n,i)=>{"use strict";i.d(n,{YE:()=>d,jK:()=>k,ns:()=>g,KB:()=>c,zc:()=>S,nb:()=>I,hC:()=>p,XQ:()=>u});var a=i(554186),t=i(863344),r=i(332752),l=i(931981);const o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsCortexTopicsSdkAuthenticationAcquireTokenQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}},{kind:"Argument",name:{kind:"Name",value:"acquireTokenOptions"},value:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"}}]}}]}}]},d="https://substrate.office.com",s=new Map,m=6e4;function c(e){return(0,t.KB)(e)}async function u(e,n,i,a,t){const r=c(i);return r?(await g(n,i,a,r),e(r)):t?t():void 0}function p(e,n,i,a,t){const r=c(i);return r?(g(n,i,a,r),e(r)):t?t():void 0}function k(e,n){const i=(0,a.v4)();return async(a,t)=>{const r=v(e,n);if(s.has(r)){const e=s.get(r);e?.token&&a(e.token,i)}else t("No token in Reference",i)}}async function g(e,n,i,a){const{enableSilentLokiAuthTokenRetrieval:t,lokiTokenResourceUrl:o}=i.get(r.w.People),{enableCallKMApiDirectly:s}=i.get(r.w.Messaging),m=N(e,n,o||l.rs,t,a),c=s?N(e,n,d,t,a):Promise.resolve();return Promise.all([m,c]).then((()=>{}))}async function N(e,n,i,a,t){let r;const l={resourceUrl:i};t||(t=c(n));const d=s.get(v(i,n));if(d){if(Date.now()-d.lastRefreshTime<m)return}t&&(r=t.createQosEvent("Cortex.TopicAnnotations.RenewToken.Execute"));try{let t;if(e){const{data:d}=await e.query({query:o,variables:{resource:i,acquireTokenOptions:{silent:a}},fetchPolicy:"network-only"});t={token:d?.authenticationToken?.token,lastRefreshTime:Date.now()},t.token?(s.set(v(i,n),{token:t.token,lastRefreshTime:t.lastRefreshTime}),r?.logSuccess(l)):r?.logUnexpectedFailure("NoTokenReceived",void 0,l)}else r?.logUnexpectedFailure("NoApolloClient",void 0,l)}catch(e){r?.logUnexpectedFailure("ErrorThrowRetrievingToken",e,l)}}function v(e,n){return`${e}_${n.userAadObjectId??""}_${n.tenantAadObjectId??""}`}function I(e,n,i,a){const{enableCortexTopicsAuthRefactor:t}=i.get(r.w.Messaging),l=c(n);return t&&a?p(e,a,n,i):l?e(l):void 0}async function S(e,n,i,a){const{enableCortexTopicsAuthRefactor:t}=i.get(r.w.Messaging),l=c(n);return t&&a?u(e,a,n,i):l?e(l):void 0}},431324:(e,n,i)=>{"use strict";i.d(n,{q0:()=>c,KZ:()=>u,Kb:()=>p});var a=i(513432),t=i(127066),r=i(332752),l=i(3120),o=i(763588),d=i(533622);const{useCallback:s,useMemo:m}=a,c=({userId:e,displayName:n,personaType:i,hostConversationId:a,ariaLabel:c,tabIndex:u})=>{const{enableEntityMoreInfo:p}=(0,t.w2)(r.w.Core,["enableEntityMoreInfo"]),k=(0,o.useNovaEventing)(),g=s(((e,{userId:n,ariaLabel:i,tabIndex:a,displayName:t,personaType:r,hostConversationId:o})=>{if(n){const{left:d,top:s,width:m,height:c}=e.target.getBoundingClientRect();k.bubble({event:l.AZ.requestPersonMoreInfo({eventType:e.type,height:c,left:d,top:s,width:m,userId:n,displayName:t,personaType:r,hostConversationId:o,ariaLabel:i,tabIndex:a}),reactEvent:e})}}),[k]),N=s((t=>{p&&g(t,{userId:e,ariaLabel:c,tabIndex:u,displayName:n,personaType:i,hostConversationId:a})}),[p,g,e,c,u,n,i,a]),v=(0,d.l)(N,500),I=s((t=>{v.cancel(),p&&g(t,{userId:e,ariaLabel:c,tabIndex:u,displayName:n,personaType:i,hostConversationId:a})}),[p,v,g,e,c,u,n,i,a]),S=s((i=>{!p||"Enter"!==i.key&&" "!==i.key||g(i,{userId:e,ariaLabel:c,tabIndex:u,displayName:n})}),[p,g,e,c,u,n]),A=s((e=>{v.cancel()}),[v]);return m((()=>({onClick:I,onKeyDown:S,onMouseEnter:v,onMouseLeave:A})),[I,S,v,A])},u=({userId:e,displayName:n,ariaLabel:i,tabIndex:a})=>{const{enableEntityMoreInfo:d}=(0,t.w2)(r.w.Core,["enableEntityMoreInfo"]),c=(0,o.useNovaEventing)(),u=s(((e,{userId:n,ariaLabel:i,tabIndex:a,displayName:t})=>{if(n){const{left:r,top:o,width:d,height:s}=e.target.getBoundingClientRect();c.bubble({event:l.AZ.requestPersonMoreOrgInfo({eventType:e.type,height:s,left:r,top:o,width:d,userId:n,displayName:t,ariaLabel:i,tabIndex:a}),reactEvent:e})}}),[c]),p=s((t=>{d&&u(t,{userId:e,ariaLabel:i,tabIndex:a,displayName:n})}),[d,u,e,i,a,n]),k=s((t=>{!d||"Enter"!==t.key&&" "!==t.key||u(t,{userId:e,ariaLabel:i,tabIndex:a,displayName:n})}),[d,u,e,i,a,n]);return m((()=>({onClick:p,onKeyDown:k})),[p,k])},p=({userId:e,ariaLabel:n,tabIndex:i,topicId:a})=>{const{enableEntityMoreInfo:d}=(0,t.w2)(r.w.Core,["enableEntityMoreInfo"]),c=(0,o.useNovaEventing)(),u=s(((e,{userId:n,ariaLabel:i,tabIndex:a,topicId:t})=>{if(n){const{left:r,top:o,width:d,height:s}=e.target.getBoundingClientRect();c.bubble({event:l.AZ.requestTopicMoreInfo({eventType:e.type,height:s,left:r,top:o,width:d,userId:n,ariaLabel:i,tabIndex:a,topicId:t}),reactEvent:e})}}),[c]),p=s((t=>d?u(t,{userId:e,ariaLabel:n,tabIndex:i,topicId:a}):void 0),[d,u,e,n,i,a]),k=s((t=>{!d||"Enter"!==t.key&&" "!==t.key||u(t,{userId:e,ariaLabel:n,tabIndex:i,topicId:a})}),[d,u,e,n,i,a]),g=s((t=>d?u(t,{userId:e,ariaLabel:n,tabIndex:i,topicId:a}):void 0),[d,u,e,n,i,a]);return m((()=>({onClick:p,onKeyDown:k,onMouseEnter:g})),[p,k,g])}},482362:(e,n,i)=>{"use strict";i.d(n,{t:()=>d});var a=i(957032),t=i(513432),r=i(50467),l=i(355515);class o extends t.PureComponent{constructor(e){super(e),this.render=()=>{const{children:e,fallbackUI:n=null}=this.props,{error:i}=this.state;return i?"function"==typeof n?n(i,this.resetError.bind(this)):n:e},this.handleError=(e,n)=>{if((0,l.XC)(e))throw e;const{errorHandler:i,onErrorCallback:a,scenarios:t,rethrowError:r,loggerName:o}=this.props;if(a&&a(e),i){if(i(e,n),r)throw e;return}let d="";try{d=JSON.stringify(e)}catch(n){d=`Failed to stringify error: ${e}`}if(t?.forEach((e=>{e.fail({reason:`Error in ${o}: ${d}`})})),this.logger.error(`error: \n    ${d}\n    componentStack: \n    ${n.componentStack}`),r)throw e};const{loggerName:n,newLogger:i}=this.props;this.state={error:null},this.logger=i(n,"components-error-boundary")}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,n){this.logger.error(`Error message: ${e?.message}.`),this.handleError(e,n)}resetError(){this.setState({error:null})}}const d=e=>(0,a.Y)(o,{...e,newLogger:(0,r.ur)().loggerFactory.newLogger})},959515:(e,n,i)=>{"use strict";i.d(n,{A:()=>T});var a=i(957032),t=i(513432),r=i(959022),l=i(50467),o=i(127066),d=i(332752),s=i(935197);const m=e=>{const{hexagonal:n,...i}=e;if(n){const e=(e,n)=>{const{"aria-label":t,src:r,...l}=n;return(0,a.Y)("svg",{viewBox:"0 0 34 34",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"100%",children:[(0,a.Y)("title",{children:i.name||l.alt||""}),(0,a.Y)("rect",{fill:"transparent",clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px"}),(0,a.Y)(e,{as:"image",clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px",xlinkHref:r,"aria-label":t||i.name||l.alt||"",...l})]})};return(0,a.Y)(s.e,{...i,image:{..."object"==typeof i.image&&i.image,children:e}})}return(0,a.Y)(s.e,{...i})};var c=i(792529),u=i(526521),p=i(881360),k=i(802756),g=i(691457),N=i(139150),v=i(607002);const I=(0,i(965804).O)({transparent:{sj55zd:"f44pa96",De3pzq:"f3rmtva",Bic5iru:"f1pspie5"}}),S=({alt:e,badge:n,name:i,size:r,src:o,className:d,setShouldFallbackToDefault:s,setBlobUrl:m,enableFetchApiForBotAvatar:S,setError:A,error:T})=>{const f=I(),M=(0,N.m)(),h=(0,p.U)("custom-avatar-v9"),{scenarioFactory:y}=(0,l.ur)();let F=y.findScenario(k.Cu.ExtBotAvatar);F||(F=y.newScenario(k.Cu.ExtBotAvatar),F.appendEventData({"App.Name":i}));const b=(e,n)=>{F?.mark(k.BQ.ExtBotAvatarFetchApi,{errors:n??""},e),"failure"===e&&(h.errorToTelemetry?.("CustomAvatarV9:: bot avatar did not load properly, rendering fallback","platform_bot_avatar_error"),s&&s(!0),A&&A(!0))};return(0,a.Y)(t.Fragment,{children:(0,a.Y)(c.e,{badge:n,className:(0,u.z)(f.transparent,d),icon:{children:()=>(0,a.Y)("svg",{viewBox:"0 0 34 34",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"100%","aria-label":e,children:[(0,a.Y)("title",{children:""}),(0,a.Y)("rect",{fill:"transparent",clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px"}),(0,a.Y)("image",{clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px",xlinkHref:o})]})},initials:null,name:i,size:r,onError:async()=>{try{if(S)if(o&&(0,v.D$)(o)){const e=await(0,g.z)(M,o,"Url",!0);if(e.result?.blob)m&&m(e.result.blob),b("success");else{b("failure",`CustomAvatarV9:: amsDownload did not return a blob for app: ${i}`)}}else{b("failure",`CustomAvatarV9:: non-AMS image did not load properly for app: ${i}`)}else s&&s(!0)}catch(e){b("failure",`CustomAvatarv9:: Failed to load bot avatar for app: ${i}`)}},onLoad:()=>{T?F?.fail():F?.stop()}})})},A=(0,a.Y)("svg",{xmlns:"http://w3.org/2000/svg",style:{width:0,height:0,position:"absolute"},children:(0,a.Y)("defs",{role:"presentation",children:(0,a.Y)("clipPath",{id:"bot-hexagon-clip-path",children:(0,a.Y)("path",{d:"M23.93,2H10.07C9,2,8.01,2.57,7.47,3.5l-6.92,12c-0.54,0.93-0.54,2.07,0,3l6.93,12c0.54,0.93,1.53,1.5,2.6,1.5h13.85c1.07,0,2.06-0.57,2.6-1.5l6.93-12c0.54-0.93,0.54-2.07,0-3l-6.93-12C25.99,2.57,25,2,23.93,2z"})})})}),T=e=>{const{host:n}=(0,l.ur)(),{enableFluentV9Avatar:i}=(0,o.w2)(d.w.People,["enableFluentV9Avatar"]),{enableFetchApiForBotAvatar:s}=(0,o.w2)(d.w.Extensibility,["enableFetchApiForBotAvatar"]),c=(e=>{const n="bot-hexagon-clip-path-container";let i=e.document.body.querySelector(`[id='${n}']`);return i||(i=e.document.createElement("div"),i.id=n,e.document.body.insertBefore(i,e.document.body.childNodes[0])),i})(n),[u,p]=t.useState(!1),[k,g]=t.useState(""),[N,v]=t.useState(!1);return t.useEffect((()=>{c.hasChildNodes()||r.render(A,c)}),[c]),i?(0,a.Y)(S,{src:k&&s?k:u?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAYAAAB5fY51AAAABGdBTUEAALGPC/xhBQAAIGhJREFUeAHtnQl4VuWZhj8IJCxhDZAERGQT12rVuuCCgChWQVu7zkwvO52pV2eKgKJtHTdwA3cExNmns9aZ6bRVtC6I+9YZF1wAQXErJiEJW9gCBJj3OeFUCX/Iv5z35Lzne97raiNZzv9+9/N8z/+d85+lw+iFq/c6FgmQAAkYINDRQI9skQRIgAQCAgwsGoEESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanabrS4qIO7acIAN6KsuO1fTvFvYPyzhAN4sNJFgIGVEj0xOW8/v9yNH1Hq5k2u9Da0EFYY/znCATwYWikx+L5hMLBSoCcm5RyZnCcP7haMpleXIi9DKwwrjB8FHuDC0ApwpOL/GFjGZewsCs6eWO5O2RdW4XB8C62WYRVyABfwASeWfQKU0bCGzWFV4U49tHll1XIovoRWa2EV8gCf2RMrGFohEMNfGVhGxeskyt0mk/C0IZnDKhxW2kOrrbAKOYATeIEbyy4BymdQuyCszit3o9sIq3BoaQ2tbMMq5ABetwk3hlZIxN5XBpYxzTDZbpVJd/ph3XPqPG2hlWtYhbDADfwYWiERW18ZWIb0KhK1bjm33J2RY1iFQ0xLaOUbViEH8ANH8GTZIkDJjOgVhtWZQ3NbWbUcnvXQKjSsQh7gyNAKadj5ysAyoBXC6uYJ5e6sAsMqHKrV0IoqrEIO4AmuXGmFRJL/lYGVcI1wdcmscwa4McMKW1m1HKa10Io6rEIe4Aq+vIonJJLsrwysBOsThJVcEzd2eKlKl2FoDendWWX7UW0U/eFyG/SrUeCLaw8ZWhp0o90mAytanpFtDZNnpmJYhY1+tH6nW7ulKfxnIr+iP/SpWQgt8GZoaVIufNsMrMIZRr6FjhJWN8huyjillVXY8NKq7W7GozWusWlv+K1EfkV/6BP9ahZ4gzv4s5JJgIGVMF0wWW4cPyC424Bma29XN7qrDIRVyAChhX7Rt2bhLg/gz9DSpJz/thlY+bOL/C8xSa4fJ2E1UueYVdjwOzWNsmKpdtsTvrIK+w2/ol/0jf41C/yhA0NLk3J+22Zg5cct8r/CXsh14/q7cw/XD6srH6l223YlezewNcDoG/1rhxZ0gB7cO2xNifb5PgOrfbjv96phWJ13eI/9vh/1P96VlYnlsAp5hKGF8WgW9GBoaRLOfdsMrNyZRfoXCKtr5Z184ijdsFq2ttFdYXhl1RI6Qgvjwbg0C7pAH660NClnv20GVvasIv9NTIJrxvZ35yuH1fIgrGrM7ga2Br45tGocxqdZ0Ac6MbQ0KWe3bQZWdpxUfguT4IIjdFdWK2ob3fRHatzWnXtUxtDeG8W4ML4VtTtUW4FO0IvVvgQYWO3E/2dn91MPq/fqdrjpi9IbVqF0QWgtqnYYr2YhtKAbq/0IMLDagf1Px/Rzk47sqfrKK4OwqnZbUrqyagkP45wuoYVxaxZ0g36s9iHAwIqZ+0/E7JOP0g2rVTJpp8nk3bwjnbuBrUmG8WLcGL9mQT/oyIqfAAMrRuZXn9XPXaQdVvU73FQPwyqUEaGF8a8SDpoFHaEnK14CDKyYeM84s5+7+GjdldX7MkmnPezfyqqlhMFKSziAh2ZBT+jKio8AAysG1leeUea+foxuWH2wTlZWMkkbPNsNbE0+cAAPcNEs6Ap9WfEQYGApc75CzHzJsb1UX2X1up0MqwyEw9ACH82CvtCZpU+AgaXIePrpZe4bymH1YRBWVW5To18H2LOVDVymPlzlwEmzoDP0ZukSYGAp8Z0m5v3ml3RXVh/KTe0ul8m4kWF1UBXB5/JFElrKNwGE3lNHM7QOKkaBP2RgFQgw059fPrqv+5ZyWOEOnAyrTPQzf2/jdgktCXftO5d++7heDvqzdAgwsCLmOuW0vu47x/WOeKv7b+7jDQiraodJyMqeQHNoVTvw0yzoDx+woifAwIqQ6Y/FpN89XjesPkFYPVTtNmzfHWHn/mwK3MAPHDULPoAfWNESYGBFxPMvTu3r/iiGsJoik209w6og1cAPK1Tt0IIf4AtWdAQYWBGw/NEpfd2ffFl3ZfXpxubdQIZVBILJJtZtaw4tcNUs+AL+YEVDgIFVIMfLTu7jvneCblj9fuOuYDcGk4wVHYEgtGTFCr6aBX/AJ6zCCTCwCmD4QzHhpSfqGnHNpl1uiny6Vc+wKkCp1v8UXMEXnDULPoFfWIURYGDlye/Pv9LHfT+OsHpIwmorV1Z5ypTVn4HvFOGsHVrwC3zDyp8AAysPdj84qY/7U/mfZn3WgN3AKlfHsNLE/IdtgzN4g7tmwTfwDys/AgysHLn94KTe7s+U3yWrZNJM+U2Vq2VY5ahOYb8O3uAO/poF/8BHrNwJMLByYPb9ExFWup/4VCOs5EAwwyoHYSL81SC0hD900Cz4CH5i5UaAgZUlr0vlk54fnqwbVjWbd7kfy2RZu6Upy674axoEwB86QA/Ngp/gK1b2BBhYWbD6npxLc5nyuTQMqyyEiPFX4got+Ar+YmVHgIHVBqfgxD/ls5VrNjcFu4H4ykoOgbh0+ZH4S/vE4+RQLawTBtZB+P3x8b3UL63AOznuIlDNsDqIEu33I+gCfbR303EJD/zGOjgBBlYrfL4rtwn5y9N0721Ui7CSj9KrGriyakWGRHwb+kAn6KVZ8Bt8x2qdAAMrA5vviGmmKN+IrU7Mj5MVP2NYZVAged+CTtALumkWfAf/sTITYGC14PJtufHe5dphtRWfQjGsWqBP/D+D0JLdwzrRT7PgP/iQdSABBtYXmHzz2J5uqvJ9uWF2rqy+AN3Yf67ZtG+lpRxa8CH8yNqfAANrH49viDmmn6H7jLl6MTluHgfTs+wSgH7QEXpqFvwIX7I+J8DAEhaXyLPlrlAOq3XbxORy07jfK98V4HNp+V+aBKAj9ISumgVfwp+sZgLeB1bwIEzlp/euF1PjcptPle+7RFPHSwB6BneAVQ6tK8WfX1N+ani85PJ/Na8DCybQfmovwyp/c1r4y7hCa8aZZQwtMYS3gXXRUT0cTNChQwe1ebFh3214P+HKSo1xEjYMfbF7CL21Cj6FX+Fbn8vLwJosol99Vj/dsAoedFAlj5TSvYDWZ/MmaezQGWfEaz7NCKEF38K/vpZ3gTXpyB7uJ8phtXFfWH3EsPJqXkFvhBb01yqEFvwLH/tYXgXWhUf0cD8do7uyag6rannCMFdWPk4o6I7dQ+3Qgo/hZ9/Km8D66qhS97OzdcNqU+NuN1XM+qE8Rp7lLwHoP21RtYMftAorLfgZvvapvAgsiHrN2P6qx6waxJzTJKxWM6x8mj+tjvWDdRJa4gf4QqsQWvC1T6GV+sCaeHhzWHUUcbUKppwq76jvi0lZJBASgB/gC83Qgq8RWvC5D5XqwDpPRLx2XH+nGlY7ZGWFsKpnWPkwYXIdI3wBfzSIT7QK/obP4fe0V2oD69yRpe465bDaLCacLmZcxbBK+zwpaHzwB3wCv2gVQgt+h+/TXKkMrAkxhtXKOq6s0jxBohobfBJXaMH/aa2iwRdMm5mmwY0f0d3dMH6AK+qod8xqy449Yr4a957BsCoSLIN7d3bDy4qD/3Uv7uia9ux1jU17E2uD3l07uqF9i90R/Utcv+5FrrMMAhokt+PMKOvlTPjX1jS68cNLXXEnHX9ipXXmYd3cp3JxdhpPrekweuFqa7pndoN8d/zw7u7Gc2IIq0eq3YraHa32kcQfHFNeElyLNlrM3LOk6IAWV9btcE+v3up+9e4mt21X+1uiW+cO7uvH9HLjRNNRElQtC8eEXv54m/v1sgb37lpbWhw5oMTNvbDSlZbo7eDsljehWU/VuiWiaZoqNYE1Vow9U8Kqk+LKautOrKyq3XJDYdWna5G7Ss6MPntY96x8i0tLHnh1vXv0vc1Z/b7GL10gJ0TioQzoPZt69sOt7q7n61Uvi8mmj1x+5yiE1qRKhxWuVmHlPFNC65kUhVYqdgkxGWdN0A+rK2VltcxQWI2U3b75Fw10x5R3yXpOdO3c0Z05tLvr263I/e7TbbHudmF3dYaE62XygFH0kW0d1qfYjR9R6t74bLtbr3hZTLb9ZPN7dVt3uzertssKUnYPMXCFwu7hWaIlrnNMyzWt5gNrzNBu7qZzy9VXVggrS7seg3p2cg98baAr69Ypr6mA3RascF7+ZFtef5/PH2ElmO99n0plpYLdR6y2NsvxLQtVG1NojZE39I/khOY03DUk+7exBDrg9CESVhN0w2rbrj1uxqO2wgqLk9vPr3A9u2S3S9WatBfL/cImx3SRLV4Hr1dIYbwYdw6Ls0JeLpK/xZsg/AWfaRUOk2CeYL5YL7OBNbRPZzcTu4FKy2kIG4TVIzXunRpbB3UvObZX8KlaFObEU4k1j7OgR2wfrxNF4dNEjN9SwV8zxGeqoSXzBPMF88ZymQ0sXI7QTfGtdLu84131aI17u6bRlL44HnLpCb0j67mXrFq0n97yLXnQAl4nqsL4tY4LRdVjy+3AZ/AbfKdVmC+YN5bLZGCdemhXd3QOB5JzFQimmSHmeavaVlhhnCcO6lrwrmBLXjhvSLNw4DnKwq4hOFgr+E07tDBvMH+slsnAGpvlR/T5iNIoYXX1b22GFcY7ekj0ZhwmnzaWl+Z38L4tDbBdbD/q0uAQdY+ZtrdUQgv+gw+1SnP+aPUcbtdkYB1XGf2kBJAwrN6ssreyCgUd1FPnGMVA+dRRo7S2q8VBg0HLbcJ/mqGlNX9ajkPj3yYDC5dnRF07mmRl9ViNe8NwWIFJmQKbYLtyXpZGlSltF+eRWS74EH6EL6MujfkTdY+tbc9kYGlcOIKT7EqKTOLYT9sdStcEWtvuzt0aLtkPtfo/4Ef4MuqyTMbkDK3bEv3TdnFB7W0Ty91phg9Iwtj1cjKiRuHCXY1S264SBw0GmbYJH84WP8KXUZfG/Im6x9a2ZzKwcGBSo/BR+G0TK0x/irKqPvpzxrBa+Vjp1s/YrsZqaKUCBw3PZdomPsWDDzXCCq+nNX8yjSXq75kMLNxVQKsQWrPFLCcP1jmwr9V3uN3nP4r+UprX12x325V2NbFdbD/qekGBQ9Q9ZtreKeI7+E/zPLIlH2zJ9NImvmcysF4Tgy+VC0e1CmaZI8vxkw+xF1p4YsvytdGuQB9e0aCFOthu1NtfJuO3+OQi+A27gZphhXnz+mfR+kPVHC02bjKwMIbZz9ap3nK2pFNHN+f8cvcVg6F1/yvrW8ic/z/fkTOwNVZtX+wI28frRFULIxx/VD21tR34DH6D77QKt2jGvLFcenSUqazZ1OSue7JW5fhH2DrMc7uY6CRjoYVjFL98Z1M4jLy/4v5fc2IyOF4Hr1doYdzWjtHAX/CZZljhOCHmC+aN5TIbWICOXcNrHq9RD607xEwnDMr+nlJJMMS8l9YF97PKt5ddYvAbF9fGdh8l3K8Jr4fXzbdw/y6M21LBV/CXdlhhnmC+WC/z98PCO8Yqub3vWLkeTes+7rg9xzi5HOhd2W2p3mzjHQrT/qnVW4Ib8eFe6LkU7jqKa9pelxvixVlr5D7kb8jxldPlNs653MAPPT60vMHNWlLrCsi7OIcavNYJA7u4O79a4booXsSPN4C/krB69dN4tdSCaT6wACYILXmUEq6RUgstORCPG8ThWEuNldCS1HpJbsCH+7WPkOv12rrlMG6p+9Dyze562XVor5u9rZVz7B5buSUIrJH9its8cRI3ppv9TJ178K1Nbm/+izOt+dXqdr8sYXVXHGH1xFr3SkrCCjBTc093DAY3KLv1PJ2T7bB9lNU7OeBW98fLJMEtc3E/8X7dO0kodHDr5YTQqoYmeQfeJgfXtzrcujcp1V8uM0K/px7azeGaQ1xus10ekFG/tSm4rz76XSqXsEjOmqrjKru4uy+oyHkVmcsgsbK6VsIKb1hpqlQFFoQ5Q3YnbsUtk2VFpFVWQ0uLB7ebPYE4wqoJYfXkWveiPFUobWX6oHsmMSDSdSIWRNMqHF+5S94hv1Rh60C8Fg9uNzsC8At8k+vxuey23vxb8D38n8awwghTF1gY1AsSWtcv1g0t3L3x7gsr3LEVuR3QRn8s/wjAJ/CL5l1yEVbwPfyf1kplYEEsnIx4ozyTDQeStSoIrQsq5TFaDC0txmnYLvxxt/hENazE5/C79km+7a1HagMLYPHIJ5zboxlaeIDCPfIU36MZWu3t5US+PnwBf2g+yAP+hs/h97RXqgML4kFEPP1WO7TuFVPi0zcWCYQE4Af4Qjus4G8fwgpcUx9YGCQe1X2TiLpbcfcQpoQ58QBSFgnAB9phBT/D12l6FH1bzvEisABhiYRWcCa0YmiVlnR0cyW0cj2zvC2R+HNbBKA/fAA/aBXCCn6Gr30qPaIJpLjkg63u5qfrVFdaQWhNqpDQiv5JMAlEypZaEIDuc0V/7bCCj+Fn38qrwIK4i9/f4m4RsfcoXsfRo6RITFvpRjG0vJpP0Bu6Q3+tgm/hX/jYx/IusCDykzGG1uFyPRwr/QSgc1xhBf/6Wl4GFsR+YtUWd6vySqunvNPeJ++4uIiXlV4C0Bc6Q2+twsoKfoVvfS5vAwuiPy7i40p/zd1DPDZ9npgZd0tgpY8AdIW+0Fmr4E/4FH71vbwOLIj/W7mVCcywV/GYVhBakyvd8L4MrTRNOOg5T3TVDCv4Ev6ET1menIfVltAww5xn61VDqxdWWmLuYQyttuQw8XPoCD2hq1YhrOBLhtXnhL1fYYUoHnlvs7v9Od3Q6t21yM0Xkw/t2zl8WX41SAD6Iaygp1YhrOBH+JL1OQEG1ucs3KIVm90dz8cRWgPd0D4MrS+gN/Of0G3+5IFt3r21kAEhrOBD+JG1PwEG1v483MNyi+A7lUMLtyqG6Q9jaLWgn+x/Qq84wgr+gw9ZBxJgYB3IJLiv+d0v6D59pY/c7he7h0N6c6WVQYLEfQs6QS/oplVYWcF3uK8+KzMBBlZmLu7XyxrEPPWt/DSab/ft1sktuKjSHcrQigao0lagD3SCXpp1z4vrAt9pvob1bTOwDqLgr95tcPcwtA5CKP0/ii2sxGfwG+vgBBhYB+fj/kdMdO+LuiutMnnnxu7G4F7cPWxDjlh/DD2gC/TRLPgLPmO1TYCB1TYjeex7g7vvJd3QwmO35stuxyG9dCdHFsPlrwgB6AA9oItmwVfwFys7Agys7Di5/3q7Qf0x6P1lciyQTw8HyTP4WO1HAPyhA/TQrHkvrQt8pfkaads2AysHRf/z7U1u/su6nx72L+3k7r+IoZWDLJH+KsIK/KGDZsFH8BMrNwIMrNx4BY9EXxBDaC1gaOWoTOG/HqysYggr+OfBtxhW+SjGwMqD2i/EbAtf0V1pDZB3+PkyefCIdpY+AXAGb3DXLPgG/mHlR4CBlR839+9LN7kHXl2f519n92flCC05llLZQ3cSZddNen8LfMEZvDULfoFvWPkTYGDlz87925sb3d/8Tje0KmQy4aRFfGVFTyAuvvAJ/MIqjAADqzB+7l/e2Oj+Vj205ExrOR9IewVQIApzfw6e4FrRQ/f8N/gDPmEVToCBVThD989ixr/7X92VVmXPzvLpFUMrArmCTSCswBNcNQu+gD9Y0RBgYEXD0f389Y3uH/5PP7Swezigu94FuBHhSPRmwA8ctcMKfoAvWNERYGBFx9L942sIrQ0RbvHATQ2UFcGCi3FSI0PrQDptfwfcwA8cNQs+gB9Y0RJgYEXLU0y6wf2T/E+zBiG0cL4QQysnzEFYCTfw0yzoDx+woifAwIqeqft7eXf9+eu6hj1ELsxFaPVjaGWlIDiBF7hpFnSH/iwdAgwsHa5yEH6DfDKka9wgtOT8oX6KN5VTwhPrZsEH1wZqhxX0hu4sPQIMLD22co7WBvevyp8QDcadMOUAchlDK6OS4AI+4KRZ0Bl6s3QJMLB0+bq/juGEwUN7Fwf3beqr+BQXZUwqmwcP3M8KfDQLJ4RCZ5Y+AQaWPuPgEp7/WKr7idGQPsXBR/UMrWZBwQGnLoCLZkFX7Uu0NPu3tm0GVkyK3f/KeveLGEILuz94Ko/PFTyVKIawgp7QlRUfAQZWfKzdAjH3g2/prrQOkxUFdoN6d/VTWowb4wcHzYKO0JMVLwE/XR0v4/1ebf7L6+Uuk7pX7A+Vx6jj7gO9u/glL8aLcWP8mgX9oCMrfgJ+OTp+vhlf8T65Ne5/K4fWMM9CKwwrjFuzoBv0Y7UPAQZW+3B3c8X0v3xHd6U1rKzYzZMVR6+Ur7QwPowT49Us6AXdWO1HgIHVfuzl8WHr5Fl0uqE1PAitStezJJ1SY1zz5JgVxqlZ0Al6sdqXQDpd3L5Mc3p1PJpc+wGaI8pKgkmdttAKwwrj0yzoA51Y7U+AgdX+GshkqHe/Wab7bLqR/UrcfbIS6ZGSlRbGgfFgXJoFXaAPKxkEGFjJ0MHd+Xy9e2i5bmgdLpN73iT7oYWwwjgwHs2CHtCFlRwCDKzkaOHueK7ePawdWv1lpWU4tIKVFcJKxqFZ0AF6sJJFgIGVLD3c7TJJFq3QXWmNksl+74WVrrTYlvzoF32jf80Cf+jASh4BW45NHj+VjuY8W+8efW+zyrbDjR45oMTNnVThuhsJLfSJftG3ZoE7+LOSSYCBlUxd3Oxn6mIIrS5u7oUVrrioQ0IpNLeF/tDnkQO6qPaJsAJ3VnIJMLASqs1e6QuT57GVuiutpdWNbuduvFpyC/29WdWo2iA4g3eySagiMLFxBlaCZcLkufXpOve4Umjh1ihW7jawEE9NVnoQKfiCM8MqwZNhX2sMrIRrhEl0i0ymJ1ZFu9KyFFahRBqhBa7gy7AKKSf7KwMr2foE3YWh9eSqLZF0azGswoFHGVrgybAKydr4ysCyoZPbI6l189O17qn3Cwsty2EVShVFaIEjeIIryw4BBpYdrYLJNWuJhNYH+YVWGsIqlKuQ0AI/cGRYhTTtfGVg2dEq6BST7Kanat3Tq3MLrTSFVShZPqEFbuDHsAop2vrKwLKlV9AtzkKYubjWPZNlaKUxrELZcgkt8AK3hJ/FEQ6NXzMQYGBlgGLhW5h0N8rke/bDrQdtN81hFQ48m9ACJ/BiWIXUbH5lYNnULegak++GxWvdc62Elg9hFcp3sNACH3BiWIW07H5lYNnVLuh89x7nrpfJ+PxH+6+0cJKllZNCo5IgU2iBC/iAE8s+AQaWfQ2DyXjdk2vdC/tCC2GFyetjfTG0wANcGFbpcUKH0QtXy44FKw0EOsnbz4SRpXL9YW6fIKZh7C3HcP6oUrdYzrVq4sqqJRrT/2ZgmZaPzZOAXwS4S+iX3hwtCZgmwMAyLR+bJwG/CDCw/NKboyUB0wQYWKblY/Mk4BcBBpZfenO0JGCaAAPLtHxsngT8IsDA8ktvjpYETBNgYJmWj82TgF8EGFh+6c3RkoBpAgws0/KxeRLwiwADyy+9OVoSME2AgWVaPjZPAn4RYGD5pTdHSwKmCTCwTMvH5knALwIMLL/05mhJwDQBBpZp+dg8CfhFgIHll94cLQmYJsDAMi0fmycBvwgwsPzSm6MlAdMEGFim5WPzJOAXAQaWX3pztCRgmgADy7R8bJ4E/CLAwPJLb46WBEwTYGCZlo/Nk4BfBBhYfunN0ZKAaQIMLNPysXkS8IsAA8svvTlaEjBNgIFlWj42TwJ+EWBg+aU3R0sCpgkwsEzLx+ZJwC8CDCy/9OZoScA0AQaWafnYPAn4RYCB5ZfeHC0JmCbAwDItH5snAb8IMLD80pujJQHTBBhYpuVj8yTgFwEGll96c7QkYJoAA8u0fGyeBPwiwMDyS2+OlgRME2BgmZaPzZOAXwQYWH7pzdGSgGkCDCzT8rF5EvCLAAPLL705WhIwTYCBZVo+Nk8CfhFgYPmlN0dLAqYJMLBMy8fmScAvAgwsv/TmaEnANAEGlmn52DwJ+EWAgeWX3hwtCZgmwMAyLR+bJwG/CDCw/NKboyUB0wQYWKblY/Mk4BcBBpZfenO0JGCaAAPLtHxsngT8IsDA8ktvjpYETBNgYJmWj82TgF8EGFh+6c3RkoBpAgws0/KxeRLwiwADyy+9OVoSME2AgWVaPjZPAn4RYGD5pTdHSwKmCTCwTMvH5knALwIMLL/05mhJwDQBBpZp+dg8CfhFgIHll94cLQmYJsDAMi0fmycBvwgwsPzSm6MlAdMEGFim5WPzJOAXAQaWX3pztCRgmgADy7R8bJ4E/CLAwPJLb46WBEwTYGCZlo/Nk4BfBP4fdKKKT3sfOPsAAAAASUVORK5CYII=":e.commonImgAttributes?.src,alt:e.commonImgAttributes?.alt,badge:e.badgeProps,size:"number"==typeof e.size?e.size:void 0,setShouldFallbackToDefault:p,setBlobUrl:g,enableFetchApiForBotAvatar:!!s,error:N,setError:v,...e}):(0,a.Y)(m,{hexagonal:!0,...e})}},931981:(e,n,i)=>{"use strict";i.d(n,{rs:()=>o,Y:()=>l,Py:()=>d});var a=i(554186),t=i(478522);const r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationToken"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}},{kind:"Argument",name:{kind:"Name",value:"acquireTokenOptions"},value:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"}}]}}]}}]},l=(e,n)=>{if("df"===n)return"Df";if("msit"===n)return"Msit";switch(e){case t.B.prod:case t.B.life:return"Prod";case t.B.gcc:return"GccModerate";case t.B.gcchigh:return"GccHigh";case t.B.dod:return"DoD";case t.B.ag08:return"AG08";case t.B.ag09:return"AG09";case t.B.gallatin:return"Gallatin";default:return"Unknown"}},o="https://unknownregion.loki.delve.office.com",d=(e,n,i)=>{const t=(0,a.v4)();return async(a,l)=>{try{let o;e.current?o=(await e.current.query({query:r,variables:{resource:n,acquireTokenOptions:{silent:i}},fetchPolicy:"network-only"})).data?.authenticationToken?.token:l("Error no apollo client to retrieve token",t),o?a(o,t):l("No auth token found",t)}catch{l("Error retrieving auth token",t)}}}},996750:(e,n,i)=>{"use strict";i.d(n,{CA:()=>u,uw:()=>p});var a=i(957032),t=i(513432),r=i(880139),l=i(509336);const o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"lpcState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lpcState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLivePersonaCardInitialized"}},{kind:"Field",name:{kind:"Name",value:"lastLoggedInUserMri"}}]}}]}}]};var d=i(37868),s=i(364819);const m=t.createContext({IsLivePersonaCardInitialized:!1,LastLoggedInUserMri:void 0}),c=e=>{const n={IsLivePersonaCardInitialized:e.IsLivePersonaCardInitialized,LastLoggedInUserMri:e.LastLoggedInUserMri};return(0,a.Y)(m.Provider,{value:(0,d.F)(n,s.isEqual),children:e.children})},u=(0,l.W)((e=>(0,a.Y)(r.X,{query:o,children:({data:n,loading:i,error:t})=>{const r=!i&&!t&&!!n&&!!n.lpcState&&n.lpcState.isLivePersonaCardInitialized;return(0,a.Y)(c,{children:e.children,IsLivePersonaCardInitialized:r,LastLoggedInUserMri:n?.lpcState.lastLoggedInUserMri})}}))),p=()=>t.useContext(m)},234221:(e,n,i)=>{"use strict";i.d(n,{V:()=>N,j:()=>A});var a=i(957032),t=i(364819),r=i(513432),l=i(100365),o=i(553882),d=i(879462),s=i(773587),m=i(188468),c=i(109604),u=i(432720);const p=e=>n=>n.pipe((0,u.T)((n=>e?(0,t.pick)(n,e):n)),(0,d.p)((e=>!(0,t.isEmpty)(e))));var k=i(997870),g=i(37868);const N=(e,n=l.w)=>{const i=r.createContext(n);return i.displayName=e,[v(i),I(i),S(i)]},v=({Provider:e})=>({source$:n,children:i})=>(0,a.Y)(e,{value:n,children:i}),I=e=>(n,i=!1,a,d=!0)=>{(0,t.isBoolean)(n)&&(d=i,i=n,n=void 0);const s=r.useContext(e),m=r.useRef(l.w),c=r.useMemo((()=>n?s.pipe(n):s),[s,n]),u=r.useRef(),p=r.useRef(!1),[g,N]=r.useState(!1),v=r.useCallback((e=>{const n=e.getValue();return void 0!==n&&a?a(n):n}),[a]);if(m.current!==s&&s instanceof o.t)try{p.current=!0,u.current=v(s),m.current=s}catch(e){return}const I=r.useCallback((e=>{if(p.current&&(p.current=!1,s instanceof o.t)){const e=v(s);if((0,t.isEqual)(e,u.current))return}u.current!==e&&(u.current=e,N((e=>!e)))}),[v,s]),S=i?t.noop:I,A=(0,k.J)(c,{next:S},d);return[i?void 0:u.current,A]},S=e=>()=>r.useContext(e),A=e=>(n,i,a=!1)=>{const l=(0,g.F)(n),o=r.useRef(),u=r.useCallback((e=>a?e.pipe(p(l),(0,d.p)((e=>!(0,t.isEqual)(e,o.current))),(0,s.M)((e=>{o.current=e}))):e.pipe(p(l),(0,m.F)(c.a))),[l,a]),[k]=e(u);return k||i}},100318:(e,n,i)=>{"use strict";i.d(n,{FN:()=>T});var a=i(957032),t=i(513432),r=i(364819),l=i(194118),o=i(358970),d=i(50467),s=i(881360),m=i(440320),c=i(332752),u=i(772783),p=i(410541),k=i(897604),g=i(482362),N=i(996750),v=i(139150);const I=(0,i(965804).O)({defaultPersona:{mc9l5x:"fau6ura",Bqenvij:"f3052tw"}});var S=i(877997);const A=e=>{const n=(0,o.ab)(u.Jj.POST_CRITICAL),i=(0,N.uw)(),A=(0,v.m)(),{host:{LivePersonaCardHoverTargetV2:T},coreSettings:f}=(0,d.ur)(),M=((e,n,i,a)=>{const[r,o]=t.useState(!0),d=t.useRef(!1),{userId:s,hostConversationId:m,hostTenantId:c,isSharedChannel:u}=e,{data:p}=(0,l.G)(["meetingDetails","meetingRole"]),k=!!p?.call?.meetingDetails?.meetingCapability?.maskIdentitiesForRole,g=p?.call?.meetingRole??"";return t.useEffect((()=>(d.current=!0,(async()=>{const e=await(0,S.Os)(s,k,g,!!u,m,c,n,i,a);d.current&&o(e)})(),()=>{d.current=!1})),[i,n,a,s,k,g,m,c,u]),r})(e,f,A,(0,s.U)("PersonaInner")),h=(e=>{const{host:n,userBiService:i,coreSettings:a,authenticationUser:r}=(0,d.ur)(),l=(0,s.U)("PersonaRenderer"),o=(0,v.m)(),{topicId:u,personaType:g}=e,N=t.useCallback((()=>{n.document.dispatchEvent(new MouseEvent("mousemove"))}),[n]),{ariaLabel:I,behavior:A,disableAccessibilityDefaults:T,externalAppSessionCorrelationId:f,hostConversationId:M,hostTenantId:h,isSharedChannel:y,tabIndex:F,userId:b,displayName:C,module:D,source:U,highlightedText:E}=e,w=t.useCallback((async()=>{if(n.document.addEventListener("mouseleave",N),"Topic"===g&&u){const e=(0,p.KB)({userAadObjectId:r?.profile.objectId,tenantAadObjectId:r?.profile.tenantId});e?.logEvent(k.P.TopicCardOpen,{topicId:u,module:D??"",source:U??""})}const e=await(0,S.Dh)(b,i,o),a={panelRegion:m.rP.popover,panelType:m.HP.LivePersonaCard,dataBag:e};i.recordPanelView(a,l)}),[r,n,N,l,i,o,u,g,D,U,b]),L=t.useCallback((()=>{n.document.removeEventListener("mouseleave",N);const e={actionGesture:m.Od.mouseleave,actionOutcome:m.nd.closePanel,actionScenarioType:m.DB.people,actionScenario:m.vB.closePanel,moduleName:m.Sn.lpcClose,panelRegion:m.rP.popover,panelType:m.HP.LivePersonaCard};i.recordPanelAction(e,l)}),[n,i,l,N]),x=!!a.get(c.w.People).isInIframe,O=t.useMemo((()=>(0,S.wQ)({ariaLabel:I,behavior:A,disableAccessibilityDefaults:T,externalAppSessionCorrelationId:f,hostConversationId:M,hostTenantId:h,isSharedChannel:y,tabIndex:F,userId:b,handleOnCardOpen:w,handleOnCardClose:L,personaType:g,topicId:u,shouldDeferCardOpenToParentWindow:x,displayName:C,module:D,source:U,highlightedText:E})),[I,A,T,f,M,h,y,F,b,w,L,u,g,x,C,D,U,E]);return t.useEffect((()=>()=>{n.document.removeEventListener("mouseleave",N)}),[n,N]),O})(e),{enableEntityMoreInfo:y}=f.get(c.w.Core),{enableFluentV9Avatar:F}=f.get(c.w.People),b=((e,n)=>{const i={"data-tid":n.callerInfo},t=I();return e?(0,a.Y)("div",{className:n.classNames||t.defaultPersona,...i,children:n.children}):n.children})(F,e);return!y&&n&&!(0,r.isEmpty)(e.userId)&&M&&i?.IsLivePersonaCardInitialized&&T?(0,a.Y)(g.t,{fallbackUI:(0,a.Y)(t.Fragment,{children:e.children}),loggerName:"PersonaInner",children:(0,a.Y)(T,{...h,children:b})}):M?(0,a.Y)(t.Fragment,{children:e.children}):(0,a.Y)(t.Fragment,{children:b})},T=t.memo((e=>A(e)))},242362:(e,n,i)=>{"use strict";i.d(n,{U:()=>d,Q:()=>s});var a=i(725797),t=i(942016),r=i(947521),l=i(513432),o=i(508411);const d=()=>{const{entity:e,getEntityOptions:n}=(0,a.At)();return l.useMemo((()=>s(e,n)),[e,n])},s=(e,n)=>{let i={};const a=e&&e.type;switch(a){case t.ck.extensions:i=m(e,n),i={...i,...n(t.ck.extensions,u(e.action))};break;case t.ck.communities:case t.ck.channels:case t.ck.channelextensibilityapppickersidepanel:case t.ck.connectorinstanceconfiguration:i=e.id?{channelId:(0,o.a9)(e)}:{channelId:void 0};break;case t.ck.extensibilityapppickersidepanel:case t.ck.chats:const r=e.id?.split(";replyChainId=")??[],l=r[0],d=r[1];i={chatId:l,channelId:d?l:void 0,replyChainId:d,channelMeetingMessageId:d};break;case t.ck.platformapp:if(e.action===t.SY.config){const e=n(t.ck.platformapp,t.SY.config),a=e?.messageId&&"0"!==e.messageId,r={chatId:e?.convId,channelId:a?e?.convId:void 0,parentMessageId:a?e.messageId:void 0,channelMeetingMessageId:a?e.messageId:void 0,eventId:e?.eventId};i={...i,...r}}else i={...n(t.ck.platformapp,t.SY.create)};break;case t.ck.platformStage:case t.ck.platformstagewithoutchat:case t.ck.platformstagemodal:i=c(a,n);break;case t.ck.yammerqna:const s=n(t.ck.yammerqna,t.SY.view);i={chatId:s?.conversationId,...s}}return i},m=(e,n)=>{if(e.linkedEntity?.id)switch(e.linkedEntity.type){case t.ck.chats:return{chatId:e.linkedEntity.id};case t.ck.communities:case t.ck.channels:case t.ck.extensions:case t.ck.schoolteams:return JSON.parse(e.linkedEntity.id);case t.ck.calls:return function(e){const{options:n}=e;if(!n)return{};const{convId:i,messageId:a}=JSON.parse(n);return function(e){return!!e&&"0"!==e}(a)?{channelId:i,chatId:i,parentMessageId:a,channelMeetingMessageId:a}:{chatId:i}}(e);case t.ck.schedulingform:return function(e,n){if(!e.linkedEntity?.id)return{};const{threadId:i,messageId:a}=e.id&&JSON.parse(e.id)||{},{channelId:r}=e.linkedEntity.id&&JSON.parse(e.linkedEntity.id)||{},{isChannelMeeting:l,messageId:o}=function(e,n){let{isChannelMeeting:i,messageId:a}=n(t.ck.extensions,u(e.action));if(void 0===i){const{options:n}=e;if(n){const{isChannelMeeting:e,backFilledOptions:{messageId:t}}=JSON.parse(n);i=e,a=t}}return{isChannelMeeting:i,messageId:a}}(e,n);return l?{channelId:r,chatId:i,parentMessageId:a??o,channelMeetingMessageId:a??o}:{chatId:i}}(e,n)}return{}},c=(e,n)=>{const i=((e,n)=>e===t.ck.platformStage?n(t.ck.platformStage,t.SY.create):e===t.ck.platformstagewithoutchat?n(t.ck.platformstagewithoutchat,t.SY.view):n(t.ck.platformstagemodal,t.SY.view))(e,n);return i.entryPoint===r.hB.adaptiveCardCollabStage||i.entryPoint===r.hB.adaptiveCardStageModal?i.replyChainId?{channelId:i.channelId??i.convId,replyChainId:i.replyChainId,entityId:i?.entityId,chatId:void 0}:{chatId:i.convId,entityId:i?.entityId}:i.replyChainId||i.channelId?{channelId:i.channelId??i.convId,replyChainId:i.replyChainId,entityId:i.entityId,parentMessageId:i.messageId,channelMeetingMessageId:i.messageId,chatId:i.messageId?i.channelId??i.convId:void 0}:{chatId:i.convId,entityId:i.entityId}};function u(e){return e===t.SY.loading?t.SY.loading:t.SY.view}},346429:(e,n,i)=>{"use strict";i.d(n,{H:()=>c});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"recordAppUsage"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"recordAppUsage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appsUsageFields"}}]}}]}},...i(214919).j.definitions]};var t=i(50467),r=i(881360),l=i(451281),o=i(513432),d=i(802756),s=i(127066),m=i(332752);const c=()=>{const{enableAppUsageRecording:e}=(0,s.w2)(m.w.Extensibility,["enableAppUsageRecording"]),{scenarioFactory:n}=(0,t.ur)(),i=(0,r.U)("useRecordAppUsage"),[c]=(0,l.n)(a);return o.useCallback((async(a,t)=>{if(!e)return;const r=n.newScenario(d.Cu.ExtRecordAppUsage);try{await c({variables:{appId:a}}),r.appendEventData({"App.Id":a,"App.EntryPoint":t}),r.stop()}catch(e){r.fail({"App.Id":a,"App.EntryPoint":t,errors:JSON.stringify(e),message:"Failed to record app usage."}),i.error("Failed to record app usage.")}}),[e,i,c,n])}},525448:(e,n,i)=>{"use strict";i.d(n,{Fd:()=>V,CD:()=>E,kR:()=>O,xQ:()=>L,qI:()=>x});var a=i(957032),t=i(513432),r=i(139150),l=i(213991),o=i(545154),d=i(83596),s=i(727572),m=i(31698);const c="Disabled",u={InAConferenceCall:{backgroundImage:m.Y.OnThePhone,title:"status_inACall"},InACall:{backgroundImage:m.Y.OnThePhone,title:"status_inACall"},Presenting:{backgroundImage:m.Y.DoNotDisturb,title:"status_presenting"},OffWork:{backgroundImage:m.Y.Offline,title:"status_offline"},InAMeeting:{backgroundImage:m.Y.Busy,title:"status_inAMeeting"},Available:{backgroundImage:m.Y.Online,title:"status_online"},Inactive:{backgroundImage:m.Y.Away,title:"status_away"},Busy:{backgroundImage:m.Y.Busy,title:"status_busy"},DoNotDisturb:{backgroundImage:m.Y.DoNotDisturb,title:"status_doNotDisturb"},BeRightBack:{backgroundImage:m.Y.BeRightBack,title:"status_beRightBack"},Away:{backgroundImage:m.Y.Away,title:"status_away"},OutOfOffice:{backgroundImage:m.Y.Away,title:"status_away"},Offline:{backgroundImage:m.Y.Offline,title:"status_offline"},UrgentInterruptionsOnly:{backgroundImage:m.Y.DoNotDisturb,title:"status_doNotDisturb"},PresenceUnknown:{backgroundImage:m.Y.Unknown,title:"status_unknown"},AvailableIdle:{backgroundImage:m.Y.Idle,title:"status_away"},BusyIdle:{backgroundImage:m.Y.Idle,title:"status_away"},OnShift:{backgroundImage:m.Y.OnShift,title:"status_onShift"},OffShift:{backgroundImage:m.Y.OffShift,title:"status_offShift"},[c]:{backgroundImage:m.Y.Disabled,title:"status_disabled"}},p={status_inACall:"inACall",status_presenting:"presenting",status_offline:"offline",status_inAMeeting:"inAMeeting",status_online:"online",status_away:"away",status_Busy:"busy",status_doNotDisturb:"doNotDisturb",status_beRightBack:"beRightBack",status_unknown:"unknown",status_onShift:"onShift",status_offShift:"offShift",status_disabled:"disabled",status_blocked:"blocked"},k={InAConferenceCall:{backgroundImage:m.Y.OnThePhoneOof,title:u.InAConferenceCall.title},InACall:{backgroundImage:m.Y.OnThePhoneOof,title:u.InACall.title},Presenting:{backgroundImage:m.Y.DoNotDisturbOof,title:u.Presenting.title},InAMeeting:{backgroundImage:m.Y.BusyOof,title:u.InAMeeting.title},Busy:{backgroundImage:m.Y.BusyOof,title:u.Busy.title},DoNotDisturb:{backgroundImage:m.Y.DoNotDisturbOof,title:u.DoNotDisturb.title},Available:{backgroundImage:m.Y.OnlineOof,title:u.Available.title}},g=e=>{const{title:n,backgroundImage:i}=e,a={status:"unknown",outOfOffice:!1};switch(n){case"status_online":a.status="available";break;case"status_busy":case"status_inAMeeting":case"status_inACall":a.status="busy";break;case"status_presenting":case"status_doNotDisturb":case"status_focusing":a.status="do-not-disturb";break;case"status_away":case"status_beRightBack":a.status="away";break;case"status_offline":a.status="offline";break;case"out_of_office_title":a.status="out-of-office";break;case"status_blocked":case"status_disabled":a.status="blocked";break;default:a.status="unknown"}switch(i){case m.Y.OutOfOffice:case m.Y.OnThePhoneOof:case m.Y.DoNotDisturbOof:case m.Y.BusyOof:case m.Y.OnlineOof:a.outOfOffice=!0}return a},N=(e,n)=>{switch(e){case"Available":return n.stringTranslate("nova","me_control_presence_activity_available");case"Away":case"Inactive":return n.stringTranslate("nova","me_control_presence_activity_away");case"BeRightBack":return n.stringTranslate("nova","me_control_presence_activity_be_right_back");case"Busy":return n.stringTranslate("nova","me_control_presence_activity_busy");case"DoNotDisturb":case"UrgentInterruptionsOnly":return n.stringTranslate("nova","me_control_presence_activity_do_not_disturb");case"InACall":case"InAConferenceCall":return n.stringTranslate("nova","me_control_presence_activity_in_a_call");case"InAMeeting":return n.stringTranslate("nova","me_control_presence_activity_in_a_meeting");case"Offline":case"OffWork":return n.stringTranslate("nova","me_control_presence_activity_offline");case"PresenceUnknown":default:return n.stringTranslate("nova","me_control_presence_activity_unknown");case"Presenting":return n.stringTranslate("nova","me_control_presence_activity_presenting")}},v=e=>!!e&&["Available","Busy","InAMeeting","InACall","InAConferenceCall","DoNotDisturb","Presenting","UrgentInterruptionsOnly"].includes(e);const I=(0,i(965804).O)({presenceIcon:{t21cq0:["f8zmjen","fjf1xye"],Bz10aip:"fxr4zw7"}}),S=e=>{const n=I(),i=(0,s.PO)(),{status:{backgroundImage:t,title:r,subTitle:l},ProvidedStatus:m,size:c,styles:u,userId:k,variables:N}=e,v=i.stringTranslate("messaging",r),S=l?`${v}, ${i.stringTranslate("messaging",l)}`:v,{status:A,outOfOffice:T}=g(e.status),f={id:`presence-pill-${k}`,title:S,style:{backgroundImage:`url('${t}')`,backgroundColor:o.L.colorNeutralBackground1},styles:u,size:c,variables:N},M=p[r]||"presence";return m?(0,a.Y)(m,{...f,"data-tid":"presence","data-pstatus":M}):(0,a.Y)(d.n,{id:`presence-pill-${k}`,className:n.presenceIcon,outOfOffice:T,status:A,size:"extra-small",title:S,"data-tid":"presence","data-pstatus":M})};var A=i(50467),T=i(772783),f=i(191596),M=i(127066),h=i(332752),y=i(358970);const F={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPresenceFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Presence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"availability"}},{kind:"Field",name:{kind:"Name",value:"activity"}},{kind:"Field",name:{kind:"Name",value:"isOutOfOffice"}},{kind:"Field",name:{kind:"Name",value:"statusNote"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"}},{kind:"Field",name:{kind:"Name",value:"publishTime"}},{kind:"Field",name:{kind:"Name",value:"expiry"}}]}},{kind:"Field",name:{kind:"Name",value:"flwPresence"}},{kind:"Field",name:{kind:"Name",value:"flwShifts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"previousShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}},{kind:"Field",name:{kind:"Name",value:"currentShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}},{kind:"Field",name:{kind:"Name",value:"nextShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isFocus"}},{kind:"Field",name:{kind:"Name",value:"workLocation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"locationSource"}},{kind:"Field",name:{kind:"Name",value:"approximateDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"idType"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isBlocked"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}}]}}]};var b=i(261741),C=i(253070);const D={backgroundImage:m.Y.Unknown,title:"status_unknown"},U={backgroundImage:m.Y.Blocked,title:"status_blocked"},E=(e,n)=>{const i=w(e);if(!n)return i;const a=((e,n,i,a,t)=>a&&!v(e)?t.stringTranslate("nova","me_control_presence_out_of_office"):a&&v(e)?t.stringTranslate("nova","me_control_presence_activity_with_out_of_office",{activity:N(e,t)}):i&&"DoNotDisturb"===n&&"Presenting"!==e?t.stringTranslate("nova","me_control_presence_activity_focusing"):N(e,t))(e?.activity??null,e?.availability??null,e?.isFocus??null,e?.isOutOfOffice??null,n);return{...i,ariaLabel:a}},w=e=>{if(!e)return D;const{isOutOfOffice:n,flwPresence:i,isFocus:a}=e,{isBlocked:t,isDisabled:r}=e;if(r)return u[c];if(t)return U;const l=e.activity,o=e.availability;if(!i||"None"===i)return a&&("DoNotDisturb"===l||!l&&"DoNotDisturb"===o)?(e=>{const n="status_focusing";return e?{backgroundImage:m.Y.FocusingOof,title:n,subTitle:"out_of_office_title"}:{backgroundImage:m.Y.Focusing,title:n}})(n):n?((e,n)=>{const i=e?k[e]:k[n],a="out_of_office_title";return i?{...i,subTitle:a}:{backgroundImage:m.Y.OutOfOffice,title:a}})(l,o):l?u[l]:u[o];if("OffShift"===i)return u.OffShift;if(!l)return"Busy"===o?u[o]:u.OnShift;switch(l){case"InAConferenceCall":case"InACall":case"InAMeeting":case"Presenting":case"Busy":return u[l];default:return u.OnShift}},L=(e,n)=>{const i=(0,r.m)(),a=(0,s.PO)(),[o,d]=t.useState(!0);t.useEffect((()=>{(0,C.unstable_scheduleCallback)(C.unstable_LowPriority,(()=>{d(!1)}))}),[]);const{data:m}=(0,l.R)(f.C,{variables:{userId:e,source:n},skip:o}),{setUserPresence:c}=(0,b.$)(),u=m?.presenceUpdateEvent??((e,n)=>{try{return e.readFragment({id:`Presence:${n}`,fragment:F})??void 0}catch(e){return}})(i,e);return t.useEffect((()=>{c(u)}),[u,c]),E(u,a)},x=(e,n)=>{const i=L(e,n),a=g(i);return a.id=`presence-pill-${e}`,a["aria-label"]=i.ariaLabel,a.title=i.ariaLabel,a},O=(e,n,i,a)=>!(!e||i&&i===a||"status_unknown"!==n.title&&"status_offline"!==n.title),P=e=>{const{userId:n,presenceSource:i}=e,{enableHideOfflinePresenceInTFL:t}=(0,M.w2)(h.w.Presence,["enableHideOfflinePresenceInTFL"]),{user:r}=(0,A.ur)(),l=L(n||"",i||"ups"),{ProvidedStatus:o,...d}=e;return O(!!t,l,n,r?.id)?null:(0,a.Y)(S,{status:{backgroundImage:l.backgroundImage,title:l.title,subTitle:l.subTitle},ProvidedStatus:o,userId:n||"",...d})},V=e=>(0,y.ab)(T.Jj.POST_CRITICAL)?(0,a.Y)(P,{...e}):null},31698:(e,n,i)=>{"use strict";i.d(n,{Y:()=>b});var a=i(118356),t=i.n(a),r=i(567322),l=i.n(r),o=i(870586),d=i.n(o),s=i(78727),m=i.n(s),c=i(791542),u=i.n(c),p=i(152248),k=i.n(p),g=i(444257),N=i.n(g),v=i(952388),I=i.n(v),S=i(834818),A=i.n(S),T=i(604322),f=i.n(T),M=i(603313),h=i.n(M),y=i(960935),F=i.n(y);const b={Online:t(),OnShift:t(),DoNotDisturb:l(),Focusing:l(),Busy:d(),OnThePhone:d(),Away:m(),Idle:m(),BeRightBack:m(),Offline:u(),OffShift:u(),OutOfOffice:k(),Unknown:N(),OnlineOof:I(),BusyOof:A(),OnThePhoneOof:A(),DoNotDisturbOof:f(),FocusingOof:f(),Disabled:h(),Blocked:F()}},261741:(e,n,i)=>{"use strict";i.d(n,{G:()=>l,$:()=>o});var a=i(957032),t=i(513432);const r=t.createContext({userPresence:void 0,setUserPresence:()=>{}}),l=({children:e})=>{const[n,i]=t.useState();return(0,a.Y)(r.Provider,{value:{userPresence:n,setUserPresence:i},children:e})},o=()=>t.useContext(r)},608797:(e,n,i)=>{"use strict";i.d(n,{v9:()=>b,wN:()=>C,Ft:()=>U,My:()=>E,RF:()=>x,Xt:()=>B,m9:()=>z,J9:()=>R,Ff:()=>Q,mU:()=>W,gO:()=>Y,P3:()=>G,bg:()=>Z});var a=i(957032),t=i(513432),r=i(959022),l=i(100365),o=i(568834),d=i(879462),s=i(432720),m=i(878138),c=i(188468),u=i(50467),p=i(997870),k=i(660060),g=i(7800),N=i(364819);const{createContext:v,memo:I,useContext:S,useMemo:A,useState:T,useRef:f,useCallback:M}=t,h={minHeightBreakpoint:k.f0.IS_GREATER_THAN_0,minWidthBreakpoint:k.cw.IS_GREATER_THAN_0,minHeightViewportBreakpoint:k.f0.IS_GREATER_THAN_0,minWidthViewportBreakpoint:k.cw.IS_GREATER_THAN_0},y={responsiveBreakpoints:{...h},responsiveBreakpointsVariables:(0,g.eo)(h)},F=v(y),b=(e,n)=>n?new o.c((i=>{const a=new e.ResizeObserver((([e])=>i.next(e)));return a.observe(n),()=>a.disconnect()})):l.w,C=()=>e=>e.pipe((0,d.p)((e=>e.contentRect.width>0))),D=(e,n,i)=>b(e,n).pipe((0,m.B)(250),((e,n)=>i=>i.pipe(C(),(0,s.T)((i=>(0,g.PY)({height:i.contentRect.height,width:i.contentRect.width,host:e,setWidthCallback:n})))))(e,i),(0,c.F)()),U=I((({children:e,containerRef:n,initialSize:i,setWidthCallback:t})=>{const{host:l}=(0,u.ur)(),[o,d]=T((()=>{const e={minHeightBreakpoint:i?.minHeightBreakpoint??k.f0.IS_GREATER_THAN_0,minWidthBreakpoint:i?.minWidthBreakpoint??k.cw.IS_GREATER_THAN_0,minHeightViewportBreakpoint:l.self.innerHeight??k.f0.IS_GREATER_THAN_0,minWidthViewportBreakpoint:l.self.innerWidth??k.cw.IS_GREATER_THAN_0};return{responsiveBreakpoints:e,responsiveBreakpointsVariables:(0,g.eo)(e)}})),s=A((()=>new Set),[]),m=M((e=>{const n={responsiveBreakpoints:e,responsiveBreakpointsVariables:(0,g.eo)(e)};(0,r.unstable_batchedUpdates)((()=>{d(n),s.forEach((e=>e.next(n)))}))}),[d,s]),c=n.current,v=A((()=>D(l,c,t)),[l,c,t]);(0,p.J)(v,{next:m},!0);const I=f(o);I.current=o;const S=f((e=>{const n={next:(N.noop,i=>{const a=w(e,i);(0,N.isEqual)(a,n.value)||(n.value=a,n.onNext?.(a))}),value:w(e,I.current),unsubscribe:(N.noop,()=>s.delete(n))};return s.add(n),n}));return(0,a.Y)(F.Provider,{value:o,children:(0,a.Y)(L.Provider,{value:S.current,children:e})})})),E=()=>S(F).responsiveBreakpoints,w=(e,n)=>{const i={};for(const a of e)i[a]=a in n.responsiveBreakpoints?n.responsiveBreakpoints[a]:n.responsiveBreakpointsVariables[a];return i},L=v((e=>({next:N.noop,value:w(e,y),unsubscribe:N.noop}))),x=e=>{const n=function(e){const n=t.useRef(e);n.current===e||(0,N.isEqual)(n.current,e)||(n.current=e);return n.current}(e),i=t.useContext(L),a=t.useMemo((()=>i(n)),[i,n]),[r,l]=t.useState(a.value);return a.onNext=l,t.useEffect((()=>()=>a.unsubscribe()),[a]),a.value};const O=["minHeightBreakpoint"],P=["minWidthBreakpoint"],V=["minHeightViewportBreakpoint"],j=["minWidthViewportBreakpoint"],B=()=>x(O),z=()=>x(P),R=({children:e})=>(0,a.Y)(F.Consumer,{children:n=>e(n)}),Q=()=>S(F).responsiveBreakpointsVariables,W=e=>{let n=B();return n=e||n,A((()=>(0,g.Lg)(n)),[n])},Y=e=>{let n=x(V);return n=e||n,A((()=>(0,g.pM)(n)),[n])},G=e=>{let n=z();return n=e||n,A((()=>(0,g.A7)(n)),[n])},Z=e=>{let n=x(j);return n=e||n,A((()=>(0,g.ok)(n)),[n])}},408148:(e,n,i)=>{"use strict";i.d(n,{N:()=>s});var a=i(513432),t=i(266713),r=i(284942),l=i(526521),o=i(618278);const d=(0,i(965804).O)({root:{oivjwe:"f1h8hb77",dvvfom:"f1x7u7e9",w71qe1:"f13mvf36",Bkioxbp:"f1cmlufx",C4gs1y:"f10aw75t",Beapcnx:"fsle3fq",Jkg3mj:"f17ae5zn"},subtle:{C4gs1y:"f18y0hww",Beapcnx:"f8r86f8"},inline:{dvvfom:"f1lqvz6u"},inlineSubtle:{dvvfom:"f1842k2q"},disabled:{dvvfom:"f1x7u7e9",C4gs1y:"f1y8dcps",Beapcnx:"f16x84av"}}),s=a.forwardRef(((e,n)=>{const i=(0,t.f)(e,n);i.root.dir="string"==typeof e.children?"auto":void 0,(0,r.r)(i);const{appearance:a,disabled:s,inline:m}=i,c=d();return i.root.className=(0,l.z)(i.root.className,c.root,"subtle"===a&&c.subtle,m&&c.inline,"subtle"===a&&m&&c.inlineSubtle,s&&c.disabled,e.className),(0,o.q)(i)}))},351198:(e,n,i)=>{"use strict";i.d(n,{P6:()=>u,oD:()=>k});var a=i(957032),t=i(513432),r=i(849731),l=i(823769),o=i(413455),d=i(364819),s=i(50467),m=i(847382);const c="333ms";var u;!function(e){e[e.Fail=0]="Fail",e[e.Loading=1]="Loading",e[e.Succeed=2]="Succeed"}(u||(u={}));class p extends t.PureComponent{constructor(){super(...arguments),this._loaderImage=null,this.state={...this._getInitialState(this.props)},this._getImageComponent=e=>{const{fixedAspectRatio:n,variables:i,isInlineImageWrapper:t,isImageInlineOrAttached:o,dataImageMode:d}=this.props,{maxHeight:s,maxWidth:m}=this.state,u=this._shouldShowImage(),p=this._shouldAddPlaceholder();return(0,a.Y)(r.s,{as:"span",itemType:d,style:{...!o&&{maxHeight:n?`${s}rem`:void 0,maxWidth:`${m}rem`}},variables:{...i,hasFixedAspectRatio:n,isRelativePositioned:p,isInlineImageWrapper:t},children:[(0,a.Y)(l.X,{visible:u,name:"fadeInInPlace",duration:c,iterationCount:"1",fillMode:"forwards",children:e}),this._getImagePlaceholder()]})},this._getHeightsAndWidths=()=>{const{width:e,height:n}=this.props;let i,a=20;if(e&&n){const t=this._getMaxHeightAndMaxWidth(n,e);a=t.maxHeight,i=t.maxWidth}return{height:n,maxHeight:a,maxWidth:i,width:e}},this._getImagePlaceholder=()=>{const{placeholder:e,preLoadState:n}=this.props,{loadState:i}=this.state;if(e&&this._shouldAddPlaceholder())return i===u.Fail||n===u.Fail?e.failureCbElem:e.loadingCbElem},this._loadImageEventListener=()=>{this.props.scenarioHandler&&this.props.scenarioHandler(u.Succeed),this.setState({src:this.props.src,loadState:u.Succeed})},this._errorImageEventListener=()=>{this.props.scenarioHandler&&this.props.scenarioHandler(u.Fail),this.setState({src:this.props.src,loadState:u.Fail})},this._lazyLoadImage=()=>{const{host:{Image:e}}=this.props;this._loaderImage=new e,this._loaderImage.addEventListener("load",this._loadImageEventListener,{once:!0}),this._loaderImage.addEventListener("error",this._errorImageEventListener,{once:!0}),this._loaderImage.src=this.props.src},this._shouldShowImage=()=>{const{preLoadState:e}=this.props,{loadState:n}=this.state;return e===u.Succeed||n===u.Succeed},this._shouldAddPlaceholder=()=>{const{placeholder:e}=this.props;return!this._shouldShowImage()&&!!e}}componentDidMount(){(0,d.isEmpty)(this.props.src)||this._lazyLoadImage()}componentWillUnmount(){this._loaderImage?.removeEventListener("load",this._loadImageEventListener),this._loaderImage?.removeEventListener("error",this._errorImageEventListener)}componentDidUpdate(e,n){const{src:i,preLoadState:a,scenarioHandler:t}=this.props,{loadState:r}=this.state;a===u.Succeed&&this.setState({src:i});const l=a===u.Fail||r===u.Fail;if(e.src===i||l)l&&t&&t(u.Fail);else{const{height:e,maxHeight:n,maxWidth:i,width:a}=this._getHeightsAndWidths();this._lazyLoadImage(),this.setState({height:e,loadState:u.Loading,maxHeight:n,maxWidth:i,width:a})}}render(){const{alt:e,as:n,fixedAspectRatio:i,height:t,id:d,itemType:s,placeholder:u,preLoadState:p,scenarioHandler:k,src:g,styles:N,variables:v,width:I,host:S,isInlineImageWrapper:A,isImageInlineOrAttached:T,isMosaicIcon:f,dataImageMode:M,dataGifSrc:h,...y}=this.props,{height:F,maxHeight:b,maxWidth:C,src:D,width:U,loadState:E}=this.state,w=`lazy-image-${E}`,L="lazy-image",x=this._shouldShowImage();let O;const P=this._shouldAddPlaceholder();if(U&&F){let t=m.Y5.NONE;return T&&(t=(0,m.AJ)(U,F)),O=(0,a.Y)(o._,{as:n,"data-tid":w,"data-inp":L,alt:e,className:"ui-known-width-and-height",id:d,itemType:s,"data-image-type":t,"data-image-mode":M,"data-gif-src":h,src:i?"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7":D,style:{...!T&&{maxHeight:`${b}rem`,maxWidth:`${C}rem`},...i&&{backgroundImage:`url("${D}")`}},styles:{...i?{backgroundPosition:"center",backgroundSize:"cover",height:"100%",width:"100%"}:N,...f&&{padding:0}},variables:{...v,hasKnownWidthAndHeight:!0,isImageInlineOrAttached:T},...y}),this._getImageComponent(O)}return i?(O=(0,a.Y)(o._,{as:n,"data-tid":w,"data-inp":L,alt:e,id:d,itemType:s,src:D,className:"ui-unknown-width-or-height","data-image-type":T?m.Y5.STANDARD:null,"data-image-mode":M,"data-gif-src":h,style:{...i&&{backgroundImage:`url("${D}")`}},variables:{...v,responsiveImageUnknownHeightAndWidth:!0},...y}),this._getImageComponent(O)):(0,a.Y)(r.s,{as:"span",variables:{...v,isRelativePositioned:P},children:[(0,a.Y)(l.X,{visible:x,name:"fadeInInPlace",duration:c,iterationCount:"1",fillMode:"forwards",children:(0,a.Y)(o._,{as:n,"data-tid":w,"data-inp":L,"aria-label":e,className:"ui-unknown-width-or-height","data-image-type":T?m.Y5.STANDARD:null,"data-image-mode":M,"data-gif-src":h,id:d,itemType:s,role:"img",style:{backgroundImage:`url("${D}")`,...!T&&{paddingTop:`${b}rem`}},styles:{...N,...T&&{backgroundSize:"cover"}},variables:{...v,hasUnknownWidthOrHeight:!0},...y})}),this._getImagePlaceholder()]})}_getInitialState(e){const{width:n,height:i,isVideoThumbnail:a,preLoadState:t}=e,r=t===u.Succeed;let l,o,d=20;if(n&&i){const e=this._getMaxHeightAndMaxWidth(i,n,a);d=e.maxHeight,l=e.maxWidth,o=`0 0 ${n} ${i}`}else o=`0 0 1 ${d}`;return{height:i,maxHeight:d,maxWidth:l,src:r?e.src:`data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="${o}"%3E%3C/svg%3E`,width:n,loadState:r?u.Succeed:u.Loading}}_getMaxHeightAndMaxWidth(e,n,i){const a=n/e;let t=e/10,r=n/10>62?62:n/10;return(t>48||a<.5)&&(i||(t=48),r=a*t),{maxHeight:t,maxWidth:r}}}const k=e=>{const{host:n}=(0,s.ur)();return(0,a.Y)(p,{...e,host:n})}},504820:(e,n,i)=>{"use strict";i.d(n,{z:()=>m});var a=i(957032),t=i(513432),r=i(670214),l=i(127066),o=i(332752),d=i(312999);const s=({children:e})=>{const{disallowAppRegionOverrides:n}=(0,l.w2)(o.w.Core,["disallowAppRegionOverrides"]);return(0,a.Y)(t.Fragment,{children:e({disallowAppRegionOverrides:!!n})})},m=e=>{const{UNSAFE_overflowAndFlipBoundaryRef:n}=(0,d.g6)(),{disableOverflowAndFlipBoundaryContext:i,...t}=e,o=i?{}:{flipBoundary:n?.current||"window",overflowBoundary:n?.current||"window"};l.w2._isMockFunction;return(0,a.Y)(s,{children:({disallowAppRegionOverrides:e})=>(e&&(t.content={...t.content,variables:{...t.content?.variables,disallowAppRegionOverrides:e}}),(0,a.Y)(r.z,{...t,...o}))})}},835895:(e,n,i)=>{"use strict";i.d(n,{S:()=>o});var a=i(957032),t=i(513432),r=i(608797),l=i(351198);const o=e=>{const n=(0,r.Ff)(),{variables:i}=e,o=t.useMemo((()=>({...i,...n})),[n,i]);return(0,a.Y)(l.oD,{...e,variables:o})}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/13290-7310287088f13a4f.js.map